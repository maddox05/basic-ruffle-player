!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("colyseus.js",["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Colyseus={})}(this,(function(e){"use strict";function _mergeNamespaces(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return null!==e&&"object"==typeof e&&e.buffer instanceof ArrayBuffer}),"undefined"==typeof globalThis&&"undefined"!=typeof window&&(window.globalThis=window);var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},extendStatics(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}function __awaiter(e,t,n,r){return new(n||(n=Promise))((function(i,o){function fulfilled(e){try{step(r.next(e))}catch(e){o(e)}}function rejected(e){try{step(r.throw(e))}catch(e){o(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))}function __generator(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(a){return function(c){return function step(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function apply(e,t){t.statusMessage=e.statusText,t.statusCode=e.status,t.data=e.body}function send(e,t,n){var r,i,o=(n=n||{}).body;return n.method=e,n.headers=n.headers||{},o instanceof FormData||o&&"object"==typeof o&&(n.headers["content-type"]="application/json",n.body=JSON.stringify(o)),n.withCredentials&&(n.credentials="include"),n.timeout&&(i=new AbortController,n.signal=i.signal,r=setTimeout(i.abort,n.timeout)),new Promise(((e,s)=>{fetch(t,n).then(((t,i)=>{clearTimeout(r),apply(t,t),i=t.status>=400?s:e,(o=t.headers.get("content-type"))&&~o.indexOf("application/json")?t.text().then((e=>{try{t.data=JSON.parse(e,n.reviver),i(t)}catch(e){e.headers=t.headers,apply(t,e),s(e)}})):i(t)})).catch((e=>{e.timeout=i&&i.signal.aborted,s(e)}))}))}var t,n=send.bind(send,"GET"),r=send.bind(send,"POST"),i=send.bind(send,"PATCH"),o=send.bind(send,"DELETE"),s=send.bind(send,"PUT"),a=n,c=r,h={del:o,get:a,patch:i,post:c,put:s,send:send},f=_mergeNamespaces({__proto__:null,default:h,del:o,get:a,patch:i,post:c,put:s,send:send},[h]);!function(e){e[e.CONSENTED=4e3]="CONSENTED",e[e.DEVMODE_RESTART=4010]="DEVMODE_RESTART"}(t||(t={}));var u=function(e){function ServerError(t,n){var r=e.call(this,n)||this;return r.name="ServerError",r.code=t,r}return __extends(ServerError,e),ServerError}(Error);function Decoder(e,t){if(this._offset=t,e instanceof ArrayBuffer)this._buffer=e,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(e))throw new Error("Invalid argument");this._buffer=e.buffer,this._view=new DataView(this._buffer,e.byteOffset,e.byteLength)}}Decoder.prototype._array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this._parse();return t},Decoder.prototype._map=function(e){for(var t={},n=0;n<e;n++)t[this._parse()]=this._parse();return t},Decoder.prototype._str=function(e){var t=function utf8Read$1(e,t,n){for(var r="",i=0,o=t,s=t+n;o<s;o++){var a=e.getUint8(o);if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(i=(7&a)<<18|(63&e.getUint8(++o))<<12|(63&e.getUint8(++o))<<6|(63&e.getUint8(++o))<<0)>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i)}else r+=String.fromCharCode((15&a)<<12|(63&e.getUint8(++o))<<6|(63&e.getUint8(++o))<<0);else r+=String.fromCharCode((31&a)<<6|63&e.getUint8(++o));else r+=String.fromCharCode(a)}return r}(this._view,this._offset,e);return this._offset+=e,t},Decoder.prototype._bin=function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t},Decoder.prototype._parse=function(){var e,t=this._view.getUint8(this._offset++),n=0,r=0,i=0,o=0;if(t<192)return t<128?t:t<144?this._map(15&t):t<160?this._array(15&t):this._str(31&t);if(t>223)return-1*(255-t+1);switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this._view.getUint8(this._offset),this._offset+=1,this._bin(n);case 197:return n=this._view.getUint16(this._offset),this._offset+=2,this._bin(n);case 198:return n=this._view.getUint32(this._offset),this._offset+=4,this._bin(n);case 199:if(n=this._view.getUint8(this._offset),r=this._view.getInt8(this._offset+1),this._offset+=2,-1===r){var s=this._view.getUint32(this._offset);return i=this._view.getInt32(this._offset+4),o=this._view.getUint32(this._offset+8),this._offset+=12,new Date(1e3*(4294967296*i+o)+s/1e6)}return[r,this._bin(n)];case 200:return n=this._view.getUint16(this._offset),r=this._view.getInt8(this._offset+2),this._offset+=3,[r,this._bin(n)];case 201:return n=this._view.getUint32(this._offset),r=this._view.getInt8(this._offset+4),this._offset+=5,[r,this._bin(n)];case 202:return e=this._view.getFloat32(this._offset),this._offset+=4,e;case 203:return e=this._view.getFloat64(this._offset),this._offset+=8,e;case 204:return e=this._view.getUint8(this._offset),this._offset+=1,e;case 205:return e=this._view.getUint16(this._offset),this._offset+=2,e;case 206:return e=this._view.getUint32(this._offset),this._offset+=4,e;case 207:return i=this._view.getUint32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,i+o;case 208:return e=this._view.getInt8(this._offset),this._offset+=1,e;case 209:return e=this._view.getInt16(this._offset),this._offset+=2,e;case 210:return e=this._view.getInt32(this._offset),this._offset+=4,e;case 211:return i=this._view.getInt32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,i+o;case 212:return r=this._view.getInt8(this._offset),this._offset+=1,0===r?void(this._offset+=1):[r,this._bin(1)];case 213:return r=this._view.getInt8(this._offset),this._offset+=1,[r,this._bin(2)];case 214:return r=this._view.getInt8(this._offset),this._offset+=1,-1===r?(e=this._view.getUint32(this._offset),this._offset+=4,new Date(1e3*e)):[r,this._bin(4)];case 215:return r=this._view.getInt8(this._offset),this._offset+=1,0===r?(i=this._view.getInt32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,new Date(i+o)):-1===r?(i=this._view.getUint32(this._offset),o=this._view.getUint32(this._offset+4),this._offset+=8,new Date(1e3*(4294967296*(3&i)+o)+(i>>>2)/1e6)):[r,this._bin(8)];case 216:return r=this._view.getInt8(this._offset),this._offset+=1,[r,this._bin(16)];case 217:return n=this._view.getUint8(this._offset),this._offset+=1,this._str(n);case 218:return n=this._view.getUint16(this._offset),this._offset+=2,this._str(n);case 219:return n=this._view.getUint32(this._offset),this._offset+=4,this._str(n);case 220:return n=this._view.getUint16(this._offset),this._offset+=2,this._array(n);case 221:return n=this._view.getUint32(this._offset),this._offset+=4,this._array(n);case 222:return n=this._view.getUint16(this._offset),this._offset+=2,this._map(n);case 223:return n=this._view.getUint32(this._offset),this._offset+=4,this._map(n)}throw new Error("Could not parse")};function utf8Write(e,t,n){for(var r=0,i=0,o=n.length;i<o;i++)(r=n.charCodeAt(i))<128?e.setUint8(t++,r):r<2048?(e.setUint8(t++,192|r>>6),e.setUint8(t++,128|63&r)):r<55296||r>=57344?(e.setUint8(t++,224|r>>12),e.setUint8(t++,128|r>>6&63),e.setUint8(t++,128|63&r)):(i++,r=65536+((1023&r)<<10|1023&n.charCodeAt(i)),e.setUint8(t++,240|r>>18),e.setUint8(t++,128|r>>12&63),e.setUint8(t++,128|r>>6&63),e.setUint8(t++,128|63&r))}function _encode(e,t,n){var r=typeof n,i=0,o=0,s=0,a=0,c=0,h=0;if("string"===r){if(c=function utf8Length$1(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(n),c<32)e.push(160|c),h=1;else if(c<256)e.push(217,c),h=2;else if(c<65536)e.push(218,c>>8,c),h=3;else{if(!(c<4294967296))throw new Error("String too long");e.push(219,c>>24,c>>16,c>>8,c),h=5}return t.push({_str:n,_length:c,_offset:e.length}),h+c}if("number"===r)return Math.floor(n)===n&&isFinite(n)?n>=0?n<128?(e.push(n),1):n<256?(e.push(204,n),2):n<65536?(e.push(205,n>>8,n),3):n<4294967296?(e.push(206,n>>24,n>>16,n>>8,n),5):(s=n/Math.pow(2,32)>>0,a=n>>>0,e.push(207,s>>24,s>>16,s>>8,s,a>>24,a>>16,a>>8,a),9):n>=-32?(e.push(n),1):n>=-128?(e.push(208,n),2):n>=-32768?(e.push(209,n>>8,n),3):n>=-2147483648?(e.push(210,n>>24,n>>16,n>>8,n),5):(s=Math.floor(n/Math.pow(2,32)),a=n>>>0,e.push(211,s>>24,s>>16,s>>8,s,a>>24,a>>16,a>>8,a),9):(e.push(203),t.push({_float:n,_length:8,_offset:e.length}),9);if("object"===r){if(null===n)return e.push(192),1;if(Array.isArray(n)){if((c=n.length)<16)e.push(144|c),h=1;else if(c<65536)e.push(220,c>>8,c),h=3;else{if(!(c<4294967296))throw new Error("Array too large");e.push(221,c>>24,c>>16,c>>8,c),h=5}for(i=0;i<c;i++)h+=_encode(e,t,n[i]);return h}if(n instanceof Date){var f=n.getTime(),u=Math.floor(f/1e3),l=1e6*(f-1e3*u);return u>=0&&l>=0&&u<=17179869183?0===l&&u<=4294967295?(e.push(214,255,u>>24,u>>16,u>>8,u),6):(s=u/4294967296,a=4294967295&u,e.push(215,255,l>>22,l>>14,l>>6,s,a>>24,a>>16,a>>8,a),10):(s=Math.floor(u/4294967296),a=u>>>0,e.push(199,12,255,l>>24,l>>16,l>>8,l,s>>24,s>>16,s>>8,s,a>>24,a>>16,a>>8,a),15)}if(n instanceof ArrayBuffer){if((c=n.byteLength)<256)e.push(196,c),h=2;else if(c<65536)e.push(197,c>>8,c),h=3;else{if(!(c<4294967296))throw new Error("Buffer too large");e.push(198,c>>24,c>>16,c>>8,c),h=5}return t.push({_bin:n,_length:c,_offset:e.length}),h+c}if("function"==typeof n.toJSON)return _encode(e,t,n.toJSON());var d=[],p="",y=Object.keys(n);for(i=0,o=y.length;i<o;i++)void 0!==n[p=y[i]]&&"function"!=typeof n[p]&&d.push(p);if((c=d.length)<16)e.push(128|c),h=1;else if(c<65536)e.push(222,c>>8,c),h=3;else{if(!(c<4294967296))throw new Error("Object too large");e.push(223,c>>24,c>>16,c>>8,c),h=5}for(i=0;i<c;i++)h+=_encode(e,t,p=d[i]),h+=_encode(e,t,n[p]);return h}if("boolean"===r)return e.push(n?195:194),1;if("undefined"===r)return e.push(192),1;if("function"==typeof n.toJSON)return _encode(e,t,n.toJSON());throw new Error("Could not encode")}function encode(e){var t=[],n=[],r=_encode(t,n,e),i=new ArrayBuffer(r),o=new DataView(i),s=0,a=0,c=-1;n.length>0&&(c=n[0]._offset);for(var h,f=0,u=0,l=0,d=t.length;l<d;l++)if(o.setUint8(a+l,t[l]),l+1===c){if(f=(h=n[s])._length,u=a+c,h._bin)for(var p=new Uint8Array(h._bin),y=0;y<f;y++)o.setUint8(u+y,p[y]);else h._str?utf8Write(o,u,h._str):void 0!==h._float&&o.setFloat64(u,h._float);a+=f,n[++s]&&(c=n[s]._offset)}return i}var l,d,p=globalThis.WebSocket||function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")},y=function(){function WebSocketTransport(e){this.events=e}return WebSocketTransport.prototype.send=function(e){e instanceof ArrayBuffer?this.ws.send(e):Array.isArray(e)&&this.ws.send(new Uint8Array(e).buffer)},WebSocketTransport.prototype.connect=function(e){this.ws=new p(e,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror},WebSocketTransport.prototype.close=function(e,t){this.ws.close(e,t)},Object.defineProperty(WebSocketTransport.prototype,"isOpen",{get:function(){return this.ws.readyState===p.OPEN},enumerable:!1,configurable:!0}),WebSocketTransport}(),v=function(){function Connection(){this.events={},this.transport=new y(this.events)}return Connection.prototype.send=function(e){this.transport.send(e)},Connection.prototype.connect=function(e){this.transport.connect(e)},Connection.prototype.close=function(e,t){this.transport.close(e,t)},Object.defineProperty(Connection.prototype,"isOpen",{get:function(){return this.transport.isOpen},enumerable:!1,configurable:!0}),Connection}();function utf8Read(e,t){for(var n=e[t++],r="",i=0,o=t,s=t+n;o<s;o++){var a=e[o];if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(i=(7&a)<<18|(63&e[++o])<<12|(63&e[++o])<<6|(63&e[++o])<<0)>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i)}else r+=String.fromCharCode((15&a)<<12|(63&e[++o])<<6|(63&e[++o])<<0);else r+=String.fromCharCode((31&a)<<6|63&e[++o]);else r+=String.fromCharCode(a)}return r}function utf8Length(e){void 0===e&&(e="");for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n+1}e.Protocol=void 0,(l=e.Protocol||(e.Protocol={}))[l.HANDSHAKE=9]="HANDSHAKE",l[l.JOIN_ROOM=10]="JOIN_ROOM",l[l.ERROR=11]="ERROR",l[l.LEAVE_ROOM=12]="LEAVE_ROOM",l[l.ROOM_DATA=13]="ROOM_DATA",l[l.ROOM_STATE=14]="ROOM_STATE",l[l.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",l[l.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",l[l.ROOM_DATA_BYTES=17]="ROOM_DATA_BYTES",e.ErrorCode=void 0,(d=e.ErrorCode||(e.ErrorCode={}))[d.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",d[d.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",d[d.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",d[d.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",d[d.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",d[d.AUTH_FAILED=4215]="AUTH_FAILED",d[d.APPLICATION_ERROR=4216]="APPLICATION_ERROR";var g={};function registerSerializer(e,t){g[e]=t}function getSerializer(e){var t=g[e];if(!t)throw new Error("missing serializer: "+e);return t}var m=function(){function EventEmitter(){this.handlers=[]}return EventEmitter.prototype.register=function(e,t){return this.handlers.push(e),this},EventEmitter.prototype.invoke=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.handlers.forEach((function(n){return n.apply(e,t)}))},EventEmitter.prototype.invokeAsync=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Promise.all(this.handlers.map((function(n){return n.apply(e,t)})))},EventEmitter.prototype.remove=function(e){var t=this.handlers.indexOf(e);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()},EventEmitter.prototype.clear=function(){this.handlers=[]},EventEmitter}();function createSignal(){var e=new m;function register(t){return e.register(t,null===this)}return register.once=function(t){var callback=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t.apply(this,n),e.remove(callback)};e.register(callback)},register.remove=function(t){return e.remove(t)},register.invoke=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.invoke.apply(e,t)},register.invokeAsync=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.invokeAsync.apply(e,t)},register.clear=function(){return e.clear()},register}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var A,S,E=function createCommonjsModule(e){var t={exports:{}};return e(t,t.exports),t.exports}((function(e,t){!function(e){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},extendStatics(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}function __decorate(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function __spreadArray(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var t,n=255,r=213;e.OPERATION=void 0,(t=e.OPERATION||(e.OPERATION={}))[t.ADD=128]="ADD",t[t.REPLACE=0]="REPLACE",t[t.DELETE=64]="DELETE",t[t.DELETE_AND_ADD=192]="DELETE_AND_ADD",t[t.TOUCH=1]="TOUCH",t[t.CLEAR=10]="CLEAR";var i=function(){function ChangeTree(e,t,n){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=e,this.setParent(t,n)}return ChangeTree.prototype.setParent=function(e,t,n){var r=this;if(this.indexes||(this.indexes=this.ref instanceof b?this.ref._definition.indexes:{}),this.parent=e,this.parentIndex=n,t)if(this.root=t,this.ref instanceof b){var i=this.ref._definition;for(var o in i.schema){var s=this.ref[o];if(s&&s.$changes){var a=i.indexes[o];s.$changes.setParent(this.ref,t,a)}}}else"object"==typeof this.ref&&this.ref.forEach((function(e,t){if(e instanceof b){var n=e.$changes,i=r.ref.$changes.indexes[t];n.setParent(r.ref,r.root,i)}}))},ChangeTree.prototype.operation=function(e){this.changes.set(--this.currentCustomOperation,e)},ChangeTree.prototype.change=function(t,n){void 0===n&&(n=e.OPERATION.ADD);var r="number"==typeof t?t:this.indexes[t];this.assertValidIndex(r,t);var i=this.changes.get(r);i&&i.op!==e.OPERATION.DELETE&&i.op!==e.OPERATION.TOUCH||this.changes.set(r,{op:i&&i.op===e.OPERATION.DELETE?e.OPERATION.DELETE_AND_ADD:n,index:r}),this.allChanges.add(r),this.changed=!0,this.touchParents()},ChangeTree.prototype.touch=function(t){var n="number"==typeof t?t:this.indexes[t];this.assertValidIndex(n,t),this.changes.has(n)||this.changes.set(n,{op:e.OPERATION.TOUCH,index:n}),this.allChanges.add(n),this.touchParents()},ChangeTree.prototype.touchParents=function(){this.parent&&this.parent.$changes.touch(this.parentIndex)},ChangeTree.prototype.getType=function(e){if(this.ref._definition)return(t=this.ref._definition).schema[t.fieldsByIndex[e]];var t,n=(t=this.parent._definition).schema[t.fieldsByIndex[this.parentIndex]];return Object.values(n)[0]},ChangeTree.prototype.getChildrenFilter=function(){var e=this.parent._definition.childFilters;return e&&e[this.parentIndex]},ChangeTree.prototype.getValue=function(e){return this.ref.getByIndex(e)},ChangeTree.prototype.delete=function(t){var n="number"==typeof t?t:this.indexes[t];if(void 0!==n){var r=this.getValue(n);this.changes.set(n,{op:e.OPERATION.DELETE,index:n}),this.allChanges.delete(n),delete this.caches[n],r&&r.$changes&&(r.$changes.parent=void 0),this.changed=!0,this.touchParents()}else console.warn("@colyseus/schema ".concat(this.ref.constructor.name,": trying to delete non-existing index: ").concat(t," (").concat(n,")"))},ChangeTree.prototype.discard=function(t,n){var r=this;void 0===t&&(t=!1),void 0===n&&(n=!1),this.ref instanceof b||this.changes.forEach((function(t){if(t.op===e.OPERATION.DELETE){var n=r.ref.getIndex(t.index);delete r.indexes[n]}})),this.changes.clear(),this.changed=t,n&&this.allChanges.clear(),this.currentCustomOperation=0},ChangeTree.prototype.discardAll=function(){var e=this;this.changes.forEach((function(t){var n=e.getValue(t.index);n&&n.$changes&&n.$changes.discardAll()})),this.discard()},ChangeTree.prototype.cache=function(e,t){this.caches[e]=t},ChangeTree.prototype.clone=function(){return new ChangeTree(this.ref,this.parent,this.root)},ChangeTree.prototype.ensureRefId=function(){void 0===this.refId&&(this.refId=this.root.getNextUniqueId())},ChangeTree.prototype.assertValidIndex=function(e,t){if(void 0===e)throw new Error('ChangeTree: missing index for field "'.concat(t,'"'))},ChangeTree}();function addCallback(e,t,n,r){return e[t]||(e[t]=[]),e[t].push(n),null==r||r.forEach((function(e,t){return n(e,t)})),function(){return spliceOne(e[t],e[t].indexOf(n))}}function removeChildRefs(t){var n=this,r="string"!=typeof this.$changes.getType();this.$items.forEach((function(i,o){t.push({refId:n.$changes.refId,op:e.OPERATION.DELETE,field:o,value:void 0,previousValue:i}),r&&n.$changes.root.removeRef(i.$changes.refId)}))}function spliceOne(e,t){if(-1===t||t>=e.length)return!1;for(var n=e.length-1,r=t;r<n;r++)e[r]=e[r+1];return e.length=n,!0}var DEFAULT_SORT=function(e,t){var n=e.toString(),r=t.toString();return n<r?-1:n>r?1:0};function getArrayProxy(e){return e.$proxy=!0,e=new Proxy(e,{get:function(e,t){return"symbol"==typeof t||isNaN(t)?e[t]:e.at(t)},set:function(e,t,n){if("symbol"==typeof t||isNaN(t))e[t]=n;else{var r=Array.from(e.$items.keys()),i=parseInt(r[t]||t);null==n?e.deleteAt(i):e.setAt(i,n)}return!0},deleteProperty:function(e,t){return"number"==typeof t?e.deleteAt(t):delete e[t],!0}})}var o=function(){function ArraySchema(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.$changes=new i(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,e)}return ArraySchema.prototype.onAdd=function(t,n){return void 0===n&&(n=!0),addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.ADD,t,n?this.$items:void 0)},ArraySchema.prototype.onRemove=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.DELETE,t)},ArraySchema.prototype.onChange=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.REPLACE,t)},ArraySchema.is=function(e){return Array.isArray(e)||void 0!==e.array},Object.defineProperty(ArraySchema.prototype,"length",{get:function(){return this.$items.size},set:function(e){0===e?this.clear():this.splice(e,this.length-e)},enumerable:!1,configurable:!0}),ArraySchema.prototype.push=function(){for(var e,t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){e=t.$refId++,t.setAt(e,n)})),e},ArraySchema.prototype.pop=function(){var e=Array.from(this.$indexes.values()).pop();if(void 0!==e){this.$changes.delete(e),this.$indexes.delete(e);var t=this.$items.get(e);return this.$items.delete(e),t}},ArraySchema.prototype.at=function(e){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)},ArraySchema.prototype.setAt=function(t,n){var r,i;void 0!==n.$changes&&n.$changes.setParent(this,this.$changes.root,t);var o=null!==(i=null===(r=this.$changes.indexes[t])||void 0===r?void 0:r.op)&&void 0!==i?i:e.OPERATION.ADD;this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,n),this.$changes.change(t,o)},ArraySchema.prototype.deleteAt=function(e){var t=Array.from(this.$items.keys())[e];return void 0!==t&&this.$deleteAt(t)},ArraySchema.prototype.$deleteAt=function(e){return this.$changes.delete(e),this.$indexes.delete(e),this.$items.delete(e)},ArraySchema.prototype.clear=function(t){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&removeChildRefs.call(this,t),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},ArraySchema.prototype.concat=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new(ArraySchema.bind.apply(ArraySchema,__spreadArray([void 0],(e=Array.from(this.$items.values())).concat.apply(e,t),!1)))},ArraySchema.prototype.join=function(e){return Array.from(this.$items.values()).join(e)},ArraySchema.prototype.reverse=function(){var e=this,t=Array.from(this.$items.keys());return Array.from(this.$items.values()).reverse().forEach((function(n,r){e.setAt(t[r],n)})),this},ArraySchema.prototype.shift=function(){var e=Array.from(this.$items.keys()).shift();if(void 0!==e){var t=this.$items.get(e);return this.$deleteAt(e),t}},ArraySchema.prototype.slice=function(e,t){var n=new ArraySchema;return n.push.apply(n,Array.from(this.$items.values()).slice(e,t)),n},ArraySchema.prototype.sort=function(e){var t=this;void 0===e&&(e=DEFAULT_SORT);var n=Array.from(this.$items.keys());return Array.from(this.$items.values()).sort(e).forEach((function(e,r){t.setAt(n[r],e)})),this},ArraySchema.prototype.splice=function(e,t){void 0===t&&(t=this.length-e);for(var n=Array.from(this.$items.keys()),r=[],i=e;i<e+t;i++)r.push(this.$items.get(n[i])),this.$deleteAt(n[i]);return r},ArraySchema.prototype.unshift=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.length,i=t.length,o=Array.from(this.$items.values());return t.forEach((function(t,n){e.setAt(n,t)})),o.forEach((function(t,n){e.setAt(i+n,t)})),r+i},ArraySchema.prototype.indexOf=function(e,t){return Array.from(this.$items.values()).indexOf(e,t)},ArraySchema.prototype.lastIndexOf=function(e,t){return void 0===t&&(t=this.length-1),Array.from(this.$items.values()).lastIndexOf(e,t)},ArraySchema.prototype.every=function(e,t){return Array.from(this.$items.values()).every(e,t)},ArraySchema.prototype.some=function(e,t){return Array.from(this.$items.values()).some(e,t)},ArraySchema.prototype.forEach=function(e,t){Array.from(this.$items.values()).forEach(e,t)},ArraySchema.prototype.map=function(e,t){return Array.from(this.$items.values()).map(e,t)},ArraySchema.prototype.filter=function(e,t){return Array.from(this.$items.values()).filter(e,t)},ArraySchema.prototype.reduce=function(e,t){return Array.prototype.reduce.apply(Array.from(this.$items.values()),arguments)},ArraySchema.prototype.reduceRight=function(e,t){return Array.prototype.reduceRight.apply(Array.from(this.$items.values()),arguments)},ArraySchema.prototype.find=function(e,t){return Array.from(this.$items.values()).find(e,t)},ArraySchema.prototype.findIndex=function(e,t){return Array.from(this.$items.values()).findIndex(e,t)},ArraySchema.prototype.fill=function(e,t,n){throw new Error("ArraySchema#fill() not implemented")},ArraySchema.prototype.copyWithin=function(e,t,n){throw new Error("ArraySchema#copyWithin() not implemented")},ArraySchema.prototype.toString=function(){return this.$items.toString()},ArraySchema.prototype.toLocaleString=function(){return this.$items.toLocaleString()},ArraySchema.prototype[Symbol.iterator]=function(){return Array.from(this.$items.values())[Symbol.iterator]()},ArraySchema.prototype.entries=function(){return this.$items.entries()},ArraySchema.prototype.keys=function(){return this.$items.keys()},ArraySchema.prototype.values=function(){return this.$items.values()},ArraySchema.prototype.includes=function(e,t){return Array.from(this.$items.values()).includes(e,t)},ArraySchema.prototype.flatMap=function(e,t){throw new Error("ArraySchema#flatMap() is not supported.")},ArraySchema.prototype.flat=function(e){throw new Error("ArraySchema#flat() is not supported.")},ArraySchema.prototype.findLast=function(){var e=Array.from(this.$items.values());return e.findLast.apply(e,arguments)},ArraySchema.prototype.findLastIndex=function(){var e=Array.from(this.$items.values());return e.findLastIndex.apply(e,arguments)},ArraySchema.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},ArraySchema.prototype.getIndex=function(e){return this.$indexes.get(e)},ArraySchema.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},ArraySchema.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},ArraySchema.prototype.toArray=function(){return Array.from(this.$items.values())},ArraySchema.prototype.toJSON=function(){return this.toArray().map((function(e){return"function"==typeof e.toJSON?e.toJSON():e}))},ArraySchema.prototype.clone=function(e){return e?new(ArraySchema.bind.apply(ArraySchema,__spreadArray([void 0],Array.from(this.$items.values()),!1))):new(ArraySchema.bind.apply(ArraySchema,__spreadArray([void 0],this.map((function(e){return e.$changes?e.clone():e})),!1)))},ArraySchema}();function getMapProxy(e){return e.$proxy=!0,e=new Proxy(e,{get:function(e,t){return"symbol"!=typeof t&&void 0===e[t]?e.get(t):e[t]},set:function(e,t,n){return"symbol"!=typeof t&&-1===t.indexOf("$")&&"onAdd"!==t&&"onRemove"!==t&&"onChange"!==t?e.set(t,n):e[t]=n,!0},deleteProperty:function(e,t){return e.delete(t),!0}})}var s=function(){function MapSchema(e){var t=this;if(this.$changes=new i(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e)if(e instanceof Map||e instanceof MapSchema)e.forEach((function(e,n){return t.set(n,e)}));else for(var n in e)this.set(n,e[n])}return MapSchema.prototype.onAdd=function(t,n){return void 0===n&&(n=!0),addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.ADD,t,n?this.$items:void 0)},MapSchema.prototype.onRemove=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.DELETE,t)},MapSchema.prototype.onChange=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.REPLACE,t)},MapSchema.is=function(e){return void 0!==e.map},MapSchema.prototype[Symbol.iterator]=function(){return this.$items[Symbol.iterator]()},Object.defineProperty(MapSchema.prototype,Symbol.toStringTag,{get:function(){return this.$items[Symbol.toStringTag]},enumerable:!1,configurable:!0}),MapSchema.prototype.set=function(t,n){if(null==n)throw new Error("MapSchema#set('".concat(t,"', ").concat(n,"): trying to set ").concat(n," value on '").concat(t,"'."));var r=void 0!==this.$changes.indexes[t],i=r?this.$changes.indexes[t]:this.$refId++,o=r?e.OPERATION.REPLACE:e.OPERATION.ADD,s=void 0!==n.$changes;return s&&n.$changes.setParent(this,this.$changes.root,i),r?s&&this.$items.get(t)!==n&&(o=e.OPERATION.ADD):(this.$changes.indexes[t]=i,this.$indexes.set(i,t)),this.$items.set(t,n),this.$changes.change(t,o),this},MapSchema.prototype.get=function(e){return this.$items.get(e)},MapSchema.prototype.delete=function(e){return this.$changes.delete(e),this.$items.delete(e)},MapSchema.prototype.clear=function(t){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&removeChildRefs.call(this,t),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},MapSchema.prototype.has=function(e){return this.$items.has(e)},MapSchema.prototype.forEach=function(e){this.$items.forEach(e)},MapSchema.prototype.entries=function(){return this.$items.entries()},MapSchema.prototype.keys=function(){return this.$items.keys()},MapSchema.prototype.values=function(){return this.$items.values()},Object.defineProperty(MapSchema.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),MapSchema.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},MapSchema.prototype.getIndex=function(e){return this.$indexes.get(e)},MapSchema.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},MapSchema.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},MapSchema.prototype.toJSON=function(){var e={};return this.forEach((function(t,n){e[n]="function"==typeof t.toJSON?t.toJSON():t})),e},MapSchema.prototype.clone=function(e){var t;return e?t=Object.assign(new MapSchema,this):(t=new MapSchema,this.forEach((function(e,n){e.$changes?t.set(n,e.clone()):t.set(n,e)}))),t},MapSchema}(),a={};function registerType(e,t){a[e]=t}function getType(e){return a[e]}var c=function(){function SchemaDefinition(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}return SchemaDefinition.create=function(e){var t=new SchemaDefinition;return t.schema=Object.assign({},e&&e.schema||{}),t.indexes=Object.assign({},e&&e.indexes||{}),t.fieldsByIndex=Object.assign({},e&&e.fieldsByIndex||{}),t.descriptors=Object.assign({},e&&e.descriptors||{}),t.deprecated=Object.assign({},e&&e.deprecated||{}),t},SchemaDefinition.prototype.addField=function(e,t){var n=this.getNextFieldIndex();this.fieldsByIndex[n]=e,this.indexes[e]=n,this.schema[e]=Array.isArray(t)?{array:t[0]}:t},SchemaDefinition.prototype.hasField=function(e){return void 0!==this.indexes[e]},SchemaDefinition.prototype.addFilter=function(e,t){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[e]]=t,this.indexesWithFilters.push(this.indexes[e]),!0},SchemaDefinition.prototype.addChildrenFilter=function(e,t){var n=this.indexes[e],r=this.schema[e];if(getType(Object.keys(r)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[n]=t,!0;console.warn("@filterChildren: field '".concat(e,"' can't have children. Ignoring filter."))},SchemaDefinition.prototype.getChildrenFilter=function(e){return this.childFilters&&this.childFilters[this.indexes[e]]},SchemaDefinition.prototype.getNextFieldIndex=function(){return Object.keys(this.schema||{}).length},SchemaDefinition}();function hasFilter(e){return e._context&&e._context.useFilters}var h=function(){function Context(){this.types={},this.schemas=new Map,this.useFilters=!1}return Context.prototype.has=function(e){return this.schemas.has(e)},Context.prototype.get=function(e){return this.types[e]},Context.prototype.add=function(e,t){void 0===t&&(t=this.schemas.size),e._definition=c.create(e._definition),e._typeid=t,this.types[t]=e,this.schemas.set(e,t)},Context.create=function(e){return void 0===e&&(e={}),function(t){return e.context||(e.context=new Context),type(t,e)}},Context}(),f=new h;function type(e,t){return void 0===t&&(t={}),function(n,r){var i=t.context||f,a=n.constructor;if(a._context=i,!e)throw new Error("".concat(a.name,': @type() reference provided for "').concat(r,"\" is undefined. Make sure you don't have any circular dependencies."));i.has(a)||i.add(a);var c=a._definition;if(c.addField(r,e),c.descriptors[r]){if(c.deprecated[r])return;try{throw new Error("@colyseus/schema: Duplicate '".concat(r,"' definition on '").concat(a.name,"'.\nCheck @type() annotation"))}catch(e){var h=e.stack.split("\n")[4].trim();throw new Error("".concat(e.message," ").concat(h))}}var u=o.is(e),l=!u&&s.is(e);if("string"!=typeof e&&!b.is(e)){var d=Object.values(e)[0];"string"==typeof d||i.has(d)||i.add(d)}if(t.manual)c.descriptors[r]={enumerable:!0,configurable:!0,writable:!0};else{var p="_".concat(r);c.descriptors[p]={enumerable:!1,configurable:!1,writable:!0},c.descriptors[r]={get:function(){return this[p]},set:function(e){e!==this[p]&&(null!=e?(!u||e instanceof o||(e=new(o.bind.apply(o,__spreadArray([void 0],e,!1)))),!l||e instanceof s||(e=new s(e)),void 0===e.$proxy&&(l?e=getMapProxy(e):u&&(e=getArrayProxy(e))),this.$changes.change(r),e.$changes&&e.$changes.setParent(this,this.$changes.root,this._definition.indexes[r])):this[p]&&this.$changes.delete(r),this[p]=e)},enumerable:!0,configurable:!0}}}}function filter(e){return function(t,n){var r=t.constructor;r._definition.addFilter(n,e)&&(r._context.useFilters=!0)}}function filterChildren(e){return function(t,n){var r=t.constructor;r._definition.addChildrenFilter(n,e)&&(r._context.useFilters=!0)}}function deprecated(e){return void 0===e&&(e=!0),function(t,n){var r=t.constructor._definition;r.deprecated[n]=!0,e&&(r.descriptors[n]={get:function(){throw new Error("".concat(n," is deprecated."))},set:function(e){},enumerable:!1,configurable:!0})}}function defineTypes(e,t,n){for(var r in void 0===n&&(n={}),n.context||(n.context=e._context||n.context||f),t)type(t[r],n)(e.prototype,r);return e}function utf8Length(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function utf8Write(e,t,n){for(var r=0,i=0,o=n.length;i<o;i++)(r=n.charCodeAt(i))<128?e[t++]=r:r<2048?(e[t++]=192|r>>6,e[t++]=128|63&r):r<55296||r>=57344?(e[t++]=224|r>>12,e[t++]=128|r>>6&63,e[t++]=128|63&r):(i++,r=65536+((1023&r)<<10|1023&n.charCodeAt(i)),e[t++]=240|r>>18,e[t++]=128|r>>12&63,e[t++]=128|r>>6&63,e[t++]=128|63&r)}function int8$1(e,t){e.push(255&t)}function uint8$1(e,t){e.push(255&t)}function int16$1(e,t){e.push(255&t),e.push(t>>8&255)}function uint16$1(e,t){e.push(255&t),e.push(t>>8&255)}function int32$1(e,t){e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255)}function uint32$1(e,t){var n=t>>24,r=t>>16,i=t>>8,o=t;e.push(255&o),e.push(255&i),e.push(255&r),e.push(255&n)}function int64$1(e,t){var n=Math.floor(t/Math.pow(2,32));uint32$1(e,t>>>0),uint32$1(e,n)}function uint64$1(e,t){var n=t/Math.pow(2,32)>>0;uint32$1(e,t>>>0),uint32$1(e,n)}function float32$1(e,t){writeFloat32(e,t)}function float64$1(e,t){writeFloat64(e,t)}var u=new Int32Array(2),l=new Float32Array(u.buffer),d=new Float64Array(u.buffer);function writeFloat32(e,t){l[0]=t,int32$1(e,u[0])}function writeFloat64(e,t){d[0]=t,int32$1(e,u[0]),int32$1(e,u[1])}function boolean$1(e,t){return uint8$1(e,t?1:0)}function string$1(e,t){t||(t="");var n=utf8Length(t),r=0;if(n<32)e.push(160|n),r=1;else if(n<256)e.push(217),uint8$1(e,n),r=2;else if(n<65536)e.push(218),uint16$1(e,n),r=3;else{if(!(n<4294967296))throw new Error("String too long");e.push(219),uint32$1(e,n),r=5}return utf8Write(e,e.length,t),r+n}function number$1(e,t){return isNaN(t)?number$1(e,0):isFinite(t)?t!==(0|t)?(e.push(203),writeFloat64(e,t),9):t>=0?t<128?(uint8$1(e,t),1):t<256?(e.push(204),uint8$1(e,t),2):t<65536?(e.push(205),uint16$1(e,t),3):t<4294967296?(e.push(206),uint32$1(e,t),5):(e.push(207),uint64$1(e,t),9):t>=-32?(e.push(224|t+32),1):t>=-128?(e.push(208),int8$1(e,t),2):t>=-32768?(e.push(209),int16$1(e,t),3):t>=-2147483648?(e.push(210),int32$1(e,t),5):(e.push(211),int64$1(e,t),9):number$1(e,t>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER)}var p=Object.freeze({__proto__:null,utf8Write:utf8Write,int8:int8$1,uint8:uint8$1,int16:int16$1,uint16:uint16$1,int32:int32$1,uint32:uint32$1,int64:int64$1,uint64:uint64$1,float32:float32$1,float64:float64$1,writeFloat32:writeFloat32,writeFloat64:writeFloat64,boolean:boolean$1,string:string$1,number:number$1});function utf8Read(e,t,n){for(var r="",i=0,o=t,s=t+n;o<s;o++){var a=e[o];0!=(128&a)?192!=(224&a)?224!=(240&a)?240!=(248&a)?console.error("Invalid byte "+a.toString(16)):(i=(7&a)<<18|(63&e[++o])<<12|(63&e[++o])<<6|(63&e[++o])<<0)>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i):r+=String.fromCharCode((15&a)<<12|(63&e[++o])<<6|(63&e[++o])<<0):r+=String.fromCharCode((31&a)<<6|63&e[++o]):r+=String.fromCharCode(a)}return r}function int8(e,t){return uint8(e,t)<<24>>24}function uint8(e,t){return e[t.offset++]}function int16(e,t){return uint16(e,t)<<16>>16}function uint16(e,t){return e[t.offset++]|e[t.offset++]<<8}function int32(e,t){return e[t.offset++]|e[t.offset++]<<8|e[t.offset++]<<16|e[t.offset++]<<24}function uint32(e,t){return int32(e,t)>>>0}function float32(e,t){return readFloat32(e,t)}function float64(e,t){return readFloat64(e,t)}function int64(e,t){var n=uint32(e,t);return int32(e,t)*Math.pow(2,32)+n}function uint64(e,t){var n=uint32(e,t);return uint32(e,t)*Math.pow(2,32)+n}var y=new Int32Array(2),v=new Float32Array(y.buffer),g=new Float64Array(y.buffer);function readFloat32(e,t){return y[0]=int32(e,t),v[0]}function readFloat64(e,t){return y[0]=int32(e,t),y[1]=int32(e,t),g[0]}function boolean(e,t){return uint8(e,t)>0}function string(e,t){var n,r=e[t.offset++];r<192?n=31&r:217===r?n=uint8(e,t):218===r?n=uint16(e,t):219===r&&(n=uint32(e,t));var i=utf8Read(e,t.offset,n);return t.offset+=n,i}function stringCheck(e,t){var n=e[t.offset];return n<192&&n>160||217===n||218===n||219===n}function number(e,t){var n=e[t.offset++];return n<128?n:202===n?readFloat32(e,t):203===n?readFloat64(e,t):204===n?uint8(e,t):205===n?uint16(e,t):206===n?uint32(e,t):207===n?uint64(e,t):208===n?int8(e,t):209===n?int16(e,t):210===n?int32(e,t):211===n?int64(e,t):n>223?-1*(255-n+1):void 0}function numberCheck(e,t){var n=e[t.offset];return n<128||n>=202&&n<=211}function arrayCheck(e,t){return e[t.offset]<160}function switchStructureCheck(e,t){return e[t.offset-1]===n&&(e[t.offset]<128||e[t.offset]>=202&&e[t.offset]<=211)}var m=Object.freeze({__proto__:null,int8:int8,uint8:uint8,int16:int16,uint16:uint16,int32:int32,uint32:uint32,float32:float32,float64:float64,int64:int64,uint64:uint64,readFloat32:readFloat32,readFloat64:readFloat64,boolean:boolean,string:string,stringCheck:stringCheck,number:number,numberCheck:numberCheck,arrayCheck:arrayCheck,switchStructureCheck:switchStructureCheck}),A=function(){function CollectionSchema(e){var t=this;this.$changes=new i(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((function(e){return t.add(e)}))}return CollectionSchema.prototype.onAdd=function(t,n){return void 0===n&&(n=!0),addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.ADD,t,n?this.$items:void 0)},CollectionSchema.prototype.onRemove=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.DELETE,t)},CollectionSchema.prototype.onChange=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.REPLACE,t)},CollectionSchema.is=function(e){return void 0!==e.collection},CollectionSchema.prototype.add=function(e){var t=this.$refId++;return void 0!==e.$changes&&e.$changes.setParent(this,this.$changes.root,t),this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,e),this.$changes.change(t),t},CollectionSchema.prototype.at=function(e){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)},CollectionSchema.prototype.entries=function(){return this.$items.entries()},CollectionSchema.prototype.delete=function(e){for(var t,n,r=this.$items.entries();(n=r.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t))},CollectionSchema.prototype.clear=function(t){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&removeChildRefs.call(this,t),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},CollectionSchema.prototype.has=function(e){return Array.from(this.$items.values()).some((function(t){return t===e}))},CollectionSchema.prototype.forEach=function(e){var t=this;this.$items.forEach((function(n,r,i){return e(n,r,t)}))},CollectionSchema.prototype.values=function(){return this.$items.values()},Object.defineProperty(CollectionSchema.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),CollectionSchema.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},CollectionSchema.prototype.getIndex=function(e){return this.$indexes.get(e)},CollectionSchema.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},CollectionSchema.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},CollectionSchema.prototype.toArray=function(){return Array.from(this.$items.values())},CollectionSchema.prototype.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},CollectionSchema.prototype.clone=function(e){var t;return e?t=Object.assign(new CollectionSchema,this):(t=new CollectionSchema,this.forEach((function(e){e.$changes?t.add(e.clone()):t.add(e)}))),t},CollectionSchema}(),S=function(){function SetSchema(e){var t=this;this.$changes=new i(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((function(e){return t.add(e)}))}return SetSchema.prototype.onAdd=function(t,n){return void 0===n&&(n=!0),addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.ADD,t,n?this.$items:void 0)},SetSchema.prototype.onRemove=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.DELETE,t)},SetSchema.prototype.onChange=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.REPLACE,t)},SetSchema.is=function(e){return void 0!==e.set},SetSchema.prototype.add=function(t){var n,r;if(this.has(t))return!1;var i=this.$refId++;void 0!==t.$changes&&t.$changes.setParent(this,this.$changes.root,i);var o=null!==(r=null===(n=this.$changes.indexes[i])||void 0===n?void 0:n.op)&&void 0!==r?r:e.OPERATION.ADD;return this.$changes.indexes[i]=i,this.$indexes.set(i,i),this.$items.set(i,t),this.$changes.change(i,o),i},SetSchema.prototype.entries=function(){return this.$items.entries()},SetSchema.prototype.delete=function(e){for(var t,n,r=this.$items.entries();(n=r.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t))},SetSchema.prototype.clear=function(t){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&removeChildRefs.call(this,t),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},SetSchema.prototype.has=function(e){for(var t,n=this.$items.values(),r=!1;(t=n.next())&&!t.done;)if(e===t.value){r=!0;break}return r},SetSchema.prototype.forEach=function(e){var t=this;this.$items.forEach((function(n,r,i){return e(n,r,t)}))},SetSchema.prototype.values=function(){return this.$items.values()},Object.defineProperty(SetSchema.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),SetSchema.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},SetSchema.prototype.getIndex=function(e){return this.$indexes.get(e)},SetSchema.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},SetSchema.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},SetSchema.prototype.toArray=function(){return Array.from(this.$items.values())},SetSchema.prototype.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},SetSchema.prototype.clone=function(e){var t;return e?t=Object.assign(new SetSchema,this):(t=new SetSchema,this.forEach((function(e){e.$changes?t.add(e.clone()):t.add(e)}))),t},SetSchema}(),E=function(){function ClientState(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return ClientState.prototype.addRefId=function(e){this.refIds.has(e)||(this.refIds.add(e),this.containerIndexes.set(e,new Set))},ClientState.get=function(e){return void 0===e.$filterState&&(e.$filterState=new ClientState),e.$filterState},ClientState}(),$=function(){function ReferenceTracker(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return ReferenceTracker.prototype.getNextUniqueId=function(){return this.nextUniqueId++},ReferenceTracker.prototype.addRef=function(e,t,n){void 0===n&&(n=!0),this.refs.set(e,t),n&&(this.refCounts[e]=(this.refCounts[e]||0)+1)},ReferenceTracker.prototype.removeRef=function(e){this.refCounts[e]=this.refCounts[e]-1,this.deletedRefs.add(e)},ReferenceTracker.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},ReferenceTracker.prototype.garbageCollectDeletedRefs=function(){var e=this;this.deletedRefs.forEach((function(t){if(!(e.refCounts[t]>0)){var n=e.refs.get(t);if(n instanceof b)for(var r in n._definition.schema)"string"!=typeof n._definition.schema[r]&&n[r]&&n[r].$changes&&e.removeRef(n[r].$changes.refId);else{var i=n.$changes.parent._definition,o=i.schema[i.fieldsByIndex[n.$changes.parentIndex]];"function"==typeof Object.values(o)[0]&&Array.from(n.values()).forEach((function(t){return e.removeRef(t.$changes.refId)}))}e.refs.delete(t),delete e.refCounts[t]}})),this.deletedRefs.clear()},ReferenceTracker}(),w=function(e){function EncodeSchemaError(){return null!==e&&e.apply(this,arguments)||this}return __extends(EncodeSchemaError,e),EncodeSchemaError}(Error);function assertType(e,t,n,r){var i,o=!1;switch(t){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":i="number",isNaN(e)&&console.log('trying to encode "NaN" in '.concat(n.constructor.name,"#").concat(r));break;case"string":i="string",o=!0;break;case"boolean":return}if(typeof e!==i&&(!o||o&&null!==e)){var s="'".concat(JSON.stringify(e),"'").concat(e&&e.constructor&&" (".concat(e.constructor.name,")")||"");throw new w("a '".concat(i,"' was expected, but ").concat(s," was provided in ").concat(n.constructor.name,"#").concat(r))}}function assertInstanceType(e,t,n,r){if(!(e instanceof t))throw new w("a '".concat(t.name,"' was expected, but '").concat(e.constructor.name,"' was provided in ").concat(n.constructor.name,"#").concat(r))}function encodePrimitiveType(e,t,n,r,i){assertType(n,e,r,i);var o=p[e];if(!o)throw new w("a '".concat(e,"' was expected, but ").concat(n," was provided in ").concat(r.constructor.name,"#").concat(i));o(t,n)}function decodePrimitiveType(e,t,n){return m[e](t,n)}var b=function(){function Schema(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object.defineProperties(this,{$changes:{value:new i(this,void 0,new $),enumerable:!1,writable:!0},$callbacks:{value:void 0,enumerable:!1,writable:!0}});var n=this._definition.descriptors;n&&Object.defineProperties(this,n),e[0]&&this.assign(e[0])}return Schema.onError=function(e){console.error(e)},Schema.is=function(e){return e._definition&&void 0!==e._definition.schema},Schema.prototype.onChange=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.REPLACE,t)},Schema.prototype.onRemove=function(t){return addCallback(this.$callbacks||(this.$callbacks=[]),e.OPERATION.DELETE,t)},Schema.prototype.assign=function(e){return Object.assign(this,e),this},Object.defineProperty(Schema.prototype,"_definition",{get:function(){return this.constructor._definition},enumerable:!1,configurable:!0}),Schema.prototype.setDirty=function(e,t){this.$changes.change(e,t)},Schema.prototype.listen=function(e,t,n){var r=this;return void 0===n&&(n=!0),this.$callbacks||(this.$callbacks={}),this.$callbacks[e]||(this.$callbacks[e]=[]),this.$callbacks[e].push(t),n&&void 0!==this[e]&&t(this[e],void 0),function(){return spliceOne(r.$callbacks[e],r.$callbacks[e].indexOf(t))}},Schema.prototype.decode=function(t,r,i){var a;void 0===r&&(r={offset:0}),void 0===i&&(i=this);var c=[],h=this.$changes.root,f=t.length,u=0;for(h.refs.set(u,this);r.offset<f;){var l=t[r.offset++];if(l!=n){var d=i.$changes,p=void 0!==i._definition,y=p?l>>6<<6:l;if(y!==e.OPERATION.CLEAR){var v=p?l%(y||255):number(t,r),g=p?i._definition.fieldsByIndex[v]:"",m=d.getType(v),E=void 0,$=void 0,w=void 0;if(p?$=i["_".concat(g)]:($=i.getByIndex(v),(y&e.OPERATION.ADD)===e.OPERATION.ADD?(w=i instanceof s?string(t,r):v,i.setIndex(v,w)):w=i.getIndex(v)),(y&e.OPERATION.DELETE)===e.OPERATION.DELETE&&(y!==e.OPERATION.DELETE_AND_ADD&&i.deleteByIndex(v),$&&$.$changes&&h.removeRef($.$changes.refId),E=null),void 0!==g){if(y===e.OPERATION.DELETE);else if(Schema.is(m)){var b=number(t,r);if(E=h.refs.get(b),y!==e.OPERATION.REPLACE){var O=this.getSchemaType(t,r,m);E||((E=this.createTypeInstance(O)).$changes.refId=b,$&&(E.$callbacks=$.$callbacks,$.$changes.refId&&b!==$.$changes.refId&&h.removeRef($.$changes.refId))),h.addRef(b,E,E!==$)}}else if("string"==typeof m)E=decodePrimitiveType(m,t,r);else{var I=getType(Object.keys(m)[0]),T=number(t,r),C=h.refs.has(T)?$||h.refs.get(T):new I.constructor;if((E=C.clone(!0)).$changes.refId=T,$&&(E.$callbacks=$.$callbacks,$.$changes.refId&&T!==$.$changes.refId)){h.removeRef($.$changes.refId);for(var R=$.entries(),x=void 0;(x=R.next())&&!x.done;){var P=(a=x.value)[0],k=a[1];c.push({refId:T,op:e.OPERATION.DELETE,field:P,value:void 0,previousValue:k})}}h.addRef(T,E,C!==$)}if(null!=E)if(E.$changes&&E.$changes.setParent(d.ref,d.root,v),i instanceof Schema)i[g]=E;else if(i instanceof s)P=w,i.$items.set(P,E),i.$changes.allChanges.add(v);else if(i instanceof o)i.setAt(v,E);else if(i instanceof A){var D=i.add(E);i.setIndex(v,D)}else i instanceof S&&!1!==(D=i.add(E))&&i.setIndex(v,D);$!==E&&c.push({refId:u,op:y,field:g,dynamicIndex:w,value:E,previousValue:$})}else{console.warn("@colyseus/schema: definition mismatch");for(var M={offset:r.offset};r.offset<f&&(!switchStructureCheck(t,r)||(M.offset=r.offset+1,!h.refs.has(number(t,M))));)r.offset++}}else i.clear(c)}else{u=number(t,r);var N=h.refs.get(u);if(!N)throw new Error('"refId" not found: '.concat(u));i=N}}return this._triggerChanges(c),h.garbageCollectDeletedRefs(),c},Schema.prototype.encode=function(t,r,i){void 0===t&&(t=!1),void 0===r&&(r=[]),void 0===i&&(i=!1);for(var o=this.$changes,a=new WeakSet,c=[o],h=1,f=0;f<h;f++){var u=c[f],l=u.ref,d=l instanceof Schema;u.ensureRefId(),a.add(u),u!==o&&(u.changed||t)&&(uint8$1(r,n),number$1(r,u.refId));for(var p=t?Array.from(u.allChanges):Array.from(u.changes.values()),y=0,v=p.length;y<v;y++){var g=t?{op:e.OPERATION.ADD,index:p[y]}:p[y],m=g.index,A=d?l._definition.fieldsByIndex&&l._definition.fieldsByIndex[m]:m,S=r.length;if(g.op!==e.OPERATION.TOUCH)if(d)uint8$1(r,m|g.op);else{if(uint8$1(r,g.op),g.op===e.OPERATION.CLEAR)continue;number$1(r,m)}if(d||(g.op&e.OPERATION.ADD)!=e.OPERATION.ADD||l instanceof s&&string$1(r,u.ref.$indexes.get(m)),g.op!==e.OPERATION.DELETE){var E=u.getType(m),$=u.getValue(m);if($&&$.$changes&&!a.has($.$changes)&&(c.push($.$changes),$.$changes.ensureRefId(),h++),g.op!==e.OPERATION.TOUCH){if(Schema.is(E))assertInstanceType($,E,l,A),number$1(r,$.$changes.refId),(g.op&e.OPERATION.ADD)===e.OPERATION.ADD&&this.tryEncodeTypeId(r,E,$.constructor);else if("string"==typeof E)encodePrimitiveType(E,r,$,l,A);else{var w=getType(Object.keys(E)[0]);assertInstanceType(l["_".concat(A)],w.constructor,l,A),number$1(r,$.$changes.refId)}i&&u.cache(m,r.slice(S))}}}t||i||u.discard()}return r},Schema.prototype.encodeAll=function(e){return this.encode(!0,[],e)},Schema.prototype.applyFilters=function(t,r){var i,o;void 0===r&&(r=!1);for(var a=this,c=new Set,h=E.get(t),f=[this.$changes],u=1,l=[],_loop_1=function(d){var y=f[d];if(c.has(y.refId))return"continue";var v=y.ref,g=v instanceof Schema;uint8$1(l,n),number$1(l,y.refId);var m=h.refIds.has(y),A=r||!m;h.addRefId(y);var S=h.containerIndexes.get(y),E=A?Array.from(y.allChanges):Array.from(y.changes.values());!r&&g&&v._definition.indexesWithFilters&&v._definition.indexesWithFilters.forEach((function(t){!S.has(t)&&y.allChanges.has(t)&&(A?E.push(t):E.push({op:e.OPERATION.ADD,index:t}))}));for(var $=0,w=E.length;$<w;$++){var b=A?{op:e.OPERATION.ADD,index:E[$]}:E[$];if(b.op!==e.OPERATION.CLEAR){var O=b.index;if(b.op!==e.OPERATION.DELETE){var I=y.getValue(O),T=y.getType(O);if(g){if((C=v._definition.filters&&v._definition.filters[O])&&!C.call(v,t,I,a)){I&&I.$changes&&c.add(I.$changes.refId);continue}}else{var C,R=y.parent;if((C=y.getChildrenFilter())&&!C.call(R,t,v.$indexes.get(O),I,a)){I&&I.$changes&&c.add(I.$changes.refId);continue}}if(I.$changes&&(f.push(I.$changes),u++),b.op!==e.OPERATION.TOUCH)if(b.op===e.OPERATION.ADD||g)l.push.apply(l,null!==(i=y.caches[O])&&void 0!==i?i:[]),S.add(O);else if(S.has(O))l.push.apply(l,null!==(o=y.caches[O])&&void 0!==o?o:[]);else{if(S.add(O),uint8$1(l,e.OPERATION.ADD),number$1(l,O),v instanceof s){var x=y.ref.$indexes.get(O);string$1(l,x)}I.$changes?number$1(l,I.$changes.refId):p[T](l,I)}else I.$changes&&!g&&(uint8$1(l,e.OPERATION.ADD),number$1(l,O),v instanceof s&&(x=y.ref.$indexes.get(O),string$1(l,x)),number$1(l,I.$changes.refId))}else g?uint8$1(l,b.op|O):(uint8$1(l,b.op),number$1(l,O))}else uint8$1(l,b.op)}},d=0;d<u;d++)_loop_1(d);return l},Schema.prototype.clone=function(){var e,t=new this.constructor,n=this._definition.schema;for(var r in n)"object"==typeof this[r]&&"function"==typeof(null===(e=this[r])||void 0===e?void 0:e.clone)?t[r]=this[r].clone():t[r]=this[r];return t},Schema.prototype.toJSON=function(){var e=this._definition.schema,t=this._definition.deprecated,n={};for(var r in e)t[r]||null===this[r]||void 0===this[r]||(n[r]="function"==typeof this[r].toJSON?this[r].toJSON():this["_".concat(r)]);return n},Schema.prototype.discardAllChanges=function(){this.$changes.discardAll()},Schema.prototype.getByIndex=function(e){return this[this._definition.fieldsByIndex[e]]},Schema.prototype.deleteByIndex=function(e){this[this._definition.fieldsByIndex[e]]=void 0},Schema.prototype.tryEncodeTypeId=function(e,t,n){t._typeid!==n._typeid&&(uint8$1(e,r),number$1(e,n._typeid))},Schema.prototype.getSchemaType=function(e,t,n){var i;return e[t.offset]===r&&(t.offset++,i=this.constructor._context.get(number(e,t))),i||n},Schema.prototype.createTypeInstance=function(e){var t=new e;return t.$changes.root=this.$changes.root,t},Schema.prototype._triggerChanges=function(t){for(var n,r,i,o,s,a,c,h,f,u=new Set,l=this.$changes.root.refs,_loop_2=function(d){var p=t[d],y=p.refId,v=l.get(y),g=v.$callbacks;if((p.op&e.OPERATION.DELETE)===e.OPERATION.DELETE&&p.previousValue instanceof Schema&&(null===(r=null===(n=p.previousValue.$callbacks)||void 0===n?void 0:n[e.OPERATION.DELETE])||void 0===r||r.forEach((function(e){return e()}))),!g)return"continue";if(v instanceof Schema){if(!u.has(y))try{null===(i=null==g?void 0:g[e.OPERATION.REPLACE])||void 0===i||i.forEach((function(e){return e(t)}))}catch(e){Schema.onError(e)}try{g.hasOwnProperty(p.field)&&(null===(o=g[p.field])||void 0===o||o.forEach((function(e){return e(p.value,p.previousValue)})))}catch(e){Schema.onError(e)}}else p.op===e.OPERATION.ADD&&void 0===p.previousValue?null===(s=g[e.OPERATION.ADD])||void 0===s||s.forEach((function(e){var t;return e(p.value,null!==(t=p.dynamicIndex)&&void 0!==t?t:p.field)})):p.op===e.OPERATION.DELETE?void 0!==p.previousValue&&(null===(a=g[e.OPERATION.DELETE])||void 0===a||a.forEach((function(e){var t;return e(p.previousValue,null!==(t=p.dynamicIndex)&&void 0!==t?t:p.field)}))):p.op===e.OPERATION.DELETE_AND_ADD&&(void 0!==p.previousValue&&(null===(c=g[e.OPERATION.DELETE])||void 0===c||c.forEach((function(e){var t;return e(p.previousValue,null!==(t=p.dynamicIndex)&&void 0!==t?t:p.field)}))),null===(h=g[e.OPERATION.ADD])||void 0===h||h.forEach((function(e){var t;return e(p.value,null!==(t=p.dynamicIndex)&&void 0!==t?t:p.field)}))),p.value!==p.previousValue&&(null===(f=g[e.OPERATION.REPLACE])||void 0===f||f.forEach((function(e){var t;return e(p.value,null!==(t=p.dynamicIndex)&&void 0!==t?t:p.field)})));u.add(y)},d=0;d<t.length;d++)_loop_2(d)},Schema._definition=c.create(),Schema}();function dumpChanges(e){for(var t=[e.$changes],n=1,r={},i=r,_loop_1=function(e){var n=t[e];n.changes.forEach((function(e){var t=n.ref,r=e.index,o=t._definition?t._definition.fieldsByIndex[r]:t.$indexes.get(r);i[o]=n.getValue(r)}))},o=0;o<n;o++)_loop_1(o);return r}var O={context:new h},I=function(e){function ReflectionField(){return null!==e&&e.apply(this,arguments)||this}return __extends(ReflectionField,e),__decorate([type("string",O)],ReflectionField.prototype,"name",void 0),__decorate([type("string",O)],ReflectionField.prototype,"type",void 0),__decorate([type("number",O)],ReflectionField.prototype,"referencedType",void 0),ReflectionField}(b),T=function(e){function ReflectionType(){var t=null!==e&&e.apply(this,arguments)||this;return t.fields=new o,t}return __extends(ReflectionType,e),__decorate([type("number",O)],ReflectionType.prototype,"id",void 0),__decorate([type([I],O)],ReflectionType.prototype,"fields",void 0),ReflectionType}(b),C=function(e){function Reflection(){var t=null!==e&&e.apply(this,arguments)||this;return t.types=new o,t}return __extends(Reflection,e),Reflection.encode=function(e){var t=e.constructor,n=new Reflection;n.rootType=t._typeid;var buildType=function(e,t){for(var r in t){var i=new I;i.name=r;var o=void 0;if("string"==typeof t[r])o=t[r];else{var s=t[r],a=void 0;b.is(s)?(o="ref",a=t[r]):"string"==typeof s[o=Object.keys(s)[0]]?o+=":"+s[o]:a=s[o],i.referencedType=a?a._typeid:-1}i.type=o,e.fields.push(i)}n.types.push(e)},r=t._context.types;for(var i in r){var o=new T;o.id=Number(i),buildType(o,r[i]._definition.schema)}return n.encodeAll()},Reflection.decode=function(e,t){var n=new h,r=new Reflection;r.decode(e,t);var i=r.types.reduce((function(e,t){var r=function(e){function _(){return null!==e&&e.apply(this,arguments)||this}return __extends(_,e),_}(b),i=t.id;return e[i]=r,n.add(r,i),e}),{});r.types.forEach((function(e){var t=i[e.id];e.fields.forEach((function(e){var r;if(void 0!==e.referencedType){var o=e.type,s=i[e.referencedType];if(!s){var a=e.type.split(":");o=a[0],s=a[1]}"ref"===o?type(s,{context:n})(t.prototype,e.name):type(((r={})[o]=s,r),{context:n})(t.prototype,e.name)}else type(e.type,{context:n})(t.prototype,e.name)}))}));var o=i[r.rootType],s=new o;for(var a in o._definition.schema){var c=o._definition.schema[a];"string"!=typeof c&&(s[a]="function"==typeof c?new c:new(getType(Object.keys(c)[0]).constructor))}return s},__decorate([type([T],O)],Reflection.prototype,"types",void 0),__decorate([type("number",O)],Reflection.prototype,"rootType",void 0),Reflection}(b);registerType("map",{constructor:s}),registerType("array",{constructor:o}),registerType("set",{constructor:S}),registerType("collection",{constructor:A}),e.ArraySchema=o,e.CollectionSchema=A,e.Context=h,e.MapSchema=s,e.Reflection=C,e.ReflectionField=I,e.ReflectionType=T,e.Schema=b,e.SchemaDefinition=c,e.SetSchema=S,e.decode=m,e.defineTypes=defineTypes,e.deprecated=deprecated,e.dumpChanges=dumpChanges,e.encode=p,e.filter=filter,e.filterChildren=filterChildren,e.hasFilter=hasFilter,e.registerType=registerType,e.type=type,Object.defineProperty(e,"__esModule",{value:!0})}(t)})),$=function(){function Room(e,t){var n=this;this.onStateChange=createSignal(),this.onError=createSignal(),this.onLeave=createSignal(),this.onJoin=createSignal(),this.hasJoined=!1,this.onMessageHandlers={emit:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=this.events[e]||[],i=0,o=r.length;i<o;i++)r[i].apply(r,t)},events:{},on:function(e,t){var n,r=this;return(null===(n=this.events[e])||void 0===n?void 0:n.push(t))||(this.events[e]=[t]),function(){var n;r.events[e]=null===(n=r.events[e])||void 0===n?void 0:n.filter((function(e){return t!==e}))}}},this.roomId=null,this.name=e,t&&(this.serializer=new(getSerializer("schema")),this.rootSchema=t,this.serializer.state=new t),this.onError((function(e,t){var n;return null===(n=console.warn)||void 0===n?void 0:n.call(console,"colyseus.js - onError => (".concat(e,") ").concat(t))})),this.onLeave((function(){return n.removeAllListeners()}))}return Object.defineProperty(Room.prototype,"id",{get:function(){return this.roomId},enumerable:!1,configurable:!0}),Room.prototype.connect=function(e,n,r){void 0===r&&(r=this);var i=new v;r.connection=i,i.events.onmessage=Room.prototype.onMessageCallback.bind(r),i.events.onclose=function(e){var i;if(!r.hasJoined)return null===(i=console.warn)||void 0===i||i.call(console,"Room connection was closed unexpectedly (".concat(e.code,"): ").concat(e.reason)),void r.onError.invoke(e.code,e.reason);e.code===t.DEVMODE_RESTART&&n?n():(r.onLeave.invoke(e.code),r.destroy())},i.events.onerror=function(e){var t;null===(t=console.warn)||void 0===t||t.call(console,"Room, onError (".concat(e.code,"): ").concat(e.reason)),r.onError.invoke(e.code,e.reason)},i.connect(e)},Room.prototype.leave=function(n){var r=this;return void 0===n&&(n=!0),new Promise((function(i){r.onLeave((function(e){return i(e)})),r.connection?n?r.connection.send([e.Protocol.LEAVE_ROOM]):r.connection.close():r.onLeave.invoke(t.CONSENTED)}))},Room.prototype.onMessage=function(e,t){return this.onMessageHandlers.on(this.getMessageHandlerKey(e),t)},Room.prototype.send=function(t,n){var r,i=[e.Protocol.ROOM_DATA];if("string"==typeof t?E.encode.string(i,t):E.encode.number(i,t),void 0!==n){var o=encode(n);(r=new Uint8Array(i.length+o.byteLength)).set(new Uint8Array(i),0),r.set(new Uint8Array(o),i.length)}else r=new Uint8Array(i);this.connection.send(r.buffer)},Room.prototype.sendBytes=function(t,n){var r,i=[e.Protocol.ROOM_DATA_BYTES];"string"==typeof t?E.encode.string(i,t):E.encode.number(i,t),(r=new Uint8Array(i.length+(n.byteLength||n.length))).set(new Uint8Array(i),0),r.set(new Uint8Array(n),i.length),this.connection.send(r.buffer)},Object.defineProperty(Room.prototype,"state",{get:function(){return this.serializer.getState()},enumerable:!1,configurable:!0}),Room.prototype.removeAllListeners=function(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}},Room.prototype.onMessageCallback=function(t){var n=Array.from(new Uint8Array(t.data)),r=n[0];if(r===e.Protocol.JOIN_ROOM){var i=1,o=utf8Read(n,i);if(i+=utf8Length(o),this.serializerId=utf8Read(n,i),i+=utf8Length(this.serializerId),!this.serializer){var s=getSerializer(this.serializerId);this.serializer=new s}n.length>i&&this.serializer.handshake&&this.serializer.handshake(n,{offset:i}),this.reconnectionToken="".concat(this.roomId,":").concat(o),this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([e.Protocol.JOIN_ROOM])}else if(r===e.Protocol.ERROR){var a={offset:1},c=E.decode.number(n,a),h=E.decode.string(n,a);this.onError.invoke(c,h)}else if(r===e.Protocol.LEAVE_ROOM)this.leave();else if(r===e.Protocol.ROOM_DATA_SCHEMA){var f={offset:1};(h=new(l=this.serializer.getState().constructor._context.get(E.decode.number(n,f)))).decode(n,f),this.dispatchMessage(l,h)}else if(r===e.Protocol.ROOM_STATE)n.shift(),this.setState(n);else if(r===e.Protocol.ROOM_STATE_PATCH)n.shift(),this.patch(n);else if(r===e.Protocol.ROOM_DATA){var u={offset:1},l=E.decode.stringCheck(n,u)?E.decode.string(n,u):E.decode.number(n,u);h=n.length>u.offset?function decode(e,t){void 0===t&&(t=0);var n=new Decoder(e,t),r=n._parse();if(n._offset!==e.byteLength)throw new Error(e.byteLength-n._offset+" trailing bytes");return r}(t.data,u.offset):void 0;this.dispatchMessage(l,h)}else if(r===e.Protocol.ROOM_DATA_BYTES){var d={offset:1};l=E.decode.stringCheck(n,d)?E.decode.string(n,d):E.decode.number(n,d);this.dispatchMessage(l,new Uint8Array(n.slice(d.offset)))}},Room.prototype.setState=function(e){this.serializer.setState(e),this.onStateChange.invoke(this.serializer.getState())},Room.prototype.patch=function(e){this.serializer.patch(e),this.onStateChange.invoke(this.serializer.getState())},Room.prototype.dispatchMessage=function(e,t){var n,r=this.getMessageHandlerKey(e);this.onMessageHandlers.events[r]?this.onMessageHandlers.emit(r,t):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",e,t):null===(n=console.warn)||void 0===n||n.call(console,"colyseus.js: onMessage() not registered for type '".concat(e,"'."))},Room.prototype.destroy=function(){this.serializer&&this.serializer.teardown()},Room.prototype.getMessageHandlerKey=function(e){switch(typeof e){case"function":return"$".concat(e._typeid);case"string":return e;case"number":return"i".concat(e);default:throw new Error("invalid message type.")}},Room}(),w=function(e){function MatchMakeError(t,n){var r=e.call(this,t)||this;return r.code=n,Object.setPrototypeOf(r,MatchMakeError.prototype),r}return __extends(MatchMakeError,e),MatchMakeError}(Error),b="undefined"!=typeof window&&void 0!==(null===(A=null===window||void 0===window?void 0:window.location)||void 0===A?void 0:A.hostname)?"".concat(window.location.protocol.replace("http","ws"),"//").concat(window.location.hostname).concat(window.location.port&&":".concat(window.location.port)):"ws://127.0.0.1:2567",O=function(){function Client(e){if(void 0===e&&(e=b),"string"==typeof e){var t=new URL(e),n="https:"===t.protocol||"wss:"===t.protocol,r=Number(t.port||(n?443:80));this.settings={hostname:t.hostname,pathname:"/"!==t.pathname?t.pathname:"",port:r,secure:n}}else void 0===e.port&&(e.port=e.secure?443:80),void 0===e.pathname&&(e.pathname=""),this.settings=e}return Client.prototype.joinOrCreate=function(e,t,n){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("joinOrCreate",e,t,n)];case 1:return[2,r.sent()]}}))}))},Client.prototype.create=function(e,t,n){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("create",e,t,n)];case 1:return[2,r.sent()]}}))}))},Client.prototype.join=function(e,t,n){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("join",e,t,n)];case 1:return[2,r.sent()]}}))}))},Client.prototype.joinById=function(e,t,n){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("joinById",e,t,n)];case 1:return[2,r.sent()]}}))}))},Client.prototype.reconnect=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n,r,i;return __generator(this,(function(o){switch(o.label){case 0:if("string"==typeof e&&"string"==typeof t)throw new Error("DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\nYou can get this token from previously connected `room.reconnectionToken`");return n=e.split(":"),r=n[0],i=n[1],[4,this.createMatchMakeRequest("reconnect",r,{reconnectionToken:i},t)];case 1:return[2,o.sent()]}}))}))},Client.prototype.getAvailableRooms=function(e){return void 0===e&&(e=""),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,a(this.getHttpEndpoint("".concat(e)),{headers:{Accept:"application/json"}})];case 1:return[2,t.sent().data]}}))}))},Client.prototype.consumeSeatReservation=function(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r,i,o,s=this;return __generator(this,(function(a){return(r=this.createRoom(e.room.name,t)).roomId=e.room.roomId,r.sessionId=e.sessionId,i={sessionId:r.sessionId},e.reconnectionToken&&(i.reconnectionToken=e.reconnectionToken),o=n||r,r.connect(this.buildEndpoint(e.room,i),e.devMode&&function(){return __awaiter(s,void 0,void 0,(function(){var n,i,s=this;return __generator(this,(function(a){return console.info("[Colyseus devMode]: ".concat(String.fromCodePoint(128260)," Re-establishing connection with room id '").concat(r.roomId,"'...")),n=0,8,i=function(){return __awaiter(s,void 0,void 0,(function(){return __generator(this,(function(s){switch(s.label){case 0:n++,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.consumeSeatReservation(e,t,o)];case 2:return s.sent(),console.info("[Colyseus devMode]: ".concat(String.fromCodePoint(9989)," Successfully re-established connection with room '").concat(r.roomId,"'")),[3,4];case 3:return s.sent(),n<8?(console.info("[Colyseus devMode]: ".concat(String.fromCodePoint(128260)," retrying... (").concat(n," out of ").concat(8,")")),setTimeout(i,2e3)):console.info("[Colyseus devMode]: ".concat(String.fromCodePoint(10060)," Failed to reconnect. Is your server running? Please check server logs.")),[3,4];case 4:return[2]}}))}))},setTimeout(i,2e3),[2]}))}))},o),[2,new Promise((function(e,t){var onError=function(e,n){return t(new u(e,n))};o.onError.once(onError),o.onJoin.once((function(){o.onError.remove(onError),e(o)}))}))]}))}))},Client.prototype.createMatchMakeRequest=function(e,t,n,r,i){return void 0===n&&(n={}),__awaiter(this,void 0,void 0,(function(){var o;return __generator(this,(function(s){switch(s.label){case 0:return[4,c(this.getHttpEndpoint("".concat(e,"/").concat(t)),{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})];case 1:if((o=s.sent().data).error)throw new w(o.error,o.code);return"reconnect"===e&&(o.reconnectionToken=n.reconnectionToken),[4,this.consumeSeatReservation(o,r,i)];case 2:return[2,s.sent()]}}))}))},Client.prototype.createRoom=function(e,t){return new $(e,t)},Client.prototype.buildEndpoint=function(e,t){void 0===t&&(t={});var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push("".concat(r,"=").concat(t[r]));var i=this.settings.secure?"wss://":"ws://";return e.publicAddress?i+="".concat(e.publicAddress):i+="".concat(this.settings.hostname).concat(this.getEndpointPort()).concat(this.settings.pathname),"".concat(i,"/").concat(e.processId,"/").concat(e.roomId,"?").concat(n.join("&"))},Client.prototype.getHttpEndpoint=function(e){return void 0===e&&(e=""),"".concat(this.settings.secure?"https":"http","://").concat(this.settings.hostname).concat(this.getEndpointPort()).concat(this.settings.pathname,"/matchmake/").concat(e)},Client.prototype.getEndpointPort=function(){return 80!==this.settings.port&&443!==this.settings.port?":".concat(this.settings.port):""},Client}();function getStorage(){return S||(S="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:{cache:{},setItem:function(e,t){this.cache[e]=t},getItem:function(e){this.cache[e]},removeItem:function(e){delete this.cache[e]}}),S}var I,T="colyseus-auth-token";e.Platform=void 0,(I=e.Platform||(e.Platform={})).ios="ios",I.android="android";var C=function(){function Auth(e){var t=this;this._id=void 0,this.username=void 0,this.displayName=void 0,this.avatarUrl=void 0,this.isAnonymous=void 0,this.email=void 0,this.lang=void 0,this.location=void 0,this.timezone=void 0,this.metadata=void 0,this.devices=void 0,this.facebookId=void 0,this.twitterId=void 0,this.googleId=void 0,this.gameCenterId=void 0,this.steamId=void 0,this.friendIds=void 0,this.blockedUserIds=void 0,this.createdAt=void 0,this.updatedAt=void 0,this.token=void 0,this.endpoint=e.replace("ws","http"),function getItem(e,t){var n=getStorage().getItem(e);"undefined"!=typeof Promise&&n instanceof Promise?n.then((function(e){return t(e)})):t(n)}(T,(function(e){return t.token=e}))}return Object.defineProperty(Auth.prototype,"hasToken",{get:function(){return!!this.token},enumerable:!1,configurable:!0}),Auth.prototype.login=function(e){return void 0===e&&(e={}),__awaiter(this,void 0,void 0,(function(){var t,n,r;return __generator(this,(function(i){switch(i.label){case 0:return t=Object.assign({},e),this.hasToken&&(t.token=this.token),[4,this.request("post","/auth",t)];case 1:for(r in n=i.sent(),this.token=n.token,function setItem(e,t){getStorage().setItem(e,t)}(T,this.token),n)this.hasOwnProperty(r)&&(this[r]=n[r]);return this.registerPingService(),[2,this]}}))}))},Auth.prototype.save=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.request("put","/auth",{},{username:this.username,displayName:this.displayName,avatarUrl:this.avatarUrl,lang:this.lang,location:this.location,timezone:this.timezone})];case 1:return e.sent(),[2,this]}}))}))},Auth.prototype.getFriends=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/all")];case 1:return[2,e.sent()]}}))}))},Auth.prototype.getOnlineFriends=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/online")];case 1:return[2,e.sent()]}}))}))},Auth.prototype.getFriendRequests=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/requests")];case 1:return[2,e.sent()]}}))}))},Auth.prototype.sendFriendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.request("post","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},Auth.prototype.acceptFriendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.request("put","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},Auth.prototype.declineFriendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.request("del","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},Auth.prototype.blockUser=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.request("post","/friends/block",{userId:e})];case 1:return[2,t.sent()]}}))}))},Auth.prototype.unblockUser=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.request("put","/friends/block",{userId:e})];case 1:return[2,t.sent()]}}))}))},Auth.prototype.request=function(e,t,n,r,i){return void 0===n&&(n={}),void 0===i&&(i={}),__awaiter(this,void 0,void 0,(function(){var o,s,a,c;return __generator(this,(function(h){switch(h.label){case 0:for(s in i.Accept="application/json",this.hasToken&&(i.Authorization="Bearer "+this.token),o=[],n)o.push("".concat(s,"=").concat(n[s]));return a=o.length>0?"?".concat(o.join("&")):"",c={headers:i},r&&(c.body=r),[4,f[e]("".concat(this.endpoint).concat(t).concat(a),c)];case 1:return[2,h.sent().data]}}))}))},Auth.prototype.logout=function(){this.token=void 0,function removeItem(e){getStorage().removeItem(e)}(T),this.unregisterPingService()},Auth.prototype.registerPingService=function(e){var t=this;void 0===e&&(e=15e3),this.unregisterPingService(),this.keepOnlineInterval=setInterval((function(){return t.request("get","/auth")}),e)},Auth.prototype.unregisterPingService=function(){clearInterval(this.keepOnlineInterval)},Auth}(),R=function(){function SchemaSerializer(){}return SchemaSerializer.prototype.setState=function(e){return this.state.decode(e)},SchemaSerializer.prototype.getState=function(){return this.state},SchemaSerializer.prototype.patch=function(e){return this.state.decode(e)},SchemaSerializer.prototype.teardown=function(){var e,t;null===(t=null===(e=this.state)||void 0===e?void 0:e.$changes)||void 0===t||t.root.clearRefs()},SchemaSerializer.prototype.handshake=function(e,t){this.state?(new E.Reflection).decode(e,t):this.state=E.Reflection.decode(e,t)},SchemaSerializer}(),x=function(){function NoneSerializer(){}return NoneSerializer.prototype.setState=function(e){},NoneSerializer.prototype.getState=function(){return null},NoneSerializer.prototype.patch=function(e){},NoneSerializer.prototype.teardown=function(){},NoneSerializer.prototype.handshake=function(e){},NoneSerializer}();registerSerializer("schema",R),registerSerializer("none",x),e.Auth=C,e.Client=O,e.Room=$,e.SchemaSerializer=R,e.registerSerializer=registerSerializer,Object.defineProperty(e,"__esModule",{value:!0})}));var CubemapRenderer=pc.createScript("cubemapRenderer");CubemapRenderer.attributes.add("inEditor",{type:"boolean",default:!0}),CubemapRenderer.attributes.add("resolution",{title:"Resolution",description:"Resolution of one side of a cubemap. Use power of 2 resolution if you wish to use Mipmaps.",type:"number",default:64}),CubemapRenderer.attributes.add("mipmaps",{title:"Mipmaps",description:"If set to true, mipmaps will be allocated and autogenerated.",type:"boolean",default:!1}),CubemapRenderer.attributes.add("depth",{title:"Depth",description:"If set to true, depth buffer will be created.",type:"boolean",default:!0}),CubemapRenderer.prototype.initialize=function(){var e=this.entity.camera;if(!e)return void console.error("CubemapRenderer component requires Camera component to be created on the Entity.");e.enabled=!1;var t=Math.min(this.resolution,this.app.graphicsDevice.maxCubeMapSize);this.cubeMap=new pc.Texture(this.app.graphicsDevice,{width:t,height:t,format:pc.PIXELFORMAT_R8_G8_B8_A8,cubemap:!0,mipmaps:this.mipmaps,minFilter:pc.FILTER_LINEAR_MIPMAP_LINEAR,magFilter:pc.FILTER_LINEAR});var r=[(new pc.Quat).setFromEulerAngles(0,90,0),(new pc.Quat).setFromEulerAngles(0,-90,0),(new pc.Quat).setFromEulerAngles(-90,0,180),(new pc.Quat).setFromEulerAngles(90,0,180),(new pc.Quat).setFromEulerAngles(0,180,0),(new pc.Quat).setFromEulerAngles(0,0,0)];const a=new pc.Entity("CubeMapCameras");this.CubeMapCameras=a,this.entity.addChild(a);for(var i=0;i<6;i++){var n=new pc.RenderTarget({colorBuffer:this.cubeMap,depth:this.depth,face:i,flipY:!0}),p=new pc.Entity("CubeMapCamera_"+i);p.uranusReflectionsCamera=!0,p.addComponent("camera",{aspectRatio:1,fov:90,layers:e.layers,priority:e.priority,clearColor:e.clearColor,clearColorBuffer:e.clearColorBuffer,clearDepthBuffer:e.clearDepthBuffer,clearStencilBuffer:e.clearStencilBuffer,farClip:e.farClip,nearClip:e.nearClip,frustumCulling:e.frustumCulling,flipFaces:e.flipFaces,renderTarget:n}),p.camera.uranusCubeMapCamera=!0,a.addChild(p),p.setRotation(r[i]),0===i&&(p.camera.onPreRender=()=>{this.entity.fire("onCubemapPreRender")}),5===i&&(p.camera.onPostRender=()=>{this.entity.fire("onCubemapPostRender")})}this.on("state",(function(e){this.CubeMapCameras.enabled=e}))};var UranusControllerVirtualJoystick=pc.createScript("uranusControllerVirtualJoystick");UranusControllerVirtualJoystick.attributes.add("playerEntity",{type:"entity"}),UranusControllerVirtualJoystick.attributes.add("stick",{type:"entity"}),UranusControllerVirtualJoystick.attributes.add("enableEvent",{type:"string"}),UranusControllerVirtualJoystick.attributes.add("moveEvent",{type:"string"}),UranusControllerVirtualJoystick.attributes.add("disableEvent",{type:"string"}),UranusControllerVirtualJoystick.attributes.add("repositionControl",{type:"boolean",default:!0}),UranusControllerVirtualJoystick.prototype.initialize=function(){this.playerEntity.on(this.enableEvent,this.onEnable,this),this.playerEntity.on(this.moveEvent,this.onMove,this),this.playerEntity.on(this.disableEvent,this.onDisable,this),this.on("destroy",(function(){this.playerEntity.off(this.enableEvent,this.onEnable,this),this.playerEntity.off(this.moveEvent,this.onMove,this),this.playerEntity.off(this.disableEvent,this.onDisable,this)}))},UranusControllerVirtualJoystick.prototype.onEnable=function(t,i){this.repositionControl&&this.entity.setLocalPosition(t,-i,0),this.stick.setLocalPosition(t,-i,0),this.entity.element.enabled=!0,this.stick.element.enabled=!0},UranusControllerVirtualJoystick.prototype.onMove=function(t,i){this.stick.setLocalPosition(t,-i,0)},UranusControllerVirtualJoystick.prototype.onDisable=function(){this.entity.element.enabled=!1,this.stick.element.enabled=!1};var Ccd=pc.createScript("ccd");Ccd.attributes.add("motionThreshold",{type:"number",default:1,title:"Motion Threshold",description:"Number of meters moved in one frame before CCD is enabled"}),Ccd.attributes.add("sweptSphereRadius",{type:"number",default:.2,title:"Swept Sphere Radius",description:"This should be below the half extent of the collision volume. E.g For an object of dimensions 1 meter, try 0.2"}),Ccd.attributes.add("contactProcessingThreshold",{type:"number",default:0,title:"Contact Processing Threshold",description:'This should be below the half extent of the collision volume. E.g For an object of dimensions 1 meter, try 0.2the constraint solver can discard solving contacts, if the distance is above this threshold. 0 by default. \n Note that using contacts with positive distance can improve stability. It increases, however, the chance of colliding with degerate contacts, such as "interior" triangle edges'}),Ccd.attributes.add("fixedTimeStep",{type:"number",default:60,title:"Fixed Time Step",description:"Physics fixed time step, the number of times the physics engine step refreshes per second, changing this to more then 60 can effect performance"}),Ccd.prototype.initialize=function(){var e;this.app.systems.rigidbody.fixedTimeStep=1/this.fixedTimeStep,(e=this.entity.rigidbody.body).setCcdMotionThreshold(this.motionThreshold),e.setCcdSweptSphereRadius(this.sweptSphereRadius),e.setContactProcessingThreshold(this.contactProcessingThreshold),this.on("attr:motionThreshold",(function(t,i){(e=this.entity.rigidbody.body).setCcdMotionThreshold(t)})),this.on("attr:sweptSphereRadius",(function(t,i){(e=this.entity.rigidbody.body).setCcdSweptSphereRadius(t)})),this.on("attr:contactProcessingThreshold",(function(t,i){(e=this.entity.rigidbody.body).setContactProcessingThreshold(t)}))};var SAMPLE_COUNT=15;function computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}function calculateBlurValues(e,t,o,s,r){e[0]=computeGaussian(0,r),t[0]=0,t[1]=0;var i,l,a=e[0];for(i=0,l=Math.floor(SAMPLE_COUNT/2);i<l;i++){var u=computeGaussian(i+1,r);e[2*i]=u,e[2*i+1]=u,a+=2*u;var h=2*i+1.5;t[4*i]=o*h,t[4*i+1]=s*h,t[4*i+2]=-o*h,t[4*i+3]=-s*h}for(i=0,l=e.length;i<l;i++)e[i]/=a}function BloomEffect(e){pc.PostEffect.call(this,e);var t={aPosition:pc.SEMANTIC_POSITION},o=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition + 1.0) * 0.5;","}"].join("\n"),s=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform sampler2D uBaseTexture;","uniform float uBloomThreshold;","","void main(void)","{","    vec4 color = texture2D(uBaseTexture, vUv0);","","    gl_FragColor = clamp((color - uBloomThreshold) / (1.0 - uBloomThreshold), 0.0, 1.0);","}"].join("\n"),r=["precision "+e.precision+" float;","","#define SAMPLE_COUNT "+SAMPLE_COUNT,"","varying vec2 vUv0;","","uniform sampler2D uBloomTexture;","uniform vec2 uBlurOffsets[SAMPLE_COUNT];","uniform float uBlurWeights[SAMPLE_COUNT];","","void main(void)","{","    vec4 color = vec4(0.0);","    for (int i = 0; i < SAMPLE_COUNT; i++)","    {","        color += texture2D(uBloomTexture, vUv0 + uBlurOffsets[i]) * uBlurWeights[i];","    }","","    gl_FragColor = color;","}"].join("\n"),i=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform float uBloomEffectIntensity;","uniform sampler2D uBaseTexture;","uniform sampler2D uBloomTexture;","","void main(void)","{","    vec4 bloom = texture2D(uBloomTexture, vUv0) * uBloomEffectIntensity;","    vec4 base = texture2D(uBaseTexture, vUv0);","","    base *= (1.0 - clamp(bloom, 0.0, 1.0));","","    gl_FragColor = base + bloom;","}"].join("\n");this.extractShader=new pc.Shader(e,{attributes:t,vshader:o,fshader:s}),this.blurShader=new pc.Shader(e,{attributes:t,vshader:o,fshader:r}),this.combineShader=new pc.Shader(e,{attributes:t,vshader:o,fshader:i}),this.targets=[],this.bloomThreshold=.25,this.blurAmount=4,this.bloomIntensity=1.25,this.sampleWeights=new Float32Array(SAMPLE_COUNT),this.sampleOffsets=new Float32Array(2*SAMPLE_COUNT)}BloomEffect.prototype=Object.create(pc.PostEffect.prototype),BloomEffect.prototype.constructor=BloomEffect,BloomEffect.prototype._destroy=function(){var e;if(this.targets)for(e=0;e<this.targets.length;e++)this.targets[e].destroyTextureBuffers(),this.targets[e].destroy();this.targets.length=0},BloomEffect.prototype._resize=function(e){var t,o=e.colorBuffer.width,s=e.colorBuffer.height;if(o!==this.width||s!==this.height)for(this.width=o,this.height=s,this._destroy(),t=0;t<2;t++){var r=new pc.Texture(this.device,{name:"Bloom Texture"+t,format:pc.PIXELFORMAT_R8_G8_B8_A8,width:o>>1,height:s>>1,mipmaps:!1});r.minFilter=pc.FILTER_LINEAR,r.magFilter=pc.FILTER_LINEAR,r.addressU=pc.ADDRESS_CLAMP_TO_EDGE,r.addressV=pc.ADDRESS_CLAMP_TO_EDGE,r.name="pe-bloom";var i=new pc.RenderTarget({name:"Bloom Render Target "+t,colorBuffer:r,depth:!1});this.targets.push(i)}},Object.assign(BloomEffect.prototype,{render:function(e,t,o){this._resize(e);var s=this.device,r=s.scope;r.resolve("uBloomThreshold").setValue(this.bloomThreshold),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(s,this.targets[0],this.vertexBuffer,this.extractShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,1/this.targets[1].width,0,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),pc.drawFullscreenQuad(s,this.targets[1],this.vertexBuffer,this.blurShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,0,1/this.targets[0].height,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[1].colorBuffer),pc.drawFullscreenQuad(s,this.targets[0],this.vertexBuffer,this.blurShader),r.resolve("uBloomEffectIntensity").setValue(this.bloomIntensity),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(s,t,this.vertexBuffer,this.combineShader,o)}});var Bloom=pc.createScript("bloom");Bloom.attributes.add("bloomIntensity",{type:"number",default:1,min:0,title:"Intensity"}),Bloom.attributes.add("bloomThreshold",{type:"number",default:.25,min:0,max:1,title:"Threshold"}),Bloom.attributes.add("blurAmount",{type:"number",default:4,min:1,title:"Blur amount"}),Bloom.prototype.initialize=function(){this.effect=new BloomEffect(this.app.graphicsDevice),this.effect.bloomThreshold=this.bloomThreshold,this.effect.blurAmount=this.blurAmount,this.effect.bloomIntensity=this.bloomIntensity;var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("attr",(function(e,t){this.effect[e]=t}),this),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect),this._destroy()}))};function FxaaEffect(e){pc.PostEffect.call(this,e);var o={aPosition:pc.SEMANTIC_POSITION},t=["attribute vec2 aPosition;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","}"].join("\n"),a=["precision "+e.precision+" float;","","uniform sampler2D uColorBuffer;","uniform vec2 uResolution;","","#define FXAA_REDUCE_MIN   (1.0/128.0)","#define FXAA_REDUCE_MUL   (1.0/8.0)","#define FXAA_SPAN_MAX     8.0","","void main()","{","    vec3 rgbNW = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * uResolution ).xyz;","    vec3 rgbNE = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * uResolution ).xyz;","    vec3 rgbSW = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * uResolution ).xyz;","    vec3 rgbSE = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * uResolution ).xyz;","    vec4 rgbaM  = texture2D( uColorBuffer,  gl_FragCoord.xy  * uResolution );","    vec3 rgbM  = rgbaM.xyz;","    float opacity  = rgbaM.w;","","    vec3 luma = vec3( 0.299, 0.587, 0.114 );","","    float lumaNW = dot( rgbNW, luma );","    float lumaNE = dot( rgbNE, luma );","    float lumaSW = dot( rgbSW, luma );","    float lumaSE = dot( rgbSE, luma );","    float lumaM  = dot( rgbM,  luma );","    float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );","    float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );","","    vec2 dir;","    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));","    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));","","    float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );","","    float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );","    dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX), max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * uResolution;","","    vec3 rgbA = 0.5 * (","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * ( 1.0 / 3.0 - 0.5 ) ).xyz +","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * ( 2.0 / 3.0 - 0.5 ) ).xyz );","","    vec3 rgbB = rgbA * 0.5 + 0.25 * (","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * -0.5 ).xyz +","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * 0.5 ).xyz );","","    float lumaB = dot( rgbB, luma );","","    if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )","    {","        gl_FragColor = vec4( rgbA, opacity );","    }","    else","    {","        gl_FragColor = vec4( rgbB, opacity );","    }","}"].join("\n");this.fxaaShader=new pc.Shader(e,{attributes:o,vshader:t,fshader:a}),this.resolution=new Float32Array(2)}FxaaEffect.prototype=Object.create(pc.PostEffect.prototype),FxaaEffect.prototype.constructor=FxaaEffect,Object.assign(FxaaEffect.prototype,{render:function(e,o,t){var a=this.device,r=a.scope;this.resolution[0]=1/e.width,this.resolution[1]=1/e.height,r.resolve("uResolution").setValue(this.resolution),r.resolve("uColorBuffer").setValue(e.colorBuffer),pc.drawFullscreenQuad(a,o,this.vertexBuffer,this.fxaaShader,t)}});var Fxaa=pc.createScript("fxaa");Fxaa.prototype.initialize=function(){this.effect=new FxaaEffect(this.app.graphicsDevice);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(o){o?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};function VignetteEffect(e){pc.PostEffect.call(this,e);var t={aPosition:pc.SEMANTIC_POSITION},i=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),f=["precision "+e.precision+" float;","","uniform sampler2D uColorBuffer;","uniform float uDarkness;","uniform float uOffset;","","varying vec2 vUv0;","","void main() {","    vec4 texel = texture2D(uColorBuffer, vUv0);","    vec2 uv = (vUv0 - vec2(0.5)) * vec2(uOffset);","    gl_FragColor = vec4(mix(texel.rgb, vec3(1.0 - uDarkness), dot(uv, uv)), texel.a);","}"].join("\n");this.vignetteShader=new pc.Shader(e,{attributes:t,vshader:i,fshader:f}),this.offset=1,this.darkness=1}VignetteEffect.prototype=Object.create(pc.PostEffect.prototype),VignetteEffect.prototype.constructor=VignetteEffect,Object.assign(VignetteEffect.prototype,{render:function(e,t,i){var f=this.device,s=f.scope;s.resolve("uColorBuffer").setValue(e.colorBuffer),s.resolve("uOffset").setValue(this.offset),s.resolve("uDarkness").setValue(this.darkness),pc.drawFullscreenQuad(f,t,this.vertexBuffer,this.vignetteShader,i)}});var Vignette=pc.createScript("vignette");Vignette.attributes.add("offset",{type:"number",default:1,min:0,title:"Offset"}),Vignette.attributes.add("darkness",{type:"number",default:1,title:"Darkness"}),Vignette.prototype.initialize=function(){this.effect=new VignetteEffect(this.app.graphicsDevice),this.effect.offset=this.offset,this.effect.darkness=this.darkness,this.on("attr",(function(e,t){this.effect[e]=t}),this);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};function SharpenEffect(e){pc.PostEffect.call(this,e),this.shader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:[e.webgl2?"#version 300 es\n\n"+pc.shaderChunks.gles3VS:"","attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:[e.webgl2?"#version 300 es\n\n"+pc.shaderChunks.gles3PS:"","precision "+e.precision+" float;",pc.shaderChunks.screenDepthPS,"","varying vec2 vUv0;","","uniform vec2 uResolution;","uniform sampler2D uColorBuffer;","uniform float uAmount;","","void main() {","   highp vec2 uv = vUv0; // variable_vertex.xy; // interpolated at pixel's center","","   vec4 base = texture2D( uColorBuffer, uv );","   vec2 texel = 1.0 / uResolution.xy;","   vec4 edgeDetection = texture2D(uColorBuffer, uv + texel * vec2(0.0, -1.0)) +","   texture2D(uColorBuffer, uv + texel * vec2(-1.0, 0.0)) +","   texture2D(uColorBuffer, uv + texel * vec2(1.0, 0.0)) +","   texture2D(uColorBuffer, uv + texel * vec2(0.0, 1.0)) -","   base * 4.0;","","   gl_FragColor = max(base - (uAmount * vec4(edgeDetection.rgb, 0)), 0.);","}"].join("\n")}),this.amount=10}SharpenEffect.prototype=Object.create(pc.PostEffect.prototype),SharpenEffect.prototype.constructor=SharpenEffect,Object.assign(SharpenEffect.prototype,{render:function(e,t,o){var r=this.device,i=r.scope;i.resolve("uResolution").setValue([r.width,r.height]),i.resolve("uAmount").setValue(this.amount),i.resolve("uColorBuffer").setValue(e.colorBuffer),pc.drawFullscreenQuad(r,t,this.vertexBuffer,this.shader,o)}});var Sharpen=pc.createScript("sharpen");Sharpen.attributes.add("amount",{type:"number",default:1,min:0,max:10,title:"Amount",description:"The amount of sharpen applied."}),Sharpen.prototype.initialize=function(){this.effect=new SharpenEffect(this.app.graphicsDevice),this.effect.amount=this.amount,this.on("attr",(function(e,t){this.effect[e]=t}),this);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};function ChromaticAberrationEffect(e){pc.PostEffect.call(this,e),this.shader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:[e.webgl2?"#version 300 es\n\n"+pc.shaderChunks.gles3VS:"","attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:[e.webgl2?"#version 300 es\n\n"+pc.shaderChunks.gles3PS:"","precision "+e.precision+" float;",pc.shaderChunks.screenDepthPS,"","varying vec2 vUv0;","","uniform vec2 uResolution;","uniform sampler2D uColorBuffer;","uniform float uAmount;","","void main() {","    highp vec2 uv = vUv0; // variable_vertex.xy; // interpolated at pixel's center","    gl_FragColor = texture2D( uColorBuffer, vUv0 );","","    vec2 texel = 1.0 / uResolution.xy;","    vec2 coords = (vUv0 - 0.5) * 2.0;","    float coordDot = dot (coords, coords);","","    vec2 aberrationPrecompute = uAmount * coordDot * coords;","    vec2 uvR = vUv0 - texel.xy * aberrationPrecompute;","    vec2 uvB = vUv0 + texel.xy * aberrationPrecompute;","","    gl_FragColor.r = texture2D(uColorBuffer, uvR).r;","    gl_FragColor.b = texture2D(uColorBuffer, uvB).b;","}"].join("\n")}),this.amount=10}ChromaticAberrationEffect.prototype=Object.create(pc.PostEffect.prototype),ChromaticAberrationEffect.prototype.constructor=ChromaticAberrationEffect,Object.assign(ChromaticAberrationEffect.prototype,{render:function(e,t,o){var r=this.device,i=r.scope;i.resolve("uResolution").setValue([r.width,r.height]),i.resolve("uAmount").setValue(this.amount),i.resolve("uColorBuffer").setValue(e.colorBuffer),pc.drawFullscreenQuad(r,t,this.vertexBuffer,this.shader,o)}});var ChromaticAberration=pc.createScript("chromaticAberration");ChromaticAberration.attributes.add("amount",{type:"number",default:10,min:-100,max:100,title:"Amount",description:"The amount of chromatic aberration applied."}),ChromaticAberration.prototype.initialize=function(){this.effect=new ChromaticAberrationEffect(this.app.graphicsDevice),this.effect.amount=this.amount,this.on("attr",(function(e,t){this.effect[e]=t}),this);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};var UranusControllerAnimationTimer=pc.createScript("uranusControllerAnimationTimer");UranusControllerAnimationTimer.attributes.add("inEditor",{type:"boolean",default:!0}),UranusControllerAnimationTimer.attributes.add("avatar",{type:"entity",title:"Avatar",description:"The avatar model parent entity used for this player controller."}),UranusControllerAnimationTimer.attributes.add("activeCameras",{type:"entity",array:!0,title:"Active Cameras",description:"A list of cameras to be used for calculating the active LOD for this component. Only one enabled camera from the list will be used."}),UranusControllerAnimationTimer.attributes.add("lodDistances",{type:"vec3",default:[25,50,100],title:"LOD Distances",description:"Set the max distance from the active camera for each animation LOD level."}),UranusControllerAnimationTimer.attributes.add("lodTimes",{type:"vec4",default:[0,.05,.1,.25],title:"LOD Times",description:"Set the animation update delay for each LOD level."}),UranusControllerAnimationTimer.attributes.add("lodTimeout",{type:"number",default:.25,title:"LOD Timeout",description:"Set how often animation LOD calculations will take place. Set to 0.0 to execute them per frame (more expensive)."}),UranusControllerAnimationTimer.attributes.add("hideDistance",{type:"number",default:0,title:"Hide Distance",description:"Set a distance threshold afterwards the model will be disabled/hidden. Set to 0.0 to always keep it visible."}),UranusControllerAnimationTimer.attributes.add("frustumCulling",{type:"boolean",default:!0,title:"Frustum Culling",description:"If enabled animation playback will pause when the bounding box is not in view."}),UranusControllerAnimationTimer.attributes.add("boundingCenter",{type:"vec3",default:[0,0,0],title:"Bounding Center",description:"Set the center offset of the bounding sphere used for frustum culling."}),UranusControllerAnimationTimer.attributes.add("boundingRadius",{type:"number",default:1,title:"Bounding Radius",description:"Set the radius of the bounding sphere used for frustum culling."}),UranusControllerAnimationTimer.overrideEngine=!1,UranusControllerAnimationTimer.prototype.initialize=function(){this.lodTimer=0,this.bounding=new pc.BoundingSphere(new pc.Vec3,2*this.boundingRadius),this.entity.uranusPlayerVisible=void 0,this.entity.uranusPlayerAway=void 0,this.renders=this.avatar?this.avatar.findComponents("render"):this.entity.findComponents("render"),UranusControllerAnimationTimer.overrideEngine||(UranusControllerAnimationTimer.overrideEngine=!0,this.overrideEngine()),this.prepare(),this.on("state",(function(t){const e=this.entity.anim;e&&(e.uranusAnimTimer=t?0:void 0)}))},UranusControllerAnimationTimer.prototype.prepare=function(){const t=this.entity.anim;t&&(t.uranusAnimTimer=0)},UranusControllerAnimationTimer.prototype.update=function(t){if(this.lodTimer+=t,this.lodTimer<this.lodTimeout)return;let e;if(this.lodTimer=0,this.activeCameras.forEach((t=>{t.enabled&&(e=t)})),!e){const t=this.app.scene.layers.cameras;if(0===t.length)return;e=t[t.length-1].entity}const i=this.entity.getPosition();let n=!0;if(!1===this.entity.uranusZoneActive&&(n=!1),n&&this.frustumCulling){const t=this.bounding;t.center.copy(i),t.center.add(this.boundingCenter),0===e.camera.frustum.containsSphere(t)&&(n=!1)}let a=null,r=!1;this.hideDistance>0&&(a=e.getPosition().distance(i),r=a>this.hideDistance,r&&(n=!1),this.entity.uranusPlayerAway=r);const o=this.lodTimes;let s;if(n){null===a&&(a=e.getPosition().distance(i));let t=0;switch(a>=this.lodDistances.x&&(t=1),a>=this.lodDistances.y&&(t=2),a>=this.lodDistances.z&&(t=3),s=o.x,t){case 1:s=o.y;break;case 2:s=o.z;break;case 3:s=o.w}}else s=!1===r?o.w:1/0;this.entity.uranusPlayerVisible!==n&&(this.renders.forEach((t=>{n?t.show():t.hide()})),this.entity.uranusPlayerVisible=n);const l=this.entity.anim;l&&(l.uranusAnimFps=s)},UranusControllerAnimationTimer.prototype.overrideEngine=function(){const t=this.app.systems.anim;this.app.systems.off("animationUpdate",t.onAnimationUpdate,t),t.onAnimationUpdate=function(t){const e=this.store;for(const i in e)if(e.hasOwnProperty(i)){const n=e[i].entity.anim;if(n.data.enabled&&n.entity.enabled&&n.playing)if(void 0!==n.uranusAnimTimer){if(n.uranusAnimTimer+=t,n.uranusAnimTimer<n.uranusAnimFps)continue;n.update(n.uranusAnimTimer),n.uranusAnimTimer=0}else n.update(t)}}.bind(t),this.app.systems.on("animationUpdate",t.onAnimationUpdate,t)};var UranusControllerReadyPlayerMe=pc.createScript("uranusControllerReadyPlayerMe");UranusControllerReadyPlayerMe.attributes.add("readyPlayerMeUrl",{type:"string",default:"https://solargames.readyplayer.me",title:"Ready Player Me Url",description:"Subdomain used to connect to the Ready Player Me API (without trailing slash). Request access here: https://readyplayer.me"}),UranusControllerReadyPlayerMe.attributes.add("localLod",{type:"number",default:0,min:0,max:2,precision:0,title:"Lod (local)",description:"Control the triangle count of the entire avatar for the local player."}),UranusControllerReadyPlayerMe.attributes.add("remoteLod",{type:"number",default:1,min:0,max:2,precision:0,title:"Lod (remote)",description:"Control the triangle count of the entire avatar for remote players."}),UranusControllerReadyPlayerMe.attributes.add("localTextureSizeLimit",{type:"string",default:"1024",enum:[{256:"256"},{512:"512"},{1024:"1024"}],title:"Texture Size Limit (local)",description:"Set the upper limit for texture resolution in pixels of any texture in the avatar."}),UranusControllerReadyPlayerMe.attributes.add("remoteTextureSizeLimit",{type:"string",default:"512",enum:[{256:"256"},{512:"512"},{1024:"1024"}],title:"Texture Size Limit (remote)",description:"Set the upper limit for texture resolution in pixels of any texture in the avatar."}),UranusControllerReadyPlayerMe.attributes.add("localTextureAtlas",{type:"string",default:"1024",enum:[{None:"none"},{256:"256"},{512:"512"},{1024:"1024"}],title:"Texture Atlas (local)",description:"Generate a texture atlas of the desired resolution. This operation merges all meshes and splits opaque objects from transparent ones resulting in a maximum of 2 draw calls. The texture atlas is generated for all PBR channels - baseColor, normal, metallicRoughness, emissive, and occlusion, if any of the assets making up the avatar includes them."}),UranusControllerReadyPlayerMe.attributes.add("remoteTextureAtlas",{type:"string",default:"512",enum:[{None:"none"},{256:"256"},{512:"512"},{1024:"1024"}],title:"Texture Atlas (remote)",description:"Generate a texture atlas of the desired resolution. This operation merges all meshes and splits opaque objects from transparent ones resulting in a maximum of 2 draw calls. The texture atlas is generated for all PBR channels - baseColor, normal, metallicRoughness, emissive, and occlusion, if any of the assets making up the avatar includes them."}),UranusControllerReadyPlayerMe.attributes.add("localTextureChannels",{type:"string",default:"baseColor,normal,metallicRoughness,emissive,occlusion",title:"Texture Channels  (local)",description:"Select the texture channels you want to have included in the .glb. (By default, the .glb comes with all available channels). You can combine these values by comma separation: baseColor,normal,metallicRoughness,emissive,occlusion,none"}),UranusControllerReadyPlayerMe.attributes.add("remoteTextureChannels",{type:"string",default:"baseColor,normal",title:"Texture Channels (remote)",description:"Select the texture channels you want to have included in the .glb. (By default, the .glb comes with all available channels). You can combine these values by comma separation: baseColor,normal,metallicRoughness,emissive,occlusion,none"}),UranusControllerReadyPlayerMe.attributes.add("textureFormat",{type:"string",default:"webp",enum:[{Webp:"webp"},{Jpeg:"jpeg"},{Png:"png"}],title:"Texture Format",description:"Reduce avatar file size by formatting all textures into the specified format. Using webp encoding can result in up to 40% reduction in avatar file size."}),UranusControllerReadyPlayerMe.attributes.add("dracoCompression",{type:"boolean",default:!1,title:"Draco Compression",description:"Select if draco compression should be used on the avatar model."}),UranusControllerReadyPlayerMe.attributes.add("playerEntity",{type:"entity",title:"Player Entity",description:"The player controller entity used to hold this avatar. It will be used to check if it is a local vs remote player. If none is provided this will be a local avatar and the character selection screen will show."}),UranusControllerReadyPlayerMe.attributes.add("applyMaterials",{type:"entity",array:!0,title:"Apply Materials",description:"A list of Uranus scripts to apply avatar materials to the materialAssets attribute, if available. Useful to quickly reference runtime generated materials."}),UranusControllerReadyPlayerMe.attributes.add("layers",{type:"string",default:"",title:"Layers",description:"A comma separated list of layer names to apply to the loaded avatar model. If none is provided the default PlayCanvas layers are added."}),UranusControllerReadyPlayerMe.attributes.add("clearParent",{type:"boolean",default:!0,title:"Clear Parent",description:"If selected the parent entity will be cleared of any other entities. Useful when using a local player model as placeholder while loading the remote avatar."}),UranusControllerReadyPlayerMe.attributes.add("autoStart",{type:"boolean",default:!0,title:"Auto Start",description:"If selected the character selection screen will be automatically shown."}),UranusControllerReadyPlayerMe.attributes.add("useLocalStorage",{type:"boolean",default:!1,title:"Use Local Storage",description:"If selected the selected character will be saved in the local storage. In future sessions the avatar will be automatically loaded from there."}),UranusControllerReadyPlayerMe.attributes.add("selectionWidth",{type:"number",default:90,min:0,max:100,title:"Selection Width",description:"The screen percentage width size of the character selection window."}),UranusControllerReadyPlayerMe.attributes.add("selectionHeight",{type:"number",default:90,min:0,max:100,title:"Selection Height",description:"The screen percentage height size of the character selection window."}),UranusControllerReadyPlayerMe.prototype.initialize=function(){this.avatarUrl=void 0,this.avatarAsset=void 0,this.isRemotePlayer=void 0,this.uranusMultiplayerColyseusPlayer=this.playerEntity?.script?.uranusMultiplayerColyseusPlayer,this.selectionActive=!1,this.prepare()},UranusControllerReadyPlayerMe.prototype.prepare=function(){if(this.isRemotePlayer=!!this.playerEntity?.tags.has("uranus-multiplayer-remote-player"),this.isRemotePlayer)this.playerEntity.on("uranusMultiplayerColyseusPlayer:avatarUrl",this.loadAvatar,this);else{if(this.autoStart&&this.showCharacterSelection(),this.useLocalStorage){const e=UranusMultiplayerRoom.active?.room;e?this.loadFromStorage():this.app.once("uranusMultiplayer:room:joined",this.loadFromStorage,this)}this.app.on("uranusControllerReadyPlayerMe:showCharacterSelection",this.showCharacterSelection,this),this.app.on("uranusControllerReadyPlayerMe:hidecharacterSelection",this.hideCharacterSelection,this),this.app.on("uranusControllerReadyPlayerMe:toggleCharacterSelection",(function(){this.selectionActive?this.hideCharacterSelection():this.showCharacterSelection()}),this)}},UranusControllerReadyPlayerMe.prototype.loadFromStorage=function(){try{const e=window.localStorage.getItem("uranusControllerReadyPlayerMe");e&&this.loadAvatar(e)}catch(e){}},UranusControllerReadyPlayerMe.prototype.showCharacterSelection=function(){this.selectionActive||(this.selectionActive=!0,this.onMessage=function(e){if(e.origin===this.readyPlayerMeUrl){const t=e.data+"?t="+pc.guid.create();if(0!==t.indexOf("http"))return;if(this.useLocalStorage)try{window.localStorage.setItem("uranusControllerReadyPlayerMe",t)}catch(e){}this.loadAvatar(t),this.hideCharacterSelection(),window.removeEventListener("message",this.onMessage,!1)}}.bind(this),window.addEventListener("message",this.onMessage,!1),this.iframeParent=document.createElement("div"),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("allow","camera *; microphone *"),this.iframe.style.width="100%",this.iframe.style.height="100%",this.iframe.style.border="0",this.iframeParent.style.width=`${this.selectionWidth}%`,this.iframeParent.style.height=`${this.selectionHeight}%`,this.iframeParent.style.position="fixed",this.iframeParent.style.top="50%",this.iframeParent.style.left="50%",this.iframeParent.style.transform="translate(-50%, -50%)",this.iframeParent.style.zIndex="100",document.body.appendChild(this.iframeParent),this.iframeParent.appendChild(this.iframe),this.iframe.src=this.readyPlayerMeUrl+"/avatar?frameApi",this.app.fire("uranusControllerReadyPlayerMe:onCharacterSelection",this.iframeParent))},UranusControllerReadyPlayerMe.prototype.hideCharacterSelection=function(){this.selectionActive&&(this.selectionActive=!1,window.removeEventListener("message",this.onMessage,!1),document.body.removeChild(this.iframeParent))},UranusControllerReadyPlayerMe.prototype.loadAvatar=function(e){if(this.avatarUrl===e||this.loadingAvatar)return;if(0!==e.indexOf("http"))return;this.loadingAvatar=!0,!this.isRemotePlayer&&this.uranusMultiplayerColyseusPlayer&&this.uranusMultiplayerColyseusPlayer.sendToRoom("playerUpdate",{avatarUrl:e}),this.isRemotePlayer||this.app.fire("uranusControllerReadyPlayerMe:characterLoading");const t=this.isRemotePlayer?this.remoteLod:this.localLod,a=this.isRemotePlayer?this.remoteTextureSizeLimit:this.localTextureSizeLimit,r=this.isRemotePlayer?this.remoteTextureAtlas:this.localTextureAtlas,i=this.isRemotePlayer?this.remoteTextureChannels:this.localTextureChannels,s=e+`&morphTargets=none&useDracoMeshCompression=${this.dracoCompression}&lod=${t}&textureSizeLimit=${a}&textureAtlas=${r}&textureChannels=${i}&textureFormat=${this.textureFormat}`;UranusUtilities.loadGlbContainerFromUrl(s,null,this.entity.name,(async(t,a)=>{if(t)return this.loadingAvatar=!1,void(this.isRemotePlayer||this.app.fire("uranusControllerReadyPlayerMe:characterReady"));if(this.avatarUrl=e,this.loadingAvatar=!1,!this.entity.parent)return;if(this.avatarEntity&&this.avatarEntity.destroy(),this.clearParent){const e=this.entity.parent.children;for(let t=e.length-1;t>=0;t--)e[t]&&e[t]!==this.entity&&e[t].destroy()}if(this.avatarAsset=a,this.avatarEntity=a.resource.instantiateRenderEntity(),this.entity.addChild(this.avatarEntity),this.layers){const e=[];this.layers.split(",").forEach((t=>{const a=this.app.scene.layers.getLayerByName(t);a&&e.push(a.id)}));this.avatarEntity.findComponents("render").forEach((t=>t.layers=e))}this.entity.on("destroy",(function(){this.avatarAsset&&(this.avatarAsset.resource.data.textures.forEach((e=>e.unload())),this.avatarAsset.unload(),this.avatarAsset=void 0)}),this),this.playerEntity&&this.playerEntity.anim&&(this.playerEntity.anim.rootBone=this.entity);const r=a.resource.materials;this.applyMaterials.forEach((e=>{const t=e?.script;if(!t)return!0;t.scripts.forEach((e=>{if(e.materialAssets){const t=e.materialAssets;t.push(...r),e.materialAssets=t}}))}));const i=pc.path.getBasename(e).split("?")[0].replace(".glb",".json"),s=await fetch(`https://models.readyplayer.me/${i}`);if(this.avatarMetadata=await s.json(),this.avatarMetadata){const e="feminine"===this.avatarMetadata.outfitGender?"female":"male";this.playerEntity.script.uranusControllerThirdPerson.gender=e}this.isRemotePlayer||this.app.fire("uranusControllerReadyPlayerMe:characterReady")}))};var UranusControllerSpawnArea=pc.createScript("uranusControllerSpawnArea");UranusControllerSpawnArea.attributes.add("inEditor",{type:"boolean",default:!1}),UranusControllerSpawnArea.attributes.add("spawnEntities",{type:"entity",array:!0,title:"Spawn Entities",description:"The entity to be positioned inside the spawn area."}),UranusControllerSpawnArea.attributes.add("spawnAreas",{type:"entity",array:!0,title:"Spawn Areas",description:"A list of one or more entities to define the spawn areas. Each entity should have a box collider attached."}),UranusControllerSpawnArea.attributes.add("spawnAreasTag",{type:"string",title:"Spawn Areas Tag",description:"Instead of referencing area entities directly, you can use a tag to let the script find them on spawn time."}),UranusControllerSpawnArea.attributes.add("faceAngles",{type:"vec2",default:[-45,45],title:"Face Angles",description:"Set a minimum and maximum angle, in world units, to automatically face the entities towards."}),UranusControllerSpawnArea.attributes.add("faceCamera",{type:"boolean",default:!1,title:"Face Camera",description:"If checked the script willa attempt to find a child camera entity to rotate, instead of the spawn entity."}),UranusControllerSpawnArea.attributes.add("bypassIfEnabled",{type:"boolean",default:!0,title:"Bypass If Enabled",description:"Bypass and don't teleport the controller if it's already enabled."}),UranusControllerSpawnArea.attributes.add("onSpawn",{type:"string",title:"On Spawn",description:"If an event name is provided the script will execute as soon as this event is fired."}),UranusControllerSpawnArea.prototype.initialize=function(){this.vec=new pc.Vec3,this.bounding=new pc.BoundingBox,this.spawn(),this.onSpawn&&this.app.on(this.onSpawn,this.spawn,this)},UranusControllerSpawnArea.prototype.spawn=function(){this.spawnEntities.forEach((t=>{if(!0===t.enabled&&this.bypassIfEnabled)return;const e=this.getRandomSpawnPoint(),a=pc.math.random(this.faceAngles.x,this.faceAngles.y);if(this.faceCamera){const e=t.findComponent("camera")?.entity;e&&e.rotateLocal(0,a,0)}else this.vec.set(0,a,0);t.rigidbody&&t.rigidbody.type===pc.RIGIDBODY_TYPE_DYNAMIC?t.rigidbody.teleport(e,this.vec):(t.setPosition(e),this.faceCamera||t.rotateLocal(this.vec))}))},UranusControllerSpawnArea.prototype.getRandomSpawnPoint=function(){if(this.spawnAreasTag&&(this.spawnAreas=this.app.root.findByTag(this.spawnAreasTag)),0===this.spawnAreas.length)return;const t=this.spawnAreas.filter((t=>t.collision&&"box"===t.collision.type)),e=t[Math.floor(Math.random()*t.length)].collision,a=this.bounding;return a.center.copy(e.entity.getPosition()),a.halfExtents.copy(e.halfExtents),a.getMin(),a.getMax(),this.getRandomPointInBounding(a)},UranusControllerSpawnArea.prototype.getRandomPointInBounding=function(t){return new pc.Vec3(pc.math.random(t._min.x,t._max.x),pc.math.random(t._min.y,t._max.y),pc.math.random(t._min.z,t._max.z))};var UranusControllerAnimatedPath=pc.createScript("uranusControllerAnimatedPath");UranusControllerAnimatedPath.attributes.add("inEditor",{type:"boolean",default:!0}),UranusControllerAnimatedPath.attributes.add("playerEntity",{type:"entity",title:"Player Entity",description:"The player entity to be animated across the path."}),UranusControllerAnimatedPath.attributes.add("startEntity",{type:"entity",title:"Trigger Entity",description:"If a start entity is provided as a trigger to start the animation as soon as the player entity enters the trigger. A collision component is required to be attached."}),UranusControllerAnimatedPath.attributes.add("autoStart",{type:"boolean",default:!1,title:"Auto Start",description:"Set it to true to automatically start the animation as soon as the entity is initialized. This property doesn't work in editor."}),UranusControllerAnimatedPath.attributes.add("curveType",{type:"number",default:pc.CURVE_SPLINE,enum:[{CURVE_LINEAR:pc.CURVE_LINEAR},{CURVE_SMOOTHSTEP:pc.CURVE_SMOOTHSTEP},{CURVE_SPLINE:pc.CURVE_SPLINE},{CURVE_STEP:pc.CURVE_STEP}],title:"Curve Type",description:"The type of the animation curve used to interpolate between the animation points."}),UranusControllerAnimatedPath.attributes.add("accelerationFactor",{type:"number",default:1,min:0,title:"Acceleration Factor",description:"Control the animation playback speed in realtime by updating this property."}),UranusControllerAnimatedPath.attributes.add("isStatic",{type:"boolean",default:!1,title:"Is Static",description:"If checked the line will not update if any point gets updated (performance optimization)."}),UranusControllerAnimatedPath.attributes.add("animationDuration",{type:"number",default:10,title:"Animation Duration",description:"The total duration in seconds of the animation from start to end."}),UranusControllerAnimatedPath.attributes.add("animationLoop",{type:"boolean",default:!1,title:"Animation Loop",description:"If selected the animation will loop infinitely."}),UranusControllerAnimatedPath.attributes.add("animationYoyo",{type:"boolean",default:!1,title:"Animation Yoyo",description:"If selected and Loop Animation is also selected the animation will yoyo back when looping."}),UranusControllerAnimatedPath.attributes.add("animateOnce",{type:"boolean",default:!1,title:"Animate Once",description:"If selected the animation will play only once in the lifetime of this entity."}),UranusControllerAnimatedPath.attributes.add("animateRotation",{type:"boolean",default:!0,title:"Animate Rotation",description:"If selected the entity will directed to face towards the next point on the path."}),UranusControllerAnimatedPath.attributes.add("rotationOffset",{type:"vec3",title:"Rotation Offset",description:"To be used with animate once and apply a custom rotation offset after the look at is applied."}),UranusControllerAnimatedPath.attributes.add("overrideAnimBoolean",{type:"string",default:"",title:"Override Anim Boolean",description:"If an optional anim boolean parameter is provided, it will be automatically set to true on the anim component of the player entity. Useful to set a persisent animation state during the animation."}),UranusControllerAnimatedPath.attributes.add("renderLine",{type:"boolean",default:!0,title:"Render Line",description:"If checked the line will be rendered in scene (works both in editor and on launch)."}),UranusControllerAnimatedPath.attributes.add("renderColor",{type:"rgba",title:"Render Color",description:"The color of the line to render."}),UranusControllerAnimatedPath.attributes.add("renderStep",{type:"number",default:.25,title:"Render Step",description:"The length of each line segment rendered."}),UranusControllerAnimatedPath.attributes.add("startEvent",{type:"string",title:"Start Event",description:"If an app wide start event is provided the animation will start as soon as it fires."}),UranusControllerAnimatedPath.attributes.add("resumeEvent",{type:"string",title:"Resume Event",description:"If an app wide start event is provided the animation will resume as soon as it fires."}),UranusControllerAnimatedPath.attributes.add("pauseEvent",{type:"string",title:"Pause Event",description:"If an app wide start event is provided the animation will pause as soon as it fires."}),UranusControllerAnimatedPath.attributes.add("stopEvent",{type:"string",title:"Stop Event",description:"If an app wide start event is provided the animation will stop as soon as it fires."}),UranusControllerAnimatedPath.attributes.add("endEvent",{type:"string",title:"On End Event",description:"If an app wide end event is provided it will automatically fire each time the player entity reaches the end."}),UranusControllerAnimatedPath.attributes.add("timeEvents",{type:"json",array:!0,schema:[{name:"time",type:"number",default:0,title:"Time",description:"The time in seconds this event will fire on."},{name:"event",type:"string",title:" Event",description:"The app wide event name that will fire."}]}),UranusControllerAnimatedPath.prototype.initialize=function(){this.runningInEditor=window.UranusEditor&&window.UranusEditor.inEditor(),this.hasStarted=!1,this.animationCount=0,this.animationDirection=1,this.time=0,this.vec=new pc.Vec3,this.vec2=new pc.Vec3,this.lookAt=new pc.Vec3,this.up=new pc.Vec3,this.modelEntity=void 0,this.createPath(),this.prepare(),this.on("attr",this.createPath,this),this.on("animation:start",(function(){this.hasStarted=!0}),this),this.on("animation:pause",(function(){this.hasStarted=!1}),this),this.on("animation:stop",(function(){this.hasStarted=!1,this.resetAnimation()}),this)},UranusControllerAnimatedPath.prototype.prepare=function(){this.startEntity&&this.startEntity.collision&&this.startEntity.collision.on("triggerenter",(function(t){this.playerEntity===t&&this.onStart()}),this),!this.runningInEditor&&this.autoStart&&this.onStart(),this.startEvent&&this.app.on(this.startEvent,this.onStart,this),this.resumeEvent&&this.app.on(this.resumeEvent,(()=>this.fire("animation:start")),this),this.pauseEvent&&this.app.on(this.pauseEvent,(()=>this.fire("animation:pause")),this),this.stopEvent&&this.app.on(this.stopEvent,(()=>this.fire("animation:stop")),this),this.runningInEditor&&(this.editorTranslationCallback=this.createPath.bind(this),this.updateEditorTranslationListeners())},UranusControllerAnimatedPath.prototype.onStart=function(){!this.hasStarted&&this.playerEntity&&(this.animateOnce&&this.animationCount>=1||(this.uranusControllerThirdPerson=this.playerEntity.script?.uranusControllerThirdPerson,this.uranusControllerThirdPerson&&(this.uranusControllerThirdPerson.lockPlayerPosition=!0),this.playerEntity.rigidbody&&(this.playerEntity.rigidbody.type=pc.BODYTYPE_KINEMATIC),this.hasStarted=!0,this.time=0))},UranusControllerAnimatedPath.prototype.onEnd=function(){this.hasStarted&&this.playerEntity&&(this.uranusControllerThirdPerson=this.playerEntity.script?.uranusControllerThirdPerson,this.uranusControllerThirdPerson&&(this.uranusControllerThirdPerson.lockPlayerPosition=!1),this.playerEntity.rigidbody&&(this.playerEntity.rigidbody.type=pc.BODYTYPE_DYNAMIC),this.hasStarted=!1,this.animationCount++,this.endEvent&&this.app.fire(this.endEvent))},UranusControllerAnimatedPath.prototype.update=function(t){this.isStatic&&!this.runningInEditor||this.monitorPointChanges(),this.renderLine&&this.drawLine(),this.hasStarted&&(this.animate(t),this.parseTimeEvents())},UranusControllerAnimatedPath.prototype.animate=function(t){this.time+=t*this.animationDirection*this.accelerationFactor;let e=this.time/this.animationDuration;if(e>1||e<0){if(!this.animationLoop)return void this.onEnd();!0===this.animationYoyo?this.animationDirection=1===this.animationDirection?-1:1:(this.time-=this.animationDuration,e=0)}const i=this.path;if(this.playerEntity.setPosition(i.px.value(e),i.py.value(e),i.pz.value(e)),this.animateRotation&&(this.lookAt.set(i.tx.value(e),i.ty.value(e),i.tz.value(e)),this.up.set(i.ux.value(e),i.uy.value(e),i.uz.value(e)),this.modelEntity.lookAt(this.lookAt,this.up),!1===pc.Vec3.ZERO.equals(this.rotationOffset))){const t=this.vec.copy(this.rotationOffset);-1===this.animationDirection&&(t.y+=180),this.modelEntity.rotateLocal(t)}this.overrideAnimBoolean&&this.playerEntity.anim&&this.playerEntity.anim.setBoolean(this.overrideAnimBoolean,!0)},UranusControllerAnimatedPath.prototype.parseTimeEvents=function(){this.timeEvents.forEach((t=>{if(t.fired)return!0;const e=Math.abs(this.time-t.time);e>t.lastDelta?(this.app.fire(t.event,this.time),t.fired=!0):t.lastDelta=e}))},UranusControllerAnimatedPath.prototype.createPath=function(){const t=this.curveType,e={pathLength:0};e.px=new pc.Curve,e.px.type=t,e.py=new pc.Curve,e.py.type=t,e.pz=new pc.Curve,e.pz.type=t,e.tx=new pc.Curve,e.tx.type=t,e.ty=new pc.Curve,e.ty.type=t,e.tz=new pc.Curve,e.tz.type=t,e.ux=new pc.Curve,e.ux.type=t,e.uy=new pc.Curve,e.uy.type=t,e.uz=new pc.Curve,e.uz.type=t;const i=this.entity.children,n=[],a=new pc.Vec3;n.push(0);for(let t=1;t<i.length;t++){const o=i[t-1],r=i[t];a.sub2(o.getPosition(),r.getPosition()),e.pathLength+=a.length(),n.push(e.pathLength)}for(let t=0;t<i.length;t++){const a=n[t]/e.pathLength,s=i[t],l=s.getPosition();e.px.add(a,l.x),e.py.add(a,l.y),e.pz.add(a,l.z);var o=l.clone().add(s.forward);e.tx.add(a,o.x),e.ty.add(a,o.y),e.tz.add(a,o.z);var r=s.up;e.ux.add(a,r.x),e.uy.add(a,r.y),e.uz.add(a,r.z)}this.path=e;const s=this.playerEntity.findByName("Model");this.modelEntity=s||this.playerEntity},UranusControllerAnimatedPath.prototype.monitorPointChanges=function(){let t=!1;if(this.runningInEditor)this.numberOfChildren!==this.entity.children.length&&(this.createPath(),this.updateEditorTranslationListeners());else{const e=this.entity.children;for(let i=0;i<e.length;i++){if(!0===e[i]._dirtyWorld){t=!0;break}}}!0===t&&(window.clearTimeout(this.curveDirtyTimeout),this.curveDirtyTimeout=window.setTimeout((()=>this.createPath()),100))},UranusControllerAnimatedPath.prototype.updateEditorTranslationListeners=function(){const t=this.entity.children;this.numberOfChildren=this.entity.children.length,t.forEach(function(t){const e=editor.call("entities:get",t._guid);e.unbind("position:set",this.editorTranslationCallback),e.on("position:set",this.editorTranslationCallback),e.unbind("rotation:set",this.editorTranslationCallback),e.on("rotation:set",this.editorTranslationCallback)}.bind(this))},UranusControllerAnimatedPath.prototype.drawLine=function(){if(!this.path||0===this.path.length)return!1;const t=this.path,e=Math.ceil(t.pathLength/this.renderStep);let i=0;const n=this.vec,a=this.vec2;let o=0,r=0;for(let s=0;s<=e&&!(r>=1);s++)i+=this.renderStep,r=i/t.pathLength,r>1&&(r=1),n.set(t.px.value(o),t.py.value(o),t.pz.value(o)),a.set(t.px.value(r),t.py.value(r),t.pz.value(r)),this.app.renderLine(n,a,this.renderColor),o=r},UranusControllerAnimatedPath.prototype.editorInitialize=function(){var t=window.document.styleSheets[0];t.insertRule(".active-block-builder-button { background-color: #f60 !important; color: white !important; }",t.cssRules.length)},UranusControllerAnimatedPath.prototype.editorAttrChange=function(t,e){"curveType"===t&&this.createPath(),"animationDuration"!==t&&"animationLoop"!==t&&"animationYoyo"!==t&&"playerEntity"!==t||this.resetAnimation()},UranusControllerAnimatedPath.prototype.editorScriptPanelRender=function(t){const e=t.firstChild,i=new ui.Button({text:"+ Toggle Animation"});i.on("click",function(){this.hasStarted=!this.hasStarted,this.setEditorPlaying(i)}.bind(this)),e.append(i.element),this.setEditorPlaying(i);const n=new ui.Button({text:"- Reset Animation"});n.on("click",function(){this.resetAnimation()}.bind(this)),e.append(n.element)},UranusControllerAnimatedPath.prototype.resetAnimation=function(){this.hasStarted=!1,this.time=0,this.animate(0)},UranusControllerAnimatedPath.prototype.setEditorPlaying=function(t){this.hasStarted?t.element.classList.add("active-block-builder-button"):t.element.classList.remove("active-block-builder-button")};var UranusControllerPlayerEmojis=pc.createScript("uranusControllerPlayerEmojis");UranusControllerPlayerEmojis.isVisible=!1,UranusControllerPlayerEmojis.isMouseOver=!1,UranusControllerPlayerEmojis.cdn="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.1/",UranusControllerPlayerEmojis.attributes.add("inEditor",{type:"boolean",default:!1}),UranusControllerPlayerEmojis.attributes.add("playerEntity",{type:"entity",title:"Player Entity",description:"The player entity to be used to render the emojis on."}),UranusControllerPlayerEmojis.attributes.add("toggleKey",{type:"string",default:"KEY_E",title:"Toggle Key",description:"Provide an optional key name to automatically toggle on/off the emoji on press."}),UranusControllerPlayerEmojis.attributes.add("autoHide",{type:"boolean",default:!1,title:"Auto Hide",description:"If selected the emoji picker will be automatically hidden after an emoji is selected."}),UranusControllerPlayerEmojis.attributes.add("emojiCategories",{type:"boolean",default:!0,title:"Emoji Categories",description:"If selected the emoji picker will include category tabs."}),UranusControllerPlayerEmojis.attributes.add("emojiSearch",{type:"boolean",default:!0,title:"Emoji Search",description:"If selected the emoji picker will include search."}),UranusControllerPlayerEmojis.attributes.add("emojiVariants",{type:"boolean",default:!1,title:"Emoji Variants",description:"If selected the emoji picker will include variants."}),UranusControllerPlayerEmojis.attributes.add("emojiRecents",{type:"boolean",default:!1,title:"Emoji Recents",description:"If selected the emoji picker will include recently selected emojis."}),UranusControllerPlayerEmojis.attributes.add("emojiRecentsCount",{type:"number",default:10,title:"Emoji Recents Count",description:"The selected emoji picker recents count saved."}),UranusControllerPlayerEmojis.attributes.add("emojiPreview",{type:"boolean",default:!1,title:"Emoji Preview",description:"If selected the emoji picker will include a preview of the selected emoji."}),UranusControllerPlayerEmojis.attributes.add("emojiSize",{type:"number",default:36,precision:0,title:"Emoji Size",description:"The pixel size for each emoji in the picker."}),UranusControllerPlayerEmojis.attributes.add("emojiPerRow",{type:"number",default:5,precision:0,title:"Emoji Per Row",description:"The number of emojis per row."}),UranusControllerPlayerEmojis.attributes.add("emojiRows",{type:"number",default:5,precision:0,title:"Emoji Rows",description:"The number of emoji rows."}),UranusControllerPlayerEmojis.attributes.add("positionTop",{type:"string",default:"25px",title:"Position Top",description:"The CSS top position of the emoji picker."}),UranusControllerPlayerEmojis.attributes.add("positionLeft",{type:"string",default:"25px",title:"Position Left",description:"The CSS left position of the emoji picker."}),UranusControllerPlayerEmojis.attributes.add("animateTopPos",{type:"number",default:20,title:"Animate Top Pos",description:"The top position in screen units to animate the emoji to."}),UranusControllerPlayerEmojis.attributes.add("animateDuration",{type:"number",default:5,title:"Animate Duration",description:"The time to show the emoji."}),UranusControllerPlayerEmojis.attributes.add("excludeEmojis",{type:"string",array:!0,title:"Exclude Emojis",description:"A list of emojis to exclude from rendering (they will continue to be included in the emoji selector but they will not work)."}),UranusControllerPlayerEmojis.prototype.initialize=function(){this.vec=new pc.Vec3,this.vec2=new pc.Vec3,this.playerEmoji=this.entity.findByName("Image Emoji"),this.playerEmojiInitialPos=this.playerEmoji.getLocalPosition().clone(),this.activeAsset=void 0,this.prepare(),this.on("destroy",this.onDestroy)},UranusControllerPlayerEmojis.prototype.prepare=function(){if(this.uranusMultiplayerColyseusPlayer=this.playerEntity.script?.uranusMultiplayerColyseusPlayer,this.isRemotePlayer=this.playerEntity.tags.has("uranus-multiplayer-remote-player"),this.isRemotePlayer){const e=UranusMultiplayerRoom.active?.room;e&&this.onJoinRoom(e),this.app.once("uranusMultiplayer:room:joined",this.onJoinRoom,this)}else this.app.on("uranusControllerPlayerEmojis:open",this.onOpen,this),this.app.on("uranusControllerPlayerEmojis:close",this.onClose,this),this.app.on("uranusControllerPlayerEmojis:toggle",this.onToggle,this),this.app.on("uranusControllerPlayerEmojis:emoji",this.playEmoji,this),this.app.keyboard.on(pc.EVENT_KEYUP,this.onKeyUp,this);this.app.loader.getHandler("texture").crossOrigin="anonymous"},UranusControllerPlayerEmojis.prototype.onDestroy=function(){this.app.off("uranusMultiplayer:room:joined",this.onJoinRoom,this),this.app.off("uranusControllerPlayerEmojis:open",this.onOpen,this),this.app.off("uranusControllerPlayerEmojis:close",this.onClose,this),this.app.keyboard.off(pc.EVENT_KEYUP,this.onKeyUp,this)},UranusControllerPlayerEmojis.prototype.onJoinRoom=function(e){e.onMessage("player:emoji",(([e,t])=>{this.playerEntity.name===e&&this.playEmoji(t.filename)}))},UranusControllerPlayerEmojis.prototype.initializePicker=function(){if(!EmojiButton)return!1;const e={style:"twemoji",twemojiOptions:{base:UranusControllerPlayerEmojis.cdn},autoHide:this.autoHide,showSearch:this.emojiSearch,showVariants:this.emojiVariants,showRecents:this.emojiRecents,recentsCount:this.emojiRecentsCount,showPreview:this.emojiPreview,initialCategory:this.emojiRecents?"recents":"smileys",showCategoryButtons:this.emojiCategories,position:{top:this.positionTop,left:this.positionLeft},emojiSize:`${this.emojiSize}px`,emojisPerRow:this.emojiPerRow,rows:this.emojiRows};return this.picker=new EmojiButton(e),this.picker.on("emoji",this.playEmoji.bind(this)),this.picker.on("hidden",(()=>{UranusControllerPlayerEmojis.isVisible=!1})),this.picker.pickerEl.onmousedown=e=>{e.stopPropagation(),e.preventDefault()},this.picker.pickerEl.onmouseup=e=>{e.stopPropagation(),e.preventDefault()},this.picker.pickerEl.onmouseover=e=>{UranusControllerPlayerEmojis.isMouseOver=!0,e.stopPropagation(),e.preventDefault()},this.picker.pickerEl.onmouseout=e=>{UranusControllerPlayerEmojis.isMouseOver=!1,e.stopPropagation(),e.preventDefault()},!0},UranusControllerPlayerEmojis.prototype.onKeyUp=function(e){if(this.toggleKey&&-1!==this.toggleKey.indexOf("KEY_")&&e.key===pc[this.toggleKey]){if(!this.picker&&!1===this.initializePicker())return;this.picker.togglePicker()}},UranusControllerPlayerEmojis.prototype.onOpen=function(){(this.picker||!1!==this.initializePicker())&&(UranusControllerPlayerEmojis.isVisible=this.picker.isPickerVisible(),!1===UranusControllerPlayerEmojis.isVisible&&(UranusControllerPlayerEmojis.isVisible=!0,this.picker.togglePicker()))},UranusControllerPlayerEmojis.prototype.onClose=function(){this.picker&&(UranusControllerPlayerEmojis.isVisible=this.picker.isPickerVisible(),UranusControllerPlayerEmojis.isVisible&&(UranusControllerPlayerEmojis.isVisible=!1,this.picker.togglePicker()))},UranusControllerPlayerEmojis.prototype.onToggle=function(){this.picker?this.picker.togglePicker():this.onOpen()},UranusControllerPlayerEmojis.prototype.getEmojiFilename=function(e){const t=e.url.split("/");return t[t.length-1].replace(".svg","")},UranusControllerPlayerEmojis.prototype.getEmojiAsset=function(e){return new Promise((t=>{!1===e.endsWith(".png")&&(e+=".png");const i=pc.app.assets.find(e,"texture");if(i)i.loaded?t(i):(i.ready((()=>t(i))),pc.app.assets.load(i));else{const i=`${UranusControllerPlayerEmojis.cdn}72x72/${e}`;pc.app.assets.loadFromUrl(i,"texture",((e,i)=>{t(i)}))}}))},UranusControllerPlayerEmojis.prototype.renderEmoji=async function(e){this.playerEmojiTween&&this.playerEmojiTween.stop();const t=this.playerEmoji;t.enabled=!0,this.activeAsset=e;const i=e.resource;if(void 0===this.playerEmojiFirst){this.playerEmojiFirst=!0;const e=t.element.material.clone();this.playerEmojiMaterial=e,t.element.materialAsset=null,t.element.material=e,e.emissiveMap=i,e.opacityMap=i,e.emissive.set(1,1,1),e.opacity=1,e.update()}this.playerEmojiMaterial.setParameter("texture_emissiveMap",i),this.playerEmojiMaterial.setParameter("texture_opacityMap",i),i&&(i.addressU=pc.ADDRESS_CLAMP_TO_EDGE,i.addressV=pc.ADDRESS_CLAMP_TO_EDGE),t.setLocalScale(0,0,0),t.setLocalPosition(this.playerEmojiInitialPos);const o=this.vec.set(1,1,1),r=t.element.width/32,s=this.vec2.copy(this.playerEmojiInitialPos);s.y+=this.animateTopPos*r;const n=this.app.scene.layers.cameras;t.tween(t.getLocalScale()).to(o,.75,pc.SineIn).start(),this.playerEmojiTween=t.tween(t.getLocalPosition()).to(s,this.animateDuration,pc.SineOut).onUpdate((()=>{const e=n[n.length-1];e.camera.projection===pc.PROJECTION_PERSPECTIVE&&(t.lookAt(e.entity.getPosition()),t.rotateLocal(0,180,0))})).onComplete((()=>{this.playerEmoji.enabled=!1})).start()},UranusControllerPlayerEmojis.prototype.playEmoji=async function(e){if(this.excludeEmojis.indexOf(e.name)>-1)return;if("string"==typeof e)if(e.indexOf(".png")>-1);else{if(!this.picker)return;{const t=this.picker.pickerEl.querySelector(`[title="${e}"]`);if(!t)return;e=t.src}}else e=this.getEmojiFilename(e);const t=await this.getEmojiAsset(e);if(this.renderEmoji(t),!this.isRemotePlayer&&this.uranusMultiplayerColyseusPlayer){const t=this.playerEntity.getPosition();this.uranusMultiplayerColyseusPlayer.sendToRoom("player:emoji",{x:t.x,y:t.y,z:t.z,filename:e})}};var UranusControllerVr=pc.createScript("uranusControllerVr");UranusControllerVr.attributes.add("playerEntity",{type:"entity",title:"Player Entity",description:"The player entity to enable VR on."}),UranusControllerVr.attributes.add("buttonVr",{type:"entity",title:"VR Button"}),UranusControllerVr.attributes.add("elementUnsupported",{type:"entity",title:"Unsupported Message"}),UranusControllerVr.attributes.add("elementHttpsRequired",{type:"entity",title:"HTTPS Required Message"}),UranusControllerVr.attributes.add("cameraEntity",{type:"entity",title:"Camera"}),UranusControllerVr.attributes.add("controllerEntity",{type:"entity",title:"Controller Entity",description:"VR controller to be spawned for each input source."}),UranusControllerVr.attributes.add("qualityPreset",{type:"string",title:"Quality Preset",description:"If a quality preset is provided, it will be automatically enabled as soon as VR mode is enabled."}),UranusControllerVr.prototype.initialize=function(){this.isRemotePlayer=this.playerEntity.tags.has("uranus-multiplayer-remote-player"),this.modelEntity=this.entity.findByPath("Model"),!1!==this.prepare()&&(this.buttonVr.element.on("click",this.sessionStart,this),this.app.keyboard.on("keydown",this.onKeyDown,this),this.app.xr.on("available:"+pc.XRTYPE_VR,this.onAvailable,this),this.app.xr.on("start",this.onStart,this),this.app.xr.on("end",this.onEnd,this),this.app.xr.input.on("add",this.onControllerAdded,this),this.on("destroy",this.onDestroy,this))},UranusControllerVr.prototype.onDestroy=function(){this.buttonVr.element.off("click",this.sessionStart,this),this.app.keyboard.off("keydown",this.onKeyDown,this),this.app.xr.off("available:"+pc.XRTYPE_VR,this.onAvailable,this),this.app.xr.off("start",this.onStart,this),this.app.xr.off("end",this.onEnd,this),this.app.xr.input.off("add",this.onControllerAdded,this)},UranusControllerVr.prototype.prepare=function(){if(this.isRemotePlayer)return!1;this.checkButton(!1)},UranusControllerVr.prototype.onKeyDown=function(t){t.key===pc.KEY_ESCAPE&&this.app.xr.active&&this.app.xr.end()},UranusControllerVr.prototype.sessionStart=function(){this.app.xr.supported&&(this.app.xr.active||this.app.xr.isAvailable(pc.XRTYPE_VR)&&(window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(t){"granted"==t&&window.addEventListener("deviceorientation",function(t){this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCAL)}.bind(this))}.bind(this)).catch(console.error):this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCAL)))},UranusControllerVr.prototype.onAvailable=function(){this.checkButton(!1)},UranusControllerVr.prototype.onStart=function(){this.checkButton(!0),this.modelEntity.enabled=!1,this.qualityPreset&&this.app.fire("UranusGraphicsSettings:setPreset",this.qualityPreset)},UranusControllerVr.prototype.onEnd=function(){this.checkButton(!1),this.modelEntity.enabled=!0,this.modelEntity.setLocalEulerAngles(0,0,0),this.qualityPreset&&this.app.fire("UranusGraphicsSettings:setPreset")},UranusControllerVr.prototype.checkButton=function(t){if(this.app.xr.isAvailable(pc.XRTYPE_VR))if(this.elementHttpsRequired&&(this.elementHttpsRequired.enabled=!1),this.elementUnsupported&&(this.elementUnsupported.enabled=!1),t)this.buttonVr.enabled=!1;else{this.buttonVr.enabled=!0;const t=this.app.xr&&!this.app.xr.active&&this.app.xr.isAvailable(pc.XRTYPE_VR);this.buttonVr.element.opacity=t?.2:.1,this.buttonVr.children[0].element.opacity=t?1:.2}else this.buttonVr.enabled=!1,"https:"==window.location.protocol?(this.elementUnsupported&&(this.elementUnsupported.enabled=!0),this.elementHttpsRequired&&(this.elementHttpsRequired.enabled=!1)):(this.elementUnsupported&&(this.elementUnsupported.enabled=!1),this.elementHttpsRequired&&(this.elementHttpsRequired.enabled=!0))},UranusControllerVr.prototype.onControllerAdded=function(t){const e=this.controllerEntity.clone();e.script.uranusControllerVrInput.setInputSource(t),e.reparent(this.playerEntity),e.enabled=!0};var UranusControllerVrInput=pc.createScript("uranusControllerVrInput");UranusControllerVrInput.prototype.initialize=function(){this.vecA=new pc.Vec3,this.vecB=new pc.Vec3,this.color=new pc.Color(1,1,1),this.pointerDistance=3,this.modelEntity=this.entity.findByName("model"),this.pointer=this.entity.findByName("pointer")},UranusControllerVrInput.prototype.setInputSource=function(t){this.inputSource=t,this.inputSource.once("remove",this.onRemove,this)},UranusControllerVrInput.prototype.onRemove=function(){this.entity.destroy()},UranusControllerVrInput.prototype.update=function(t){this.inputSource.grip&&(this.modelEntity.enabled=!0,this.entity.setPosition(this.inputSource.getPosition()),this.entity.setRotation(this.inputSource.getRotation()),this.vecA.copy(this.inputSource.getOrigin()),this.vecB.copy(this.inputSource.getDirection()),this.vecB.scale(1e3).add(this.vecA),this.app.renderLine(this.vecA,this.vecB,this.color)),this.vecA.copy(this.inputSource.getDirection()).scale(this.pointerDistance).add(this.inputSource.getOrigin()),this.pointer.setPosition(this.vecA),this.app.xr.camera&&(this.pointer.lookAt(this.app.xr.camera.getPosition(),pc.Vec3.DOWN),this.pointer.rotateLocal(0,180,0));const e=this.inputSource.gamepad;e&&(this.inputSource.handedness===pc.XRHAND_LEFT&&(e.axes[3]||e.axes[2])?this.entity.parent.fire("vr:controller:move",e.axes[2],-e.axes[3]):this.inputSource.handedness===pc.XRHAND_RIGHT&&(e.axes[2]||e.axes[3])&&this.entity.parent.fire("vr:controller:turn",e.axes[2]))};function SSAOEffect(e,t){pc.PostEffect.call(this,e),this.ssaoScript=t,this.needsDepthBuffer=!0,this.waterPlane=t.waterPlane,this.waterPlane&&(this.matrix=new pc.Mat4,this.matrix2=new pc.Mat4);var i=[e.webgl2?"#version 300 es\n\n"+pc.shaderChunks.gles3VS:"",e.webgl2?"":"#extension GL_OES_standard_derivatives: enable\n","attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","   vUv0 = (aPosition.xy + 1.0) * 0.5;","   gl_Position = vec4(aPosition, 0.0, 1.0);","}"].join("\n");this.ssaoShader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:i,fshader:[e.webgl2?"#version 300 es\n\n"+pc.shaderChunks.gles3PS:"",e.webgl2?"":"#extension GL_OES_standard_derivatives: enable\n","precision "+e.precision+" float;",pc.shaderChunks.screenDepthPS,"","varying vec2 vUv0;","","uniform sampler2D uColorBuffer;","uniform vec4 uResolution;","","uniform float uAspect;","","#define saturate(x) clamp(x,0.0,1.0)","","// Largely based on 'Dominant Light Shadowing'","// 'Lighting Technology of The Last of Us Part II' by Hawar Doghramachi, Naughty Dog, LLC","","const float kSSCTLog2LodRate = 3.0;","","highp float getWFromProjectionMatrix(const mat4 p, const vec3 v) {","    // this essentially returns (p * vec4(v, 1.0)).w, but we make some assumptions","    // this assumes a perspective projection","    return -v.z;","    // this assumes a perspective or ortho projection","    // return p[2][3] * v.z + p[3][3];","}","","highp float getViewSpaceZFromW(const mat4 p, const float w) {","    // this assumes a perspective projection","    return -w;","    // this assumes a perspective or ortho projection","   // return (w - p[3][3]) / p[2][3];","}","","","const float kLog2LodRate = 3.0;","","vec2 sq(const vec2 a) {","    return a * a;","}","","uniform float uInvFarPlane;","","vec2 pack(highp float depth) {","// we need 16-bits of precision","    highp float z = clamp(depth * uInvFarPlane, 0.0, 1.0);","    highp float t = floor(256.0 * z);","    mediump float hi = t * (1.0 / 256.0);   // we only need 8-bits of precision","    mediump float lo = (256.0 * z) - t;     // we only need 8-bits of precision","    return vec2(hi, lo);","}","","// random number between 0 and 1, using interleaved gradient noise","float random(const highp vec2 w) {","    const vec3 m = vec3(0.06711056, 0.00583715, 52.9829189);","    return fract(m.z * fract(dot(w, m.xy)));","}","","// returns the frag coord in the GL convention with (0, 0) at the bottom-left","highp vec2 getFragCoord() {","    return gl_FragCoord.xy;","}","","highp vec3 computeViewSpacePositionFromDepth(highp vec2 uv, highp float linearDepth) {","    return vec3((0.5 - uv) * vec2(uAspect, 1.0) * linearDepth, linearDepth);","}","","highp vec3 faceNormal(highp vec3 dpdx, highp vec3 dpdy) {","    return normalize(cross(dpdx, dpdy));","}","","// Compute normals using derivatives, which essentially results in half-resolution normals","// this creates arifacts around geometry edges.","// Note: when using the spirv optimizer, this results in much slower execution time because","//       this whole expression is inlined in the AO loop below.","highp vec3 computeViewSpaceNormal(const highp vec3 position) {","    return faceNormal(dFdx(position), dFdy(position));","}","","// Compute normals directly from the depth texture, resulting in full resolution normals","// Note: This is actually as cheap as using derivatives because the texture fetches","//       are essentially equivalent to textureGather (which we don't have on ES3.0),","//       and this is executed just once.","highp vec3 computeViewSpaceNormal(const highp vec3 position, const highp vec2 uv) {","    highp vec2 uvdx = uv + vec2(uResolution.z, 0.0);","    highp vec2 uvdy = uv + vec2(0.0, uResolution.w);","    highp vec3 px = computeViewSpacePositionFromDepth(uvdx, -getLinearScreenDepth(uvdx));","    highp vec3 py = computeViewSpacePositionFromDepth(uvdy, -getLinearScreenDepth(uvdy));","    highp vec3 dpdx = px - position;","    highp vec3 dpdy = py - position;","    return faceNormal(dpdx, dpdy);","}","","// Ambient Occlusion, largely inspired from:","// 'The Alchemy Screen-Space Ambient Obscurance Algorithm' by Morgan McGuire","// 'Scalable Ambient Obscurance' by Morgan McGuire, Michael Mara and David Luebke","","uniform vec2 uSampleCount;","uniform float uSpiralTurns;","","#define PI (3.14159)","","vec3 tapLocation(float i, const float noise) {","    float offset = ((2.0 * PI) * 2.4) * noise;","    float angle = ((i * uSampleCount.y) * uSpiralTurns) * (2.0 * PI) + offset;","    float radius = (i + noise + 0.5) * uSampleCount.y;","    return vec3(cos(angle), sin(angle), radius * radius);","}","","highp vec2 startPosition(const float noise) {","    float angle = ((2.0 * PI) * 2.4) * noise;","    return vec2(cos(angle), sin(angle));","}","","uniform vec2 uAngleIncCosSin;","","highp mat2 tapAngleStep() {","    highp vec2 t = uAngleIncCosSin;","    return mat2(t.x, t.y, -t.y, t.x);","}","","vec3 tapLocationFast(float i, vec2 p, const float noise) {","    float radius = (i + noise + 0.5) * uSampleCount.y;","    return vec3(p, radius * radius);","}","","uniform float uMaxLevel;","uniform float uInvRadiusSquared;","uniform float uMinHorizonAngleSineSquared;","uniform float uBias;","uniform float uPeak2;","","void computeAmbientOcclusionSAO(inout float occlusion, float i, float ssDiskRadius,","        const highp vec2 uv,  const highp vec3 origin, const vec3 normal,","        const vec2 tapPosition, const float noise) {","","    vec3 tap = tapLocationFast(i, tapPosition, noise);","","    float ssRadius = max(1.0, tap.z * ssDiskRadius);","","    vec2 uvSamplePos = uv + vec2(ssRadius * tap.xy) * uResolution.zw;","","    float level = clamp(floor(log2(ssRadius)) - kLog2LodRate, 0.0, float(uMaxLevel));","    highp float occlusionDepth = -getLinearScreenDepth(uvSamplePos);","    highp vec3 p = computeViewSpacePositionFromDepth(uvSamplePos, occlusionDepth);","","    // now we have the sample, compute AO","    vec3 v = p - origin;        // sample vector","    float vv = dot(v, v);       // squared distance","    float vn = dot(v, normal);  // distance * cos(v, normal)","","    // discard samples that are outside of the radius, preventing distant geometry to","    // cast shadows -- there are many functions that work and choosing one is an artistic","    // decision.","    float w = max(0.0, 1.0 - vv * uInvRadiusSquared);","    w = w*w;","","    // discard samples that are too close to the horizon to reduce shadows cast by geometry","    // not sufficiently tessellated. The goal is to discard samples that form an angle 'beta'","    // smaller than 'epsilon' with the horizon. We already have dot(v,n) which is equal to the","    // sin(beta) * |v|. So the test simplifies to vn^2 < vv * sin(epsilon)^2.","    w *= step(vv * uMinHorizonAngleSineSquared, vn * vn);","","    occlusion += w * max(0.0, vn + origin.z * uBias) / (vv + uPeak2);","}","","uniform float uProjectionScaleRadius;","uniform float uIntensity;","","float scalableAmbientObscurance(highp vec2 uv, highp vec3 origin, vec3 normal) {","    float noise = random(getFragCoord());","    highp vec2 tapPosition = startPosition(noise);","    highp mat2 angleStep = tapAngleStep();","","    // Choose the screen-space sample radius","    // proportional to the projected area of the sphere","    float ssDiskRadius = -(uProjectionScaleRadius / origin.z);","","    float occlusion = 0.0;",e.webgl2?"    for (float i = 0.0; i < uSampleCount.x; i += 1.0) {":"   const float maxSampleCount = 256.0;   for (float i = 0.0; i < maxSampleCount; i += 1.0) {       if (i >= uSampleCount.x) break;","        computeAmbientOcclusionSAO(occlusion, i, ssDiskRadius, uv, origin, normal, tapPosition, noise);","        tapPosition = angleStep * tapPosition;","    }","    return sqrt(occlusion * uIntensity);","}","","uniform float uPower;",this.waterPlane?"uniform mat4 matrix_viewInverse;":"",this.waterPlane?"uniform mat4 matrix_projectionInverse;":"",this.waterPlane?"uniform float uWaterY;":"","","void main() {","    highp vec2 uv = vUv0; //variable_vertex.xy; // interpolated to pixel center","","    highp float depth = -getLinearScreenDepth(vUv0);","    highp vec3 origin = computeViewSpacePositionFromDepth(uv, depth);","    vec3 normal = computeViewSpaceNormal(origin, uv);","","    float occlusion = 0.0;","","    if (uIntensity > 0.0) {","        occlusion = scalableAmbientObscurance(uv, origin, normal);","    }","","    // occlusion to visibility","    float aoVisibility = pow(saturate(1.0 - occlusion), uPower);",this.waterPlane?"\n                float z = texture2D(uSceneDepthMap, uv).r * 2.0 - 1.0;\n\n                vec4 clipSpacePosition = vec4(uv * 2.0 - 1.0, z, 1.0);\n                vec4 viewSpacePosition = matrix_projectionInverse * clipSpacePosition;\n                viewSpacePosition /= viewSpacePosition.w;            \n                vec4 worldSpacePosition = matrix_viewInverse * viewSpacePosition;\n\n                if(worldSpacePosition.y < uWaterY){\n                    aoVisibility = 1.0;\n                }\n            ":"","    vec4 inCol = vec4(1.0, 1.0, 1.0, 1.0); //texture2D( uColorBuffer,  uv );","","    gl_FragColor.r = aoVisibility; //postProcess.color.rgb = vec3(aoVisibility, pack(origin.z));","}","","void main_old()","{","    vec2 aspectCorrect = vec2( 1.0, uAspect );","","    float depth = getLinearScreenDepth(vUv0);","    gl_FragColor.r = fract(floor(depth*256.0*256.0)),fract(floor(depth*256.0)),fract(depth);","}"].join("\n")}),this.blurShader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:i,fshader:[e.webgl2?"#version 300 es\n\n"+pc.shaderChunks.gles3PS:"",e.webgl2?"":"#extension GL_OES_standard_derivatives: enable\n","precision "+e.precision+" float;",pc.shaderChunks.screenDepthPS,"","varying vec2 vUv0;","","uniform sampler2D uColorBuffer;","uniform sampler2D uSSAOBuffer;","uniform vec4 uResolution;","","uniform float uAspect;","","uniform int uBilatSampleCount;","uniform float uFarPlaneOverEdgeDistance;","uniform float uBrightness;","","float random(const highp vec2 w) {","    const vec3 m = vec3(0.06711056, 0.00583715, 52.9829189);","    return fract(m.z * fract(dot(w, m.xy)));","}","","float bilateralWeight(in float depth, in float sampleDepth) {","    float diff = (sampleDepth - depth) * uFarPlaneOverEdgeDistance;","    return max(0.0, 1.0 - diff * diff);","}","","void tap(inout float sum, inout float totalWeight, float weight, float depth, vec2 position) {","    // ambient occlusion sample","    float ssao = texture2D( uSSAOBuffer, position ).r;","    float tdepth = -getLinearScreenDepth( position );","","    // bilateral sample","    float bilateral = bilateralWeight(depth, tdepth);","    bilateral *= weight;","    sum += ssao * bilateral;","    totalWeight += bilateral;","}","","void main() {","    highp vec2 uv = vUv0; // variable_vertex.xy; // interpolated at pixel's center","","    // we handle the center pixel separately because it doesn't participate in bilateral filtering","    float depth = -getLinearScreenDepth(vUv0); // unpack(data.gb);","    float totalWeight = 0.0; // float(uBilatSampleCount*2+1)*float(uBilatSampleCount*2+1);","    float ssao = texture2D( uSSAOBuffer, vUv0 ).r;","    float sum = ssao * totalWeight;","",e.webgl2?"    for (int x = -uBilatSampleCount; x <= uBilatSampleCount; x++) {       for (int y = -uBilatSampleCount; y < uBilatSampleCount; y++) {":"    for (int x = -4; x <= 4; x++) {       for (int y = -4; y < 4; y++) {","           float weight = 1.0;","           vec2 offset = vec2(x,y)*uResolution.zw;","           tap(sum, totalWeight, weight, depth, uv + offset);","       }","    }","","    float ao = sum / totalWeight;","","    // simple dithering helps a lot (assumes 8 bits target)","    // this is most useful with high quality/large blurs","    ao += ((random(gl_FragCoord.xy) - 0.5) / 255.0);","","    ao = mix(ao, 1.0, uBrightness);","    gl_FragColor.a = ao;","}"].join("\n")}),this.outputShader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:i,fshader:[e.webgl2?"#version 300 es\n\n"+pc.shaderChunks.gles3PS:"",e.webgl2?"":"#extension GL_OES_standard_derivatives: enable\n","precision "+e.precision+" float;","varying vec2 vUv0;","uniform sampler2D uColorBuffer;","uniform sampler2D uSSAOBuffer;","","void main(void)","{","    vec4 inCol = texture2D( uColorBuffer,  vUv0 );","    float ssao = texture2D( uSSAOBuffer,  vUv0 ).a;","    gl_FragColor.rgb = inCol.rgb * ssao;","    gl_FragColor.a = inCol.a;","}"].join("\n")}),this.radius=4,this.brightness=0,this.samples=20,this.downscale=1,this.blurSamples=4,this.bilateralThreshold=.0625,this.waterY=0}SSAOEffect.prototype=Object.create(pc.PostEffect.prototype),SSAOEffect.prototype.constructor=SSAOEffect,SSAOEffect.prototype._destroy=function(){this.target&&(this.target.destroyTextureBuffers(),this.target.destroy(),this.target=null),this.blurTarget&&(this.blurTarget.destroyTextureBuffers(),this.blurTarget.destroy(),this.blurTarget=null)},SSAOEffect.prototype._resize=function(e){var t=Math.ceil(e.colorBuffer.width/this.downscale),i=Math.ceil(e.colorBuffer.height/this.downscale);if(t!==this.width||i!==this.height){this.width=t,this.height=i,this._destroy();var a=new pc.Texture(this.device,{format:pc.PIXELFORMAT_RGBA8,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,width:this.width,height:this.height,mipmaps:!1});a.name="SSAO Result",this.target=new pc.RenderTarget({name:"SSAO Result Render Target",colorBuffer:a,depth:!1});var o=new pc.Texture(this.device,{format:pc.PIXELFORMAT_RGBA8,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,width:this.width,height:this.height,mipmaps:!1});o.name="SSAO Blur",this.blurTarget=new pc.RenderTarget({name:"SSAO Blur Render Target",colorBuffer:o,depth:!1})}},Object.assign(SSAOEffect.prototype,{render:function(e,t,i){this._resize(e);var a=this.device,o=a.scope,s=this.samples,r=1/(s-.5)*10*2*3.141,n=this.radius,l=.1*n,u=2*l*3.141*.125,c=.5*a.height,h=this.ssaoScript.entity.camera.farClip;if(this.waterPlane){var p=this.matrix,f=this.matrix2;p.copy(this.ssaoScript.entity.camera.viewMatrix).invert(),o.resolve("matrix_viewInverse").setValue(p.data),f.copy(this.ssaoScript.entity.camera.projectionMatrix).invert(),o.resolve("matrix_projectionInverse").setValue(f.data),o.resolve("uWaterY").setValue(this.waterY)}o.resolve("uAspect").setValue(this.width/this.height),o.resolve("uResolution").setValue([this.width,this.height,1/this.width,1/this.height]),o.resolve("uBrightness").setValue(this.brightness),o.resolve("uInvFarPlane").setValue(1/h),o.resolve("uSampleCount").setValue([s,1/s]),o.resolve("uSpiralTurns").setValue(10),o.resolve("uAngleIncCosSin").setValue([Math.cos(r),Math.sin(r)]),o.resolve("uMaxLevel").setValue(0),o.resolve("uInvRadiusSquared").setValue(1/(n*n)),o.resolve("uMinHorizonAngleSineSquared").setValue(0),o.resolve("uBias").setValue(.001),o.resolve("uPeak2").setValue(l*l),o.resolve("uIntensity").setValue(u),o.resolve("uPower").setValue(1),o.resolve("uProjectionScaleRadius").setValue(c*n),pc.drawFullscreenQuad(a,this.target,this.vertexBuffer,this.ssaoShader,i),o.resolve("uSSAOBuffer").setValue(this.target.colorBuffer),o.resolve("uFarPlaneOverEdgeDistance").setValue(1/this.bilateralThreshold),o.resolve("uBilatSampleCount").setValue(this.blurSamples),pc.drawFullscreenQuad(a,this.blurTarget,this.vertexBuffer,this.blurShader,i),o.resolve("uSSAOBuffer").setValue(this.blurTarget.colorBuffer),o.resolve("uColorBuffer").setValue(e.colorBuffer),pc.drawFullscreenQuad(a,t,this.vertexBuffer,this.outputShader,i)}});var SSAO=pc.createScript("ssao");SSAO.attributes.add("radius",{type:"number",default:4,min:0,max:20,title:"Radius"}),SSAO.attributes.add("brightness",{type:"number",default:0,min:0,max:1,title:"Brightness"}),SSAO.attributes.add("samples",{type:"number",default:16,min:1,max:256,title:"Samples"}),SSAO.attributes.add("downscale",{type:"number",default:1,min:1,max:4,title:"Downscale"}),SSAO.attributes.add("blurSamples",{type:"number",default:4,min:1,max:8,precision:0,title:"Blur Samples"}),SSAO.attributes.add("bilateralThreshold",{type:"number",default:.0625,min:.001,max:1,precision:4,title:"Bilateral Threshold"}),SSAO.attributes.add("waterPlane",{type:"boolean",default:!1,title:"Water Plane",description:"If selected the effect will not render beneath this Y plane. Requires reload."}),SSAO.attributes.add("waterY",{type:"number",default:0,title:"Water Y",description:"If waterPlane is enabled, this value defines the Y position of the plane cutoff."}),SSAO.prototype.initialize=function(){this.effect=new SSAOEffect(this.app.graphicsDevice,this),this.effect.radius=this.radius,this.effect.brightness=this.brightness,this.effect.samples=this.samples,this.effect.downscale=this.downscale,this.effect.blurSamples=this.blurSamples,this.effect.bilateralThreshold=this.bilateralThreshold,this.effect.waterY=this.waterY,this.on("attr",(function(e,t){this.effect[e]=t}),this);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect),this.effect._destroy()}))};function BokehEffect(e){pc.PostEffect.call(this,e),this.needsDepthBuffer=!0,this.shader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:["precision "+e.precision+" float;",e.webgl2?"#define GL2":"",pc.shaderChunks.screenDepthPS,"","varying vec2 vUv0;","","uniform sampler2D uColorBuffer;","","uniform float uMaxBlur;","uniform float uAperture;","","uniform float uFocus;","uniform float uAspect;","","void main()","{","    vec2 aspectCorrect = vec2( 1.0, uAspect );","","    float factor = ((getLinearScreenDepth(vUv0) * -1.0) - uFocus) / camera_params.y;","","    vec2 dofblur = vec2 ( clamp( factor * uAperture, -uMaxBlur, uMaxBlur ) );","","    vec2 dofblur9 = dofblur * 0.9;","    vec2 dofblur7 = dofblur * 0.7;","    vec2 dofblur4 = dofblur * 0.4;","","    vec4 col;","","    col  = texture2D( uColorBuffer, vUv0 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.0,   0.4  ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.15,  0.37 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.29,  0.29 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.37,  0.15 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.40,  0.0  ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.37, -0.15 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.29, -0.29 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.15, -0.37 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.0,  -0.4  ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.15,  0.37 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.29,  0.29 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.37,  0.15 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.4,   0.0  ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.37, -0.15 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.29, -0.29 ) * aspectCorrect ) * dofblur );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.15, -0.37 ) * aspectCorrect ) * dofblur );","","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.15,  0.37 ) * aspectCorrect ) * dofblur9 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.37,  0.15 ) * aspectCorrect ) * dofblur9 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.37, -0.15 ) * aspectCorrect ) * dofblur9 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.15, -0.37 ) * aspectCorrect ) * dofblur9 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.15,  0.37 ) * aspectCorrect ) * dofblur9 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.37,  0.15 ) * aspectCorrect ) * dofblur9 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.37, -0.15 ) * aspectCorrect ) * dofblur9 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.15, -0.37 ) * aspectCorrect ) * dofblur9 );","","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.29,  0.29 ) * aspectCorrect ) * dofblur7 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.40,  0.0  ) * aspectCorrect ) * dofblur7 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.29, -0.29 ) * aspectCorrect ) * dofblur7 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.0,  -0.4  ) * aspectCorrect ) * dofblur7 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.29,  0.29 ) * aspectCorrect ) * dofblur7 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.4,   0.0  ) * aspectCorrect ) * dofblur7 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.29, -0.29 ) * aspectCorrect ) * dofblur7 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.0,   0.4  ) * aspectCorrect ) * dofblur7 );","","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.29,  0.29 ) * aspectCorrect ) * dofblur4 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.4,   0.0  ) * aspectCorrect ) * dofblur4 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.29, -0.29 ) * aspectCorrect ) * dofblur4 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.0,  -0.4  ) * aspectCorrect ) * dofblur4 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.29,  0.29 ) * aspectCorrect ) * dofblur4 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.4,   0.0  ) * aspectCorrect ) * dofblur4 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2( -0.29, -0.29 ) * aspectCorrect ) * dofblur4 );","    col += texture2D( uColorBuffer, vUv0 + ( vec2(  0.0,   0.4  ) * aspectCorrect ) * dofblur4 );","","    gl_FragColor = col / 41.0;","    gl_FragColor.a = 1.0;","}"].join("\n")}),this.maxBlur=.02,this.aperture=1,this.focus=1}BokehEffect.prototype=Object.create(pc.PostEffect.prototype),BokehEffect.prototype.constructor=BokehEffect,Object.assign(BokehEffect.prototype,{render:function(e,r,t){var o=this.device,c=o.scope;c.resolve("uMaxBlur").setValue(this.maxBlur),c.resolve("uAperture").setValue(this.aperture),c.resolve("uFocus").setValue(this.focus),c.resolve("uAspect").setValue(o.width/o.height),c.resolve("uColorBuffer").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,r,this.vertexBuffer,this.shader,t)}});var Bokeh=pc.createScript("bokeh");Bokeh.attributes.add("maxBlur",{type:"number",default:.02,min:0,max:1,precision:5,title:"Max Blur"}),Bokeh.attributes.add("aperture",{type:"number",default:1,min:0,max:1,precision:5,title:"Aperture"}),Bokeh.attributes.add("focus",{type:"number",default:1,title:"Focus"}),Bokeh.prototype.initialize=function(){this.effect=new BokehEffect(this.app.graphicsDevice),this.effect.maxBlur=this.maxBlur,this.effect.aperture=this.aperture,this.effect.focus=this.focus,this.on("attr",(function(e,r){this.effect[e]=r}),this);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(r){r?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};var UranusPhysicsCollider=pc.createScript("uranusPhysicsCollider");UranusPhysicsCollider.attributes.add("inEditor",{type:"boolean",default:!0}),UranusPhysicsCollider.attributes.add("customShape",{type:"string",default:"trimesh",enum:[{Trimesh:"trimesh"},{Heightfield:"heightfield"}],title:"Custom Shape",description:"Select if a custom shape type will be created."}),UranusPhysicsCollider.attributes.add("groupByScale",{type:"number",default:0,title:"Group By Scale",description:"Extends the default trimesh collider to support model scaling. Models should have a uniform scale and vary their scale from to another based on the step provided. This settings works only for trimesh shapes. If 0.0 is provided the regular PlayCanvas engine cache will be used instead."}),UranusPhysicsCollider.overrideInPlace=!1,UranusPhysicsCollider.prototype.initialize=function(){UranusPhysicsCollider.overrideInPlace||(UranusPhysicsCollider.overrideInPlace=!0,this.override()),this.entity.collision&&(this.entity.collision.enabled=!0)},UranusPhysicsCollider.prototype.getMeshCacheId=function(e,t){return`${e}_${t}`},UranusPhysicsCollider.prototype.override=function(){this.app.systems.collision._createImplementation("mesh");const e=new pc.GraphNode,t=this.app.systems.collision.implementations.mesh;t.createPhysicalShape=function(t,s){if("undefined"!=typeof Ammo&&(s.model||s.render)){const o=new Ammo.btCompoundShape,i=t.script?.uranusPhysicsCollider;if(i&&"trimesh"!==i.customShape){if("heightfield"===i.customShape){const e=s.render.meshes[0];this.createAmmoHeightfield(e,i,o)}}else if(s.model){const e=s.model.meshInstances;for(let s=0;s<e.length;s++)this.createAmmoMesh(e[s].mesh,e[s].node,o,i,t)}else if(s.render){const a=s.render.meshes;for(let s=0;s<a.length;s++)this.createAmmoMesh(a[s],e,o,i,t)}const a=t.getWorldTransform().getScale(),n=new Ammo.btVector3(a.x,a.y,a.z);return o.setLocalScaling(n),Ammo.destroy(n),o}}.bind(t),t.createAmmoMesh=function(e,t,s,o,i){let a,n=e.id;const r=o?.groupByScale;if(r){let t=i;i.name.indexOf("_LOD")>-1&&(t=i.parent,s.baseEntityRefName=t.name);const o=Math.floor(t.getLocalScale().x/r)*r;n=UranusPhysicsCollider.prototype.getMeshCacheId(e.id,o),s.entityRefName=i.name,s.cacheId=n,s.meshId=e.id,s.scaleWithStep=o}if(this.system._triMeshCache[n])a=this.system._triMeshCache[n];else{const t=e.vertexBuffer,o=t.getFormat();let i,r;for(let e=0;e<o.elements.length;e++){const s=o.elements[e];if(s.name===pc.SEMANTIC_POSITION){r=new Float32Array(t.lock(),s.offset),i=s.stride/4;break}}const m=[];e.getIndices(m);const l=e.primitive[0].count/3,h=new Ammo.btVector3,c=new Ammo.btVector3,d=new Ammo.btVector3;let u,p,y;const g=e.primitive[0].base;a=new Ammo.btTriangleMesh,a.shape=s,this.system._triMeshCache[n]=a;for(let e=0;e<l;e++)u=m[g+3*e]*i,p=m[g+3*e+1]*i,y=m[g+3*e+2]*i,h.setValue(r[u],r[u+1],r[u+2]),c.setValue(r[p],r[p+1],r[p+2]),d.setValue(r[y],r[y+1],r[y+2]),a.addTriangle(h,c,d,!0);Ammo.destroy(h),Ammo.destroy(c),Ammo.destroy(d)}const m=new Ammo.btBvhTriangleMeshShape(a,!0),l=this.system._getNodeScaling(t);m.setLocalScaling(l),Ammo.destroy(l);const h=this.system._getNodeTransform(t);s.addChildShape(h,m),Ammo.destroy(h)}.bind(t),t.createAmmoHeightfield=function(e,t,s){const o=t.entity,i=e.inputData,a=e.meshData,n=i.subdivisions+1,r=i.subdivisions+1,m=a.heights;t.ammoHeightData,ammoHeightData=t.ammoHeightData=Ammo._malloc(4*n*r);let l=0;for(let e=0;e<n*r;e++)Ammo.HEAPF32[ammoHeightData+l>>2]=m[e],l+=4;const h=new Ammo.btHeightfieldTerrainShape(n,r,ammoHeightData,1,a.minHeight,a.maxHeight,1,"PHY_FLOAT",!1),c=i.width/(n-1),d=i.depth/(r-1);h.setLocalScaling(new Ammo.btVector3(c,1,d)),h.setMargin(.01);const u=new pc.GraphNode;u.setRotation(o.getRotation()),u.rotateLocal(0,-90,0);const p=u.getPosition(),y=u.getRotation(),g=new Ammo.btTransform;g.setIdentity();const f=g.getOrigin();f.setValue(p.x,p.y+(a.maxHeight+a.minHeight)/2,p.z);const A=new Ammo.btQuaternion;A.setValue(y.x,y.y,y.z,y.w),g.setRotation(A),Ammo.destroy(A),Ammo.destroy(f),s.addChildShape(g,h),Ammo.destroy(g)}};var UranusModuleLoader=pc.createScript("uranusModuleLoader");UranusModuleLoader.attributes.add("inEditor",{type:"boolean",default:!1}),UranusModuleLoader.attributes.add("moduleAsset",{type:"asset",assetType:"script"}),UranusModuleLoader.attributes.add("className",{type:"string",default:"MyModule"}),UranusModuleLoader.prototype.initialize=function(){if(!this.moduleAsset)return;if(window[this.className])return;const e=new URL(this.moduleAsset.getFileUrl(),document.baseURI).href;import(e).then((e=>{window[this.className]=e[this.className]}))};var UranusEffectsMaterialDistanceFade=pc.createScript("uranusEffectsMaterialDistanceFade");UranusEffectsMaterialDistanceFade.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsMaterialDistanceFade.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0}),UranusEffectsMaterialDistanceFade.attributes.add("fadeDistance",{type:"number",default:50,min:0,title:"Fade Distance"}),UranusEffectsMaterialDistanceFade.attributes.add("fadeBorder",{type:"number",default:5,min:0,title:"Fade Border"}),UranusEffectsMaterialDistanceFade.attributes.add("fadeIn",{type:"boolean",default:!1,title:"Fade In",description:"If selected the effect will fade in at that distance, instead of fading out. Requires material reload."}),UranusEffectsMaterialDistanceFade.attributes.add("fadeCamera",{type:"entity",title:"Fade Camera",description:"If a camera entity is provided the fade distance will be calculated from the entity world position. If none is provided then the world view position from the uranusInstancer will be used instead (this will work for instanced models only)."}),UranusEffectsMaterialDistanceFade.prototype.initialize=function(){this.viewPos=[0,0,0],this.materialAssets.forEach((a=>{a.ready((()=>this.updateMaterial(a.resource))),a.on("change",(()=>this.updateMaterial(a.resource)))})),UranusUtilities.loadAssets(this.materialAssets),this.on("attr",(function(){this.materialAssets.forEach((a=>this.updateAttributes(a.resource)))})),this.on("state",(function(a){a?this.materialAssets.forEach((a=>this.updateMaterial(a.resource))):this.materialAssets.forEach((a=>this.clearMaterial(a.resource)))})),this.app.on("UranusInstancer:onLodMultiplier",(function(){this.materialAssets.forEach((a=>this.updateAttributes(a.resource)))}),this)},UranusEffectsMaterialDistanceFade.prototype.updateMaterial=function(a){const e=this.fadeCamera?"fadeViewPosition":"uranus_view_position_alpha";let t=`  \nuniform float alpha_ref;\n\n${this.fadeCamera?"uniform vec3 fadeViewPosition;\n":"uniform vec3 uranus_view_position_alpha;\n"}\nuniform float fadeDistance;\nuniform float fadeBorder;  \n`;this.fadeIn?t+=`\nvoid alphaTest(float a) {\n    float distance = distance(${e}, vPositionW);\n    float fadeFactor = clamp( (distance - fadeDistance) / fadeBorder, alpha_ref, 1.0);\n\n    if (fadeFactor < a) discard;\n}\n`:t+=`\nvoid alphaTest(float a) {\n    float distance = distance(${e}, vPositionW);\n    float fadeFactor = clamp( (distance - fadeDistance) / fadeBorder, alpha_ref, 1.0);\n\n    if (a < fadeFactor) discard;\n}\n`,a.chunks.alphaTestPS=t,a.chunks.APIVersion=pc.CHUNKAPI_1_55,UranusUtilities.addUranusBaseUniforms(a),a.update(),this.updateAttributes(a)},UranusEffectsMaterialDistanceFade.prototype.clearMaterial=function(a){a&&(delete a.chunks.alphaTestPS,a.update())},UranusEffectsMaterialDistanceFade.prototype.updateAttributes=function(a){const e=void 0!==UranusInstancer?.api?.lodMultiplier?UranusInstancer.api.lodMultiplier:1;a.setParameter("fadeDistance",this.fadeDistance*e),a.setParameter("fadeBorder",this.fadeBorder),this.fadeCamera&&this.app.on("update",this.appUpdate,this)},UranusEffectsMaterialDistanceFade.prototype.appUpdate=function(){const a=this.fadeCamera.getPosition(),e=this.viewPos;e[0]=a.x,e[1]=a.y,e[2]=a.z,this.materialAssets.forEach((a=>a.resource.setParameter("fadeViewPosition",e)))};var UranusEffectsMultiMaterial=pc.createScript("uranusEffectsMultiMaterial");UranusEffectsMultiMaterial.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsMultiMaterial.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0}),UranusEffectsMultiMaterial.attributes.add("channels",{type:"json",array:!0,title:"Channels",schema:[{name:"maskType",type:"string",default:"none",enum:[{None:"none"},{"Texture Channel R":"texture_r"},{"Texture Channel G":"texture_g"},{"Texture Channel B":"texture_b"},{"Texture Channel A":"texture_a"},{"Vertex Color R":"vertex_r"},{"Vertex Color G":"vertex_g"},{"Vertex Color B":"vertex_b"}],title:"Mask Type"},{name:"maskMap",type:"asset",assetType:"texture",title:"Mask Map",description:"If a texture channel has been selected as mask reference the texture mask here."},{name:"invertMask",type:"boolean",title:"Invert Mask"},{name:"diffuseMap",type:"asset",assetType:"texture",title:"Diffuse Map"},{name:"diffuseTiling",type:"vec2",default:[1,1],title:"Diffuse Tiling"},{name:"diffuseTint",type:"rgb",title:"Diffuse Tint"},{name:"diffuseBlendMode",type:"string",default:"replace",enum:[{Replace:"replace"},{Multiply:"mul"},{Additive:"add"},{Screen:"screen"},{Overlay:"overlay"},{Min:"min"},{Max:"max"}],title:"Diffuse Blend Mode"},{name:"normalMap",type:"asset",assetType:"texture",title:"Normal Map"},{name:"normalMapTiling",type:"vec2",default:[1,1],title:"Normal Tiling"},{name:"normalMapBumpiness",type:"number",min:0,max:2,default:1,title:"Normal Map Bumpiness"},{name:"metalness",type:"number",min:0,max:1,default:0,title:"Metalness"},{name:"shininess",type:"number",min:0,max:100,default:39.29,title:"Glossiness"}]}),UranusEffectsMultiMaterial.prototype.initialize=function(){this.uniqueAssets={},this.uniqueAssetsAdded=!1,this.overrideDiffuse=!1,this.overrideNormal=!1,this.prepare(),this.on("attr",(async function(e){await this.prepareAssets(),this.materialAssets.forEach((e=>this.updateMaterial(e.resource)))})),this.on("state",(async function(e){e?(await this.prepareAssets(),this.materialAssets.forEach((e=>this.updateMaterial(e.resource)))):this.materialAssets.forEach((e=>this.clearMaterial(e.resource)))}))},UranusEffectsMultiMaterial.prototype.prepare=async function(){await this.prepareAssets(),this.materialAssets.forEach((e=>{e.ready((e=>this.updateMaterial(e.resource))),e.on("change",(e=>this.updateMaterial(e.resource)))}))},UranusEffectsMultiMaterial.prototype.prepareAssets=async function(){this.uniqueAssets={},this.channels.forEach((e=>{e.diffuseMap&&(this.uniqueAssets[e.diffuseMap.id]=e.diffuseMap,this.overrideDiffuse||(this.overrideDiffuse=!0)),e.normalMap&&(this.uniqueAssets[e.normalMap.id]=e.normalMap,this.overrideNormal||(this.overrideNormal=!0)),e.maskMap&&(this.uniqueAssets[e.maskMap.id]=e.maskMap)})),await UranusUtilities.loadAssets(Object.values(this.uniqueAssets).concat(this.materialAssets))},UranusEffectsMultiMaterial.prototype.updateMaterial=function(e){if(e){this.uniqueAssetsAdded=!1,this.overrideNormal&&this.normalDetailMapPS(e),this.overrideDiffuse&&this.diffuseDetailMapPS(e),this.metalnessPS(e),this.glossPS(e);for(let t in this.uniqueAssets)e.setParameter(`texture_${t}`,this.uniqueAssets[t].resource);e.onUpdateShader=function(t){return e._uranusRequiresInstancing&&(t.useInstancing=!0),t.vertexColors=!0,t},e.update(),e.chunks.APIVersion=pc.CHUNKAPI_1_55,e._uranusRequiresVertexColors=!0}},UranusEffectsMultiMaterial.prototype.clearMaterial=function(e){e&&(delete e.chunks.diffuseDetailMapPS,delete e.chunks.normalDetailMapPS,delete e.chunks.metalnessPS,delete e.chunks.glossPS,e.update())},UranusEffectsMultiMaterial.prototype.addUniforms=function(){let e="";if(!1===this.uniqueAssetsAdded){this.uniqueAssetsAdded=!0;for(let t in this.uniqueAssets)e+=`uniform sampler2D texture_${t};\n`}return e},UranusEffectsMultiMaterial.prototype.getChannelMask=function(e,t){let a="";const n=e.maskType.split("_")[0],s=e.maskType.split("_")[1];return"texture"===n?a=`    float mask${t} = ${e.invertMask?"1.0 - ":""}texture2D(texture_${e.maskMap.id}, vUv0).${s};`:"vertex"===n&&(a=`    float mask${t} = ${e.invertMask?"1.0 - ":""}vVertexColor.${s};`),a},UranusEffectsMultiMaterial.prototype.diffuseDetailMapPS=function(e){let t=this.addUniforms(),a="",n=!1;this.channels.forEach(((t,s)=>{if(n||(n=!0,e.diffuseDetailMap=t.diffuseMap.resource),t.diffuseMap){let e="$UV";!1===t.diffuseTiling.equals(pc.Vec2.ONE)&&(e+=` * vec2(${t.diffuseTiling.x.toFixed(2)}, ${t.diffuseTiling.y.toFixed(2)})`),a+=`\n    vec3 albedoDetail${s} = gammaCorrectInput(texture2D(texture_${t.diffuseMap.id}, ${e}, textureBias).rgb);\n`,!1===t.diffuseTint.equals(pc.Color.WHITE)&&(a+=`\n    albedoDetail${s} *= vec3(${t.diffuseTint.r.toFixed(3)}, ${t.diffuseTint.g.toFixed(3)}, ${t.diffuseTint.b.toFixed(3)});\n`)}a+=this.getChannelMask(t,s);const i="none"!==t.maskType?` * mask${s}`:"";t.diffuseMap?"replace"===t.diffuseBlendMode?a+=`detailColor += albedoDetail${s}${i};\n\n`:a+=`detailColor += detailMode_${t.diffuseBlendMode}(albedo, albedoDetail${s})${i};\n\n`:a+=`detailColor += albedo${i};\n\n`})),t+=`\nvec3 addAlbedoDetail(vec3 albedo) {\n\n    vec3 detailColor = vec3(0.0);\n\n    ${a}\n\n    return detailColor;\n}    \n`,e.chunks.diffuseDetailMapPS=t},UranusEffectsMultiMaterial.prototype.normalDetailMapPS=function(e){let t=this.addUniforms(),a="",n=!1;this.channels.forEach(((t,s)=>{if(n||(n=!0,e.normalDetailMap=t.normalMap.resource),t.normalMap){let e="$UV";!1===t.normalMapTiling.equals(pc.Vec2.ONE)&&(e+=` * vec2(${t.normalMapTiling.x.toFixed(2)}, ${t.normalMapTiling.y.toFixed(2)})`);const n=t.normalMap.resource,i=!!n&&(n.format===pc.PIXELFORMAT_DXT5||n.type===pc.TEXTURETYPE_SWIZZLEGGGR);a+=`\n    vec3 normalDetail${s} = ${i?"unpackNormalXY":"unpackNormalXYZ"}(texture2D(texture_${t.normalMap.id}, ${e}, textureBias));\n`}a+=this.getChannelMask(t,s);const i="none"!==t.maskType?` * mask${s}`:"";t.normalMap&&(a+=`\n    normalDetail${s} = normalize(mix(vec3(0.0, 0.0, 1.0), normalDetail${s}, ${t.normalMapBumpiness.toFixed(2)}));            \n    detailColor += blendNormals(detailColor, normalDetail${s})${i};\n`),a+="\n        \n        \n        "})),t+=`\nvec3 blendNormals(vec3 n1, vec3 n2) {\n    // https://blog.selfshadow.com/publications/blending-in-detail/#detail-oriented\n    n1 += vec3(0, 0, 1);\n    n2 *= vec3(-1, -1, 1);\n    return normalize(n1*dot(n1, n2)/n1.z - n2);\n}\n\nvec3 unpackNormalXY(vec4 nmap) {\n    vec3 normal;\n    normal.xy = nmap.wy * 2.0 - 1.0;\n    normal.z = sqrt(1.0 - saturate(dot(normal.xy, normal.xy)));\n    return normal;\n}\n\nvec3 unpackNormalXYZ(vec4 nmap) {\n    return nmap.xyz * 2.0 - 1.0;\n}\n\nvec3 addNormalDetail(vec3 normalMap) {\n\n    vec3 detailColor = normalMap;\n\n    ${a}\n    detailColor = normalize(mix(vec3(0.0, 0.0, 1.0), detailColor, 1.0));\n\n    return detailColor;\n}    \n`,e.chunks.normalDetailMapPS=t},UranusEffectsMultiMaterial.prototype.metalnessPS=function(e){let t=this.addUniforms(),a="";const n=[];this.channels.forEach(((e,t)=>{"none"!==e.maskType&&(a+=this.getChannelMask(e,t),n.push(`mask${t} * ${e.metalness.toFixed(2)}`))})),t+=`\n#ifdef MAPFLOAT\nuniform float material_metalness;\n#endif\n\n#ifdef MAPTEXTURE\nuniform sampler2D texture_metalnessMap;\n#endif\n\nvoid getMetalness() {\n\n    ${a}\n\n    float metalness = 1.0;\n\n    #ifdef MAPFLOAT\n    metalness *= material_metalness${n.length>0?" + ":";"}${n.join(" + ")};\n    #endif\n\n    #ifdef MAPTEXTURE\n    metalness *= texture2D(texture_metalnessMap, $UV, textureBias).$CH;\n    #endif\n\n    #ifdef MAPVERTEX\n    metalness *= saturate(vVertexColor.$VC);\n    #endif\n\n    dMetalness = metalness;\n} \n`,e.chunks.metalnessPS=t},UranusEffectsMultiMaterial.prototype.glossPS=function(e){let t=this.addUniforms(),a="";const n=[];this.channels.forEach(((e,t)=>{"none"!==e.maskType&&(a+=this.getChannelMask(e,t),n.push(`mask${t} * ${(.01*e.shininess).toFixed(2)}`))})),t+=`\n#ifdef MAPFLOAT\nuniform float material_shininess;\n#endif\n\n#ifdef MAPTEXTURE\nuniform sampler2D texture_glossMap;\n#endif\n\nvoid getGlossiness() {\n    dGlossiness = 1.0;\n\n    ${a}\n\n    #ifdef MAPFLOAT\n    dGlossiness *= material_shininess${n.length>0?" + ":";"}${n.join(" + ")};\n    #endif\n\n    #ifdef MAPTEXTURE\n    dGlossiness *= texture2D(texture_glossMap, $UV).$CH;\n    #endif\n\n    #ifdef MAPVERTEX\n    dGlossiness *= saturate(vVertexColor.$VC);\n    #endif\n\n    dGlossiness += 0.0000001;\n}\n`,e.chunks.glossPS=t};var UranusEffectsMaterialWind=pc.createScript("uranusEffectsMaterialWind");UranusEffectsMaterialWind.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsMaterialWind.attributes.add("eventEntity",{type:"entity",title:"Event Holder",description:"If an event entity is provided then all events will fire on that entity. Otherwise they will fire on the app object."}),UranusEffectsMaterialWind.attributes.add("onRender",{type:"string",title:"On Render",description:"If an event name is provided the shader will update automatically when the event will fire. Useful when combining multiple effects on the same shader (e.g. terrain splatmaps with surface noise)."}),UranusEffectsMaterialWind.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0}),UranusEffectsMaterialWind.attributes.add("windChannels",{type:"json",array:!0,schema:[{name:"wavelength",type:"number",default:.5,title:"Wavelength"},{name:"amplitude",type:"number",default:.05,title:"Amplitude"},{name:"timeOffset",type:"number",default:0,title:"Time Offset",description:"You can set an optional time offset per channel to further randomize the wind animation."},{name:"textureCoord",type:"string",default:"vertex_texCoord0",enum:[{UV0:"vertex_texCoord0"},{UV1:"vertex_texCoord1"},{World:"world"}],title:"Texture Coord",description:"Set which set of coordinates will be used to calculate the wind animation."},{name:"textureCoordAxis",type:"string",default:"y",enum:[{X:"x"},{Y:"y"},{Z:"z"}],title:"Texture Coord Axis",description:"The axis on which the wind animation will play on. To use multiple axis you can add more channels."},{name:"windBase",type:"number",default:0,min:0,max:1,title:"Wind Base",description:"Set the starting coordinates value in the range of 0.0 to 1.0 for the wind animation."},{name:"invertCoords",type:"boolean",default:!1,title:"Invert Coordinates",description:"If selected the coordinates used will be inverted."}]}),UranusEffectsMaterialWind.attributes.add("windGustSize",{type:"number",default:.5,title:"Wind Gust Size",description:"The size in world units of each  wind gust."}),UranusEffectsMaterialWind.attributes.add("windDirection",{type:"vec2",default:[1,1],title:"Wind Direction",description:"The wind direction in the X and Z axis."}),UranusEffectsMaterialWind.attributes.add("interactObject",{type:"boolean",default:!1,title:"Interact Object",description:"If selected the vertices of the model will be pushed away by any objects nearby."}),UranusEffectsMaterialWind.attributes.add("interactList",{type:"entity",array:!0,title:"Interact List",description:"A list of entities that can interact with this material (on WebGL1 devices a maximum of 20 entities is supported)."}),UranusEffectsMaterialWind.attributes.add("interactRadius",{type:"number",default:1,minimum:0,title:"Interact Radius",description:"The area around each interaction entity that will be pushed away."}),UranusEffectsMaterialWind.attributes.add("interactAxis",{type:"json",schema:[{name:"x",type:"boolean",default:!0,title:"X"},{name:"y",type:"boolean",default:!0,title:"Y"},{name:"z",type:"boolean",default:!0,title:"Z"}],title:"Interact Axis",description:"Set the axis the vertext interact effect will be applied."}),UranusEffectsMaterialWind.attributes.add("billboard",{type:"boolean",default:!1,title:"Billboard",description:"If selected the model will be rendered as a billboard to always face the camera."}),UranusEffectsMaterialWind.attributes.add("billboardLockY",{type:"boolean",default:!0,title:"Billboard Lock Y",description:"If set to true the billboard rotation will be only on Y axis, otherwise it will face the camera in all direction."}),UranusEffectsMaterialWind.attributes.add("billboardReverseSize",{type:"boolean",default:!1,title:"Billboard Reverse Size",description:"If selected the billboard half extents calculation from the reference render asset will be reversed."}),UranusEffectsMaterialWind.attributes.add("billboardRefSize",{type:"asset",assetType:"render",array:!0,title:"Billbaord Ref Size",description:"Provide a list of render assets for each material (in the same order), to be used for sizing the billboard."}),UranusEffectsMaterialWind.prototype.initialize=function(){this.arr2=[0,0],this.interactionArr=[],this.prepare(),this.on("attr",(function(e){"windGustSize"===e||"windDirection"===e?this.materialAssets.forEach((e=>this.updateAttributes(e.resource))):this.materialAssets.forEach((e=>this.updateMaterial(e.resource)))})),this.on("state",(function(e){e?this.materialAssets.forEach((e=>this.updateMaterial(e.resource))):this.materialAssets.forEach((e=>this.clearMaterial(e.resource)))}))},UranusEffectsMaterialWind.prototype.prepare=async function(){UranusEffectsMaterialWind.time||UranusEffectsMaterialWind.prepareGlobal(this.app),await UranusUtilities.loadAssets(this.materialAssets.concat(this.billboardRefSize)),this.materialAssets.forEach((e=>{e.ready(this.onMaterialReady.bind(this)),e.on("change",this.onMaterialReady.bind(this))}))},UranusEffectsMaterialWind.prototype.onMaterialReady=function(e){if(this.onRender){(this.eventEntity?this.eventEntity:this.app).on(this.onRender,(function(){this.updateMaterial(e.resource)}),this)}else this.updateMaterial(e.resource)},UranusEffectsMaterialWind.prototype.updateMaterial=function(e){UranusUtilities.prepareShaderForInjection(e,"transformVS");let t=e.chunks.transformVS_uranusBase,i="\nuniform float uranus_material_wind_time;\nuniform float windGustSize;\nuniform vec2 windDirection;\n";this.interactObject&&(i+="\nuniform vec3 interactionList[20];\nuniform int interactionListLength;\n"),this.billboard&&(i+="\nuniform vec2 billboardSize;\n");let a=this.getWindChunk();this.interactObject&&(a+=this.getInteractChunk()),t=t.replace("// INJECT uniforms",i),this.billboard&&(t=this.applyBillboard(t,e)),t=t.replace("// INJECT chunk",a),e.chunks.transformVS=t,e.chunks.APIVersion=pc.CHUNKAPI_1_55,e.update(),this.updateAttributes(e)},UranusEffectsMaterialWind.prototype.applyBillboard=function(e,t){const i=this.materialAssets.findIndex((e=>e.resource===t)),a=this.billboardRefSize[i];let n;if(a){const e=a.resource.meshes[0],t=[e.aabb.halfExtents.x,e.aabb.halfExtents.y,e.aabb.halfExtents.z];t.reverse(),n=[t[0],t[1]],this.billboardReverseSize&&n.sort()}else n=[1,1];return t.setParameter("billboardSize",n),e.replace("vec4 posW = dModelMatrix * vec4(localPos, 1.0);",`\n    vec3 right = vec3(matrix_view[0][0], matrix_view[1][0], matrix_view[2][0]);\n\n    ${this.billboardLockY?"\n    vec3 up = vec3(0.0, 1.0, 0.0);\n":"\n    vec3 up\t= vec3(matrix_view[0][1], matrix_view[1][1], matrix_view[2][1]);\n"}\n    vec2 billboardSizeScaled = billboardSize;\n\n    // --- if the billboard is instanced, uniform scaling is supported\n    #ifdef INSTANCING\n        billboardSizeScaled *= instance_line3.y;\n    #endif\n    \n    vec3 actualQuadCenter = vec3(dModelMatrix[3][0], dModelMatrix[3][1], dModelMatrix[3][2]);\n    actualQuadCenter.y += billboardSizeScaled.y;\n\n    vec2 quadPos = vertex_texCoord0 * 2.0 - vec2(1.0);\n\n    localPos = actualQuadCenter - (quadPos.x * right * billboardSizeScaled.x + quadPos.y * up * billboardSizeScaled.y);\n    vec4 posW = vec4(localPos, 1.0);\n`)},UranusEffectsMaterialWind.prototype.getWindChunk=function(){let e="";return this.windChannels.forEach(((t,i)=>{"world"!==t.textureCoord?e+=`\n    vec2 uv${i} = vec2(${t.textureCoord}.x, 1.0 -  ${t.textureCoord}.y);\n\n    float height${i} = uv${i}.y >= ${t.windBase.toFixed(2)} ? pow(${t.invertCoords?"1.0 -":""}uv${i}.${t.textureCoordAxis}, 2.0) : 0.0;\n    \n    float posTime${i} = uranus_material_wind_time + ${t.timeOffset.toFixed(2)};\n    posW.x += sin( posTime${i} * ${t.amplitude.toFixed(2)} + posW.x * windGustSize) * height${i} * ${t.wavelength.toFixed(2)} * windDirection.x;\n    posW.z += sin( posTime${i} * ${t.amplitude.toFixed(2)} + posW.z * windGustSize) * height${i} * ${t.wavelength.toFixed(2)} * windDirection.y;`:e+=`    \n      float posWorldTime${i} = uranus_material_wind_time + ${t.timeOffset.toFixed(2)};\n      posW.${t.textureCoordAxis} +=cos( (posW.x + posWorldTime${i}) /${t.wavelength.toFixed(2)} ) * sin( (posW.z + posWorldTime${i}) /${t.wavelength.toFixed(2)} ) * ${t.amplitude.toFixed(2)};\n      `})),e},UranusEffectsMaterialWind.prototype.getInteractChunk=function(){return`\n    for (int i = 0; i < ${this.app.graphicsDevice.webgl2?"interactionListLength":"20"}; i++){\n       vec3 interactionPos = interactionList[i];\n       vec3 dis = vec3(distance(interactionPos, posW.xyz));\n       vec3 circle = 1.0 - clamp(dis / ${this.interactRadius.toFixed(2)},0.0,1.0);\n       vec3 sphereDisp = posW.xyz - interactionPos;\n       sphereDisp *= circle;\n       sphereDisp.y = clamp(sphereDisp.y, -1.0, 0.0);\n       sphereDisp.xyz *= 2.0;\n       ${this.interactAxis.x?"posW.x += sphereDisp.x;":""}\n       ${this.interactAxis.y?"posW.y += sphereDisp.y;":""}\n       ${this.interactAxis.z?"posW.z += sphereDisp.z;":""}\n    }\n`},UranusEffectsMaterialWind.prototype.clearMaterial=function(e){e&&(delete e.chunks.transformVS,e.update())},UranusEffectsMaterialWind.prototype.updateAttributes=function(e){e.setParameter("windGustSize",this.windGustSize),this.arr2[0]=this.windDirection.x,this.arr2[1]=this.windDirection.y,e.setParameter("windDirection",this.arr2)},UranusEffectsMaterialWind.prototype.updateInteractAttributes=function(e){const t=this.interactionArr;let i=0;this.interactList.forEach((e=>{if(!e)return!0;const a=e.getPosition();t[i++]=a.x,t[i++]=a.y,t[i++]=a.z})),e.setParameter("interactionList[0]",t),!0===this.app.graphicsDevice.webgl2&&e.setParameter("interactionListLength",i/3)},UranusEffectsMaterialWind.prototype.update=function(e){this.materialAssets.forEach((e=>{const t=e.resource;t&&this.interactObject&&this.updateInteractAttributes(t)}))},UranusEffectsMaterialWind.time=0,UranusEffectsMaterialWind.prepareGlobal=function(e){this.app=e,this.windTimeId=this.app.graphicsDevice.scope.resolve("uranus_material_wind_time"),this.app.on("update",UranusEffectsMaterialWind.appUpdate,this)},UranusEffectsMaterialWind.appUpdate=function(e){UranusEffectsMaterialWind.time+=e,this.windTimeId.setValue(UranusEffectsMaterialWind.time)};var UranusEffectsRenderSurface=pc.createScript("uranusEffectsRenderSurface");UranusEffectsRenderSurface.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsRenderSurface.attributes.add("eventEntity",{type:"entity",title:"Event Holder",description:"If an event entity is provided then all events will fire on that entity. Otherwise they will fire on the app object."}),UranusEffectsRenderSurface.attributes.add("targetEntity",{type:"entity",array:!0,title:"Target Entity",description:"A target entity is required to size the camera viewport based on its model bounding box."}),UranusEffectsRenderSurface.attributes.add("onRender",{type:"string",title:"On Render",description:"If an event name is provided the surface will render automatically when the event will fire."}),UranusEffectsRenderSurface.attributes.add("onSurface",{type:"string",title:"On Surface",description:"If an event name is provided the rendered texture will be passed as a reference to the event callback. If no surface has been rendered, a new render will be scheduled."}),UranusEffectsRenderSurface.attributes.add("shaderUniform",{type:"string",title:"Shader Uniform",description:"If a uniform name is provided the rendered texture will be injected in the global WebGL context to be made accessible to all shaders."}),UranusEffectsRenderSurface.attributes.add("elementEntity",{type:"entity",title:"Element Entity",description:"If an entity with an image element component is provided, the rendered surface will be applied to it."}),UranusEffectsRenderSurface.attributes.add("layers",{type:"string",array:!0,default:["World"],title:"Layers",description:"A list of layer names which the render camera will target while rendering."}),UranusEffectsRenderSurface.attributes.add("renderWidth",{type:"number",default:1024,title:"Render Width",description:"The width of the render target."}),UranusEffectsRenderSurface.attributes.add("renderHeight",{type:"number",default:1024,title:"Render Height",description:"The height of the render target."}),UranusEffectsRenderSurface.attributes.add("renderPreset",{type:"string",default:"full",enum:[{Full:"full"},{Diffuse:"diffuse"},{Normals:"normals"}],title:"Render Preset",description:"The selected preset to render with."}),UranusEffectsRenderSurface.attributes.add("renderDepth",{type:"boolean",default:!1,title:"Render Depth",description:"If selected a depth map will be rendered at the same time."}),UranusEffectsRenderSurface.attributes.add("disableShadows",{type:"boolean",default:!0,title:"Disable Shadows",description:"If selected shadows will be disabled for all lights during rendering."}),UranusEffectsRenderSurface.attributes.add("disableLights",{type:"boolean",default:!0,title:"Disable Lights",description:"If selected all lights will be disabled during rendering. Only a single top down directional light will be added."}),UranusEffectsRenderSurface.attributes.add("addLight",{type:"boolean",default:!1,title:"Add Light",description:"If selected a top down directional light will be added."}),UranusEffectsRenderSurface.attributes.add("readPixels",{type:"boolean",default:!1,title:"Read Pixels",description:"If true, instead of returning the pc.Texture, a typed array with the image pixels will be returned."}),UranusEffectsRenderSurface.attributes.add("cleanUpOnRender",{type:"boolean",default:!1,title:"Clean Up On Render",description:"If true, the render target will automatically be destroyed after the render is complete and all events have fired."}),UranusEffectsRenderSurface.attributes.add("debugOnScreen",{type:"boolean",default:!1,title:"Debug On Screen",description:"If true, the rendered texture will be displayed on screen."}),UranusEffectsRenderSurface.prototype.initialize=function(){if(this.ready=!1,this.renderTexture=void 0,this.renderTarget=void 0,this.orthoHeight=void 0,this.prepareRenderTarget(),this.onDebug(),this.onRender){(this.eventEntity?this.eventEntity:this.app).on(this.onRender,this.render,this)}this.on("attr:debugOnScreen",this.onDebug)},UranusEffectsRenderSurface.prototype.onDebug=function(){this.debugOnScreen?this.app.on("update",this.onDebugUpdate,this):this.app.off("update",this.onDebugUpdate,this)},UranusEffectsRenderSurface.prototype.onDebugUpdate=function(){if(!this.renderTexture)return;const e=this.app.graphicsDevice.width/this.app.graphicsDevice.height;this.app.drawTexture(0,0,1,1*e,this.renderTexture)},UranusEffectsRenderSurface.prototype.prepareRenderTarget=function(){this.clearRenderTarget(),this.renderTexture=new pc.Texture(this.app.graphicsDevice,{width:this.renderWidth,height:this.renderHeight,format:pc.PIXELFORMAT_R8_G8_B8,autoMipmap:!0,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE});const e={};this.renderDepth&&(this.depthTexture=new pc.Texture(this.app.graphicsDevice,{width:this.renderWidth,height:this.renderHeight,format:pc.PIXELFORMAT_DEPTH,mipmaps:!1,minFilter:pc.FILTER_NEAREST,magFilter:pc.FILTER_NEAREST,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE}),e.depth=!0,e.depthBuffer=this.depthTexture),this.renderTarget=new pc.RenderTarget(this.app.graphicsDevice,this.renderTexture,e)},UranusEffectsRenderSurface.prototype.clearRenderTarget=function(){this.renderTexture&&this.renderTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.renderTarget&&this.renderTarget.destroy(),this.renderTexture=void 0,this.depthTexture=void 0,this.renderTarget=void 0},UranusEffectsRenderSurface.prototype.render=function(e){return new Promise((t=>{const r=this.layers.map((e=>this.app.scene.layers.getLayerByName(e)));r.sort(((e,t)=>pc.app.scene.layers._opaqueOrder[e.id]<pc.app.scene.layers._opaqueOrder[t.id]?-1:1));const n=this.app.scene.layers.cameras,i=this;this.ready=!1,this.addLight&&(this.renderLight=new pc.Entity("RenderSurfaceLight"),this.renderLight.addComponent("light",{intensity:1,layers:r.map((e=>e.id)),type:pc.LIGHTTYPE_DIRECTIONAL}),this.app.root.addChild(this.renderLight));const a=UranusUtilities.findEntityMeshInstances(this.targetEntity),s=new pc.BoundingBox;a.forEach(((e,t)=>{0===t?s.copy(e.aabb):s.add(e.aabb)})),this.surfaceBounding=s;const d=new pc.Entity,o=s.halfExtents.x;d.addComponent("camera",{orthoHeight:o,farClip:2*s.halfExtents.y,layers:r.map((e=>e.id)),priority:-10,projection:pc.PROJECTION_ORTHOGRAPHIC,renderTarget:this.renderTarget}),d.setPosition(s.center),d.translate(0,s.halfExtents.y,0),d.rotateLocal(-90,0,0),this.app.root.addChild(d),this.surfaceCameraPos=d.getPosition().clone();const preCullRef=function(e){n[e].entity===d&&(i.onPreCull=void 0,i.disableShadows&&i.app.fire("UranusInstancer:setBypassShadows",!0),i.app.fire("UranusInstancer:setBypassCulling",!0),UranusEffectsShadowsTimer.bypassTimer=!0)},preRenderRef=function(e){n[e].entity===d&&(i.onPreRenderOpaque=void 0,i.disableLights&&this._lights.forEach((e=>{e.intensityOriginal=e.intensity,e.intensity=0})),i.addLight&&(i.renderLight.light.intensity=1))};let c=0;const postRenderRef=function(a){if(n[a].entity!==d)return;if(this.onPostRenderOpaque=void 0,i.disableShadows&&i.app.fire("UranusInstancer:setBypassShadows",!1),i.disableLights&&this._lights.forEach((e=>{e.intensity=e.intensityOriginal,delete e.intensityOriginal})),i.addLight&&(i.renderLight.light.intensity=0),c++,c<r.length)return;switch(i.app.fire("UranusInstancer:setBypassCulling",!1),UranusEffectsShadowsTimer.bypassTimer=!1,i.renderPreset){case"diffuse":case"normals":r.forEach((e=>{e.instances.opaqueMeshInstances.concat(e.instances.transparentMeshInstances).forEach((e=>{if(!e.material.chunks)return!0;e.material.chunks.endPS=pc.shaderChunks.endPS,e.material.update()}))}))}d.destroy(),i.addLight&&i.renderLight.destroy(),i.shaderUniform&&i.app.graphicsDevice.scope.resolve(i.shaderUniform).setValue(i.renderTexture),i.elementEntity&&i.elementEntity.element&&(i.elementEntity.element.texture=i.renderTexture),i.ready=!0;const s=i.getReturnData();if(i.onSurface){const t=i.eventEntity?i.eventEntity:i.app,r="string"==typeof e?e:i.onSurface;t.fire(r,s,i)}i.fire("uranusEffectsRenderSurface:_ready"),t(s),i.cleanUpOnRender&&i.clearRenderTarget()};switch(this.renderPreset){case"diffuse":case"normals":r.forEach((e=>{e.instances.opaqueMeshInstances.concat(e.instances.transparentMeshInstances).forEach((e=>{if(!e.material.chunks)return!0;switch(this.renderPreset){case"diffuse":e.material.chunks.endPS="\ngl_FragColor.rgb = dAlbedo;\n\n#ifndef HDR\ngl_FragColor.rgb = toneMap(gl_FragColor.rgb);\ngl_FragColor.rgb = gammaCorrectOutput(gl_FragColor.rgb);\n#endif\n";break;case"normals":e.material.chunks.endPS="\ngl_FragColor.rgb = dNormalW * 0.5 + 0.5;\n"}e.material.update()}))}))}r.forEach((e=>e.onPreCull=preCullRef)),r.forEach((e=>e.onPreRenderOpaque=preRenderRef)),r.forEach((e=>e.onPostRenderOpaque=postRenderRef))}))},UranusEffectsRenderSurface.prototype.getReturnData=function(){let e={texture:this.renderTexture};return this.readPixels&&(e.pixels=UranusUtilities.readPixelsFromTexture(this.renderTexture)),e};var UranusEffectsMaterialContrast=pc.createScript("uranusEffectsMaterialContrast");UranusEffectsMaterialContrast.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsMaterialContrast.attributes.add("brightness",{type:"number",default:0,min:-1,max:1,title:"Brightness"}),UranusEffectsMaterialContrast.attributes.add("contrast",{type:"number",default:0,min:-1,max:1,title:"Contrast"}),UranusEffectsMaterialContrast.attributes.add("saturation",{type:"number",default:0,min:-1,max:1,title:"Saturation"}),UranusEffectsMaterialContrast.prototype.initialize=function(){this.scopeMaterialBrightness=this.app.graphicsDevice.scope.resolve("materialBrightness"),this.scopeMaterialContrast=this.app.graphicsDevice.scope.resolve("materialContrast"),this.scopeMaterialSaturation=this.app.graphicsDevice.scope.resolve("materialSaturation"),this.prepare(),this.on("attr",this.updateAttributes)},UranusEffectsMaterialContrast.prototype.updateAttributes=async function(){this.scopeMaterialBrightness.setValue(this.brightness),this.scopeMaterialContrast.setValue(this.contrast),this.scopeMaterialSaturation.setValue(this.saturation)},void 0===UranusEffectsMaterialContrast.overridenGlobalChunks&&(UranusEffectsMaterialContrast.overridenGlobalChunks=!1),UranusEffectsMaterialContrast.prototype.prepare=function(){UranusEffectsMaterialContrast.overridenGlobalChunks||(UranusEffectsMaterialContrast.overridenGlobalChunks=!0,pc.shaderChunks.basePS=this.basePS(),pc.shaderChunks.endPS=this.endPS()),this.updateAttributes()},UranusEffectsMaterialContrast.prototype.basePS=function(){return`\nuniform float materialBrightness;\nuniform float materialContrast;\nuniform float materialSaturation;\n\n${pc.shaderChunks.basePS}\n`},UranusEffectsMaterialContrast.prototype.endPS=function(){return`\n${pc.shaderChunks.endPS}\n\n// brightness\ngl_FragColor.rgb += materialBrightness;\n            \n// contrast\nif (materialContrast > 0.0) {\n    gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - materialContrast) + 0.5;\n} else {\n    gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + materialContrast) + 0.5;\n}\n\n// saturation\nfloat average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;\nif (materialSaturation > 0.0) {\n    gl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - materialSaturation));\n} else {\n    gl_FragColor.rgb += (average - gl_FragColor.rgb) * (-materialSaturation);\n}\n`};var UranusInstantiateTemplate=pc.createScript("uranusInstantiateTemplate");UranusInstantiateTemplate.attributes.add("inEditor",{type:"boolean",default:!0}),UranusInstantiateTemplate.attributes.add("template",{type:"asset",assetType:"template",title:"Template",description:"Reference a template asset to automatically instantiate on initialize."}),UranusInstantiateTemplate.prototype.initialize=function(){if(this.template){const t=this.template.resource.instantiate();t.enabled=!1,this.entity.addChild(t),window.setTimeout((()=>t.enabled=!0),0)}};var UranusEffectsMaterialSurfaceColor=pc.createScript("uranusEffectsMaterialSurfaceColor");UranusEffectsMaterialSurfaceColor.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsMaterialSurfaceColor.attributes.add("eventEntity",{type:"entity",title:"Event Holder",description:"If an event entity is provided then all events will fire on that entity. Otherwise they will fire on the app object."}),UranusEffectsMaterialSurfaceColor.attributes.add("onRender",{type:"string",title:"On Render",description:"If an event name is provided the shader will update automatically when the event will fire. Useful when combining multiple effects on the same shader (e.g. terrain splatmaps with surface noise)."}),UranusEffectsMaterialSurfaceColor.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0}),UranusEffectsMaterialSurfaceColor.attributes.add("renderSurface",{type:"entity",title:"Render Surface",description:"If a uranusEffectsRenderSurface entity is referenced the material diffuse color will be multiplied by the pixel color on that world position."}),UranusEffectsMaterialSurfaceColor.attributes.add("surfaceBlend",{type:"boolean",default:!1,title:"Surface Blend",description:"If selected the pixel color will be blended up to the specified height with the surface, based on the rendered depth."}),UranusEffectsMaterialSurfaceColor.attributes.add("surfaceBlendHeight",{type:"number",default:2.5,min:0,title:"Surface Blend Height",description:"If surface blend is enabled this value controls the blending height from the surface intersection."}),UranusEffectsMaterialSurfaceColor.attributes.add("surfaceBlendPower",{type:"number",default:1,min:0,max:1,title:"Surface Blend Power",description:"The power of the final surface blend color."}),UranusEffectsMaterialSurfaceColor.attributes.add("normalsSurface",{type:"entity",title:"Normals Surface",description:"If a uranusEffectsRenderSurface entity is referenced the material normal map will be derived from this surface. Make sure you are referencing a surface that rendered Normals."}),UranusEffectsMaterialSurfaceColor.attributes.add("normalsBlend",{type:"boolean",default:!1,title:"Normals Blend",description:"If enabled the normals will be blended with the normals surface referenced in the normalsSurface attribute."}),UranusEffectsMaterialSurfaceColor.attributes.add("surfaceNormalsBlendHeight",{type:"number",default:2.5,min:0,title:"Surface Normals Blend Height",description:"If surface normals blend is enabled this value controls the blending height from the surface intersection."}),UranusEffectsMaterialSurfaceColor.attributes.add("surfaceNormalsBlendPower",{type:"number",default:1,min:0,max:1,title:"Surface Normals Blend Power",description:"The power of the final surface normals blend color."}),UranusEffectsMaterialSurfaceColor.attributes.add("surfaceBlendNoise",{type:"json",schema:[{name:"noiseTexture",type:"asset",assetType:"texture",title:"Noise Texture",description:"Provide a noise sampling texture (grayscale)."},{name:"noiseTextureChannel",type:"string",default:"r",enum:[{R:"r"},{G:"g"},{B:"b"},{A:"a"}],title:"Noise Texture Channel",description:"The channel to be used for the texture noise map."},{name:"noiseTiling",type:"vec2",default:[.005,.005],title:"Noise Tiling",description:"The world tiling of the noise texture."},{name:"noiseClamping",type:"vec2",default:[.5,1],title:"Noise Clamping",description:"Clamp the noise intensity between a min and max value (0-1)."}]}),UranusEffectsMaterialSurfaceColor.attributes.add("noiseChannels",{type:"json",array:!0,schema:[{name:"noiseTexture",type:"asset",assetType:"texture",title:"Noise Texture",description:"Provide a noise sampling texture (grayscale)."},{name:"noiseTextureChannel",type:"string",default:"r",enum:[{R:"r"},{G:"g"},{B:"b"},{A:"a"}],title:"Noise Texture Channel",description:"The channel to be used for the texture noise map."},{name:"noiseTiling",type:"vec2",default:[.005,.005],title:"Noise Tiling",description:"The world tiling of the noise texture."},{name:"noiseClamping",type:"vec2",default:[.5,1],title:"Noise Clamping",description:"Clamp the noise intensity between a min and max value (0-1)."},{name:"noiseSpeed",type:"number",default:.1,title:"Noise Speed",description:"If a value > 0 is provided the noise texture will be animated, useful for wind effects."},{name:"viewDistance",type:"number",default:0,title:"View Distance",description:"If a view distance is provided the noise effect will gradually fade out after it's being reached."},{name:"viewBorder",type:"number",default:50,title:"View Border",description:"The view border size for the noise fade out effect."},{name:"viewCamera",type:"entity",title:"View Camera",description:"If a camera entity is provided the view distance will be calculated from the entity world position. If none is provided then the world view position from the uranusInstancer will be used instead (this will work for instanced models only)."}]}),UranusEffectsMaterialSurfaceColor.prototype.initialize=function(){this.renderSurfaceParams=[0,0,0,0],this.viewPos=[0,0,0],this.texturesLoaded=!1,this.prepare(),this.on("attr",(function(e){0===e.indexOf("noise")||0===e.indexOf("surfaceBlend")||0===e.indexOf("normalsBlend")?this.materialAssets.forEach((e=>this.updateMaterial(e.resource))):this.materialAssets.forEach((e=>this.updateAttributes(e.resource)))})),this.on("state",(function(e){e?this.materialAssets.forEach((e=>this.updateMaterial(e.resource))):this.materialAssets.forEach((e=>this.clearMaterial(e.resource)))}))},UranusEffectsMaterialSurfaceColor.prototype.prepare=async function(){await this.prepareAssets(),this.materialAssets.forEach((e=>{e.ready(this.onMaterialReady.bind(this)),e.on("change",this.onMaterialReady.bind(this))}));const e=this.renderSurface?.script?.uranusEffectsRenderSurface;e&&e.on("uranusEffectsRenderSurface:_ready",(function(){this.materialAssets.forEach((e=>this.updateAttributes(e.resource)))}),this);const t=this.normalsSurface?.script?.uranusEffectsRenderSurface;t&&t.on("uranusEffectsRenderSurface:_ready",(function(){this.materialAssets.forEach((e=>this.updateAttributes(e.resource)))}),this)},UranusEffectsMaterialSurfaceColor.prototype.prepareAssets=async function(){const e=[];this.uniqueAssets={},this.noiseChannels.forEach((t=>{e.push(t.noiseTexture),this.uniqueAssets[t.noiseTexture.id]=t.noiseTexture})),this.surfaceBlendNoise.noiseTexture&&(this.uniqueAssets[this.surfaceBlendNoise.noiseTexture.id]=this.surfaceBlendNoise.noiseTexture),await UranusUtilities.loadAssets(Object.values(this.uniqueAssets).concat(this.materialAssets))},UranusEffectsMaterialSurfaceColor.prototype.onMaterialReady=function(e){if(this.onRender){(this.eventEntity?this.eventEntity:this.app).on(this.onRender,(function(){this.updateMaterial(e.resource)}),this)}else this.updateMaterial(e.resource)},UranusEffectsMaterialSurfaceColor.prototype.updateMaterial=function(e){UranusUtilities.prepareShaderForInjection(e,"diffusePS");const t=this.renderSurface?.script?.uranusEffectsRenderSurface;let r="";e:for(let t in this.uniqueAssets){const a=`uniform sampler2D texture_${t};`;for(let t in e.chunks)if("diffusePS"!==t&&t.indexOf("PS")>-1&&e.chunks[t].indexOf(a)>-1)continue e;r+=`\n${a}\n`}let a=!1;this.noiseChannels.forEach(((e,t)=>{e.noiseSpeed>0&&(r+=`\nuniform float surfaceNoiseTime${t};\n`),e.viewDistance>0&&!a&&e.viewCamera&&(a=!0,r+="uniform vec3 cameraViewPosition;\n")})),t&&(r+=`\nuniform sampler2D texture_renderSurface;\nuniform vec4 renderSurfaceParams; // orthoX orthoY sizeX sizeZ\n\n${this.surfaceBlend?"\nuniform sampler2D texture_depthSurface;\n\nuniform float renderFarClip;\nuniform float renderPosY;\n\nuniform float surfaceBlendHeight;\nuniform float surfaceBlendPower;\n\nuniform float surfaceNormalsBlendHeight;\nuniform float surfaceNormalsBlendPower;\n":""}\n\n${this.normalsBlend?"\n    uniform sampler2D texture_normalsSurface;\n":""}\n\nvec2 dSurfaceCoords;\n\n${pc.shaderChunks.screenDepthPS}\n`);let s="";t&&(s+=`\n    ${this.surfaceBlendNoise.noiseTexture?`\n        float surfaceNoise = texture2D(\n            texture_${this.surfaceBlendNoise.noiseTexture.id}, \n            vPositionW.xz * vec2(${this.surfaceBlendNoise.noiseTiling.x.toFixed(7)}, ${this.surfaceBlendNoise.noiseTiling.y.toFixed(7)})\n        ).${this.surfaceBlendNoise.noiseTextureChannel}; \n        surfaceNoise = clamp(surfaceNoise, ${this.surfaceBlendNoise.noiseClamping.x.toFixed(2)}, ${this.surfaceBlendNoise.noiseClamping.y.toFixed(2)});\n    `:"\n        float surfaceNoise = 1.0;\n    "}\n\n    dSurfaceCoords.x = clamp( (vPositionW.x + surfaceNoise * 0.001 + renderSurfaceParams.x) / renderSurfaceParams.z, 0.0, 1.0);\n    dSurfaceCoords.y = -clamp( (vPositionW.z + surfaceNoise * 0.001 + renderSurfaceParams.y) / renderSurfaceParams.w, -1.0, 0.0);    \n    vec3 surfaceColor = gammaCorrectInput(texture2D(texture_renderSurface, dSurfaceCoords).rgb);\n\n    ${this.normalsBlend?"\n    vec3 normals = texture2D(texture_normalsSurface, dSurfaceCoords).rgb * 2.0 - 1.0;\n":""}    \n\n    ${!0===this.surfaceBlend?`\n\n    float terrainDepth = texture2D(texture_depthSurface, dSurfaceCoords).r;\n    float terrainWorldY = renderPosY - terrainDepth * renderFarClip;\n\n    ${this.normalsBlend?"\n    float surfaceNormalsAlpha = saturate(smoothstep(terrainWorldY + surfaceNormalsBlendHeight * surfaceNoise, terrainWorldY, vPositionW.y));\n    dNormalW = mix(dNormalW, normals, surfaceNormalsAlpha * surfaceNormalsBlendPower * normals.y);  \n    ":""}    \n\n\tfloat surfaceAlpha = saturate(smoothstep(terrainWorldY + surfaceBlendHeight * surfaceNoise, terrainWorldY, vPositionW.y));\n    dAlbedo = mix(dAlbedo, surfaceColor, surfaceAlpha * surfaceBlendPower ${this.normalsBlend?"* normals.y":""});\n`:`\n    dAlbedo *= surfaceColor;\n\n    ${this.normalsBlend?"\n    dNormalW = normals;\n    ":""}\n`}\n`),this.noiseChannels.length>0&&(s+=this.getNoiseChunk(e));let i=e.chunks.diffusePS_uranusBase;i=i.replace("// INJECT uniforms",r),i=i.replace("// INJECT chunk",s),e.chunks.diffusePS=i,e.chunks.APIVersion=pc.CHUNKAPI_1_55,UranusUtilities.addUranusBaseUniforms(e),e.update();for(let t in this.uniqueAssets)e.setParameter(`texture_${t}`,this.uniqueAssets[t].resource);this.updateAttributes(e)},UranusEffectsMaterialSurfaceColor.prototype.getNoiseChunk=function(e){let t="",r=!1;return this.noiseChannels.forEach(((a,s)=>{const i=a.viewCamera?"cameraViewPosition":"uranus_view_position";a.appUpdate&&this.app.off("update",a.appUpdate);let n="";a.noiseSpeed>0&&(n=`+ vec2(surfaceNoiseTime${s})`,a.viewDistance>0&&!r&&a.viewCamera&&(a.calcViewPos=!0,r=!0),a.appUpdate=()=>{if(e.setParameter(`surfaceNoiseTime${s}`,pc.now()*a.noiseSpeed*.001),a.calcViewPos){const t=a.viewCamera.getPosition(),r=this.viewPos;r[0]=t.x,r[1]=t.y,r[2]=t.z,e.setParameter("cameraViewPosition",r)}},this.app.on("update",a.appUpdate)),t+=`\n    float surfaceColorNoise${s} = texture2D(\n        texture_${a.noiseTexture.id}, \n        vPositionW.xz * vec2(${a.noiseTiling.x.toFixed(7)}, ${a.noiseTiling.y.toFixed(7)})${n}\n    ).${a.noiseTextureChannel};\n\n    ${a.viewDistance>0?`\n    float surfaceDistanceNoise${s} = distance(${i}, vPositionW);\n    float surfaceDistanceFactor${s} = clamp( (surfaceDistanceNoise${s} - ${a.viewDistance.toFixed(2)}) / ${a.viewBorder.toFixed(2)}, 0.0, 1.0);\n\n    surfaceColorNoise${s} += surfaceDistanceFactor${s};\n`:""}\n\n    dAlbedo *= clamp(surfaceColorNoise${s}, ${a.noiseClamping.x.toFixed(2)}, ${a.noiseClamping.y.toFixed(2)});\n`})),t},UranusEffectsMaterialSurfaceColor.prototype.clearMaterial=function(e){e&&(delete e.chunks.diffusePS,e.update())},UranusEffectsMaterialSurfaceColor.prototype.updateAttributes=function(e){const t=this.renderSurface?.script?.uranusEffectsRenderSurface,r=this.app.assets.find("texture-white.jpg"),a=this.normalsSurface?.script?.uranusEffectsRenderSurface;if(a&&a.ready&&e.setParameter("texture_normalsSurface",a.renderTexture?a.renderTexture:r.resource),t&&t.ready){e.setParameter("texture_renderSurface",t.renderTexture?t.renderTexture:r.resource),e.setParameter("texture_depthSurface",t.depthTexture?t.depthTexture:r.resource);const a=t.surfaceBounding.halfExtents,s=t.entity.getPosition(),i=a.x,n=2*a.x,o=2*a.z,u=this.renderSurfaceParams;u[0]=i-s.x,u[1]=-(i+s.z),u[2]=n,u[3]=o,e.setParameter("renderSurfaceParams",u),e.setParameter("renderFarClip",2*a.y),e.setParameter("renderPosY",t.surfaceCameraPos.y),e.setParameter("surfaceBlendHeight",this.surfaceBlendHeight),e.setParameter("surfaceBlendPower",this.surfaceBlendPower),e.setParameter("surfaceNormalsBlendHeight",this.surfaceNormalsBlendHeight),e.setParameter("surfaceNormalsBlendPower",this.surfaceNormalsBlendPower)}else e.setParameter("texture_renderSurface",r.resource),e.setParameter("texture_depthSurface",r.resource),e.setParameter("texture_normalsSurface",r.resource)};var UranusEffectsNormalsOverride=pc.createScript("uranusEffectsNormalsOverride");UranusEffectsNormalsOverride.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsNormalsOverride.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0}),UranusEffectsNormalsOverride.attributes.add("normals",{type:"vec3",default:[0,1,0],title:"Normals",description:"Set the normals direction for each axis (-1 to 1)."}),UranusEffectsNormalsOverride.prototype.initialize=function(){this.materialAssets.forEach((e=>{e.ready((()=>this.updateMaterial(e.resource))),e.on("change",(()=>this.updateMaterial(e.resource)))})),UranusUtilities.loadAssets(this.materialAssets),this.on("attr",(function(){this.materialAssets.forEach((e=>this.updateAttributes(e.resource)))})),this.on("state",(function(e){e?this.materialAssets.forEach((e=>this.updateMaterial(e.resource))):this.materialAssets.forEach((e=>this.clearMaterial(e.resource)))}))},UranusEffectsNormalsOverride.prototype.updateMaterial=function(e){e.chunks.normalMapPS="\nuniform float material_bumpiness;\n\nuniform vec3 overrideNormals;\n\nvoid getNormal() {\n#ifdef MAPTEXTURE\n    vec3 normalMap = overrideNormals;\n    normalMap = mix(vec3(0.0, 0.0, 1.0), normalMap, material_bumpiness);\n    dNormalW = normalize(dTBN * addNormalDetail(normalMap));\n#else\n    dNormalW = overrideNormals;\n#endif\n}    \n    ",e.chunks.APIVersion=pc.CHUNKAPI_1_55,e.update(),this.updateAttributes(e)},UranusEffectsNormalsOverride.prototype.clearMaterial=function(e){e&&(delete e.chunks.normalMapPS,e.update())},UranusEffectsNormalsOverride.prototype.updateAttributes=function(e){e.setParameter("overrideNormals",this.normals.data)};var UranusEffectsSkybox=pc.createScript("uranusEffectsSkybox");UranusEffectsSkybox.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsSkybox.attributes.add("turbidity",{type:"number",default:2,title:"Turbidity"}),UranusEffectsSkybox.attributes.add("steepness",{type:"vec2",default:[.5,1.5],title:"Steepness"}),UranusEffectsSkybox.attributes.add("rayleigh",{type:"vec2",default:[2,1.5],title:"Rayleigh"}),UranusEffectsSkybox.attributes.add("mieCoefficient",{type:"number",default:.005,title:"MieCoefficient"}),UranusEffectsSkybox.attributes.add("mieDirectionalG",{type:"number",default:.8,title:"MieDirectionalG"}),UranusEffectsSkybox.attributes.add("sunEntity",{type:"entity",title:"Light Entity"}),UranusEffectsSkybox.attributes.add("sunColorTop",{type:"rgb",title:"Light Color Top"}),UranusEffectsSkybox.attributes.add("sunColorBottom",{type:"rgb",title:"Light Color Bottom"}),UranusEffectsSkybox.attributes.add("sunIntensityBounds",{type:"vec2",default:[.3,1],title:"Light Intensity",description:"Min/Max sun intensity"}),UranusEffectsSkybox.attributes.add("skyBlueIntensity",{type:"number",default:0,max:.99,title:"Sky Blue Intensity"}),UranusEffectsSkybox.attributes.add("skyContrast",{type:"number",default:0,min:0,title:"Sky Contrast"}),UranusEffectsSkybox.attributes.add("toneMappingExposure",{type:"number",default:.3,title:"Tonemapping Exposure"}),UranusEffectsSkybox.attributes.add("animateSpeed",{type:"number",default:0,title:"Animate speed"}),UranusEffectsSkybox.attributes.add("renderStars",{type:"boolean",default:!1,title:"Render Stars"}),UranusEffectsSkybox.attributes.add("starsScale",{type:"number",default:50,min:0,max:200,title:"Stars Scale",description:"Set the scale of the stars on the sky."}),UranusEffectsSkybox.attributes.add("starsBrightness",{type:"number",default:2.5,min:0,title:"Stars Brightness",description:"Set the brightness of the stars on the sky."}),UranusEffectsSkybox.attributes.add("renderSunDisk",{type:"boolean",default:!1,title:"Render Sun Disk"}),UranusEffectsSkybox.attributes.add("renderClouds",{type:"boolean",default:!0,title:"Render Clouds"}),UranusEffectsSkybox.attributes.add("cloudNoise",{type:"asset",assetType:"texture",title:"Cloud Noise",description:"Provide a grayscale noise texture to be used as the base for the cloud pattern."}),UranusEffectsSkybox.attributes.add("cloudSpeed",{type:"number",default:3,title:"Cloud Speed",description:"Set the cloud animation speed."}),UranusEffectsSkybox.attributes.add("cloudScale",{type:"number",default:2.5,min:0,title:"Cloud Scale",description:"Set the size of each individual cloud on the sky."}),UranusEffectsSkybox.attributes.add("cloudCoverage",{type:"number",default:.65,min:0,title:"Cloud Coverage",description:"Set the clouds sky coverage."}),UranusEffectsSkybox.attributes.add("cloudSoftness",{type:"number",default:.35,min:0,title:"Cloud Softness",description:"Set the clouds shape softness."}),UranusEffectsSkybox.attributes.add("cloudBrightness",{type:"number",default:1,min:0,title:"Cloud Brightness",description:"Set the brightness of the clouds on the sky."}),UranusEffectsSkybox.attributes.add("cloudOctaves",{type:"number",default:5,min:0,precision:0,title:"Cloud Octaves",description:"The number of iterations to run for rendering the cloud shape. More octaves result in better quality at the expense of performance."}),UranusEffectsSkybox.first=!1,UranusEffectsSkybox.prototype.initialize=function(){this.vec=new pc.Vec3,this.color=new pc.Color,this.vecData=[0,0,0],this.time=0,this.scope=this.app.graphicsDevice.scope,this.skyPivotEntity=this.entity.parent.findByName("Light Pivot"),this.skyPivotAngleX=this.skyPivotEntity.getLocalEulerAngles().x,this.compileShader(),this.on("attr",this.setAttributes),UranusEffectsSkybox.first||(UranusEffectsSkybox.first=!0,this.app.on("UranusEffectsSkybox:setTime",this.set24Time,this))},UranusEffectsSkybox.prototype.compileShader=async function(){this.material&&this.material.destroy(),this.meshInstance=this.entity.render.meshInstances[0],this.material=new pc.Material,this.material.blendType=pc.BLEND_NORMAL,this.material.update(),this.meshInstance.material=this.material;var t=this.app.graphicsDevice;const e={attributes:{vertex_position:pc.SEMANTIC_POSITION,vertex_texCoord0:pc.SEMANTIC_TEXCOORD0},vshader:this.getVertexShader(),fshader:this.getPixelShader()};if(this.shader=new pc.Shader(t,e),this.material.shader=this.shader,this.renderClouds){if(!this.cloudNoise.loaded){const t=this.app.assets.find("texture-white.jpg");this.material.setParameter("cloudNoise",t.resource),await UranusUtilities.loadAsset(this.cloudNoise)}this.material.setParameter("cloudNoise",this.cloudNoise.resource)}this.setAttributes()},UranusEffectsSkybox.prototype.update=function(t){this.updateLightPosition(),this.updateTimer(t),this.animateSky(t)},UranusEffectsSkybox.prototype.animateSky=function(t){if(this.sunEntity.getPosition().y>=0&&this.animateSpeed>0){const e=this.vec.copy(this.skyPivotEntity.getLocalEulerAngles());e.z+=this.animateSpeed*t,this.skyPivotEntity.setLocalEulerAngles(e)}},UranusEffectsSkybox.prototype.set24Time=function(t){this.skyPivotEntity.setLocalEulerAngles(this.skyPivotAngleX,0,15*(t+12))},UranusEffectsSkybox.prototype.get24Angle=function(){return(180+this.skyPivotEntity?.getLocalEulerAngles().z)/360*24},UranusEffectsSkybox.prototype.setAttributes=function(t){"renderStars"!==t&&"renderSunDisk"!==t&&"renderClouds"!==t&&"cloudNoise"!==t&&"cloudOctaves"!==t?(this.material.setParameter("uTime",this.time),this.material.setParameter("turbidity",this.turbidity),this.material.setParameter("mieCoefficient",this.mieCoefficient),this.material.setParameter("mieDirectionalG",this.mieDirectionalG),this.material.setParameter("toneMappingExposure",this.toneMappingExposure),this.material.setParameter("skyBlueIntensity",this.skyBlueIntensity),this.material.setParameter("skyContrast",this.skyContrast),this.renderStars&&(this.material.setParameter("starsScale",this.starsScale),this.material.setParameter("starsBrightness",this.starsBrightness)),this.renderClouds&&(this.material.setParameter("cloudSpeed",this.cloudSpeed),this.material.setParameter("cloudScale",this.cloudScale),this.material.setParameter("cloudCoverage",this.cloudCoverage),this.material.setParameter("cloudSoftness",this.cloudSoftness),this.material.setParameter("cloudBrightness",this.cloudBrightness))):this.compileShader()},UranusEffectsSkybox.prototype.updateLightPosition=function(){const t=this.sunEntity,e=this.material,n=t.getPosition();t.lookAt(pc.Vec3.ZERO),t.rotateLocal(90,0,0);const o=this.vecData;o[0]=n.x,o[1]=n.y,o[2]=n.z,e.setParameter("sunPosition",o);const s=n.y>=0,i=(1-t.forward.dot(pc.Vec3.UP))/.5,a=this.sunIntensityBounds,r=this.steepness,l=this.rayleigh;let c,u,f,d;if(s)c=a.x+(a.y-a.x)*i,u=this.color.lerp(this.sunColorBottom,this.sunColorTop,i),f=r.x+(r.y-r.x)*i,d=l.x+(l.y-l.x)*i,state=!0;else{const t=1-pc.math.clamp(300*i,0,1);c=a.x*t,u=this.sunColorBottom,f=r.x,d=l.x,state=t>0}t.enabled!==state&&pc.app.frame>1&&(t.enabled=state,this.entity.render.enabled=state),!1!==state&&(t.light.intensity=c,t.light.color=u,e.setParameter("steepness",f),e.setParameter("rayleigh",d))},UranusEffectsSkybox.prototype.updateTimer=function(t){this.time+=t;let e=this.time%2;e>1&&(e=1-(e-1)),this.material.setParameter("uTime",e),this.renderClouds&&this.material.setParameter("uCloudsTime",this.time)},UranusEffectsSkybox.prototype.getVertexShader=function(){return"\nattribute vec3 vertex_position;\nattribute vec2 vertex_texCoord0;\n\nuniform mat4 matrix_model;\nuniform mat4 matrix_viewProjection;\nuniform mat3 matrix_normal;\n\nuniform vec3 sunPosition;\nuniform float steepness;\nuniform float rayleigh;\nuniform float turbidity;\nuniform float mieCoefficient;\n\nvarying vec2 vUv0;\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nconst vec3 up = vec3(0.0, 1.0, 0.0);\n\n// constants for atmospheric scattering\nconst float e = 2.71828182845904523536028747135266249775724709369995957;\nconst float pi = 3.141592653589793238462643383279502884197169;\n\n// wavelength of used primaries, according to preetham\nconst vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n\n// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\nconst vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n// mie stuff\n// K coefficient for the primaries\nconst float v = 4.0;\nconst vec3 K = vec3( 0.686, 0.678, 0.666 );\n\n// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\nconst vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n// earth shadow hack\nconst float cutoffAngle = 1.6110731556870734;\nconst float EE = 1000.0;\n\nfloat sunIntensity( float zenithAngleCos ) {\n    zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n    return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n}\nvec3 totalMie( float T ) {\n    float c = ( 0.2 * T ) * 10E-18;\n    return 0.434 * c * MieConst;\n}\n\nvoid main(void)\n{\n    vUv0 = vertex_texCoord0;\n    vec4 worldPosition = matrix_model * vec4(vertex_position, 1.0);\n    vWorldPosition = worldPosition.xyz;\n    \n    gl_Position = matrix_viewProjection * worldPosition;\n    gl_Position.z = gl_Position.w; // set z to camera.far\n    \n    vSunDirection = normalize( sunPosition );\n    \n    vSunE = sunIntensity( dot( vSunDirection, up ) );\n    \n    vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 500000.0 ) ), 0.0, 1.0 );\n    \n    float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n    \n    // extinction (absorbtion + out scattering)\n    // rayleigh coefficients\n    vBetaR = totalRayleigh * rayleighCoefficient;\n    \n    // mie coefficients\n    vBetaM = totalMie( turbidity ) * mieCoefficient;    \n}    \n"},UranusEffectsSkybox.prototype.getPixelShader=function(){return`\nprecision ${this.app.graphicsDevice.precision} float;\n\n#define NUM_LAYERS 3.\n\nvarying vec2 vUv0;\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nuniform float uTime;\nuniform float mieDirectionalG;\nuniform float toneMappingExposure;\nuniform float skyBlueIntensity;\nuniform float skyContrast;\nuniform vec3 view_position;\n\nconst vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\nconst vec3 up = vec3(0.0, 1.0, 0.0);\nconst vec3 down = vec3(0.0, -1.0, 0.0);\n\n// constants for atmospheric scattering\nconst float pi = 3.141592653589793238462643383279502884197169;\n\nconst float n = 1.0003; // refractive index of air\nconst float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)\n\n// optical length at zenith for molecules\nconst float rayleighZenithLength = 8.4E3;\nconst float mieZenithLength = 1.25E3;\n\n// 66 arc seconds -> degrees, and the cosine of that\nconst float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n// 3.0 / ( 16.0 * pi )\nconst float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n\n// 1.0 / ( 4.0 * pi )\nconst float ONE_OVER_FOURPI = 0.07957747154594767;\n\nfloat rayleighPhase( float cosTheta ) {\n    return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n}\n\nfloat hgPhase( float cosTheta, float g ) {\n    float g2 = pow( g, 2.0 );\n    float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n    return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n}\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\n\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\t// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ), // transposed from source\n\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\t// ODT_SAT => XYZ => D60_2_D65 => sRGB\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ), // transposed from source\n\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\t// Apply RRT and ODT\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\t// Clamp to [0, 1]\n\treturn clamp( color, 0.0, 1.0 );\n}\n\n${this.renderStars?"\n/* ------------------------------- STARS METHODS ------------------------------- */\nuniform float starsScale;\nuniform float starsBrightness;\n\nfloat rand(vec2 p) {\n    return fract(sin(p.x * 317. + p.y * 137.) * 132.);\n}\n\nfloat star(vec2 uv) {\n\tfloat d = length(uv);\n    float m = .1/d;\n    \n    return m * 5.;\n}\n\nvec3 starLayer(vec2 uv) {\n\tfloat T = uTime * 1.8;\n    vec2 gv = fract(uv)-.5;\n    vec2 id = floor(uv);\n    \n   \tvec3 col = vec3(0.);\n\n    for (float y = -1.; y <= 1.; ++y) {\n        for (float x = -1.; x <= 1.; ++x) {\n            vec2 offs = vec2(x, y);\n            float r = rand(id + offs);\n            float size = max(0.2, fract(r * 127.)) * 0.05;\n            float blink = sin(x * y + T * r) * 0.2 + 0.2;\n            col += blink * size * star(gv - offs - vec2(r, fract(r * 275.)) + .5);\n        }\n    }\n    \n    return col;\n}\n\n/* --------------------------------------------------------------------------- */\n":""}\n\n\n${this.renderClouds?`\n/* ------------------------------- CLOUDS METHODS ------------------------------- */\nuniform float uCloudsTime;\n\nuniform sampler2D cloudNoise;\nuniform float cloudSpeed;\nuniform float cloudScale;\nuniform float cloudCoverage;\nuniform float cloudSoftness;\nuniform float cloudBrightness;\n\nconst int cloudOctaves = ${Math.trunc(this.cloudOctaves).toString()};\nconst float curlStrain = 3.0;\n\nfloat saturate(float num)\n{\n    return clamp(num,0.0,1.0);\n}\n\nfloat noise(vec2 uv)\n{\n    return texture2D(cloudNoise,uv).r;\n}\n\nvec2 rotate(vec2 uv)\n{\n    uv = uv + noise(uv*0.2)*0.005;\n    float rot = curlStrain;\n    float sinRot=sin(rot);\n    float cosRot=cos(rot);\n    mat2 rotMat = mat2(cosRot,-sinRot,sinRot,cosRot);\n    return uv * rotMat;\n}\nfloat fbm (vec2 uv)\n{\n    float rot = 1.57;\n    float sinRot=sin(rot);\n    float cosRot=cos(rot);\n    float f = 0.0;\n    float total = 0.0;\n    float mul = 0.5;\n    mat2 rotMat = mat2(cosRot,-sinRot,sinRot,cosRot);\n    \n    for(int i = 0;i < cloudOctaves;i++)\n    {\n        f += noise(uv+uCloudsTime*0.00015*cloudSpeed*(1.0-mul))*mul;\n        total += mul;\n        uv *= 3.0;\n        uv=rotate(uv);\n        mul *= 0.5;\n    }\n    return f/total;\n}\n`:""}\n\nvoid main(void)\n{\n    vec3 direction = normalize( vWorldPosition - cameraPos );\n    \n    // optical length\n    // cutoff angle at 90 to avoid singularity in next formula.\n    float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );\n    float inverse = (1.0 - skyBlueIntensity) / ( cos( zenithAngle ) + 0.5 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n    float sR = rayleighZenithLength * inverse;\n    float sM = mieZenithLength * inverse;\n    \n    // combined extinction factor\n    vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n    \n    // in scattering\n    float cosTheta = dot( direction, vSunDirection );\n    float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n    vec3 betaRTheta = vBetaR * rPhase;\n    float mPhase = hgPhase( cosTheta, mieDirectionalG );\n    vec3 betaMTheta = vBetaM * mPhase;\n    vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n    Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n    \n    // nightsky\n    vec3 L0 = vec3( 0.1 ) * Fex;\n\n    // --- get the view direction from world up to calculate the horizon angle\n    vec3 viewDirection = normalize(view_position - vWorldPosition);\n    float horizonCosAngle = dot(viewDirection, down);    \n    float horizonCutoff = step(0.0, vWorldPosition.y);\n\n    ${this.renderClouds?"\n    vec2 cloudsUV = vUv0 * cloudScale;\n    float cover = cloudCoverage * 1.1+0.1;    \n    float bright = cloudBrightness * (1.8 - cover);\n    \n    float color1 = fbm(cloudsUV-0.5+uCloudsTime*0.00004 * cloudSpeed);\n    float color2 = fbm(cloudsUV-10.5+uCloudsTime*0.00002 * cloudSpeed);\n    \n    float clouds1 = smoothstep(1.0-cover,min((1.0-cover) + cloudSoftness *2.0, 1.0),color1);\n    float clouds2 = smoothstep(1.0-cover,min((1.0-cover) + cloudSoftness, 1.0),color2);\n\n    float cloudsFormComb = saturate(clouds1+clouds2);\n\n    // --- fade out any clouds/stars below the horizon\n    float horizonCloudsFade = 1.0 - exp(-pow(horizonCosAngle / 0.2, 2.0));\n    cloudsFormComb *= horizonCloudsFade * horizonCutoff;\n\n    float sunDiskCloudFade = saturate(1.5 - 1.5 * saturate(clouds1+clouds2));\n    ":"\n    float sunDiskCloudFade = 1.0;\n    "}    \n    \n    ${this.renderSunDisk?"\n    float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );    \n    L0 += ( vSunE * 19000.0 * Fex ) * sundisk * sunDiskCloudFade;\n    ":""}\n\n    vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n    vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n    vec3 finalColor = retColor;\n\n    ${this.renderStars?"\n\tvec2 uv = vUv0 * starsScale;\n    vec3 starColor = vec3(0.);\n\n    float i = 0.1;\n    float depth = fract(0.1);\n    float scale = mix(2., 1., depth);\n    float fade = depth * smoothstep(1., .9, depth);\n    starColor += fade * starLayer(uv * scale + 323. * i) * starsBrightness;\n\n    float horizonStarFade = 1.0 - exp(-pow(horizonCosAngle / 0.25, 2.0));\n    starColor *= horizonStarFade * horizonCutoff;\n":""}\n\n    ${this.renderClouds?`\n    float cloudCol = saturate(saturate(1.0-pow(color1,1.0)*0.2));\n    vec3 clouds1Color = vec3(cloudCol);\n    vec3 clouds2Color = mix(clouds1Color, finalColor, 0.5);\n    vec3 cloudColComb = mix(clouds1Color, clouds2Color, cloudsFormComb);\n    cloudColComb = mix(cloudColComb, finalColor, 0.2);\n\n    // Add sunlight to the clouds\n    float sunlightInfluence = smoothstep(-1.0, 1.0, cosTheta);\n    cloudColComb = (cloudColComb + sunlightInfluence * ( vSunE * Fex * 0.01 )) * bright;\n\n    finalColor = mix(finalColor, cloudColComb, cloudsFormComb); \n\n    ${this.renderStars?"\n    finalColor += mix(starColor, vec3(0.0), cloudsFormComb);\n    ":""}\n`:`\n    ${this.renderStars?"\n    finalColor += starColor;\n    ":""}\n`}\n\n    finalColor = ACESFilmicToneMapping(finalColor);\n\n    // sky contrast\n    finalColor.rgb = (finalColor.rgb - 0.5) * (1.0 + skyContrast) + 0.5;\n\n    gl_FragColor = vec4( finalColor, retColor.b);\n}\n`};var UranusEffectsShadowsTimer=pc.createScript("uranusEffectsShadowsTimer");UranusEffectsShadowsTimer.bypassTimer=!1,UranusEffectsShadowsTimer.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsShadowsTimer.attributes.add("dirLights",{type:"boolean",default:!0,title:"Dir Lights",description:"If selected directional lights will be handled. Requires application restart"}),UranusEffectsShadowsTimer.attributes.add("staticTimes",{type:"vec4",default:[.01,.05,.25,.5],title:"Static Times",description:"Set the minimum shadow update time for each shadow cascade while the camera is stationary. Works only for PCF3 and PCF5 shadow casters."}),UranusEffectsShadowsTimer.attributes.add("movingTimes",{type:"vec4",default:[0,.02,.1,.15],title:"Moving Times",description:"Set the minimum shadow update time for each shadow cascade while the camera is moving. Works only for PCF3 and PCF5 shadow casters."}),UranusEffectsShadowsTimer.attributes.add("localLights",{type:"boolean",default:!0,title:"Local Lights",description:"If selected local lights, omni and spot, will be handled too. Requires application restart."}),UranusEffectsShadowsTimer.attributes.add("baseTime",{type:"number",default:.1,title:"Local Time",description:"Set the minimum shadow update time for all omni and spot lights casting shadows."}),UranusEffectsShadowsTimer.attributes.add("cullByShadowDistance",{type:"boolean",default:!1,title:"Cull By Shadow Distance",description:"If selected point and spot lights will cull their shadows based from the light distance from the active camera."}),UranusEffectsShadowsTimer.attributes.add("activeCameras",{type:"entity",array:!0,title:"Active Cameras",description:"A list of cameras to be used for culling by shadow distance."}),UranusEffectsShadowsTimer.timer={enabled:!1,cameraHasMoved:!1,cameraLastPos:new pc.Vec3,cameraLastRot:new pc.Vec3,shadowsUpdateTimes:[0],shadowsUpdateDurations:[1/0],shadowsUpdate:[!1],cullByShadowDistance:!1},UranusEffectsShadowsTimer.prototype.initialize=function(){this.shadowsUpdateTimes=[1/0,1/0,1/0,1/0],UranusEffectsShadowsTimer.timer.enabled=this.localLights,this.overrideEngine(),this.app.on("postrender",(function(){UranusEffectsShadowsTimer.timer.shadowsUpdate[0]=!1}),this)},UranusEffectsShadowsTimer.prototype.getActiveCamera=function(){let e;if(this.activeCameras.length>0)this.activeCameras.forEach((s=>{s.enabled&&(e=s)}));else{const s=this.app.scene.layers.cameras,t=s[s.length-1];if(!t)return;e=t.entity}return e},UranusEffectsShadowsTimer.prototype.update=function(e){const s=this.getActiveCamera();this.dirLights&&this.updateDirLights(e),this.localLights&&this.updateLocalLights(e,s)},UranusEffectsShadowsTimer.prototype.updateDirLights=function(e){const s=this.shadowsUpdateTimes,t=this.staticTimes,a=this.movingTimes,r=this.app.scene.layers.cameras;for(let i=0;i<r.length;i++){const o=r[i],d=o.camera,n=o.node,c=n.getPosition(),h=n.getEulerAngles();d.uranusEffectsShadowsTimer||(d.uranusEffectsShadowsTimer={cameraHasMoved:!1,cameraLastPos:new pc.Vec3,cameraLastRot:new pc.Vec3,shadowsUpdateTimes:[1/0,1/0,1/0,1/0],shadowsUpdateDurations:[1/0,1/0,1/0,1/0],shadowsUpdate:[!1,!1,!1,!1]});const l=d.uranusEffectsShadowsTimer,p=l.cameraLastPos,u=l.cameraLastRot,f=p.distance(c)>.1||u.distance(h)>.1;l.cameraHasMoved=f,p.copy(c),u.copy(h),s[0]=f?a.x:t.x,s[1]=f?a.y:t.y,s[2]=f?a.z:t.z,s[3]=f?a.w:t.w;const m=l.shadowsUpdateDurations,w=l.shadowsUpdate;for(let t=0;t<4;t++){m[t]+=e;const a=m[t]>=s[t];w[t]=a,a&&(m[t]=0)}}},UranusEffectsShadowsTimer.prototype.updateLocalLights=function(e,s){const t=UranusEffectsShadowsTimer.timer;t.shadowsUpdateTimes[0]=this.baseTime,t.shadowsUpdateDurations[0]+=e;const a=t.shadowsUpdateDurations[0]>=t.shadowsUpdateTimes[0];t.shadowsUpdate[0]=a,a&&(s&&t.cameraLastPos.copy(s.getPosition()),t.cullByShadowDistance=this.cullByShadowDistance,t.shadowsUpdateDurations[0]=0)},UranusEffectsShadowsTimer.prototype.overrideEngine=function(){const e=this.app.renderer,s=this.app.renderer._shadowRendererDirectional,t=new Set;e.cullShadowmaps=function(e){const s=UranusEffectsShadowsTimer.timer;if(!UranusEffectsShadowsTimer.bypassTimer&&s&&s.shadowsUpdate[0]){const t=this.scene.clusteredLightingEnabled;for(let a=0;a<this.localLights.length;a++){const r=this.localLights[a];if(r._type!==pc.LIGHTTYPE_DIRECTIONAL){if(s.cullByShadowDistance&&(void 0===r.castShadowsUser||!0===r.castShadowsUser)){const e=r._position.distance(s.cameraLastPos)<=r.shadowDistance;r.castShadows!==e&&(r.castShadows=e)}t?r.atlasSlotUpdated&&r.shadowUpdateMode===pc.SHADOWUPDATE_NONE&&(r.shadowUpdateMode=pc.SHADOWUPDATE_THISFRAME):r.shadowUpdateMode===pc.SHADOWUPDATE_NONE&&r.castShadows&&(r.getRenderData(null,0).shadowCamera.renderTarget||(r.shadowUpdateMode=pc.SHADOWUPDATE_THISFRAME)),r.visibleThisFrame&&r.castShadows&&r.shadowUpdateMode!==SHADOWUPDATE_NONE&&this._shadowRendererLocal.cull(r,e)}}}const a=e._renderActions;for(let s=0;s<a.length;s++){const r=a[s];r.directionalLights.length=0;const i=r.camera.camera;if(r.firstCameraUse){const s=i.layers;for(let a=0;a<s.length;a++){const o=e.getLayerById(s[a]);if(o){const s=o.splitLights[pc.LIGHTTYPE_DIRECTIONAL];for(let a=0;a<s.length;a++){const o=s[a];o.castShadows&&!t.has(o)&&(t.add(o),r.directionalLights.push(o),this._shadowRendererDirectional.cull(o,e,i))}}}t.clear()}}}.bind(e),e.updateShaders=function(e,s){const a=e.length;for(let r=0;r<a;r++){const a=e[r].material;if(a&&!t.has(a)&&(t.add(a),a.getShaderVariant!==pc.Material.prototype.getShaderVariant)){if(s&&(!a.useLighting||a.emitter&&!a.emitter.lighting))continue;a.clearVariants()}}t.clear()}.bind(e),this.dirLights&&(s.addLightRenderPasses=function(e,s,t){const a=s.numShadowFaces,r=s.shadowUpdateOverrides;let i,o=!0;const d=t.uranusEffectsShadowsTimer,n=!0===t.node.uranusReflectionsCamera;if(n)return;for(let e=0;e<a;e++)UranusEffectsShadowsTimer.bypassTimer||n||!d||d.shadowsUpdate[e]||(o=!1),r?.[e]===pc.SHADOWUPDATE_NONE&&(o=!1),i=this.shadowRenderer.prepareFace(s,t,e);const c=new RenderPass(this.device,(()=>{for(let e=0;e<a;e++)(UranusEffectsShadowsTimer.bypassTimer||!d||d.shadowsUpdate[e])&&(r?.[e]!==pc.SHADOWUPDATE_NONE&&this.shadowRenderer.renderFace(s,t,e,!o),r?.[e]===pc.SHADOWUPDATE_THISFRAME&&(r[e]=pc.SHADOWUPDATE_NONE))}));c._after=()=>{this.shadowRenderer.renderVsm(s,t)},this.shadowRenderer.setupRenderPass(c,i,o),e.addRenderPass(c)}.bind(s)),this.localLights&&(e.buildFrameGraph=function(e,s){const t=this.scene.clusteredLightingEnabled,a=this.device.isWebGL1;if(e.reset(),this.update(s),t){if(this.scene.lighting.cookiesEnabled){const s=this.cookiesRenderPass;s.update(this.lights),e.addRenderPass(s)}{const t=UranusEffectsShadowsTimer.timer;if(!(!UranusEffectsShadowsTimer.bypassTimer&&t&&!t.shadowsUpdate[0])){const t=new RenderPass(this.device);t.requiresCubemaps=!1,e.addRenderPass(t),this.scene.lighting.shadowsEnabled&&this._shadowRendererLocal.prepareClusteredRenderPass(t,this.localLights),t._after=()=>{this.updateClusters(s)}}}}else this._shadowRendererLocal.buildNonClusteredRenderPasses(e,this.localLights);let r=0,i=!0,o=null;const d=s._renderActions;for(let t=r;t<d.length;t++){const n=d[t],c=s.layerList[n.layerIndex],h=n.camera,l=h.camera.renderPassDepthGrab;if(l&&a&&n.firstCameraUse&&(l.update(this.scene),e.addRenderPass(l)),!n.isLayerEnabled(s))continue;const p=c.id===pc.LAYERID_DEPTH;if(a&&p&&!h.renderSceneColorMap)continue;const u=p&&(h.renderSceneColorMap||h.renderSceneDepthMap);n.hasDirectionalShadowLights&&h&&this._shadowRendererDirectional.buildFrameGraph(e,n.directionalLights,h),i&&(i=!1,r=t,o=n.renderTarget);let f=t+1;for(;d[f]&&!d[f].isLayerEnabled(s);)f++;const m=d[f],w=!!m&&s.layerList[m.layerIndex].id===LAYERID_DEPTH&&(h.renderSceneColorMap||h.renderSceneDepthMap)&&!a;if(!m||m.renderTarget!==o||m.hasDirectionalShadowLights||w||u){if(p&&r===t||this.addMainRenderPass(e,s,o,r,t),p&&(h.renderSceneColorMap&&e.addRenderPass(h.camera.renderPassColorGrab),h.renderSceneDepthMap&&!a&&e.addRenderPass(h.camera.renderPassDepthGrab)),n.triggerPostprocess&&h?.onPostprocessing){const s=new RenderPass(this.device,(()=>{this.renderPassPostprocessing(n)}));s.requiresCubemaps=!1,e.addRenderPass(s)}i=!0}}}.bind(e))};class ColorAttachmentOps{clearValue=new pc.Color(0,0,0,1);clear=!1;store=!1;resolve=!0;mipmaps=!1}class DepthStencilAttachmentOps{clearDepthValue=1;clearStencilValue=0;clearDepth=!1;clearStencil=!1;storeDepth=!1;storeStencil=!1}class RenderPass{name;renderTarget;samples=0;colorArrayOps=[];get colorOps(){return this.colorArrayOps[0]}depthStencilOps;requiresCubemaps=!0;fullSizeClearRect=!0;execute;executeEnabled=!0;_before;_after;constructor(e,s){this.device=e,this._execute=s}init(e=null){this.renderTarget=e,this.samples=Math.max(this.renderTarget?this.renderTarget.samples:this.device.samples,1),this.depthStencilOps=new DepthStencilAttachmentOps;const s=e?e._colorBuffers?.length:1;for(let e=0;e<s;e++){const s=new ColorAttachmentOps;this.colorArrayOps[e]=s,1===this.samples&&(s.store=!0,s.resolve=!1),this.renderTarget?._colorBuffers?.[e].mipmaps&&(s.mipmaps=!0)}}before(){this._before?.()}after(){this._after?.()}setClearColor(e){const s=this.colorArrayOps.length;for(let t=0;t<s;t++){const s=this.colorArrayOps[t];s.clearValue.copy(e),s.clear=!0}}setClearDepth(e){this.depthStencilOps.clearDepthValue=e,this.depthStencilOps.clearDepth=!0}setClearStencil(e){this.depthStencilOps.clearStencilValue=e,this.depthStencilOps.clearStencil=!0}render(){const e=this.device,s=void 0!==this.renderTarget;this.before(),this.executeEnabled&&(s&&e.startPass(this),this._execute?.(),s&&e.endPass(this)),this.after(),e.renderPassIndex++}}var UranusEffectsSkyboxAnimate=pc.createScript("uranusEffectsSkyboxAnimate");UranusEffectsSkyboxAnimate.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsSkyboxAnimate.attributes.add("skyboxTime",{type:"number",default:12,min:0,max:23.59,title:"Skybox Time",description:"Set the target skybox time that will be set on entity initialize."}),UranusEffectsSkyboxAnimate.attributes.add("transitionSpeed",{type:"number",default:1,min:0,title:"Transition Speed",description:"Set the animation speed when changing the skybox time. Set to 0 for instantaneous updates"}),UranusEffectsSkyboxAnimate.attributes.add("pauseSkyboxCubemap",{type:"boolean",default:!1,title:"Pause Skybox Cubemap",description:"If selected and the skybox is rendering a real time cubemap, it will pause when the animation is not playing."}),UranusEffectsSkyboxAnimate.prototype.postInitialize=function(){this.skySystemEntity=this.app.root.findByName("Uranus Sky System"),this.skyboxEntity=this.skySystemEntity.findOne((t=>t.script.uranusEffectsSkybox)),this.uranusEffectsSkybox=this.skyboxEntity.script.uranusEffectsSkybox,this.uranusEffectsSkyboxCubemap=this.skySystemEntity.script?.uranusEffectsSkyboxCubemap,this.currentTime=this.uranusEffectsSkybox.get24Angle(),this.lastHour=this.getRoundTime()-1,this.on("attr:skyboxTime",this.setTime),this.on("state",(function(t){t&&this.setTime(this.targetTime)})),this.app.on("uranusEffectsSkyboxAnimate:setTime",this.setTime,this)},UranusEffectsSkyboxAnimate.prototype.setTime=function(t){void 0!==t&&(this.targetTime=t),this.app.fire("uranusEffectsSkyboxAnimate:onSetTime",this.targetTime)},UranusEffectsSkyboxAnimate.prototype.getRoundTime=function(){return Math.floor(2*this.uranusEffectsSkybox.get24Angle())/2},UranusEffectsSkyboxAnimate.prototype.update=function(t){if(t>.1)return;const e=this.getRoundTime();e!==this.lastHour&&(this.setTime(e),this.lastHour=e);const i=Math.abs(this.currentTime-this.targetTime)>=.01;i&&(this.transitionSpeed>0?this.currentTime=pc.math.lerp(this.currentTime,this.targetTime,this.transitionSpeed*t):this.currentTime=this.targetTime),this.pauseSkyboxCubemap?this.uranusEffectsSkyboxCubemap.pauseRendering=!i:this.uranusEffectsSkyboxCubemap.pauseRendering=!1};var UranusEffectsWater=pc.createScript("uranusEffectsWater");UranusEffectsWater.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsWater.attributes.add("materialAsset",{type:"asset",assetType:"material"}),UranusEffectsWater.attributes.add("activeCameras",{type:"entity",array:!0,title:"Active Cameras",description:"A list of cameras that render the water model, used to enable depth access to these cameras."}),UranusEffectsWater.attributes.add("infiniteSurface",{type:"boolean",default:!0,title:"Infinite Surface",description:"If selected the water surface will follow the active camera to give the illusion of an infinite water surface. Useful for sea and ocean effects."}),UranusEffectsWater.attributes.add("waterScale",{type:"number",default:50,min:0,title:"Water Scale",description:"The scale of the water surface (texture tiling)."}),UranusEffectsWater.attributes.add("depthOpacity",{type:"number",default:.05,min:0,max:1,title:"Depth Opacity",description:"Sets the amount of opacity the water will have as it gets deeper."}),UranusEffectsWater.attributes.add("refractionOpacity",{type:"number",default:.05,min:0,max:1,precision:3,title:"Refraction Opacity",description:"Sets the amount of opacity the refraction effect will have as it gets deeper."}),UranusEffectsWater.attributes.add("causticsMapAsset",{type:"asset",assetType:"texture",title:"Caustics Map",description:"The caustics map used to simulate the water caustics effects."}),UranusEffectsWater.attributes.add("causticsOpacity",{type:"number",default:.2,min:0,max:1,title:"Caustics Opacity",description:"Sets the amount of caustics effects the water will have as it gets deeper."}),UranusEffectsWater.attributes.add("causticsIntensity",{type:"number",default:10,min:0,title:"Caustics Intensity",description:"Sets the intensity of the caustics effect."}),UranusEffectsWater.attributes.add("causticsTiling",{type:"number",default:250,min:0,title:"Caustics Tiling",description:"Sets the tiling of the caustics effect."}),UranusEffectsWater.attributes.add("shoreOpacity",{type:"number",default:.5,min:0,title:"Shore Opacity",description:"Sets the amount of shore effects the water will have as it gets deeper."}),UranusEffectsWater.attributes.add("shoreIntensity",{type:"number",default:10,min:0,title:"Shore Intensity",description:"Sets the intensity of the shore effect."}),UranusEffectsWater.attributes.add("shoreTiling",{type:"number",default:250,min:0,title:"Shore Tiling",description:"Sets the tiling of the shore effect."}),UranusEffectsWater.attributes.add("shoreFrequency",{type:"number",default:.1,min:0,title:"Shore Frequency",description:"Sets the animation speed of shore effects on the water."}),UranusEffectsWater.attributes.add("flowMapAsset",{type:"asset",assetType:"texture",title:"Flow Map",description:"The flow map used to simulate the water flow effects."}),UranusEffectsWater.attributes.add("flowFrequency",{type:"number",default:.5,min:0,title:"Flow Frequency",description:"Sets the animation speed of flow effects on the water."}),UranusEffectsWater.attributes.add("reflectionsIntensity",{type:"number",default:1,min:0,title:"Reflections Intensity",description:"Sets the intensity of the reflections map."}),UranusEffectsWater.attributes.add("refractionIntensity",{type:"number",default:1,min:0,title:"Refraction Intensity",description:"Sets the intensity of the refraction map."}),UranusEffectsWater.attributes.add("reflectionsBumpiness",{type:"number",default:1,min:0,precision:3,title:"Reflections Bumpiness",description:"Sets the intensity of the reflections bumpiness."}),UranusEffectsWater.attributes.add("refractionBumpiness",{type:"number",default:1,min:0,precision:3,title:"Refraction Bumpiness",description:"Sets the intensity of the refraction bumpiness."}),UranusEffectsWater.attributes.add("specularColor",{type:"rgb",default:[.98,.97,.7],title:"Specular Color",description:"Sets the color of the specular highlights."}),UranusEffectsWater.attributes.add("specularIntensity",{type:"number",default:1e3,min:0,title:"Specular Intensity",description:"Sets the intensity of the specular highlights."}),UranusEffectsWater.attributes.add("specularBlinking",{type:"number",default:.1,min:0,title:"Specular Blinking",description:"If a value > 0 is provided the specular highlights will blink based on that frequency."}),UranusEffectsWater.attributes.add("underwaterFogDensity",{type:"number",default:0,min:0,title:"Underwater Fog Density",description:"Sets the intensity of the scene fog when the active camera is under the water surface. Set to 0.0 to disable this check."}),UranusEffectsWater.attributes.add("vertexWaves",{type:"boolean",default:!1,title:"Vertex Waves",description:"If selected the vertices of the water surface will animate to simulate waves. Requires a water plane with enough triangles per unit. Requires application reload."}),UranusEffectsWater.attributes.add("wavesFrequency",{type:"number",default:.2,min:0,title:"Waves Frequency",description:"The frequency of the sin/cos of the vertex waves."}),UranusEffectsWater.attributes.add("wavesAmplitude",{type:"number",default:3,min:0,title:"Waves Amplitude",description:"The amplitude of the sin/cos of the vertex waves."}),UranusEffectsWater.attributes.add("wavesDepthMinMax",{type:"vec2",default:[.05,.5],title:"Waves Depth Min Max",description:"The min/max values to clamp the minimum and maximum wave height based on the water depth."}),UranusEffectsWater.attributes.add("renderSurface",{type:"entity",title:"Render Surface",description:"If a uranusEffectsRenderSurface entity is referenced the material will use the depth from the surface to improve the look of several effects."}),UranusEffectsWater.prototype.initialize=function(){this.vec=new pc.Vec3,this.time=0,this.normalMapUniform0=[0,0,0],this.normalMapUniform1=[0,0,0],this.waterInitialPos=this.entity.getPosition().clone(),this.renderSurfaceParams=[0,0,0,0],this.hasSurfaceDepth=!1,this.prepare(),this.on("attr",(function(e,t){"specularBlinking"!==e?this.updateAttributes():this.updateMaterial()})),this.on("state",(function(e){e?this.updateMaterial():this.clearMaterial()}));const e=this.entity.script.uranusEffectsPlanarReflections;e&&e.on("attr",this.updateMaterial.bind(this))},UranusEffectsWater.prototype.prepare=async function(){const e=this.renderSurface?.script?.uranusEffectsRenderSurface;e&&(this.hasSurfaceDepth=!0,e.on("uranusEffectsRenderSurface:_ready",(function(){this.updateAttributes()}),this)),await UranusUtilities.loadAssets([this.materialAsset,this.causticsMapAsset,this.flowMapAsset]),this.materialAsset.ready(this.onMaterialReady.bind(this)),this.materialAsset.on("change",this.onMaterialReady.bind(this))},UranusEffectsWater.prototype.update=function(e){this.time+=e;const t=this.material;if(t){t.setParameter("waterUpdateTime",this.time);const n=t.normalMapTiling,r=this.normalMapUniform0;r[0]=n.x,r[1]=0,r[2]+=e*(.02+.05*Math.sin(this.time)),t.setParameter("texture_normalMapTransform0",r);const a=this.normalMapUniform1;a[0]=0,a[1]=n.y,a[2]+=e*(.02+.05*Math.sin(this.time)),t.setParameter("texture_normalMapTransform1",a)}if(this.activeCameras){let e;if(this.activeCameras.forEach((t=>{t.enabled&&(e=t)})),!e)return;const t=e.getPosition();if(this.underwaterFogDensity>0){this.app.scene.fogDensityDefault||(this.app.scene.fogDensityDefault=this.app.scene.fogDensity);const e=t.y<this.entity.getPosition().y;this.app.scene.fogDensity=e?this.underwaterFogDensity:this.app.scene.fogDensityDefault}if(this.infiniteSurface){const e=this.vec.copy(t);e.y=this.waterInitialPos.y,this.entity.setPosition(e)}}},UranusEffectsWater.prototype.updateAttributes=function(){const e=this.material;if(!e)return;e.setParameter("wavesFrequency",this.wavesFrequency),e.setParameter("wavesAmplitude",this.wavesAmplitude),e.setParameter("wavesDepthMinMax",this.wavesDepthMinMax.data),e.setParameter("waterScale",this.waterScale),e.setParameter("depthOpacity",this.depthOpacity),e.setParameter("refractionOpacity",this.refractionOpacity),e.setParameter("causticsOpacity",this.causticsOpacity),e.setParameter("shoreOpacity",this.shoreOpacity),e.setParameter("causticsIntensity",this.causticsIntensity),e.setParameter("causticsTiling",this.causticsTiling),e.setParameter("shoreIntensity",this.shoreIntensity),e.setParameter("shoreTiling",this.shoreTiling),e.setParameter("shoreFrequency",this.shoreFrequency),e.setParameter("texture_causticsMapAsset",this.causticsMapAsset.resource),e.setParameter("texture_flowMap",this.flowMapAsset.resource),e.setParameter("flowFrequency",this.flowFrequency),e.setParameter("reflectionsIntensity",this.reflectionsIntensity),e.setParameter("refractionIntensity",this.refractionIntensity),e.setParameter("reflectionsBumpiness",this.reflectionsBumpiness),e.setParameter("refractionBumpiness",this.refractionBumpiness),e.setParameter("specularColor",this.specularColor.data3),e.setParameter("specularIntensity",this.specularIntensity);const t=this.renderSurface?.script?.uranusEffectsRenderSurface;if(t)if(t.ready){this.entity.render.enabled=!0;const n=t.surfaceBounding.halfExtents,r=t.entity.getPosition(),a=n.x,i=2*n.x,s=2*n.z,o=this.renderSurfaceParams;o[0]=a-r.x,o[1]=-(a+r.z),o[2]=i,o[3]=s,e.setParameter("texture_depthSurface",t.depthTexture),e.setParameter("renderSurfaceParams",o),e.setParameter("renderFarClip",2*n.y),e.setParameter("renderPosY",t.surfaceCameraPos.y)}else this.entity.render.enabled=!1},UranusEffectsWater.prototype.onMaterialReady=function(){this.updateMaterial()},UranusEffectsWater.prototype.updateMaterial=function(){this.material=this.materialAsset.resource;const e=this.material,t=this.entity.script.uranusEffectsPlanarReflections;e.chunks.startVS=this.getStartVS(),this.vertexWaves&&(e.chunks.transformVS=this.getTransformVS(),e.chunks.normalVS=this.getNormalVS()),e.chunks.opacityPS=this.getOpacity(),e.chunks.normalMapPS=this.getNormalMap(),e.chunks.diffusePS=this.getDiffuse(t),e.chunks.lightSpecularBlinnPS=this.getLightSpecular(),e.chunks.combinePS=this.getCombineColor(),this.material.update(),this.updateAttributes()},UranusEffectsWater.prototype.clearMaterial=function(){this.material&&(delete this.material.chunks.startVS,delete this.material.chunks.transformVS,delete this.material.chunks.normalVS,delete this.material.chunks.opacityPS,delete this.material.chunks.diffusePS,delete this.material.chunks.normalMapPS,delete this.material.chunks.lightSpecularBlinnPS,delete this.material.chunks.combinePS,this.material.update())},UranusEffectsWater.prototype.getDiffuse=function(e){const t=e&&!0===e.enabled,n=e.renderReflection,r=e.renderRefraction;let a="";return t&&(n&&(a+="uniform sampler2D texture_planarReflectionMap;\n"),r&&(a+="uniform sampler2D texture_planarRefractionMap;\n")),`\n#ifdef MAPCOLOR\nuniform vec3 material_diffuse;\n#endif\n\n#ifdef MAPTEXTURE\nuniform sampler2D texture_diffuseMap;\n#endif\n\n${a}\nuniform mat3 matrix_view3;\n\nvec2 getReflectionCoords(float bumpiness, vec3 viewDirS) {\n\n    vec2 reflCoords = gl_FragCoord.xy * uScreenSize.zw;\n    //reflCoords.xy -= viewDirS.xy * (-0.086 * material_bumpiness);\n\n    vec2 dx = dFdx(reflCoords);\n    vec2 dy = dFdy(reflCoords);\n    float flatten = dot(abs(dy*1.0),vec2(1.0));    \n\n    vec2 dudv = dNormalW.xz;\n    dudv.x *= 0.0;\n    dudv.y *= 2.0${this.vertexWaves?" - (1.0 - dVertexDepth)":""}; // to avoid leaking reflections at the top of the object\n    dudv /= flatten*3.0+1.0;\n\n    reflCoords += dudv * bumpiness;\n    return reflCoords;\n}\n\nvoid getAlbedo() {\n\n    float fangle = 1.0+dot(dViewDirW, dNormalW);\n    fangle = pow(fangle,5.0);\n    float fresnelTerm = 1.0 - 1.0/fangle;\n\n    // --- caustics\n    vec2 normalPos = dhA.xy + dhB.xy;\n    vec2 shorePos = normalPos + dWaterUV * vec2(texture_normalMapTransform0.x, texture_normalMapTransform1.y);\n    float shoreSample = texture2D(texture_causticsMapAsset, shorePos, textureBias).r;\n\n    vec2 causticsPos = shoreSample * dWaterDepth + (cos(waterUpdateTime) + sin(waterUpdateTime)) * 0.05 + normalPos + dWaterUV * causticsTiling;\n    float causticsSample = texture2D(texture_causticsMapAsset, causticsPos, textureBias).a;\n    vec3 causticsColor = fresnelTerm * vec3(causticsSample) * causticsIntensity * dWaterCaustics;\n\n    // --- shore\n    float shoreColor = dWaterShore * saturate(\n        sin((dWaterShore - waterUpdateTime * shoreFrequency) * shoreTiling) - shoreSample +\n        cos((dWaterShore - waterUpdateTime * shoreFrequency) * shoreTiling) - shoreSample\n        ) * shoreIntensity;\n\n    #ifdef MAPTEXTURE\n    dAlbedo += gammaCorrectInput(addAlbedoDetail(texture2D(texture_diffuseMap, $UV, textureBias).$CH));\n    #endif\n\n    ${t?`\n    vec3 viewDirS = matrix_view3 * dNormalW;\n\n    ${n?"\n    vec2 reflCoords = getReflectionCoords(reflectionsBumpiness, viewDirS);    \n    vec3 reflection = reflectionsIntensity * texture2D(texture_planarReflectionMap, reflCoords, textureBias).rgb;\n":"\n    vec3 reflection = vec3(0.0);\n"}\n    ${r?"\n    float distance = distance(view_position, vPositionW);\n    float factor = 1.0 - clamp( (distance - 150.0) / 150.0, 0.0, 0.5);\n\n    vec2 refrCoords = getReflectionCoords(refractionBumpiness * factor, viewDirS);    \n    vec3 refraction = mix(reflection, refractionIntensity * texture2D(texture_planarRefractionMap, refrCoords, textureBias).rgb, dWaterRefraction);\n":"\n    vec3 refraction = vec3(0.0);\n"}\n`:"\n    vec3 reflection = vec3(0.0);\n    vec3 refraction = vec3(0.0);\n"}\n\n    #ifdef MAPVERTEX\n    dAlbedo += gammaCorrectInput(saturate(vVertexColor.$VC));\n    #endif\n\n    //dAlbedo += gammaCorrectInput(reflection * max(1.0 - dWaterRefraction, 1.0 - fresnelTerm)  + refraction * fresnelTerm);\n    dAlbedo += gammaCorrectInput(reflection * (1.0 - fresnelTerm) + refraction * fresnelTerm);\n\n    #ifdef MAPCOLOR\n    dAlbedo += material_diffuse.rgb;\n    #endif\n    \n    dAlbedo += saturate(causticsColor + shoreColor);\n}\n`},UranusEffectsWater.prototype.getOpacity=function(){return`\n${pc.shaderChunks.screenDepthPS}\n\nvarying vec2 dWaterUV;\nvarying float dVertexDepth;\n\nuniform float waterUpdateTime;\n\nuniform float depthOpacity;\nuniform float refractionOpacity;\n\nuniform sampler2D texture_causticsMapAsset;\nuniform float causticsOpacity;\nuniform float shoreOpacity;\nuniform float causticsIntensity;\nuniform float causticsTiling;\nuniform float shoreIntensity;\nuniform float shoreTiling;\nuniform float shoreFrequency;\n\nuniform sampler2D texture_flowMap;\nuniform float flowFrequency;\n\nuniform float reflectionsIntensity;\nuniform float refractionIntensity;\nuniform float reflectionsBumpiness;\nuniform float refractionBumpiness;\nuniform vec3 specularColor;\nuniform float specularIntensity;\n\nfloat dWaterDepth;\nfloat dWaterCaustics;\nfloat dWaterShore;\nfloat dWaterRefraction;\n\n${this.hasSurfaceDepth?"\nvarying float dTerrainWaterDepth;\n":""}\n\nvec3 dhA;\nvec3 dhB;\n\nvec3 dNormalHighlightsW;\n\nuniform vec3 texture_normalMapTransform0;\nuniform vec3 texture_normalMapTransform1;\n\nuniform sampler2D texture_normalMap;\nuniform float material_bumpiness;\n\n#ifdef MAPFLOAT\nuniform float material_opacity;\n#endif\n\n#ifdef MAPTEXTURE\nuniform sampler2D texture_opacityMap;\n#endif\n\nvoid getOpacity() {\n    \n    dAlpha = 1.0;\n\n    #ifdef MAPFLOAT\n    dAlpha *= material_opacity;\n    #endif\n\n    #ifdef MAPTEXTURE\n    dAlpha *= texture2D(texture_opacityMap, $UV, textureBias).$CH;\n    #endif\n\n    #ifdef MAPVERTEX\n    dAlpha *= clamp(vVertexColor.$VC, 0.0, 1.0);\n    #endif\n\n    // --- calculate water opacity based on depth depth\n    float waterBottom = getLinearDepth(vPositionW);\n    float depth = getLinearScreenDepth();\n    float depthDiff = abs(depth - waterBottom) * dViewDirW.y;\n\n    dWaterDepth = saturate(pow(depthDiff * depthOpacity, 0.5));\n    dWaterCaustics = 1.0 - saturate(pow(${this.hasSurfaceDepth?"dTerrainWaterDepth":"depthDiff"} * causticsOpacity, 0.5));\n    dWaterShore = 1.0 - saturate(pow(depthDiff * shoreOpacity, 0.5));    \n\n    dWaterRefraction = 1.0 - saturate(pow(${this.hasSurfaceDepth?"dTerrainWaterDepth":"depthDiff"} * refractionOpacity, 0.5));\n\n    dAlpha *= dWaterDepth;\n}\n`},UranusEffectsWater.prototype.getNormalMap=function(){return"\nvec3 FlowUVW (\n\tvec2 uv, vec2 flowVector, vec2 jump,\n\tfloat flowOffset, float tiling, float time, bool flowB\n) {\n\tfloat phaseOffset = flowB ? 0.5 : 0.0;\n\tfloat progress = fract(time + phaseOffset);\n\tvec3 uvw;\n\tuvw.xy = uv - flowVector * (progress + flowOffset);\n\tuvw.xy *= tiling;\n\tuvw.xy += phaseOffset;\n\tuvw.xy += (time - progress) * jump;\n\tuvw.z = 1.0 - abs(1.0 - 2.0 * progress);\n\treturn uvw;\n}\n\nvec3 UnpackDerivativeHeight (vec4 textureData) {\n    vec3 dh = textureData.agb;\n    dh.xy = dh.xy * 2.0 - 1.0;\n    return dh;\n}\n\nvec2 normalMapPos;\n\nvoid getNormal() {\n\n    // --- calculate world based UV coordinates so the water surface can move with the camera\n    normalMapPos = vec2(dWaterUV.x * texture_normalMapTransform0.x, dWaterUV.y * texture_normalMapTransform1.y);\n\n    // --- calculate water flow\n    vec3 flowSampler = texture2D(texture_flowMap, normalMapPos, textureBias).rgb;\n\n    vec3 flow = vec3(flowSampler.xy, 0.0);\n    flow.xy = flow.xy * 2.0 - 1.0;\n    flow *= 0.1; // _FlowStrength;\n\n    float noise = flowSampler.b;\n    float time = waterUpdateTime * flowFrequency + noise;\n    vec2 jump = vec2(0.24,0.20); //vec2(_UJump, _VJump);\n\n    vec3 uvwA = FlowUVW(\n        normalMapPos, flow.xy, jump,\n        0.0, 3.0, time, false\n        //_FlowOffset, _Tiling, time, false\n    );\n\n    vec3 uvwB = FlowUVW(\n        normalMapPos, flow.xy, jump,\n        0.0, 3.0, time, true\n        //_FlowOffset, _Tiling, time, false\n    );     \n\n    float normalBumpiness = material_bumpiness;\n\tfloat finalHeightScale = (flow.z * 9.0 + normalBumpiness) * dWaterDepth; // * _HeightScaleModulated + _HeightScale;\n\n\tdhA = UnpackDerivativeHeight(texture2D(texture_normalMap, uvwA.xy, textureBias)) * (uvwA.z * finalHeightScale);\n    dhB = UnpackDerivativeHeight(texture2D(texture_normalMap, uvwB.xy, textureBias)) * (uvwB.z * finalHeightScale);\n\n    // --- sample the normalMap and calculate the final normals\n    vec3 normalMap = normalize(vec3(-(dhA.xy + dhB.xy), 1.0));\n\n    dNormalW = dTBN * normalMap;\n\n    // --- repeat for a different normal sample for specular highlights\n    normalBumpiness = 1.0 * smoothstep(1.0, 0.0, dWaterCaustics);\n\tfinalHeightScale = (flow.z * 9.0 + normalBumpiness) * dWaterDepth;\n\n\tvec3 dhAH = UnpackDerivativeHeight(texture2D(texture_normalMap, uvwA.xy, textureBias)) * (uvwA.z * finalHeightScale);\n    vec3 dhBH = UnpackDerivativeHeight(texture2D(texture_normalMap, uvwB.xy, textureBias)) * (uvwB.z * finalHeightScale);\n\n    normalMap = normalize(vec3(-(dhAH.xy + dhBH.xy), 1.0));\n    dNormalHighlightsW = dTBN * normalMap;\n}\n"},UranusEffectsWater.prototype.getLightSpecular=function(){return"\n// Energy-conserving (hopefully) Blinn-Phong\nfloat calcLightSpecular(float gloss, vec3 worldNormal, vec3 h) {\n    float nh = max( dot( h, worldNormal ), 0.0 );\n\n    float specPow = exp2(gloss * 11.0); // glossiness is linear, power is not; 0 - 2048\n\n    // Hack: On Mac OS X, calling pow with zero for the exponent generates hideous artifacts so bias up a little\n    specPow = max(specPow, 0.0001);\n\n    return pow(nh, specPow) * (specPow + 2.0) / 8.0;\n}\n\nfloat getLightSpecular(vec3 h, vec3 reflDir, vec3 worldNormal, vec3 viewDir, vec3 lightDirNorm, float gloss, mat3 tbn) {\n    float specPow = exp2(gloss * 2.0);\n\n    vec3 H = normalize(-lightDirNorm + viewDir);\n\tfloat e = specPow * 800.0;\n\tfloat kS = saturate(dot(dNormalHighlightsW, -lightDirNorm));\n\treturn kS * specularIntensity * pow(saturate(dot(dNormalHighlightsW, H)), e) * sqrt((e + 1.0) / 2.0);\n}\n"},UranusEffectsWater.prototype.getCombineColor=function(){return`\nvec3 combineColor(vec3 albedo, vec3 sheenSpecularity, float clearcoatSpecularity) {\n    vec3 ret = vec3(0);\n#ifdef LIT_OLD_AMBIENT\n    ret += (dDiffuseLight - light_globalAmbient) * albedo + material_ambient * light_globalAmbient;\n#else\n    ret += albedo * dDiffuseLight;\n#endif\n#ifdef LIT_SPECULAR\n    ${this.specularBlinking>0?`\n    float specularBlinking = texture2D(texture_causticsMapAsset, vec2(vUv0.xy + waterUpdateTime * ${this.specularBlinking.toFixed(3)}), textureBias).a;\n    `:""}\n\n    ret += dSpecularLight * specularColor ${this.specularBlinking>0?"* specularBlinking":""};\n#endif\n#ifdef LIT_REFLECTIONS\n    ret += dReflection.rgb * dReflection.a;\n#endif\n\n#ifdef LIT_SHEEN\n    float sheenScaling = 1.0 - max(max(sheenSpecularity.r, sheenSpecularity.g), sheenSpecularity.b) * 0.157;\n    ret = ret * sheenScaling + (sSpecularLight + sReflection.rgb) * sheenSpecularity;\n#endif\n#ifdef LIT_CLEARCOAT\n    float clearCoatScaling = 1.0 - ccFresnel * clearcoatSpecularity;\n    ret = ret * clearCoatScaling + (ccSpecularLight + ccReflection.rgb) * clearcoatSpecularity;\n#endif\n\n    return ret;\n}\n`},UranusEffectsWater.prototype.getStartVS=function(){return"\nvarying vec2 dWaterUV;\n\nuniform float waterScale;\n\nvoid main(void) {\n\n    gl_Position = getPosition();\n\n    vec2 world_size;\n    vec2 world_tiling;\n\n    world_size.x = length(vec3(dModelMatrix[0].xyz));\n    world_size.y = length(vec3(dModelMatrix[2].xyz));\n\n    world_tiling.x = world_size.y / waterScale;\n    world_tiling.y = world_size.y / waterScale;\n\n    dWaterUV = vec2(dPositionW.x / world_size.x, dPositionW.z / world_size.y) * world_tiling.xy;      \n"},UranusEffectsWater.prototype.getTransformVS=function(){return`\n${pc.shaderChunks.screenDepthPS}\n\nuniform vec3 view_position;\n\nuniform float waterUpdateTime;\nuniform float wavesFrequency;\nuniform float wavesAmplitude;\nuniform vec2 wavesDepthMinMax;\nuniform sampler2D texture_causticsMapAsset;\n\n${this.hasSurfaceDepth?"\nuniform vec4 renderSurfaceParams; // orthoX orthoY sizeX sizeZ\nuniform sampler2D texture_depthSurface;\nuniform float renderFarClip;\nuniform float renderPosY;\n\nvarying float dTerrainWaterDepth;\n":""}\n\nvec3 dPositionWBase;\nvarying float dVertexDepth;\nfloat dDepthFactor;\n\n// convert clip space position into texture coordinates to sample scene grab textures\nvec2 grabScreenPos(vec4 clipPos) {\n    vec2 uv = (clipPos.xy / clipPos.w) * 0.5 + 0.5;\n    #ifdef WEBGPU\n        uv.y = 1.0 - uv.y;\n    #endif\n    return uv;\n}\n\n#ifdef PIXELSNAP\nuniform vec4 uScreenSize;\n#endif\n\n#ifdef SCREENSPACE\nuniform float projectionFlipY;\n#endif\n\n#ifdef MORPHING\nuniform vec4 morph_weights_a;\nuniform vec4 morph_weights_b;\n#endif\n\n#ifdef MORPHING_TEXTURE_BASED\nuniform vec4 morph_tex_params;\n\nvec2 getTextureMorphCoords() {\n    float vertexId = morph_vertex_id;\n    vec2 textureSize = morph_tex_params.xy;\n    vec2 invTextureSize = morph_tex_params.zw;\n\n    // turn vertexId into int grid coordinates\n    float morphGridV = floor(vertexId * invTextureSize.x);\n    float morphGridU = vertexId - (morphGridV * textureSize.x);\n\n    // convert grid coordinates to uv coordinates with half pixel offset\n    vec2 uv = (vec2(morphGridU, morphGridV) * invTextureSize) + (0.5 * invTextureSize);\n    return getImageEffectUV(uv);\n}\n#endif\n\n#ifdef MORPHING_TEXTURE_BASED_POSITION\nuniform highp sampler2D morphPositionTex;\n#endif\n\nmat4 getModelMatrix() {\n    #ifdef DYNAMICBATCH\n    return getBoneMatrix(vertex_boneIndices);\n    #elif defined(SKIN)\n    return matrix_model * getSkinMatrix(vertex_boneIndices, vertex_boneWeights);\n    #elif defined(INSTANCING)\n    return mat4(instance_line1, instance_line2, instance_line3, instance_line4);\n    #else\n    return matrix_model;\n    #endif\n}\n\nfloat getWaveElevation(vec3 posW) {\n   float base = texture2D(texture_causticsMapAsset, vertex_texCoord0).r;\n   return cos(posW.x * wavesFrequency * base + waterUpdateTime) * sin(posW.z * wavesFrequency * base + waterUpdateTime) * wavesAmplitude * dDepthFactor;\n}\n\nvec4 getPosition() {\n    dModelMatrix = getModelMatrix();\n\n    vec3 localPos = vertex_position;\n\n    #ifdef NINESLICED\n    // outer and inner vertices are at the same position, scale both\n    localPos.xz *= outerScale;\n\n    // offset inner vertices inside\n    // (original vertices must be in [-1;1] range)\n    vec2 positiveUnitOffset = clamp(vertex_position.xz, vec2(0.0), vec2(1.0));\n    vec2 negativeUnitOffset = clamp(-vertex_position.xz, vec2(0.0), vec2(1.0));\n    localPos.xz += (-positiveUnitOffset * innerOffset.xy + negativeUnitOffset * innerOffset.zw) * vertex_texCoord0.xy;\n\n    vTiledUv = (localPos.xz - outerScale + innerOffset.xy) * -0.5 + 1.0; // uv = local pos - inner corner\n\n    localPos.xz *= -0.5; // move from -1;1 to -0.5;0.5\n    localPos = localPos.xzy;\n    #endif\n\n    #ifdef MORPHING\n    #ifdef MORPHING_POS03\n    localPos.xyz += morph_weights_a[0] * morph_pos0;\n    localPos.xyz += morph_weights_a[1] * morph_pos1;\n    localPos.xyz += morph_weights_a[2] * morph_pos2;\n    localPos.xyz += morph_weights_a[3] * morph_pos3;\n    #endif // MORPHING_POS03\n    #ifdef MORPHING_POS47\n    localPos.xyz += morph_weights_b[0] * morph_pos4;\n    localPos.xyz += morph_weights_b[1] * morph_pos5;\n    localPos.xyz += morph_weights_b[2] * morph_pos6;\n    localPos.xyz += morph_weights_b[3] * morph_pos7;\n    #endif // MORPHING_POS47\n    #endif // MORPHING\n\n    #ifdef MORPHING_TEXTURE_BASED_POSITION\n    // apply morph offset from texture\n    vec2 morphUV = getTextureMorphCoords();\n    vec3 morphPos = texture2D(morphPositionTex, morphUV).xyz;\n    localPos += morphPos;\n    #endif\n\n    vec4 posW = dModelMatrix * vec4(localPos, 1.0);\n    #ifdef SCREENSPACE\n    posW.zw = vec2(0.0, 1.0);\n    #endif\n\n    // --- calculate vertex waves\n    ${this.hasSurfaceDepth?"\n    vec2 dSurfaceCoords;\n    dSurfaceCoords.x = clamp( (posW.x + renderSurfaceParams.x) / renderSurfaceParams.z, 0.0, 1.0);\n    dSurfaceCoords.y = -clamp( (posW.z + renderSurfaceParams.y) / renderSurfaceParams.w, -1.0, 0.0);    \n\n    float terrainDepth = texture2D(texture_depthSurface, dSurfaceCoords).r;\n    float terrainWorldY = renderPosY - terrainDepth * renderFarClip;\n\n    float depthDiff = max((posW.y - terrainWorldY) / renderFarClip * 2.0, 0.0);\n    dTerrainWaterDepth = depthDiff * renderFarClip;\n    ":"\n    vec2 screenCoord = grabScreenPos(matrix_viewProjection * posW);\n    float sceneDepth = getLinearScreenDepth(screenCoord) * camera_params.x;\n    float waterDepth = getLinearDepth(posW.xyz) * camera_params.x;\n    float depthDiff = clamp(sceneDepth - waterDepth, 0.0, 1.0) * 50.0;\n    "}\n\n    dDepthFactor = clamp(depthDiff, wavesDepthMinMax.x, wavesDepthMinMax.y);\n    dVertexDepth = (wavesDepthMinMax.y - dDepthFactor - wavesDepthMinMax.x) / (wavesDepthMinMax.y - wavesDepthMinMax.x);\n\n    dPositionWBase = posW.xyz;  \n\n    posW.y += getWaveElevation(posW.xyz);\n\n    dPositionW = posW.xyz;\n\n    vec4 screenPos;\n    #ifdef UV1LAYOUT\n    screenPos = vec4(vertex_texCoord1.xy * 2.0 - 1.0, 0.5, 1);\n    #else\n    #ifdef SCREENSPACE\n    screenPos = posW;\n    screenPos.y *= projectionFlipY;\n    #else\n    screenPos = matrix_viewProjection * posW;\n    #endif\n\n    #ifdef PIXELSNAP\n    // snap vertex to a pixel boundary\n    screenPos.xy = (screenPos.xy * 0.5) + 0.5;\n    screenPos.xy *= uScreenSize.xy;\n    screenPos.xy = floor(screenPos.xy);\n    screenPos.xy *= uScreenSize.zw;\n    screenPos.xy = (screenPos.xy * 2.0) - 1.0;\n    #endif\n    #endif\n\n    return screenPos;\n}\n\nvec3 getWorldPosition() {\n    return dPositionW;\n}\n`},UranusEffectsWater.prototype.getNormalVS=function(){return"\nvec3 getNormal() {\n\n    dNormalMatrix = matrix_normal;\n\n    vec3 v0 = dPositionWBase;\n    vec3 v1 = dPositionWBase + vec3(0.01, 0.0, 0.0);\n    vec3 v2 = dPositionWBase + vec3(0.0, 0.0, 0.01);\n\n    v0.y += getWaveElevation(v0);\n    v1.y += getWaveElevation(v1);\n    v2.y += getWaveElevation(v2);\n\n    vec3 vn = cross(v2 - v0, v1 - v0);\n    return normalize(vn);\n}  \n"};var UranusEffectsSkyboxCubemap=pc.createScript("uranusEffectsSkyboxCubemap");UranusEffectsSkyboxCubemap.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsSkyboxCubemap.attributes.add("updateFrequency",{title:"Update Frequency",description:"Set the frequency of the cubemap renderer to skip this number of frames. If it is set to 1 it will update per frame. Set to 0 to pause rendering.",type:"number",default:30,min:0}),UranusEffectsSkyboxCubemap.attributes.add("renderWidth",{title:"Render Width",description:"The resolution of the render target for the cubemap. Updating it requires application reload.",type:"number",default:256}),UranusEffectsSkyboxCubemap.attributes.add("renderOnSkyTime",{title:"Render On Sky Time",description:"This will automatically update the cubemap only when there is a sky time change.",type:"entity"}),UranusEffectsSkyboxCubemap.attributes.add("renderOnce",{title:"Render Once",default:!1,description:"This will render the cubemap just once after it's enabled.",type:"boolean"}),UranusEffectsSkyboxCubemap.attributes.add("prefilterCubemap",{type:"boolean",default:!0,title:"Prefilter Cubemap",description:"If selected the rendered cubemap will be filtered, required if used for reflections."}),UranusEffectsSkyboxCubemap.attributes.add("layers",{type:"string",array:!0,default:["Sky"],title:"Layers",description:"A list of layer names which the render camera will target while rendering."}),UranusEffectsSkyboxCubemap.attributes.add("materialsTag",{type:"string",title:"Materials Tag",description:"Instead of referencing materials directly, you can use a tag to let the script find them on run time."}),UranusEffectsSkyboxCubemap.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0,title:"Material Assets",description:"If one or more materials are provided the environmental map will be applied to it, otherwise to the scene directly."}),UranusEffectsSkyboxCubemap.prototype.initialize=function(){this.probeEntity=new pc.Entity,this.probeEntity.addComponent("script"),this.entity.addChild(this.probeEntity),this.pauseRendering=!1,this.uranusEffectsSkybox=this.renderOnSkyTime?.script?.uranusEffectsSkybox,this.materialsTag&&(this.materialAssets=this.app.assets.findByTag(this.materialsTag)),this.prefilterCubemap&&(this.envAtlas=new pc.Texture(this.app.graphicsDevice,{width:this.renderWidth,height:this.renderWidth,format:pc.PIXELFORMAT_R8_G8_B8_A8,type:pc.TEXTURETYPE_RGBM,projection:pc.TEXTUREPROJECTION_EQUIRECT,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,mipmaps:!1})),this.probeEntity.addComponent("camera",{clearColorBuffer:!1,priority:0,frustumCulling:!1,enabled:!1,nearClip:1,farClip:500}),this.probeEntity.uranusReflectionsCamera=!0,this.setRenderLayers(),this.probeEntity.script.create("cubemapRenderer",{enabled:!1,attributes:{resolution:this.renderWidth/4,mipmaps:!1,depth:!0}});const e=this.probeEntity.script.cubemapRenderer;this.cubemapRenderer=e,this.updateProbeCount=this.updateFrequency,this.renderOnce&&(this.updateProbeCount=1),this.app.on("uranusEffectsSkyboxCubemap:render",(()=>{this.pauseRendering=!1,this.updateProbeCount=1}));let t=!0;this.probeEntity.on("onCubemapPostRender",(()=>{this.applyEnvMap(e.cubeMap),t&&this.entity.collision&&this.materialAssets.forEach((e=>this.setMaterialCubemapProjection(e.resource))),t=!1})),this.prepare(),this.on("attr",this.prepare,this),this.on("attr:renderOnce",(function(){this.pauseRendering=!1})),this.on("state",this.onState,this),this.on("destroy",(()=>this.onState(!1)),this)},UranusEffectsSkyboxCubemap.prototype.prepare=function(){this.updateFrequency>0?(this.app.on("update",this.appUpdate,this),this.cubemapRenderer.enabled=!0):(this.app.off("update",this.appUpdate,this),this.cubemapRenderer.enabled=!1)},UranusEffectsSkyboxCubemap.prototype.onState=function(e){e?this.app.on("update",this.appUpdate,this):(this.app.off("update",this.appUpdate,this),this.cubemapRenderer.enabled=!1)},UranusEffectsSkyboxCubemap.prototype.setRenderLayers=function(){const e=this.layers.map((e=>this.app.scene.layers.getLayerByName(e)));this.probeEntity.camera.layers=e.map((e=>e.id))},UranusEffectsSkyboxCubemap.prototype.applyEnvMap=function(e){const t=this.prefilterCubemap,a=this.envAtlas;t&&pc.EnvLighting.generateAtlas(e,{target:a}),this.materialAssets.length>0?this.materialAssets.forEach((i=>{const s=i.resource;if(!s)return!0;t?s.envAtlas=a:s.cubeMap=e})):this.app.scene.envAtlas=a},UranusEffectsSkyboxCubemap.prototype.setMaterialCubemapProjection=function(e){e&&(e.cubeMapProjection=pc.CUBEPROJ_BOX,e.cubeMapProjectionBox=new pc.BoundingBox(this.entity.getPosition().clone(),this.entity.collision.halfExtents.clone()),e.update())},UranusEffectsSkyboxCubemap.prototype.appUpdate=function(e){const t=this.updateFrequency;if(this.uranusEffectsSkybox&&pc.app.frame>=60){const e=this.uranusEffectsSkybox.get24Angle();e!==this.lastTime&&(this.updateProbeCount=-1,this.lastTime=e)}else this.updateProbeCount--;this.renderOnce||0!==t||(this.updateProbeCount=1),!this.pauseRendering&&this.updateProbeCount<0?(this.updateProbeCount=t,this.cubemapRenderer.enabled=!0,this.renderOnce&&(this.pauseRendering=!0)):this.cubemapRenderer.enabled=!1};var UranusEffectsMaterialVideo=pc.createScript("uranusEffectsMaterialVideo");UranusEffectsMaterialVideo.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsMaterialVideo.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0}),UranusEffectsMaterialVideo.attributes.add("video",{title:"Video",description:"MP4 video asset to play back on this video texture.",type:"asset"}),UranusEffectsMaterialVideo.attributes.add("videoUrl",{title:"Video Url",description:"Instead of passing a video asset you can add a remote url for video playback.",type:"string"}),UranusEffectsMaterialVideo.attributes.add("eventPlay",{title:"Event Play",description:"Provide an app event that will fire as soon as the video starts playing.",type:"string"}),UranusEffectsMaterialVideo.prototype.initialize=function(){this.play()},UranusEffectsMaterialVideo.prototype.play=function(e){if(!this.video&&!this.videoUrl&&!e)return;this.stop();const t=document.createElement("video");t.loop=!0,t.muted=!0,t.playsInline=!0,t.crossOrigin="anonymous",t.autoplay=!0;const i=t.style;i.width="1px",i.height="1px",i.position="absolute",i.opacity="0",i.zIndex="-1000",i.pointerEvents="none",this.videoTexture=new pc.Texture(this.app.graphicsDevice,{format:pc.PIXELFORMAT_R8_G8_B8,minFilter:pc.FILTER_LINEAR_MIPMAP_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,mipmaps:!0}),this.videoTexture.setSource(t),t.addEventListener("canplaythrough",function(e){t.play()}.bind(this)),t.addEventListener("play",function(e){this.eventPlay&&this.app.fire(this.eventPlay)}.bind(this)),e?t.srcObject=e:t.src=this.video?this.video.getFileUrl():this.videoUrl,document.body.appendChild(t),t.load(),this.videoElement=t,this.materialAssets.forEach((e=>{const t=e.resource;t.diffuseMap=this.videoTexture,t.emissiveMap=this.videoTexture,t.update()}))},UranusEffectsMaterialVideo.prototype.stop=function(){this.videoTexture&&(this.videoTexture.destroy(),this.videoTexture=void 0,this.materialAssets.forEach((e=>{const t=e.resource;t.diffuseMap=void 0,t.emissiveMap=void 0,t.update()})),this.videoElement.remove(),this.videoElement=void 0)},UranusEffectsMaterialVideo.prototype.update=function(e){this.videoTexture&&this.videoTexture.upload()};var world2reflMirror,UranusEffectsPlanarReflections=pc.createScript("uranusEffectsPlanarReflections");UranusEffectsPlanarReflections.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsPlanarReflections.attributes.add("activeCameras",{type:"entity",array:!0,title:"Active Cameras",description:"A list of cameras to render reflections from."}),UranusEffectsPlanarReflections.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0,description:"If apply shader is selected, this material will be updated to have the reflections map referenced on its diffuse channel. If not, a shader uniform named texture_planarReflectionMap will be added to the material scope."}),UranusEffectsPlanarReflections.attributes.add("reflectionLayers",{type:"string",array:!0,default:["WaterReflection"],title:"Reflection Layers",description:"The scene layers names that are being used by models casting reflections."}),UranusEffectsPlanarReflections.attributes.add("refractionLayers",{type:"string",array:!0,default:["WaterRefraction"],title:"Refraction Layers",description:"The scene layers names that iare being used by models casting refraction."}),UranusEffectsPlanarReflections.attributes.add("renderPreset",{type:"string",default:"Reflection",enum:[{Reflection:"Reflection"},{Refraction:"Refraction"},{Both:"Both"}],title:"Render Preset",description:"Select if a reflection or refraction map will be rendered (or both). Restart is required."}),UranusEffectsPlanarReflections.attributes.add("resolutionFactor",{type:"number",min:1,max:4,precision:0,default:1,title:"Resolution Factor",description:"Used to scale down the resolution size of the reflection render target and improve performance. Set to 1 to be equal in size with the screen size. Set to 4 to downscale the resolution 4x."}),UranusEffectsPlanarReflections.attributes.add("reflectionVector",{type:"vec3",default:[0,0,0],title:"Reflection Vector",description:"If set to non zero, then this normal will be used instead of the entity back direction."}),UranusEffectsPlanarReflections.attributes.add("reflectionOffset",{type:"vec3",default:[0,0,0],title:"Reflection Offset",description:"Add a reflection plane offset to fine adjust the exact position of the plane."}),UranusEffectsPlanarReflections.attributes.add("reflectSkybox",{type:"boolean",default:!1,title:"Reflect Skybox",description:"If selected the scene skybox will be added to the reflections."}),UranusEffectsPlanarReflections.attributes.add("updateFrequency",{title:"Update Frequency",description:"Set the frequency of the reflections rendered to skip this number of frames. If it is set to 0 it will update per frame.",type:"number",default:0,min:0}),UranusEffectsPlanarReflections.attributes.add("materialSettings",{type:"json",array:!0,schema:[{name:"applyShader",type:"boolean",default:!0,title:"Apply Shader",description:"If apply shader is selected, the referenced material will be updated to have the reflections map on its diffuse channel and the diffuse shader chunk will be updated."},{name:"uvChannel",type:"string",default:"vUv0",enum:[{UV0:"vUv0"},{UV1:"vUv1"}],title:"UV Channel",description:"When using Apply Shader set which UV channel should be used."},{name:"shaderReflectionsIntensity",type:"number",default:1,min:0,title:"Reflections Intensity",description:"Sets the intensity of the reflections map."},{name:"shaderReflectionsIndex",type:"number",default:1,min:0,title:"Reflections Index",description:"Sets the reflection index that affects the reflections viewing angle."},{name:"shaderReflectionsNormalMap",type:"asset",assetType:"texture",title:"Normal Map",description:"If a normal is provided it will be used for the reflections in the overriden shader."},{name:"shaderReflectionsNormalIntensity",type:"number",default:.05,precision:3,min:0,max:2,title:"Normal Intensity",description:"Sets the intensity of the reflections normal map."},{name:"shaderReflectionsNormalTiling",type:"vec2",default:[1,1],title:"Normal Tiling",description:"Sets the UV tiling of the reflections normal map."},{name:"shaderReflectionsMask",type:"asset",assetType:"texture",title:"Mask",description:"If a mask is provided it will be used to mask the reflections."},{name:"shaderReflectionsMaskTiling",type:"vec2",default:[1,1],title:"Mask Tiling",description:"Sets the UV tiling of the reflections mask."}]}),UranusEffectsPlanarReflections.prototype.initialize=function(){this.canvasTimeout=void 0,this.updateCount=0,this.renderReflection="Reflection"===this.renderPreset||"Both"===this.renderPreset,this.renderRefraction="Refraction"===this.renderPreset||"Both"===this.renderPreset,this.prepareCamera(),this.prepareReflections(),this.on("attr",(function(e){0!==e.indexOf("shader")?this.prepareReflections():this.updateShaderAttributes()}),this),this.on("state",(function(e){this.reflectionCamera&&(this.reflectionCamera.enabled=e),this.refractionCamera&&(this.refractionCamera.enabled=e)})),this.app.graphicsDevice.on("resizecanvas",this.onResizeCanvas,this),this.on("destroy",(function(){this.app.graphicsDevice.off("resizecanvas",this.onResizeCanvas,this),this.clearRenderTarget(),this.reflectionCamera&&this.reflectionCamera.destroy(),this.refractionCamera&&this.refractionCamera.destroy()}))},UranusEffectsPlanarReflections.prototype.onResizeCanvas=function(){window.clearTimeout(this.canvasTimeout),this.canvasTimeout=window.setTimeout((()=>{this.reflectionCamera&&(this.reflectionCamera.camera.renderTarget=this.updateRenderTarget("Reflection")),this.refractionCamera&&(this.refractionCamera.camera.renderTarget=this.updateRenderTarget("Refraction"))}),100)},UranusEffectsPlanarReflections.prototype.getReflectionLayers=function(e){const t=[];return e.forEach((e=>{const a=this.app.scene.layers.getLayerByName(e);a&&t.push(a)})),t},UranusEffectsPlanarReflections.prototype.prepareCamera=function(){if(this.renderReflection){const e=new pc.Entity("Reflection Camera");e.addComponent("camera",{flipFaces:!0,priority:10}),e.uranusReflectionsCamera=!1,this.reflectionCamera=e,e.enabled=!0}if(this.renderRefraction){const e=new pc.Entity("Refraction Camera");e.addComponent("camera",{priority:10}),e.uranusReflectionsCamera=!1,this.refractionCamera=e,e.enabled=!0}},UranusEffectsPlanarReflections.prototype.getActiveCamera=function(){let e;if(this.activeCameras.length>0)this.activeCameras.forEach((t=>{t.enabled&&(e=t)}));else{const t=this.app.scene.layers.cameras,a=t[t.length-1];if(!a)return;e=a.entity}return e},UranusEffectsPlanarReflections.prototype.postUpdate=function(){const e=this.getActiveCamera();if(!e)return;const t=this.reflectionCamera,a=this.refractionCamera,r=this.updateFrequency;this.updateCount--;this.updateCount<0?(this.updateCount=r,t&&(t.camera.enabled=!0,this.postUpdateCamera(t,e)),a&&(a.camera.enabled=!0,this.postUpdateCamera(a,e))):(t&&(t.camera.enabled=!1),a&&(a.camera.enabled=!1))},UranusEffectsPlanarReflections.prototype.postUpdateCamera=function(e,t){t||(t=this.getActiveCamera()),e.parent!==t&&(e.reparent(t),UranusUtilities.copyCameraProperties(e,t));const a=t.camera,r=e.camera,n=r.rect,i=a.rect;!1===i.equals(n)&&n.copy(i),r.horizontalFov=a.horizontalFov,r.fov=a.fov,r.aspectRatio=a.aspectRatio,r.farClip=a.farClip,r.nearClip=a.nearClip},UranusEffectsPlanarReflections.prototype.prepareReflections=function(){this.materialAssets.forEach(((e,t)=>{const a=this.materialSettings[t];if(!a||!a.applyShader)return;const r=e.resource;r.chunks.diffusePS=this.getShader(a),r.chunks.APIVersion=pc.CHUNKAPI_1_63,r.update()})),this.updateShaderAttributes();const e=this.entity;this.planePosW=e.getPosition().clone().add(this.reflectionOffset),!1===pc.Vec3.ZERO.equals(this.reflectionVector)?this.planeNormalW=this.reflectionVector:this.planeNormalW=e.up.scale(-1).clone();const t=this.planeNormalW.x,a=this.planeNormalW.y,r=this.planeNormalW.z,n=-this.planePosW.dot(this.planeNormalW);this.world2refl=reflectionMatrix(t,a,r,n),this.planeDW=n;const i=this,s=this.app.renderer.updateCameraFrustum.bind(this.app.renderer),o=this.reflectionCamera?.camera;if(o){o.renderTarget=this.updateRenderTarget("Reflection");const preFunctionReflection=function(){planePosWM=i.planePosW,planeNormalWM=i.planeNormalW,world2reflMirror=i.world2refl,o&&(o.calculateTransform=customTransformFuncMirror,o.calculateProjection=customProjFuncMirror,s(o.camera))},e=this.getReflectionLayers(this.reflectionLayers);e.forEach((e=>{e.onPreCull=e.onPreRender=preFunctionReflection})),o.layers=e.map((e=>e.id))}const l=this.refractionCamera?.camera;if(l){l.renderTarget=this.updateRenderTarget("Refraction");const preFunctionRefraction=function(){planePosWM=i.planePosW,planeNormalWM=i.planeNormalW,world2reflMirror=i.world2refl,l.calculateTransform=customTransformFunc,l.calculateProjection=customProjFuncMirror,s(l.camera)},e=this.getReflectionLayers(this.refractionLayers);e.forEach((e=>{e.onPreCull=e.onPreRender=preFunctionRefraction})),l.layers=e.map((e=>e.id))}},UranusEffectsPlanarReflections.prototype.clearRenderTarget=function(e){!this.rtReflection||e&&"Reflection"!==e||(this.rtReflection.colorBuffer.destroy(),this.rtReflection.destroy()),!this.rtRefraction||e&&"Refraction"!==e||(this.rtRefraction.colorBuffer.destroy(),this.rtRefraction.destroy())},UranusEffectsPlanarReflections.prototype.updateRenderTarget=function(e){this.clearRenderTarget(e);const t=this.app.graphicsDevice;let a=pc.PIXELFORMAT_R8_G8_B8_A8;t.webgl2&&t.extTextureFloatRenderable?a=pc.PIXELFORMAT_111110F:t.extTextureHalfFloatRenderable&&t.extTextureHalfFloatLinear&&(a=pc.PIXELFORMAT_RGBA16F);const r=new pc.Texture(t,{width:t.width/this.resolutionFactor,height:t.height/this.resolutionFactor,format:a,autoMipmap:!1});r.addressU=pc.ADDRESS_CLAMP_TO_EDGE,r.addressV=pc.ADDRESS_CLAMP_TO_EDGE,r.magFilter=pc.FILTER_LINEAR,r.minFilter=pc.FILTER_LINEAR;const n=new pc.RenderTarget({colorBuffer:r,depth:!0,samples:4});return this[`rt${e}`]=n,this.materialAssets.forEach((t=>this.applyRenderTarget(e,r,t.resource))),n},UranusEffectsPlanarReflections.prototype.applyRenderTarget=function(e,t,a){t&&a&&a.setParameter(`texture_planar${e}Map`,t)},UranusEffectsPlanarReflections.prototype.updateShaderAttributes=async function(){const e=this.materialSettings.map((e=>e.shaderReflectionsNormalMap)).concat(this.materialSettings.map((e=>e.shaderReflectionsMask))),t=this.app.assets.find("texture-white.jpg");this.materialAssets.forEach(((e,a)=>{const r=this.materialSettings[a];if(!r||!r.applyShader)return;const n=e.resource;r.shaderReflectionsNormalMap&&n.setParameter("texture_planarReflectionNormalMap",t.resource),r.shaderReflectionsMask&&n.setParameter("texture_planarReflectionMask",t.resource)})),await UranusUtilities.loadAssets(e),this.materialAssets.forEach(((e,t)=>{const a=this.materialSettings[t];if(!a||!a.applyShader)return;const r=e.resource;r.setParameter("reflectionsIntensity",a.shaderReflectionsIntensity),r.setParameter("reflectionsIndex",a.shaderReflectionsIndex),r.setParameter("reflectionsNormalIntensity",a.shaderReflectionsNormalIntensity),r.setParameter("reflectionsNormalTiling",a.shaderReflectionsNormalTiling.data),r.setParameter("reflectionsMaskTiling",a.shaderReflectionsMaskTiling.data),a.shaderReflectionsNormalMap&&r.setParameter("texture_planarReflectionNormalMap",a.shaderReflectionsNormalMap.resource),a.shaderReflectionsMask&&r.setParameter("texture_planarReflectionMask",a.shaderReflectionsMask.resource)}))},UranusEffectsPlanarReflections.prototype.getShader=function(e){return`\nuniform vec4 uScreenSize;\n\n#ifdef MAPCOLOR\nuniform vec3 material_diffuse;\n#endif\n\nuniform sampler2D texture_planarReflectionMap;\nuniform float reflectionsIntensity;\nuniform float reflectionsIndex;\nuniform float reflectionsNormalIntensity;\nuniform vec2 reflectionsNormalTiling;\n\n${e.shaderReflectionsNormalMap?"\nuniform sampler2D texture_planarReflectionNormalMap;\nuniform mat3 matrix_view3;\n":""}\n\n${e.shaderReflectionsMask?"\nuniform sampler2D texture_planarReflectionMask;\nuniform vec2 reflectionsMaskTiling;\n":""}\n\nfloat schlick(float cosTheta, float refIndex) \n{\n    float r0 = (1.0 - refIndex) / (1.0 + refIndex);\n    r0 = r0 * r0;\n    return r0 + (1.0 - r0) * pow(1.0 - cosTheta, 5.0);\n}\n\nvoid getAlbedo() {\n    dAlbedo = vec3(1.0);\n\n    #ifdef MAPCOLOR\n        dAlbedo *= material_diffuse.rgb;\n    #endif\n\n    #ifdef MAPTEXTURE\n        vec3 albedoBase = $DECODE(texture2DBias($SAMPLER, $UV, textureBias)).$CH;\n        dAlbedo *= addAlbedoDetail(albedoBase);\n    #endif\n\n    #ifdef MAPVERTEX\n        dAlbedo *= gammaCorrectInput(saturate(vVertexColor.$VC));\n    #endif\n\n    vec2 reflCoords = gl_FragCoord.xy * uScreenSize.zw;\n\n    ${e.shaderReflectionsNormalMap?`\n\n    vec3 normalMap = unpackNormal(texture2D(texture_planarReflectionNormalMap, ${e.uvChannel} * reflectionsNormalTiling, textureBias));\n    normalMap = mix(vec3(0.0, 0.0, 1.0), normalMap, reflectionsNormalIntensity);\n    vec3 normalW = normalize(dTBN * normalMap);\n\n    vec3 viewDirS = matrix_view3 * normalW;\n    reflCoords.xy += viewDirS.xy * (-0.086 * reflectionsNormalIntensity);\n\n    vec2 dx = dFdx(reflCoords);\n    vec2 dy = dFdy(reflCoords);\n    float flatten = dot(abs(dy*1.0),vec2(1.0));\n\n    vec2 dudv = normalW.xz;\n    dudv.x *= 0.0;\n    dudv.y *= 2.0;\n    dudv /= flatten*3.0+1.0;\n\n    reflCoords += dudv;    \n    `:""}\n\n    ${e.shaderReflectionsMask?"\n    float mask = texture2D(texture_planarReflectionMask, $UV * reflectionsMaskTiling, textureBias).r;\n    vec3 planarReflections = mask * reflectionsIntensity * texture2D(texture_planarReflectionMap, reflCoords, textureBias).rgb;\n    ":"\n    vec3 planarReflections = reflectionsIntensity * texture2D(texture_planarReflectionMap, reflCoords, textureBias).rgb;\n    "}\n\n    float cosTheta = dot(normalize(dViewDirW), normalize(dNormalW));\n    float blendFactor = schlick(cosTheta, reflectionsIndex);\n    dAlbedo = mix(dAlbedo, planarReflections, blendFactor);    \n}\n`};var planePosWM,planeNormalWM,planeAV,planeBV,planeCV,planeDV,tmpView=new pc.Mat4,planeQ=new pc.Vec4,planeV=new pc.Vec4,planePosV=new pc.Vec3,planeNormalV=new pc.Vec3,projInv=new pc.Mat4;function reflectionMatrix(e,t,a,r){var n=new pc.Mat4;return n.data[0]=1-2*e*e,n.data[1]=-2*e*t,n.data[2]=-2*e*a,n.data[3]=-2*e*r,n.data[4]=-2*e*t,n.data[5]=1-2*t*t,n.data[6]=-2*t*a,n.data[7]=-2*t*r,n.data[8]=-2*e*a,n.data[9]=-2*t*a,n.data[10]=1-2*a*a,n.data[11]=-2*a*r,n.data[12]=0,n.data[13]=0,n.data[14]=0,n.data[15]=1,n.transpose(),n}function customTransformFuncMirror(e,t){var a=this.node.getPosition(),r=this.node.getRotation();e.setTRS(a,r,pc.Vec3.ONE),e.mul2(world2reflMirror,e)}function customTransformFunc(e,t){var a=this.node.getPosition(),r=this.node.getRotation();e.setTRS(a,r,pc.Vec3.ONE)}function customProjFuncMirror(e,t){if(this.projection===pc.PROJECTION_PERSPECTIVE)e.setPerspective(this.fov,this.aspectRatio,this.nearClip,this.farClip,this.horizontalFov);else{var a=this.orthoHeight,r=a*this.aspectRatio;e.setOrtho(-r,r,-a,a,this.nearClip,this.farClip)}var n=this.node.getPosition(),i=this.node.getRotation();tmpView.setTRS(n,i,pc.Vec3.ONE).invert(),tmpView.transformPoint(planePosWM,planePosV),tmpView.transformVector(planeNormalWM,planeNormalV).normalize(),planeAV=planeNormalV.x,planeBV=planeNormalV.y,planeCV=planeNormalV.z,planeDV=-planePosV.dot(planeNormalV),planeV.set(planeAV,planeBV,planeCV,planeDV),projInv.copy(e).invert(),planeQ.set(sgn(planeAV),sgn(planeBV),1,1),projInv.transformVec4(planeQ,planeQ),planeV.scale(2/planeV.dot(planeQ));var s=e.data;s[2]=planeV.x-s[3],s[6]=planeV.y-s[7],s[10]=planeV.z-s[11],s[14]=planeV.w-s[15]}function sgn(e){return e>0?1:e<0?-1:0}var UranusEffectsMaterialTextureMix=pc.createScript("uranusEffectsMaterialTextureMix");UranusEffectsMaterialTextureMix.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsMaterialTextureMix.attributes.add("materialAsset",{type:"asset",assetType:"material"}),UranusEffectsMaterialTextureMix.attributes.add("mixChannel",{type:"string",default:"diffusePS",enum:[{Diffuse:"diffusePS"},{Emissive:"emissivePS"}]}),UranusEffectsMaterialTextureMix.attributes.add("mixTextureA",{type:"asset",assetType:"texture",title:"Mix Texture A",description:"The texture to mix from based on the alpha value provided."}),UranusEffectsMaterialTextureMix.attributes.add("mixTextureB",{type:"asset",assetType:"texture",title:"Mix Texture B",description:"The texture to mix to based on the alpha value provided."}),UranusEffectsMaterialTextureMix.attributes.add("mixAlpha",{type:"number",default:.5,min:0,max:1,title:"Mix Alpha",description:"The alpha value used to mix the base and mix textures."}),UranusEffectsMaterialTextureMix.attributes.add("animateEvent",{type:"string",default:"",title:"Animate Event",description:"An app wide animation event that can be called with a true/false argument and animate the transition."}),UranusEffectsMaterialTextureMix.attributes.add("animateTime",{type:"number",default:1,title:"Animate Time",description:"The time it takes to animate a full transition when the animate event is called."}),UranusEffectsMaterialTextureMix.prototype.initialize=function(){this.materialAsset.ready((()=>this.updateMaterial(this.materialAsset.resource))),this.materialAsset.on("change",(()=>this.updateMaterial(this.materialAsset.resource))),UranusUtilities.loadAsset(this.materialAsset),this.app.on(this.animateEvent,this.onAnimate,this),this.on("attr",(function(){this.updateAttributes(this.materialAsset.resource)})),this.on("state",(function(e){e?this.updateMaterial(this.materialAsset.resource):this.clearMaterial(this.materialAsset.resource)}))},UranusEffectsMaterialTextureMix.prototype.updateMaterial=function(e){const t=this.getShader();if(!t)return!1;e.chunks[this.mixChannel]=t,e.chunks.APIVersion=pc.CHUNKAPI_1_58,e.update(),this.updateAttributes(e)},UranusEffectsMaterialTextureMix.prototype.getShader=function(){const e="\nuniform sampler2D texture_mixTextureA;\nuniform sampler2D texture_mixTextureB;\nuniform float mixAlpha;\n    ";switch(this.mixChannel){case"diffusePS":return`\n${e}\n#ifdef MAPCOLOR\nc\n#endif\n\nvoid getAlbedo() {\n    dAlbedo = vec3(1.0);\n\n#ifdef MAPCOLOR\n    dAlbedo *= material_diffuse.rgb;\n#endif\n\n#ifdef MAPTEXTURE\n    vec3 albedoBase1 = $DECODE(texture2DBias(texture_mixTextureA, $UV, textureBias)).$CH;\n    vec3 albedoBase2 = $DECODE(texture2DBias(texture_mixTextureB, $UV, textureBias)).$CH;\n\n    vec3 albedoBase = mix(albedoBase1, albedoBase2, mixAlpha);\n\n    dAlbedo *= addAlbedoDetail(albedoBase);\n#endif\n\n#ifdef MAPVERTEX\n    dAlbedo *= gammaCorrectInput(saturate(vVertexColor.$VC));\n#endif\n}        \n        `;case"emissivePS":return`\n${e}\n#ifdef MAPCOLOR\nuniform vec3 material_emissive;\n#endif\n\n#ifdef MAPFLOAT\nuniform float material_emissiveIntensity;\n#endif\n\nvoid getEmission() {\n    dEmission = vec3(1.0);\n\n    #ifdef MAPFLOAT\n    dEmission *= material_emissiveIntensity;\n    #endif\n\n    #ifdef MAPCOLOR\n    dEmission *= material_emissive;\n    #endif\n\n    #ifdef MAPTEXTURE\n    vec3 emissionBase1 = $DECODE(texture2DBias(texture_mixTextureA, $UV, textureBias)).$CH;\n    vec3 emissionBase2 = $DECODE(texture2DBias(texture_mixTextureB, $UV, textureBias)).$CH;\n\n    vec3 emissionBase = mix(emissionBase1, emissionBase2, mixAlpha);\n\n    dEmission *= emissionBase;\n    #endif\n\n    #ifdef MAPVERTEX\n    dEmission *= gammaCorrectInput(saturate(vVertexColor.$VC));\n    #endif\n}        \n        `}},UranusEffectsMaterialTextureMix.prototype.clearMaterial=function(e){e&&(delete e.chunks[this.mixChannel],e.update())},UranusEffectsMaterialTextureMix.prototype.updateAttributes=async function(e){if(!this.mixTextureA.loaded||!this.mixTextureB.loaded){const t=this.app.assets.find("texture-white.jpg");e.setParameter("texture_mixTextureA",t.resource),e.setParameter("texture_mixTextureB",t.resource),await UranusUtilities.loadAssets([this.mixTextureA,this.mixTextureB])}e.setParameter("texture_mixTextureA",this.mixTextureA.resource),e.setParameter("texture_mixTextureB",this.mixTextureB.resource),e.setParameter("mixAlpha",this.mixAlpha)},UranusEffectsMaterialTextureMix.prototype.onAnimate=function(e){const t=this.materialAsset?.resource;if(!t)return;this.animateTween&&this.animateTween.stop();const i={alpha:this.mixAlpha};this.animateTween=this.app.tween(i).to({alpha:e},this.animateTime,pc.SineInOut).onUpdate((()=>{this.mixAlpha=i.alpha,t.setParameter("mixAlpha",i.alpha)})).onComplete((()=>{this.mixAlpha=e,this.animateTween=void 0})).start()};var UranusEffectsEnvironmentSnow=pc.createScript("uranusEffectsEnvironmentSnow");UranusEffectsEnvironmentSnow.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsEnvironmentSnow.attributes.add("snowColor",{type:"rgb",default:[1,1,1],title:"Snow Color",description:"The snow color."}),UranusEffectsEnvironmentSnow.attributes.add("snowThreshold",{type:"number",default:.01,min:0,max:1,precision:5,title:"Snow Threshold",description:"The slope threshold to apply on each surface based on the pixel normal."}),UranusEffectsEnvironmentSnow.attributes.add("snowNoise",{type:"asset",assetType:"texture",title:"Snow Noise",description:"A noise texture to make the transition towards snow more natural."}),UranusEffectsEnvironmentSnow.attributes.add("snowNoiseScale",{type:"number",default:1,title:"Snow Noise Scale"}),UranusEffectsEnvironmentSnow.attributes.add("snowNoiseBorder",{type:"number",default:.5,min:0,max:1,precision:4,title:"Snow Noise Border"}),UranusEffectsEnvironmentSnow.attributes.add("snowWaterLevel",{type:"number",default:-100,title:"Snow Water Level",description:"The Y axis position below which there will be no snow."}),UranusEffectsEnvironmentSnow.attributes.add("snowWaterBorder",{type:"number",default:10,title:"Snow Water Border",description:"Affects the size of the snow border with the water level."}),UranusEffectsEnvironmentSnow.attributes.add("disableOnSkin",{type:"boolean",default:!0,title:"Disable On Skin",description:"If selected no snow will be rendered on skinned (animated) models. Requires restart."}),UranusEffectsEnvironmentSnow.attributes.add("materialAssets",{type:"asset",assetType:"material",array:!0,title:"Material Assets",description:"If one or more materials are provided the effect will be only applied to these materials, instead of globally."}),UranusEffectsEnvironmentSnow.attributes.add("disableMaterialTag",{type:"string",default:"uranus-environment-snow-disable",title:"Disable Material Tag",description:"Use this tag on your material assets to exclude them from rendering snow, when applying the effect globally."}),UranusEffectsEnvironmentSnow.prototype.initialize=function(){this.scopeSnowColor=this.app.graphicsDevice.scope.resolve("snowColor"),this.scopeSnowThreshold=this.app.graphicsDevice.scope.resolve("snowThreshold"),this.scopeSnowNoise=this.app.graphicsDevice.scope.resolve("snowNoise"),this.scopeSnowNoiseScale=this.app.graphicsDevice.scope.resolve("snowNoiseScale"),this.scopeSnowNoiseBorder=this.app.graphicsDevice.scope.resolve("snowNoiseBorder"),this.scopeSnowWaterLevel=this.app.graphicsDevice.scope.resolve("snowWaterLevel"),this.scopeSnowWaterBorder=this.app.graphicsDevice.scope.resolve("snowWaterBorder"),this.prepare(),this.on("attr",this.updateAttributes)},UranusEffectsEnvironmentSnow.prototype.updateAttributes=async function(){this.scopeSnowColor.setValue(this.snowColor.data3),this.scopeSnowThreshold.setValue(1-this.snowThreshold),this.scopeSnowNoise.setValue(this.snowNoise.resource),this.scopeSnowNoiseScale.setValue(.01*this.snowNoiseScale),this.scopeSnowNoiseBorder.setValue(this.snowNoiseBorder),this.scopeSnowWaterLevel.setValue(this.snowWaterLevel),this.scopeSnowWaterBorder.setValue(this.snowWaterBorder)},UranusEffectsEnvironmentSnow.startVS_orig=pc.shaderChunks.startVS,UranusEffectsEnvironmentSnow.combinePS_orig=pc.shaderChunks.combinePS,UranusEffectsEnvironmentSnow.prototype.prepare=function(){this.disableOnSkin&&(pc.shaderChunks.startVS=this.getStart());const e=this.getCombine();if(this.updateAttributes(),this.materialAssets.length>0)this.materialAssets.forEach((n=>{n.resource.onUpdateShader=function(n){return n.chunks.combinePS=e,n}}));else{pc.shaderChunks.combinePS=e;this.app.assets.findByTag(this.disableMaterialTag).map((e=>e.resource)).forEach((e=>{e.onUpdateShader=function(e){return e.chunks.startVS=UranusEffectsEnvironmentSnow.startVS_orig,e.chunks.combinePS=UranusEffectsEnvironmentSnow.combinePS_orig,e}}))}},UranusEffectsEnvironmentSnow.prototype.getStart=function(){return"\nvarying float vHasSkin;\n\nvoid main(void) {\n    gl_Position = getPosition();\n\n    #ifdef SKIN\n    vHasSkin = 1.0;\n    #endif\n"},UranusEffectsEnvironmentSnow.prototype.getCombine=function(){return`\n${this.disableOnSkin?"varying float vHasSkin;":""}\n\nuniform vec3 snowColor;\nuniform float snowThreshold;\nuniform sampler2D snowNoise;\nuniform float snowNoiseScale;\nuniform float snowNoiseBorder;\nuniform float snowWaterLevel;\nuniform float snowWaterBorder;\n\nfloat noise(vec2 uv)\n{\n    return texture2D(snowNoise,uv).r;\n}\n\nvec3 combineColor(vec3 albedo, vec3 sheenSpecularity, float clearcoatSpecularity) {\n    vec3 ret = vec3(0);\n\n#ifdef LIT_SPECULAR\n    // add snow up to a certain angle\n    float snowReflectionFactor = 1.0;\n\n    if(snowThreshold < 1.0 \n        ${this.disableOnSkin?"&& vHasSkin <= 0.5":""}\n    ){\n        float normal = saturate(dNormalW.y);\n\n        float noise = noise(vPositionW.xz * snowNoiseScale) * snowNoiseBorder;\n        float slope = smoothstep(snowThreshold - noise, snowThreshold, normal);\n        float snowToWater = smoothstep(snowWaterLevel - noise * snowWaterBorder, snowWaterLevel, vPositionW.y);\n\n        float snowFactor = saturate(slope * snowToWater);\n        snowReflectionFactor -= snowFactor;\n\n        albedo = mix(albedo, snowColor, snowFactor);\n    }\n#endif\n\n#ifdef LIT_OLD_AMBIENT\n    ret += (dDiffuseLight - light_globalAmbient) * albedo + material_ambient * light_globalAmbient;\n#else\n    ret += albedo * dDiffuseLight;\n#endif\n#ifdef LIT_SPECULAR\n    ret += dSpecularLight * snowReflectionFactor;\n#endif\n#ifdef LIT_REFLECTIONS\n    ret += dReflection.rgb * dReflection.a * snowReflectionFactor;\n#endif\n\n#ifdef LIT_SHEEN\n    float sheenScaling = 1.0 - max(max(sheenSpecularity.r, sheenSpecularity.g), sheenSpecularity.b) * 0.157;\n    ret = ret * sheenScaling + (sSpecularLight + sReflection.rgb) * sheenSpecularity;\n#endif\n#ifdef LIT_CLEARCOAT\n    float clearCoatScaling = 1.0 - ccFresnel * clearcoatSpecularity;\n    ret = ret * clearCoatScaling + (ccSpecularLight + ccReflection.rgb) * clearcoatSpecularity;\n#endif\n\n    return ret;\n}\n`};var UranusEffectsEnvironmentFog=pc.createScript("uranusEffectsEnvironmentFog");UranusEffectsEnvironmentFog.attributes.add("inEditor",{type:"boolean",default:!0}),UranusEffectsEnvironmentFog.attributes.add("fogCubemapColor",{type:"boolean",default:!0,title:"Cubemap Color"}),UranusEffectsEnvironmentFog.attributes.add("fogDensityMax",{type:"number",default:.75,min:0,max:1,title:"Fog Density Max"}),UranusEffectsEnvironmentFog.attributes.add("fogScattering",{type:"vec2",default:[.05,25],title:"Scattering"}),UranusEffectsEnvironmentFog.attributes.add("fogScatteringHeight",{type:"number",default:0,title:"Scattering Height"}),UranusEffectsEnvironmentFog.attributes.add("fogScatteringDistance",{type:"number",default:1e3,title:"Scattering Distance"}),UranusEffectsEnvironmentFog.attributes.add("fogNoise",{type:"boolean",default:!0,title:"Noise"}),UranusEffectsEnvironmentFog.attributes.add("fogNoiseScale",{type:"number",default:.0015,title:"Noise Scale"}),UranusEffectsEnvironmentFog.attributes.add("fogNoiseDistance",{type:"number",default:250,title:"Noise Distance"}),UranusEffectsEnvironmentFog.attributes.add("fogNoiseSpeed",{type:"number",default:50,title:"Noise Speed"}),UranusEffectsEnvironmentFog.attributes.add("fogNoiseOctaves",{type:"number",default:5,title:"Noise Octaves"}),UranusEffectsEnvironmentFog.prototype.initialize=function(){this.fogTime=0,this.scopeFogTime=this.app.graphicsDevice.scope.resolve("fogTime"),this.scopeFogDensityMax=this.app.graphicsDevice.scope.resolve("fogDensityMax"),this.scopeFogScattering=this.app.graphicsDevice.scope.resolve("fogScattering"),this.scopeFogScatteringHeight=this.app.graphicsDevice.scope.resolve("fogScatteringHeight"),this.scopeFogScatteringDistance=this.app.graphicsDevice.scope.resolve("fogScatteringDistance"),this.scopeFogNoiseScale=this.app.graphicsDevice.scope.resolve("fogNoiseScale"),this.scopeFogNoiseDistance=this.app.graphicsDevice.scope.resolve("fogNoiseDistance"),this.scopeFogNoiseSpeed=this.app.graphicsDevice.scope.resolve("fogNoiseSpeed"),this.prepare(),this.on("attr",this.updateAttributes)},UranusEffectsEnvironmentFog.prototype.updateAttributes=function(){this.scopeFogDensityMax.setValue(this.fogDensityMax),this.scopeFogScattering.setValue([this.fogScattering.x,this.fogScattering.y]),this.scopeFogScatteringHeight.setValue(this.fogScatteringHeight),this.scopeFogScatteringDistance.setValue(this.fogScatteringDistance),this.scopeFogNoiseScale.setValue(this.fogNoiseScale),this.scopeFogNoiseDistance.setValue(this.fogNoiseDistance)},void 0===UranusEffectsEnvironmentFog.overridenGlobalChunks&&(UranusEffectsEnvironmentFog.overridenGlobalChunks=!1),UranusEffectsEnvironmentFog.prototype.prepare=function(){UranusEffectsEnvironmentFog.overridenGlobalChunks||(UranusEffectsEnvironmentFog.overridenGlobalChunks=!0,pc.shaderChunks.basePS=this.basePS(),this.fogCubemapColor&&(pc.shaderChunks.ambientEnvPS=this.ambientEnvPS()),pc.shaderChunks.fogExp2PS=this.fogExp2PS(),pc.shaderChunks.particle_initVS=this.particle_initVS(),pc.shaderChunks.particle_cpuVS=this.particle_cpuVS(),pc.shaderChunks.particle_endVS=this.particle_endVS()),this.updateAttributes()},UranusEffectsEnvironmentFog.prototype.update=function(e){this.fogNoise&&(this.fogTime+=e*this.fogNoiseSpeed,this.scopeFogTime.setValue(this.fogTime))},UranusEffectsEnvironmentFog.prototype.basePS=function(){return`\nvec3 dEnvironmentAmbient;\n\n${pc.shaderChunks.basePS}\n`},UranusEffectsEnvironmentFog.prototype.ambientEnvPS=function(){return"\n#ifndef ENV_ATLAS\n#define ENV_ATLAS\nuniform sampler2D texture_envAtlas;\n#endif\n\nvoid addAmbient(vec3 worldNormal) {\n    vec3 dir = normalize(cubeMapRotate(worldNormal) * vec3(-1.0, 1.0, 1.0));\n    vec2 uv = mapUv(toSphericalUv(dir), vec4(128.0, 256.0 + 128.0, 64.0, 32.0) / atlasSize);\n\n    vec4 raw = texture2D(texture_envAtlas, uv);\n    vec3 linear = $DECODE(raw);\n\n    dDiffuseLight += processEnvironment(linear);\n\n    // --- calculate ambient for environment fog\n    vec2 uv1 = vec2(0.5, 0.25); // sample a horizon pixel\n\n    vec4 raw1 = texture2D(texture_envAtlas, uv1);\n    vec3 linear1 = $DECODE(raw1);\n    \n    dEnvironmentAmbient = processEnvironment(linear1);\n}    \n"},UranusEffectsEnvironmentFog.prototype.fogExp2PS=function(){return`\n#ifdef PARTICLE\nvarying vec3 vPositionW;\nvec3 dEnvironmentAmbient = vec3(1.0, 1.0, 1.0);\nuniform vec3 view_position;\n#endif\n\nuniform float fogTime;\nuniform float fogDensityMax;\nuniform vec2 fogScattering;\nuniform float fogScatteringHeight;\nuniform float fogScatteringDistance;\n\nuniform vec3 fog_color;\nuniform float fog_density;\nfloat dBlendModeFogFactor = 1.0;\n\n${this.fogNoise?`\nuniform float fogNoiseScale;\nuniform float fogNoiseDistance;\n\nfloat noise_simplex_3D( vec3 P )\n{\n    //  https://github.com/BrianSharpe/Wombat/blob/master/SimplexPerlin3D.glsl\n\n    //  simplex math constants\n    const float SKEWFACTOR = 1.0/3.0;\n    const float UNSKEWFACTOR = 1.0/6.0;\n    const float SIMPLEX_CORNER_POS = 0.5;\n    const float SIMPLEX_TETRAHEDRON_HEIGHT = 0.70710678118654752440084436210485;    // sqrt( 0.5 )\n\n    //  establish our grid cell.\n    P *= SIMPLEX_TETRAHEDRON_HEIGHT;    // scale space so we can have an approx feature size of 1.0\n    vec3 Pi = floor( P + dot( P, vec3( SKEWFACTOR) ) );\n\n    //  Find the vectors to the corners of our simplex tetrahedron\n    vec3 x0 = P - Pi + dot(Pi, vec3( UNSKEWFACTOR ) );\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 Pi_1 = min( g.xyz, l.zxy );\n    vec3 Pi_2 = max( g.xyz, l.zxy );\n    vec3 x1 = x0 - Pi_1 + UNSKEWFACTOR;\n    vec3 x2 = x0 - Pi_2 + SKEWFACTOR;\n    vec3 x3 = x0 - SIMPLEX_CORNER_POS;\n\n    //  pack them into a parallel-friendly arrangement\n    vec4 v1234_x = vec4( x0.x, x1.x, x2.x, x3.x );\n    vec4 v1234_y = vec4( x0.y, x1.y, x2.y, x3.y );\n    vec4 v1234_z = vec4( x0.z, x1.z, x2.z, x3.z );\n\n    // clamp the domain of our grid cell\n    Pi.xyz = Pi.xyz - floor(Pi.xyz * ( 1.0 / 69.0 )) * 69.0;\n    vec3 Pi_inc1 = step( Pi, vec3( 69.0 - 1.5 ) ) * ( Pi + 1.0 );\n\n    //\tgenerate the random vectors\n    vec4 Pt = vec4( Pi.xy, Pi_inc1.xy ) + vec2( 50.0, 161.0 ).xyxy;\n    Pt *= Pt;\n    vec4 V1xy_V2xy = mix( Pt.xyxy, Pt.zwzw, vec4( Pi_1.xy, Pi_2.xy ) );\n    Pt = vec4( Pt.x, V1xy_V2xy.xz, Pt.z ) * vec4( Pt.y, V1xy_V2xy.yw, Pt.w );\n    const vec3 SOMELARGEFLOATS = vec3( 635.298681, 682.357502, 668.926525 );\n    const vec3 ZINC = vec3( 48.500388, 65.294118, 63.934599 );\n    vec3 lowz_mods = vec3( 1.0 / ( SOMELARGEFLOATS.xyz + Pi.zzz * ZINC.xyz ) );\n    vec3 highz_mods = vec3( 1.0 / ( SOMELARGEFLOATS.xyz + Pi_inc1.zzz * ZINC.xyz ) );\n    Pi_1 = ( Pi_1.z < 0.5 ) ? lowz_mods : highz_mods;\n    Pi_2 = ( Pi_2.z < 0.5 ) ? lowz_mods : highz_mods;\n    vec4 hash_0 = fract( Pt * vec4( lowz_mods.x, Pi_1.x, Pi_2.x, highz_mods.x ) ) - 0.49999;\n    vec4 hash_1 = fract( Pt * vec4( lowz_mods.y, Pi_1.y, Pi_2.y, highz_mods.y ) ) - 0.49999;\n    vec4 hash_2 = fract( Pt * vec4( lowz_mods.z, Pi_1.z, Pi_2.z, highz_mods.z ) ) - 0.49999;\n\n    //\tevaluate gradients\n    vec4 grad_results = inversesqrt( hash_0 * hash_0 + hash_1 * hash_1 + hash_2 * hash_2 ) * ( hash_0 * v1234_x + hash_1 * v1234_y + hash_2 * v1234_z );\n\n    //\tNormalization factor to scale the final result to a strict 1.0->-1.0 range\n    //\thttp://briansharpe.wordpress.com/2012/01/13/simplex-noise/#comment-36\n    const float FINAL_NORMALIZATION = 37.837227241611314102871574478976;\n\n    //  evaulate the kernel weights ( use (0.5-x*x)^3 instead of (0.6-x*x)^4 to fix discontinuities )\n    vec4 kernel_weights = v1234_x * v1234_x + v1234_y * v1234_y + v1234_z * v1234_z;\n    kernel_weights = max(0.5 - kernel_weights, 0.0);\n    kernel_weights = kernel_weights*kernel_weights*kernel_weights;\n\n    //\tsum with the kernel and return\n    return dot( kernel_weights, grad_results ) * FINAL_NORMALIZATION;\n}\n\nfloat fog_FBM(vec3 p) {\n  float value = 0.0;\n  float amplitude = 0.5;\n  float frequency = 0.0;\n  for (int i = 0; i < ${Math.trunc(this.fogNoiseOctaves)}; ++i) {\n    value += amplitude * noise_simplex_3D(p);\n    p *= 2.0;\n    amplitude *= 0.5;\n  }\n  return value;\n}\n`:""}\n\nvec3 addFog(vec3 color) {\n\n    float depth = distance(view_position, vPositionW);\n\n    ${this.fogNoise?"\n    vec3 noisePos = vPositionW * fogNoiseScale + vec3(0.0, 0.0, fogTime * fogNoiseScale * 0.1);\n    float noiseSample = fog_FBM(noisePos + fog_FBM(noisePos)) * 0.5 + 0.5;\n    float fogDepth = depth * mix(noiseSample, 1.0, clamp((depth - fogNoiseDistance) / fogNoiseDistance, 0.0, 1.0));    \n    ":"\n    float fogDepth = depth;\n    "}\n\n    fogDepth *= fogDepth;\n\n    float fogAmount = fog_density * fog_density;\n\n    float scattering = fogScattering.x + fogScattering.y * clamp((depth - fogScatteringDistance) / fogScatteringDistance, 0.0, 1.0);\n\n    // --- calculate height based fog\n    float worldPosY = max( abs(vPositionW.y - fogScatteringHeight), 0.01);\n\n    float fogFactor = scattering * exp(-worldPosY * fogAmount) * (1.0 - exp(-fogDepth * fogAmount * worldPosY)) / worldPosY;\n    fogFactor = min(fogDensityMax, fogFactor);\n\n    fogFactor = clamp(1.0 - fogFactor, 0.0, 1.0);\n\n    return mix(${this.fogCubemapColor?"dEnvironmentAmbient * ":""} dBlendModeFogFactor * fog_color, color, fogFactor);\n}\n`},UranusEffectsEnvironmentFog.prototype.particle_initVS=function(){return`\n${pc.shaderChunks.particle_initVS}\n\nvarying vec3 vPositionW;\n`},UranusEffectsEnvironmentFog.prototype.particle_cpuVS=function(){return`\nvarying vec3 vPositionW;\n\n${pc.shaderChunks.particle_cpuVS}\n`},UranusEffectsEnvironmentFog.prototype.particle_endVS=function(){return`\n  ${pc.shaderChunks.particle_endVS} \n\n  vPositionW = gl_Position.xyz;\n`};function HueSaturationEffect(t){pc.PostEffect.call(this,t),this.shader=new pc.Shader(t,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:["precision "+t.precision+" float;","","uniform sampler2D uColorBuffer;","uniform float uHue;","uniform float uSaturation;","","varying vec2 vUv0;","","void main() {","    gl_FragColor = texture2D( uColorBuffer, vUv0 );","","    float angle = uHue * 3.14159265;","    float s = sin(angle), c = cos(angle);","    vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","    float len = length(gl_FragColor.rgb);","    gl_FragColor.rgb = vec3(","        dot(gl_FragColor.rgb, weights.xyz),","        dot(gl_FragColor.rgb, weights.zxy),","        dot(gl_FragColor.rgb, weights.yzx)","    );","","    float average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","    if (uSaturation > 0.0) {","        gl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - uSaturation));","    } else {","        gl_FragColor.rgb += (average - gl_FragColor.rgb) * (-uSaturation);","    }","}"].join("\n")}),this.hue=0,this.saturation=0}HueSaturationEffect.prototype=Object.create(pc.PostEffect.prototype),HueSaturationEffect.prototype.constructor=HueSaturationEffect,Object.assign(HueSaturationEffect.prototype,{render:function(t,e,r){var a=this.device,o=a.scope;o.resolve("uHue").setValue(this.hue),o.resolve("uSaturation").setValue(this.saturation),o.resolve("uColorBuffer").setValue(t.colorBuffer),pc.drawFullscreenQuad(a,e,this.vertexBuffer,this.shader,r)}});var HueSaturation=pc.createScript("hueSaturation");HueSaturation.attributes.add("hue",{type:"number",default:0,min:-1,max:1,title:"Hue"}),HueSaturation.attributes.add("saturation",{type:"number",default:0,min:-1,max:1,title:"Saturation"}),HueSaturation.prototype.initialize=function(){this.effect=new HueSaturationEffect(this.app.graphicsDevice),this.effect.hue=this.hue,this.effect.saturation=this.saturation,this.on("attr",(function(t,e){this.effect[t]=e}),this);var t=this.entity.camera.postEffects;t.addEffect(this.effect),this.on("state",(function(e){e?t.addEffect(this.effect):t.removeEffect(this.effect)})),this.on("destroy",(function(){t.removeEffect(this.effect)}))};!function(t,r,o){var i,u=256,f="random",a=o.pow(u,6),c=o.pow(2,52),s=2*c,l=255;function n(l,p,d){function e(){for(var t=h.g(6),r=a,o=0;t<c;)t=(t+o)*u,r*=u,o=h.g(1);for(;s<=t;)t/=2,r/=2,o>>>=1;return(t+o)/r}var g=[],y=j(function n(t,r){var o,i=[],u=typeof t;if(r&&"object"==u)for(o in t)try{i.push(n(t[o],r-1))}catch(n){}return i.length?i:"string"==u?t:t+"\0"}((p=1==p?{entropy:!0}:p||{}).entropy?[l,S(r)]:null==l?function(){try{var o;return i&&(o=i.randomBytes)?o=o(u):(o=new Uint8Array(u),(t.crypto||t.msCrypto).getRandomValues(o)),S(o)}catch(o){var f=t.navigator,a=f&&f.plugins;return[+new Date,t,a,t.screen,S(r)]}}():l,3),g),h=new m(g);return e.int32=function(){return 0|h.g(4)},e.quick=function(){return h.g(4)/4294967296},e.double=e,j(S(h.S),r),(p.pass||d||function(t,r,i,u){return u&&(u.S&&v(u,h),t.state=function(){return v(h,{})}),i?(o[f]=t,r):t})(e,y,"global"in p?p.global:this==o,p.state)}function m(t){var r,o=t.length,i=this,f=0,a=i.i=i.j=0,c=i.S=[];for(o||(t=[o++]);f<u;)c[f]=f++;for(f=0;f<u;f++)c[f]=c[a=l&a+t[f%o]+(r=c[f])],c[a]=r;(i.g=function(t){for(var r,o=0,f=i.i,a=i.j,c=i.S;t--;)r=c[f=l&f+1],o=o*u+c[l&(c[f]=c[a=l&a+r])+(c[a]=r)];return i.i=f,i.j=a,o})(u)}function v(t,r){return r.i=t.i,r.j=t.j,r.S=t.S.slice(),r}function j(t,r){for(var o,i=t+"",u=0;u<i.length;)r[l&u]=l&(o^=19*r[l&u])+i.charCodeAt(u++);return S(r)}function S(t){return String.fromCharCode.apply(0,t)}if(j(o.random(),r),"object"==typeof module&&module.exports){module.exports=n;try{i=require("crypto")}catch(n){}}else"function"==typeof define&&define.amd?define((function(){return n})):o["seed"+f]=n}("undefined"!=typeof self?self:this,[],Math);var UranusInstancerCell=pc.createScript("uranusInstancerCell");UranusInstancerCell.attributes.add("inEditor",{type:"boolean",default:!0}),UranusInstancerCell.attributes.add("cellSize",{type:"vec3",default:[10,10,10],title:"Cell Size",description:"The size of the cell in the frustum culling grid. Only static instances support cell based culling. Minimum cell side size is 1."}),UranusInstancerCell.attributes.add("updateFrequency",{type:"number",default:0,title:"Update Frequency",description:"Set how often in seconds culling updates will execute for this cell. To disable this check and execute it per frame set it to 0."}),UranusInstancerCell.attributes.add("updateShadowsFrequency",{type:"number",default:0,title:"Update Shadows Frequency",description:"Set how often in seconds culling shadows updates will execute for this cell. To disable this check and execute it per frame set it to 0."}),UranusInstancerCell.attributes.add("isDynamic",{type:"boolean",default:!1,title:"Is Dynamic",description:"If selected all entities in each cell will update their world transform matrix. Useful for animating instances while in a cell. Note if an instanced changes its position to be outside its initial cell, it will not change cell automatically."}),UranusInstancerCell.prototype.addInstanceToPayload=function(e,t,n,s){const l=e.entity,a=e.cullPosition?e.cullPosition:l.getPosition(),r=this.getCellFromPosition(a,t,s);t&&!t.singleInstance&&r.instances.push(e);const i=r.buffer,c=e.data?e.data:n.getWorldTransform().data;let o=i.length;e.cell=r;const u=e.lodScript;u&&(r.lodScript=u),void 0===r.hasEntities&&l&&(r.hasEntities=!0),l&&(l.uranusInstancerCells||(l.uranusInstancerCells=[]),-1===l.uranusInstancerCells.indexOf(r)&&l.uranusInstancerCells.push(r));for(let e=0;e<16;e++)i[o++]=c[e]},UranusInstancerCell.prototype.removeInstanceFromPayload=function(e,t){const n=e.cell;if(!n)return;const s=n.instances.indexOf(e);s>-1&&(n.instances.splice(s,1),Array.isArray(n.buffer)&&n.buffer.splice(16*s,16)),0===n.instances.length&&t.cells.delete(n.id)},UranusInstancerCell.vec=new pc.Vec3,UranusInstancerCell.prototype.getPositionOnGrid=function(e,t){const n=Math.max(t.x,1),s=Math.max(t.y,1),l=Math.max(t.z,1),a=Math.floor(e.x/n)*n,r=Math.floor(e.y/s)*s,i=Math.floor(e.z/l)*l;return UranusInstancerCell.vec.set(a,r,i)},UranusInstancerCell.prototype.getCellGuid=function(e,t,n,s){return e.toFixed(0)+"_"+t.toFixed(0)+"_"+n.toFixed(0)+"-"+s.x+"_"+s.y+"_"+s.z},UranusInstancerCell.prototype.calculateCellBounding=function(e,t){const n=new pc.BoundingBox,s=n.halfExtents.copy(pc.Vec3.ZERO);s.x+=t.x/2,s.y+=t.y/2,s.z+=t.z/2;const l=n.center.copy(e);return l.x+=s.x,l.y+=s.y,l.z+=s.z,n},UranusInstancerCell.prototype.getCellFromPosition=function(e,t,n){const s=Math.max(n.x,1),l=Math.max(n.y,1),a=Math.max(n.z,1),r=Math.floor(e.x/s)*s,i=Math.floor(e.y/l)*l,c=Math.floor(e.z/a)*a,o=this.getCellGuid(r,i,c,n);t.cells||(t.cells=new Map);let u=t.cells.get(o);if(!u){const e=t.refBoundingBox.halfExtents,s=new pc.Vec3;s.x+=n.x/2+e.x/2,s.y+=n.y/2+e.y/2,s.z+=n.z/2+e.z/2;const l=2*Math.max(s.x,s.y,s.z),a=s.clone();a.x+=r,a.y+=i,a.z+=c,u=UranusInstancerCell.prototype.createCell(o,a,s,l,t)}return u},UranusInstancerCell.prototype.createCell=function(e,t,n,s,l){const a={aabb:new pc.BoundingBox(t,n),center:t,radius:s,buffer:[],id:e,instances:!1===l.singleInstance?[]:void 0,refLodIndices:[]};return l.cells.set(e,a),l.shadowCaster&&(l.shouldUpdateShadows=2),a},UranusInstancerCell.tempSphere=new pc.BoundingSphere,UranusInstancerCell.cellsVisCache=new Map,UranusInstancerCell.prototype.isVisible=function(e,t,n){let s=UranusInstancerCell.cellsVisCache.get(e.id);if(s||(s={camera:void 0,layer:void 0,dirty:!0,visible:!1},UranusInstancerCell.cellsVisCache.set(e.id,s)),s.dirty||s.camera!==t||s.layer!==n){s.camera=t,s.layer=n,s.dirty=!1;const l=UranusInstancerCell.tempSphere;l.center=e.center,l.radius=1.75*e.radius;const a=t.frustum.containsSphere(l);s.visible=a>0}return s.visible},UranusInstancerCell.prototype.updateInstancerCell=function(e){e.forEach((e=>{const t=e.entity.uranusInstancerCells;if(!t)return!0;t.forEach((e=>e.entityMoved=!0))}))};var UranusInstancerLod=pc.createScript("uranusInstancerLod");UranusInstancerLod.attributes.add("inEditor",{type:"boolean",default:!0}),UranusInstancerLod.LAYER_TYPE_ALL="all",UranusInstancerLod.LAYER_TYPE_MODEL="model",UranusInstancerLod.LAYER_TYPE_SHADOW="shadow",UranusInstancerLod.attributes.add("lodLevels",{type:"json",title:"Lod Levels",array:!0,schema:[{name:"index",type:"number",default:0,precision:0,min:0,max:9,description:"The LOD index for this level e.g. 0 for LOD0, 1 for LOD1."},{name:"layer",type:"string",description:"Add an optional layer name to specify a LOD level for this layer only. If left blank it will be used for any layer."},{name:"layerType",type:"string",default:UranusInstancerLod.LAYER_TYPE_ALL,enum:[{All:UranusInstancerLod.LAYER_TYPE_ALL},{Model:UranusInstancerLod.LAYER_TYPE_MODEL},{Shadow:UranusInstancerLod.LAYER_TYPE_SHADOW}],description:"Set what type of payloads this LOD level will apply to. If left blank it will be used for any type."},{name:"start",type:"number",default:0,description:"Starting from this distance from the camera this level of detail will be visible."},{name:"end",type:"number",default:0,description:"After this distance from the camera this level of detail will be hidden. Use 0 to keep it enabled infinitely."}]}),UranusInstancerLod.attributes.add("proxyMesh",{type:"entity",title:"Proxy Mesh",description:"If an entity is referenced, as soon as its model level of detail is visible, this entity model will be hidden. Useful for hierarchical LODs. The referenced entity needs to have an instanced model rendered."}),UranusInstancerLod.attributes.add("skipShadowsLod",{type:"boolean",default:!1,title:"Skip Shadows LOD",description:"If selected all shadowcaster instances will skip any LOD check. Useful for rendering shadows for a lower level of detail, to lower polycount. You can control which LOD casts shadows by using the model/render component Cast Shadows property."}),UranusInstancerLod.attributes.add("skipShadowsOffset",{type:"number",default:0,title:"Skip Shadows Offset",description:"If Skip Shadows LOD is selected you can define an offset on the Y axis to adjust the rendering position of the LOD shadowcaster. Useful for removing self shadowing artifacts when rendering shadows on a level of detail with a different polycount."}),UranusInstancerLod.prototype.initialize=function(){this.lodLevelsFiltered={},this.hasCustomShadowLod=!1},UranusInstancerLod.prototype.prepareLodLevels=function(e){const t={};this.lodLevels.forEach((e=>{const n=e.layer?e.layer:"";if(e.layerType===UranusInstancerLod.LAYER_TYPE_ALL){let s=`${n}_${UranusInstancerLod.LAYER_TYPE_MODEL}`;t[s]||(t[s]=[]),t[s][e.index]=e,s=`${n}_${UranusInstancerLod.LAYER_TYPE_SHADOW}`,t[s]||(t[s]=[]),t[s][e.index]=e}else{const s=`${n}_${e.layerType}`;e.layerType===UranusInstancerLod.LAYER_TYPE_SHADOW&&(this.hasCustomShadowLod=!0),t[s]||(t[s]=[]),t[s][e.index]=e}})),this.lodLevelsFiltered[e.id]=void 0;let n=`${e.layer.name}_${e.shadowCaster?"shadow":"model"}`;t[n]?this.lodLevelsFiltered[e.id]=t[n].map((e=>e)):(n="_"+(e.shadowCaster?"shadow":"model"),t[n]&&(this.lodLevelsFiltered[e.id]=t[n].map((e=>e))))},UranusInstancerLod.prototype.getLodIndexFromName=function(e){const t=e.split("_"),n=t[t.length-1];if(0!==n.indexOf("LOD"))return-1;return parseInt(n.replace("LOD",""))},UranusInstancerLod.prototype.isLodVisible=function(e,t,n,s,a,o){if(!n)return 0;const r=n.fov>90;let i;if(s)i=s[e];else{let t=this.lodLevelsFiltered[a.id];t||(this.prepareLodLevels(a),t=this.lodLevelsFiltered[a.id]),i=t[e]}if(!i){if(r){return n.node.getPosition().distance(t)<=n.farClip?2:0}return 0}const d=n.node.getPosition().distance(t),l=i.start*o;return end=i.end>0?i.end*o:1/0,end>n.farClip&&(end=n.farClip),d>=l&&d<end?2:0};var UranusInstancerData=pc.createScript("uranusInstancerData");UranusInstancerData.attributes.add("inEditor",{type:"boolean",default:!0}),UranusInstancerData.attributes.add("templates",{type:"asset",assetType:"template",array:!0,title:"Templates",description:"A list of templates that instances will be spawned from."}),UranusInstancerData.attributes.add("dataFile",{type:"asset",assetType:"json",title:"Data File",description:"A JSON file that contains an one dimension data array that should conform to the selected format."}),UranusInstancerData.attributes.add("playcanvasToken",{type:"string",title:"Playcanvas Token",description:"A valid Playcanvas Rest API access token to be used for updating the data holder file if required."}),UranusInstancerData.attributes.add("spawnEntities",{type:"boolean",default:!0,title:"Spawn Entities",description:"If selected an entity will be spawned for each instance, otherwise buffers will be passed to the instancer which is more performance."}),UranusInstancerData.attributes.add("spawnEditCells",{type:"boolean",title:"Spawn Edit Cells",default:!1,description:"If selected instances will be sorted in world positionwed cells to allow for realtime editing. If running in editor this setting is always set to true. This setting works only with Spawn Entities set to false."}),UranusInstancerData.attributes.add("useBaseMatrix",{type:"boolean",title:"Use Base Matrix",default:!1,description:"If set to true the base template entity matrix will be used for instancing and any internal hierarchy transformations will not be preserved. This offers a performance optimization."}),UranusInstancerData.attributes.add("singleInstance",{type:"boolean",title:"Single Instance",default:!1,description:"If set to true all instances will be added in a single batch action resulting in increased performance. This disables editing of the instances and requires instancer cells."}),UranusInstancerData.attributes.add("seed",{type:"number",default:0,title:"Seed",description:"Seed to be used for any random number generation, if required. Use 0 for a different random seed on each run."}),UranusInstancerData.attributes.add("templateFormat",{type:"boolean",default:!0,title:"Template Format",description:"If set to yes the template format is expected to be included in the dataset, otherwise a random one will be generated."}),UranusInstancerData.attributes.add("positionFormat",{type:"json",schema:[{name:"x",type:"boolean",default:!0,title:"X"},{name:"y",type:"boolean",default:!0,title:"Y"},{name:"z",type:"boolean",default:!0,title:"Z"},{name:"precisionX",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."},{name:"precisionY",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."},{name:"precisionZ",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."},{name:"isLocal",type:"boolean",default:!1,description:"If this is a local position, the parent world position will be added."}],title:"Position Format",description:"Define which position elements to be parsed from data. Omitting elements can reduce the size of the data file."}),UranusInstancerData.attributes.add("rotationFormat",{type:"json",schema:[{name:"x",type:"boolean",default:!0,title:"X"},{name:"y",type:"boolean",default:!0,title:"Y"},{name:"z",type:"boolean",default:!0,title:"Z"},{name:"precisionX",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."},{name:"precisionY",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."},{name:"precisionZ",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."},{name:"isLocal",type:"boolean",default:!1,description:"If this is a local position, the parent world rotation will be added."}],title:"Rotation Format",description:"Define which rotation elements to be parsed from data. Omitting elements can reduce the size of the data file."}),UranusInstancerData.attributes.add("scaleFormat",{type:"json",schema:[{name:"x",type:"boolean",default:!0,title:"X"},{name:"y",type:"boolean",default:!0,title:"Y"},{name:"z",type:"boolean",default:!0,title:"Z"},{name:"precisionX",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."},{name:"precisionY",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."},{name:"precisionZ",type:"number",precision:0,min:0,max:3,default:1,description:"Number of decimal points used by this number when saving data."}],title:"Scale Format",description:"Define which scale elements to be parsed from data. Omitting elements can reduce the size of the data file."}),UranusInstancerData.attributes.add("randomPosition",{type:"json",schema:[{name:"x",type:"vec2",default:[0,0],title:"X"},{name:"y",type:"vec2",default:[0,0],title:"Y"},{name:"z",type:"vec2",default:[0,0],title:"Z"}],title:"Random Position",description:"Calculate a random position per axis between the min/max limit provided. If 0,0 is provided no random position will be calculated."}),UranusInstancerData.attributes.add("randomRotation",{type:"json",schema:[{name:"x",type:"vec2",default:[0,0],title:"X"},{name:"y",type:"vec2",default:[0,0],title:"Y"},{name:"z",type:"vec2",default:[0,0],title:"Z"}],title:"Random Rotation",description:"Calculate a random rotation per axis between the min/max limit provided (range 0-360). If 0,0 is provided no random rotation will be calculated."}),UranusInstancerData.attributes.add("randomScale",{type:"json",schema:[{name:"uniform",type:"boolean",default:!0,title:"Uniform",description:"If selected a uniform scale will be calculated for all three axis from the X random field."},{name:"x",type:"vec2",default:[1,1],title:"X"},{name:"y",type:"vec2",default:[1,1],title:"Y"},{name:"z",type:"vec2",default:[1,1],title:"Z"},{name:"step",type:"number",default:0,min:0,title:"Step",description:"If a value larger than 0 is provided each random scale will be rounded to the closest number based on this step."}],title:"Random Scale",description:"Calculate a random scale per axis between the min/max limit provided. If 0,0 is provided no random scale will be calculated."}),UranusInstancerData.axis=["x","y","z"],UranusInstancerData.FORMAT_POSITION="positionFormat",UranusInstancerData.FORMAT_ROTATION="rotationFormat",UranusInstancerData.FORMAT_SCALE="scaleFormat",UranusInstancerData.RANDOM_POSITION="randomPosition",UranusInstancerData.RANDOM_ROTATION="randomRotation",UranusInstancerData.RANDOM_SCALE="randomScale",UranusInstancerData.prototype.initialize=async function(){this.vec=new pc.Vec3,this.vec2=new pc.Vec3,this.vec3=new pc.Vec3,this.holders=[],this.removeData=[],this.removePreviewData=[],this.previewData=[],this.cells={},this.cellSize=new pc.Vec3(10,10,10),await this.prepare(),this.parseData(),this.on("state",(function(e){this.holders&&this.holders.forEach((t=>{t.entity.enabled=e}))}))},UranusInstancerData.prototype.prepare=async function(){!0===UranusEditor.inEditor()&&(this.spawnEditCells=!0),"function"!=typeof Math.seedrandom&&await UranusUtilities.loadAsset("seedrandom.min.js","script")},UranusInstancerData.prototype.onAttrUpdate=function(e,t){"dataFile"===e&&(this.dataFile.off("change",this.onDataFileChange,this),t.on("change",this.onDataFileChange,this)),this.parseData()},UranusInstancerData.prototype.editorScriptPanelRender=function(e){this.buttons={};const t=e.firstChild;this.addButton(t,"save","+ Save",!1,(()=>this.saveDataToFile()))},UranusInstancerData.prototype.addButton=function(e,t,a,n,s){const i=new ui.Button({text:a});n&&(this.stateButtons[t]=i),this.buttons[t]=i,i.on("click",s),e.append(i.element)},UranusInstancerData.prototype.onDataFileChange=function(){this.parseData()},UranusInstancerData.prototype.getDataFromFile=function(){const validateData=e=>Array.isArray(e)&&"object"!=typeof e[0]?e:[];return this.dataFile?this.dataFile.loaded?validateData(this.dataFile.resources):new Promise((e=>{this.dataFile.ready((t=>{const a=validateData(t.resources);e(a)})),this.app.assets.load(this.dataFile)})):[]},UranusInstancerData.prototype.calculateStride=function(){let e=0;this.templateFormat&&e++;const t=this[UranusInstancerData.FORMAT_POSITION];t.x&&e++,t.y&&e++,t.z&&e++;const a=this[UranusInstancerData.FORMAT_ROTATION];a.x&&e++,a.y&&e++,a.z&&e++;const n=this[UranusInstancerData.FORMAT_SCALE];return n.x&&e++,n.y&&e++,n.z&&e++,e},UranusInstancerData.prototype.addPreviewInstance=function(e,t,a,n,s){const i=s;let r=i.length;this.templateFormat&&(i[r++]=e);const o=this[UranusInstancerData.FORMAT_POSITION];o.x&&(i[r++]=this.roundNumber(t.x,this.getPrecision(o.precisionX))),o.y&&(i[r++]=this.roundNumber(t.y,this.getPrecision(o.precisionX))),o.z&&(i[r++]=this.roundNumber(t.z,this.getPrecision(o.precisionX)));const c=this[UranusInstancerData.FORMAT_ROTATION];c.x&&(i[r++]=this.roundNumber(a.x,this.getPrecision(c.precisionX))),c.y&&(i[r++]=this.roundNumber(a.y,this.getPrecision(c.precisionX))),c.z&&(i[r++]=this.roundNumber(a.z,this.getPrecision(c.precisionX)));const l=this[UranusInstancerData.FORMAT_SCALE];l.x&&(i[r++]=this.roundNumber(n.x,this.getPrecision(l.precisionX))),l.y&&(i[r++]=this.roundNumber(n.y,this.getPrecision(l.precisionX))),l.z&&(i[r++]=this.roundNumber(n.z,this.getPrecision(l.precisionX)))},UranusInstancerData.prototype.removePreviewInstances=async function(e,t){const a=this.removeData,n=this.removePreviewData,s=this.holders;s.forEach((e=>e.removeInstances=[]));const i=this.getAffectedCells(e,t),r=this.vec;for(let s=i.length-1;s>=0;s--){const o=i[s],c=o.instances;for(let s=c.length-1;s>=0;s--){const i=c[s],l=i.position;r.set(l[0],l[1],l[2]),r.distance(e)<=t&&(i.holder.removeInstances.push(i),i.bufferIndex>-1&&-1===a.indexOf(i.bufferIndex)?a.push(i.bufferIndex):i.bufferPreviewIndex>-1&&-1===n.indexOf(i.bufferPreviewIndex)&&n.push(i.bufferPreviewIndex),o.instances.splice(s,1))}}s.forEach((e=>{const t=e.removeInstances;e.components.forEach((e=>{const a=e.entity.uranusInstancingData;t.forEach((e=>{const t=a.indexOf(e);t>-1&&a.splice(t,1)})),t.length>0&&e.entity.fire("UranusInstancerData:remove:instances",t)}))}))},UranusInstancerData.prototype.clearPreviewInstances=function(){const e=this.removeData.length>0||this.removePreviewData.length>0||this.previewData.length>0;this.removeData.length=0,this.removePreviewData.length=0,this.previewData.length=0,this.clearHolderLists(),e&&this.parseData()},UranusInstancerData.prototype.savePreviewInstances=async function(){if(!this.playcanvasToken)return;let e=await this.getDataFromFile();const t=this.previewData,a=this.calculateStride(),n=this.removeData;n.sort(((e,t)=>e-t));for(let t=n.length-1;t>=0;t--){const s=n[t];e.splice(s,a)}const s=this.removePreviewData;s.sort(((e,t)=>e-t));for(let e=s.length-1;e>=0;e--){const n=s[e];t.splice(n,a)}e=e.concat(t),this.clearPreviewInstances(),this.saveDataToFile(e)},UranusInstancerData.prototype.saveDataToFile=async function(e){if(e||(e=this.data),!e)return;e=Array.from(e),this.dataFile&&(this.dataFile.resources=e);const t="https://playcanvas.com/api/assets/"+this.dataFile.id,a=new FormData;a.append("name",this.dataFile.name),a.append("file",new Blob([JSON.stringify(e)]),this.dataFile.name),await fetch(t,{method:"PUT",headers:{Authorization:"Bearer "+this.playcanvasToken},body:a})},UranusInstancerData.prototype.clearHolderLists=function(){this.holders.forEach((e=>{e.newInstances=[],e.removeInstances=[]}))},UranusInstancerData.bufferIDs=0,UranusInstancerData.prototype.parseData=async function(e,t,a,n){let s,i;if(e)i=this.previewData,s=e;else{if(s=await this.getDataFromFile(),s=s.concat(this.previewData),t&&(s=s.length>0?s.concat(t):t),!0!==n){const e=this.holders;for(var r=e.length-1;r>=0;r--)e[r].entity.destroy();this.holders=[]}this.entity.enabled=!1}if(0===s.length||!this.entity.parent)return;const o=this.holders;e&&this.clearHolderLists();const c=a?10:this.calculateStride(),l=this.spawnEntities,d=this.seed>0?new Math.seedrandom(this.seed):Math.random,u=this.cellSize,p=this.spawnEditCells,h=this.useBaseMatrix,m=this.singleInstance,f=this.templates,y=f.length-1,b=this.templateFormat,I=this.cells,D=this.vec,g=this.vec2,w=this.vec3,v=this.randomInt.bind(this),U=this.formatVector.bind(this),x=this.createDebugCell.bind(this),F=this.entity.script.uranusInstancerDataRigidbody,O=[];for(let t=0;t<s.length;t+=c){let n,r=D,c=g,A=w;if(a)n=s[t],m||(r.set(s[t+1],s[t+2],s[t+3]),c.set(s[t+4],s[t+5],s[t+6]),A.set(s[t+7],s[t+8],s[t+9]));else{let e=t;if(b?(n=s[t],e++):n=v(0,y,d),!0===isNaN(n))return!1;e=U(e,UranusInstancerData.FORMAT_POSITION,UranusInstancerData.RANDOM_POSITION,r,s,d),e=U(e,UranusInstancerData.FORMAT_ROTATION,UranusInstancerData.RANDOM_ROTATION,c,s,d),e=U(e,UranusInstancerData.FORMAT_SCALE,UranusInstancerData.RANDOM_SCALE,A,s,d)}if(this.positionFormat.isLocal&&r.add(this.entity.getPosition()),this.rotationFormat.isLocal&&c.add(this.entity.getEulerAngles()),l){const e=f[n].resource.instantiate();e.setPosition(r),e.setEulerAngles(c),e.setLocalScale(A),e.enabled=!0,this.entity.addChild(e)}else{let l=o[n];if(!l){l={components:void 0,instances:[],entity:f[n].resource.instantiate(),newInstances:[],removeInstances:[],rigidbodies:void 0},o[n]=l,l.rigidbodies=l.entity.findComponents("rigidbody"),l.rigidbodies.forEach((e=>e.enabled=!1))}if(m){let e=l.instances[0];e||(e={baseEntity:l.entity,holder:l,buffer:[],bufferId:UranusInstancerData.bufferIDs++,bufferDetached:!1,singleInstance:m,useBaseMatrix:h},l.instances.push(e),O.push(e));const n=e.buffer;if(a){let e=n.length;for(let a=1;a<10;a++)n[e++]=s[t+a];F&&F.createBody(l,s[t+1],s[t+2],s[t+3],s[t+4],s[t+5],s[t+6],s[t+7],s[t+8],s[t+9])}else n.push(r.x,r.y,r.z),n.push(c.x,c.y,c.z),n.push(A.x,A.y,A.z),F&&F.createBody(l,r.x,r.y,r.z,c.x,c.y,c.z,A.x,A.y,A.z)}else{const a={baseEntity:l.entity,holder:l,position:[r.x,r.y,r.z],rotation:[c.x,c.y,c.z],scale:[A.x,A.y,A.z],singleInstance:m,useBaseMatrix:h};if(l.instances.push(a),O.push(a),F&&F.createBody(l,r.x,r.y,r.z,c.x,c.y,c.z,A.x,A.y,A.z),e&&l.newInstances.push(a),p){const n=UranusInstancerCell.prototype.getPositionOnGrid(r,u),s=UranusInstancerCell.prototype.getCellGuid(n.x,n.y,n.z,u);let o=I[s];o||(o=x(n,s,u)),o.instances.push(a),e?(a.bufferIndex=-1,a.bufferPreviewIndex=i.length+t):(a.bufferIndex=t,a.bufferPreviewIndex=-1)}}}}e&&(this.previewData=this.previewData.concat(e));let A=!1;return o&&o.forEach((e=>{let t=e.components;t||(t=e.entity.findComponents("render").concat(e.entity.findComponents("model")),e.components=t);const a=e.newInstances;t.forEach((t=>{t.entity.uranusHasInstancingData=!0,t.entity.uranusInstancingData=e.instances,a.length>0&&t.entity.fire("UranusInstancerData:add:instances",a)})),e.instances[0].singleInstance&&(e.instances[0].buffer=Float32Array.from(e.instances[0].buffer)),e.entity.enabled=!0,e.entity.parent||(this.entity.addChild(e.entity),A=!0)})),e&&!A||(this.entity.enabled=!0),UranusEditor.inEditor()?this.data=s:m&&(o.forEach((e=>{e.components.forEach((e=>{e.entity.once("UranusInstancerData:onBufferConsumed",(function(){e.entity.uranusInstancingData=void 0}),this)}))})),this.holders=void 0),O},UranusInstancerData.prototype.formatVector=function(e,t,a,n,s,i){for(let r=0;r<UranusInstancerData.axis.length;r++){const o=UranusInstancerData.axis[r];if(this[t][o])n[o]=s[e],e++;else{const e=a===UranusInstancerData.RANDOM_SCALE;if(e&&this[a].uniform&&o!==UranusInstancerData.axis[0]){n[o]=n[UranusInstancerData.axis[0]];continue}const t=this[a][o],s=t.x<t.y;if(n[o]=s?this.randomFloat(t.x,t.y,i):t.x,e){const e=this[a].step;if(e>0){let t=n[o];t=Math.floor(t/e)*e,n[o]=t}}}}return e},UranusInstancerData.prototype.randomInt=function(e,t,a){return e>t?Math.floor(t+a()*(e-t+1)):Math.floor(e+a()*(t-e+1))},UranusInstancerData.prototype.randomFloat=function(e,t,a){return((e*=1e3)>(t*=1e3)?Math.floor(t+a()*(e-t+1)):Math.floor(e+a()*(t-e+1)))/1e3},UranusInstancerData.prototype.roundNumber=function(e,t){return Math.round(e*t)/t},UranusInstancerData.prototype.getPrecision=function(e){switch(e){case 0:return 1;case 1:return 10;case 2:return 100;case 3:return 1e3}},UranusInstancerData.prototype.createDebugCell=function(e,t,a){const n={id:t,instances:[],aabb:UranusInstancerCell.prototype.calculateCellBounding(e,a)};return this.cells[t]=n,n},UranusInstancerData.boundingSphere=new pc.BoundingSphere,UranusInstancerData.prototype.getAffectedCells=function(e,t){const a=UranusInstancerData.boundingSphere;a.center.copy(e),a.radius=t;const n=this.cells,s=[];for(let e in n){const t=n[e];!0===t.aabb.intersectsBoundingSphere(a)&&s.push(t)}return s};var UranusInstancerDataRigidbody=pc.createScript("uranusInstancerDataRigidbody");UranusInstancerDataRigidbody.attributes.add("inEditor",{type:"boolean",default:!0}),window.Ammo&&(UranusInstancerDataRigidbody.ammoTransform=new Ammo.btTransform,UranusInstancerDataRigidbody.ammoVec1=new Ammo.btVector3,UranusInstancerDataRigidbody.ammoQuat=new Ammo.btQuaternion),UranusInstancerDataRigidbody.shapeCache={},UranusInstancerDataRigidbody.getShapeId=function(t,e,a){return`${t}_${e}_${a}`},UranusInstancerDataRigidbody.getShapeFromCache=function(t,e,a){let i=UranusInstancerDataRigidbody.shapeCache[t];if(!i){const n=UranusInstancerDataRigidbody.ammoVec1;let s,o,r;switch(e.type){case"box":const t=e.halfExtents;n.setValue(t?t.x*a:.5*a,t?t.y*a:.5*a,t?t.z*a:.5*a),i=new Ammo.btBoxShape(n);break;case"sphere":i=new Ammo.btSphereShape(e.radius*a);break;case"capsule":switch(s=void 0!==e.axis?e.axis:1,o=(e.radius||.5)*a,r=Math.max((e.height||2)-2*o,0)*a,s){case 0:i=new Ammo.btCapsuleShapeX(o,r);break;case 1:i=new Ammo.btCapsuleShape(o,r);break;case 2:i=new Ammo.btCapsuleShapeZ(o,r)}break;case"cylinder":switch(s=void 0!==e.axis?e.axis:1,o=void 0!==e.radius?e.radius*a:.5*a,r=void 0!==e.height?e.height*a:1*a,s){case 0:n.setValue(.5*r,o,o),i=new Ammo.btCylinderShapeX(n);break;case 1:n.setValue(o,.5*r,o),i=new Ammo.btCylinderShape(n);break;case 2:n.setValue(o,o,.5*r),i=new Ammo.btCylinderShapeZ(n)}break;case"cone":switch(s=void 0!==e.axis?e.axis:1,o=void 0!==e.radius?e.radius*a:.5*a,r=void 0!==e.height?e.height*a:1*a,s){case 0:i=new Ammo.btConeShapeX(o,r);break;case 1:i=new Ammo.btConeShape(o,r);break;case 2:i=new Ammo.btConeShapeZ(o,r)}}i.cacheId=t,i.scaleWithStep=a,UranusInstancerDataRigidbody.shapeCache[t]=i}return i},UranusInstancerDataRigidbody.prototype.initialize=function(){this.list=[],this.on("state",this.onState,this),this.on("destroy",this.onDestroy,this)},UranusInstancerDataRigidbody.prototype.onState=function(t){this.list.forEach((e=>{t?this.enableSimulation(e):this.disableSimulation(e)}))},UranusInstancerDataRigidbody.prototype.onDestroy=function(){this.list.forEach((t=>{this.disableSimulation(t),t.rigidbody.system.dynamicsWorld.removeRigidBody(t);const e=t.getMotionState();e&&Ammo.destroy(e),Ammo.destroy(t)}))},UranusInstancerDataRigidbody.prototype.createBody=async function(t,e,a,i,n,s,o,r,c,d){if(!window.Ammo)return;const m=UranusInstancerDataRigidbody.ammoTransform;await new Promise((t=>setTimeout(t,0)));const y=t.entity,u=t.rigidbodies,h=this.list,l=this.app.systems.collision,p=l._triMeshCache;let b;for(let t=0;t<u.length;t++){const g=u[t];if(g._type===pc.BODYTYPE_DYNAMIC)continue;const I=g.entity,D=I?.collision;if(!D)continue;let S=D.shape;const f=D.type;if("mesh"===f){if(S.scaleWithStep!==r){const t=UranusPhysicsCollider.prototype.getMeshCacheId(S.meshId,r);if(p[t])S=p[t].shape;else{const t=y.clone();t.setLocalScale(r,c,d);const e=t.findByName(I.name);b||(b=l.implementations.mesh,b||(b=l._createImplementation("mesh"))),S=b.createPhysicalShape(e,I.collision),e.destroy()}}}else{const t=UranusInstancerDataRigidbody.getShapeId(f,S.meshId,r);S=UranusInstancerDataRigidbody.getShapeFromCache(t,D,r)}if(!S)continue;const A=g._type===pc.BODYTYPE_DYNAMIC?g._mass:0;this._getEntityTransform(m,y,I,e,a,i,n,s,o);const R=g.system.createBody(A,S,m);R.setRestitution(g._restitution),R.setFriction(g._friction),R.setRollingFriction(g._rollingFriction),R.setDamping(g._linearDamping,g._angularDamping),R.entity=I,R.rigidbody=g,h.push(R),this.enableSimulation(R)}},UranusInstancerDataRigidbody.prototype.enableSimulation=function(t){const e=t.entity,a=t.rigidbody;if(a.system.addBody(t,a._group,a._mask),a._type===pc.BODYTYPE_STATIC)t.forceActivationState(pc.BODYSTATE_ACTIVE_TAG),a.syncEntityToBody();"compound"===e.collision.type&&a.system._compounds.push(e.collision),t.activate()},UranusInstancerDataRigidbody.prototype.disableSimulation=function(t){const e=t.entity,a=t.rigidbody.system;let i=a._compounds.indexOf(e.collision);i>-1&&a._compounds.splice(i,1),a.removeBody(t),t.forceActivationState(pc.BODYSTATE_DISABLE_SIMULATION)},UranusInstancerDataRigidbody.prototype._getEntityTransform=function(t,e,a,i,n,s,o,r,c){const d=UranusInstancerDataRigidbody.ammoVec1,m=UranusInstancerDataRigidbody.ammoQuat;d.setValue(i,n,s),e.setEulerAngles(o,r,c);const y=a.getRotation();m.setValue(y.x,y.y,y.z,y.w),t.setOrigin(d),t.setRotation(m)};var UranusInstancer=pc.createScript("uranusInstancer");UranusInstancer.attributes.add("inEditor",{type:"boolean",default:!0}),UranusInstancer.attributes.add("frustumCulling",{type:"boolean",default:!0,title:"Frustum Culling",description:"Controls the culling of instances against the camera frustum (frustum culling needs to enabled on each camera component). If false all instances will be rendered regardless of their visibility. Changing this setting requires application reload."}),UranusInstancer.attributes.add("cloneMaterials",{type:"boolean",default:!1,title:"Clone Materials",description:"If selected all instances will use a clone of the original model material. This is useful when the original material is being used in non instanced models and otherwise it will produce render artifacts. Changing this setting requires application reload."}),UranusInstancer.attributes.add("autoDynamicCells",{type:"boolean",default:!1,title:"Auto Dynamic Cells",description:"If this is selected the instancer will attempt to automatically understand if an instance has moved in a cell and update it accordingly. It can have a performance hit with too many cells/instances"}),UranusInstancer.attributes.add("disableCells",{type:"boolean",default:!1,title:"Disable Cells",description:"Disable cells generation and do per instance culling globally. In editor this setting is being bypassed for entities to allow for individual editing."}),UranusInstancer.attributes.add("disableShadows",{type:"boolean",default:!1,title:"Disable Shadows",description:"If selected no shadows buffers will be created (optimization). Requires app reload."}),UranusInstancer.attributes.add("bypassTransparent",{type:"boolean",default:!0,title:"Bypass Transparent",description:"If selected transparent mesh instances will not be instanced."}),UranusInstancer.attributes.add("excludeTag",{type:"string",default:"uranus-instancing-exclude",title:"Exclude Tag",description:"Use this tag on entities to exclude them from instancing."}),UranusInstancer.attributes.add("shadowsOnlyTag",{type:"string",default:"uranus-instancing-shadows-only",title:"Shadows Only Tag",description:"Use this tag on entities to exclude them from model rendering. Those models will only render shadows."}),UranusInstancer.attributes.add("entityDisableTag",{type:"string",default:"uranus-instancing-entity-disable",title:"Entity Disable Tag",description:"Use this tag on entities to exclude them from rendering their model. It will be rendered only for shadows."}),UranusInstancer.attributes.add("materialShadowsDisable",{type:"string",default:"uranus-instancing-material-shadows-disable",title:"Material Shadows Disable",description:"Use this tag on material assets to exclude them from rendering shadows."}),UranusInstancer.attributes.add("materialCloneDisable",{type:"string",default:"uranus-instancing-material-clone-disable",title:"Material Clone Disable",description:"Use this tag on material assets to exclude them from cloning their material."}),UranusInstancer.attributes.add("excludeLayers",{type:"string",array:!0,default:["Depth","Skybox","Immediate","UI","Sky","Occlusion"],title:"Exclude Layers",description:"Mesh instances rendered in these layers won't be instanced."}),UranusInstancer.attributes.add("excludeShadowsLayers",{type:"string",array:!0,default:["WaterReflection"],title:"Exclude Shadows Layers",description:"Payloads in these layers will skip generating shadow casters."}),UranusInstancer.attributes.add("lodMultiplier",{type:"number",min:0,max:10,default:1,title:"LOD Multiplier",description:"The LOD multiplier all LOD Levels start/end distances will be multiplied with. Useful when creating LOD presets."}),UranusInstancer.attributes.add("lodLevels",{type:"json",title:"Lod Levels",array:!0,schema:[{name:"index",type:"number",default:0,precision:0,min:0,max:9,description:"The LOD index for this level e.g. 0 for LOD0, 1 for LOD1."},{name:"start",type:"number",default:0},{name:"end",type:"number",default:0}]}),UranusInstancer.attributes.add("cells",{type:"json",title:"Cells",array:!0,schema:[{name:"cellSize",type:"vec3",default:[10,10,10],title:"Cell Size",description:"The size of the cell in the frustum culling grid. Only static instances support cell based culling. Minimum cell side size is 1."},{name:"updateFrequency",type:"number",default:0,title:"Update Frequency",description:"Set how often in seconds culling updates will execute for this cell. To disable this check and execute it per frame set it to 0."},{name:"updateShadowsFrequency",type:"number",default:0,title:"Update Shadows Frequency",description:"Set how often in seconds culling shadows updates will execute for this cell. To disable this check and execute it per frame set it to 0."},{name:"isDynamic",type:"boolean",default:!1,title:"Is Dynamic",description:"If selected all entities in each cell will update their world transform matrix. Useful for animating instances while in a cell. Note if an instanced changes its position to be outside its initial cell, it will not change cell automatically."}]}),UranusInstancer.editorLayers=["Editor Layer Viewport Grid","Editor Layer Bright Gizmo","Editor Layer Bright Gizmo","Editor Layer Viewport Grid","Editor Layer Bright Collision","Editor Layer Bright Collision","Editor Layer Dim Gizmo","Editor Layer Dim Gizmo","Editor Layer Viewport Outline","Editor Layer Viewport Outline","Editor Layer Axis Gizmo Immediate","Editor Layer Axis Gizmo Immediate","Editor Layer Axis Rotate Gizmo Immediate","Editor Layer Axis Rotate Gizmo Immediate","Editor Layer Axis Gizmo","Editor Layer Axis Gizmo","Editor Layer Camera Preview","Editor Layer Camera Preview"],UranusInstancer.prototype.initialize=function(){UranusInstancer.api=this,this.payloads=void 0,this.runningInEditor=window.UranusEditor&&window.UranusEditor.inEditor(),this.vec=new pc.Vec3,this.vec2=new pc.Vec3,this.quat=new pc.Quat,this.matrix=new pc.Mat4,this.hasLod=this.lodLevels.length>0,this.globalCells=void 0,this.viewPos=[0,0,0],this.instancerWorker=void 0,this.bypassCulling=!1,this.prepare(),window.setTimeout((()=>this.onState(!0)),0),this.on("state",this.onState,this),this.on("attr:disableShadows",this.onDisableShadows,this),this.on("attr:lodMultiplier",this.onLodMultiplier,this),this.app.on("UranusInstancer:setBypassCulling",(function(e){this.bypassCulling=e;for(let e in this.payloads){const t=this.payloads[e];if(t.shadowCaster){const e=t.refPayload?t.refPayload:t;e.updateFrequencyTime=e.updateFrequency}}}),this),this.app.on("UranusInstancer:setBypassShadows",(function(e){for(let t in this.payloads){const a=this.payloads[t];if(a.shadowCaster){const t=a.refPayload?a.refPayload:a;t.updateFrequencyTime=t.updateFrequency,a.meshInstance.visible=!e}}}),this)},UranusInstancer.prototype.prepare=function(){this.overrideEngine(),this.payloads={},this.cells.length>0&&(this.globalCells=new UranusInstancerCell({app:this.app,entity:this.entity,enabled:!0}),this.onCellsUpdated(this.cells)),!this.frustumCulling&&this.cloneMaterials&&this.app.on("update",this.onUpdate,this),this.app.on("prerender",this.onPreRender,this),this.app.on("postrender",this.onPostRender,this)},UranusInstancer.prototype.onCellsUpdated=function(e){(e=e[0])&&this.globalCells&&(this.globalCells.cellSize=e.cellSize,this.globalCells.updateFrequency=e.updateFrequency,this.globalCells.updateShadowsFrequency=e.updateShadowsFrequency,this.globalCells.isDynamic=e.isDynamic)},UranusInstancer.prototype.onState=function(e){if(e){const e=this.app.scene.layers.layerList;for(let t=0;t<e.length;t++){const a=e[t];if(!1===this.isLayerValid(a))continue;let s;this.bypassTransparent?(a.meshInstances||console.log(a),s=a.meshInstances.filter((e=>e.material.blendType===pc.BLEND_NONE))):s=a.meshInstances,a.removeMeshInstances(s),a.addMeshInstances(s)}}else{for(let e in this.payloads){const t=this.payloads[e],a=t.refMeshInstances,s=t.layer;this.clearPayload(t),s.addMeshInstances(a)}this.payloads={}}},UranusInstancer.prototype.onDisableShadows=function(e){this.enabled&&(this.enabled=!1,this.enabled=!0)},UranusInstancer.prototype.setShadows=function(e){this.disableShadows=!e},UranusInstancer.prototype.onLodMultiplier=function(e){this.app.fire("UranusInstancer:onLodMultiplier",e)},UranusInstancer.prototype.isLayerValid=function(e,t){return t?-1===this.excludeShadowsLayers.indexOf(e.name):-1===this.excludeLayers.indexOf(e.name)&&-1===UranusInstancer.editorLayers.indexOf(e.name)},UranusInstancer.worldMatX=new pc.Vec3,UranusInstancer.worldMatY=new pc.Vec3,UranusInstancer.worldMatZ=new pc.Vec3,UranusInstancer.prototype.shouldFlipFaces=function(e){const t=UranusInstancer.worldMatX,a=UranusInstancer.worldMatY,s=UranusInstancer.worldMatZ,n=e.getWorldTransform();return n.getX(t),n.getY(a),n.getZ(s),t.cross(t,a),!(t.dot(s)>=0)},UranusInstancer.prototype.getPayloadId=function(e,t,a,s){const n=s||e.material,i=this.shouldFlipFaces(e.node);return BigInt(65535&t.id)<<34n|BigInt(a?1:0)<<33n|BigInt(i?1:0)<<32n|BigInt(65535&e.mesh.id)<<16n|BigInt(65535&n.id)},UranusInstancer.prototype.getMeshInstanceEntity=function(e){let t=e.node;if(t instanceof pc.Entity==!1){for(;t instanceof pc.Entity==!1&&t.parent;)t=t.parent;if(t instanceof pc.Entity==!1)return}return t},UranusInstancer.prototype.addMeshInstance=function(e,t,a,s){if(!e.material||e.mesh.skin)return!1;if("uranus-instancer-payload"===e.node.name)return!1;if(this.bypassTransparent&&e.material.blendType!==pc.BLEND_NONE)return!1;const n=this.getMeshInstanceEntity(e);if(!n)return!1;const i=e.node!==n?e.node:n;if(!0===UranusUtilities.itemHasTag(n,this.excludeTag))return!1;const r=n.render?n.render:n.model;if(!r||r&&r.batchGroupId>-1)return!1;let o=this.cloneMaterials;if(n.render){const t=r.meshInstances.findIndex((t=>t===e));if(t>-1){const e=r.materialAssets[t],s=this.app.assets.get(e);s&&(!0===UranusUtilities.itemHasTag(s,this.materialShadowsDisable)&&(a=!0),!0===UranusUtilities.itemHasTag(s,"uranus-instancing-material-clone-disable")&&(o=!1))}}const l=n.uranusInstancingData;return l?(n.on("UranusInstancerData:add:instances",(n=>{this.addBufferToPayload(n,i,e,t,a,s,o)})),n.on("UranusInstancerData:remove:instances",(n=>{this.removeBufferFromPayload(n,e,t,a,s)})),this.addBufferToPayload(l,i,e,t,a,s,o)):(s||this.addToPayload(n,i,e,t,!1,!1,o),!this.disableShadows&&!a&&e.castShadow&&this.isLayerValid(t,!0)&&this.addToPayload(n,i,e,t,!0,!1,o),this.overrideMeshInstance(e,(()=>{this.removeFromPayload(e,t,!1,null),this.removeFromPayload(e,t,!0,null),s||this.addToPayload(n,i,e,t,!1,!1,o),!this.disableShadows&&!a&&e.castShadow&&this.isLayerValid(t,!0)&&this.addToPayload(n,i,e,t,!0,!1,o)}))),!0},UranusInstancer.WORKER_CALCULATE_CELLS="calculate-cells",UranusInstancer.prototype.workerCalculateCells=function(e){this.instancerWorker||(this.instancerWorker=UranusUtilities.createWorker(this.entity,"uranus-instancer.worker.js"),UranusUtilities.postWorkerMessage(this.instancerWorker,"load-libraries",{libraries:[UranusUtilities.getAbsoluteUrl(this.app.assets.find("playcanvas-stable.min.js","script").getFileUrl()),UranusUtilities.getAbsoluteUrl(this.app.assets.find("uranus-worker-polyfill.js","script").getFileUrl()),UranusUtilities.getAbsoluteUrl(this.app.assets.find("uranus-instancer-cell.worker.js","script").getFileUrl())]})),UranusUtilities.postWorkerMessage(this.instancerWorker,UranusInstancer.WORKER_CALCULATE_CELLS,e,!0)},UranusInstancer.workerCalculateCellsListeners=[],UranusInstancer.prototype.addBufferToPayload=function(e,t,a,s,n,i,r){const o=e[0];let l=t.script?.uranusInstancerCell;!l&&this.globalCells&&(l=this.globalCells);const c=void 0!==l&&l.enabled;if(o.singleInstance&&c){if(this.entity.on(`worker:${UranusInstancer.WORKER_CALCULATE_CELLS}:${o.bufferId}`,(function(e){t.fire("UranusInstancerData:onBufferConsumed"),o.workerPayload=e.payload,i||this.addToPayload(o,t,a,s,!1,!1,r),!this.disableShadows&&!n&&a.castShadow&&this.isLayerValid(s,!0)&&this.addToPayload(o,t,a,s,!0,!1,r),UranusInstancer.workerCalculateCellsListeners[o.bufferId]||(UranusInstancer.workerCalculateCellsListeners[o.bufferId]=window.setTimeout((()=>{this.entity.off(`worker:${UranusInstancer.WORKER_CALCULATE_CELLS}:${o.bufferId}`)}),0))}),this),!o.bufferDetached){o.bufferDetached=!0;const e=o.useBaseMatrix||o.baseEntity===t;let s;e||(s=UranusUtilities.serializeEntityTRS(t)),this.workerCalculateCells({id:o.bufferId,cellSize:UranusUtilities.serializeVec3(l.cellSize),buffer:o.buffer,node:s,refBoundingBox:a.aabb.halfExtents.data,useBaseMatrix:e})}}else{for(let o=0;o<e.length;o++){const l=e[o],c=o>=e.length-1;i||this.addToPayload(l,t,a,s,!1,!c,r),!this.disableShadows&&!n&&a.castShadow&&this.isLayerValid(s,!0)&&this.addToPayload(l,t,a,s,!0,!c,r)}t.fire("UranusInstancerData:onBufferConsumed")}},UranusInstancer.prototype.removeBufferFromPayload=function(e,t,a,s,n){n||this.removeFromPayload(t,a,!1,e),!s&&t.castShadow&&this.removeFromPayload(t,a,!0,e)},UranusInstancer.prototype.addToPayload=function(e,t,a,s,n,i,r){const o=e.workerPayload,l=!o&&e instanceof pc.Entity;if(!n&&!0===UranusUtilities.itemHasTag(l?e:t,this.shadowsOnlyTag))return;let c,d,u;l?(c=e.script?.uranusInstancerCell,!c&&this.globalCells&&(c=this.globalCells),d=void 0!==c&&c.enabled,(this.disableCells||this.runningInEditor&&l)&&(d=!1),u=!1):(c=t.script?.uranusInstancerCell,!c&&this.globalCells&&(c=this.globalCells),d=void 0!==c&&c.enabled,(this.disableCells||this.runningInEditor&&l)&&(d=!1),u=e.singleInstance);const h=this.getPayloadId(a,s,n);let p=this.payloads[h];if(p){if(!p.refPayload&&l){if(p.refMeshInstances.indexOf(a)>-1)return p}else if(!p.refPayload&&!o&&p.refBufferInstances.indexOf(e)>-1)return p}else p=this.createPayload(h,a,s,n,u,d,r),this.setPayloadUpdateFrequency(p,c);if(p.refPayload)return!0!==i&&this.updateVertexBuffer(p,!0),p;const f={};if(this.hasLod){const e=t.script?.uranusInstancerLod;e&&(f.lodScript=e)}if(l){if(f.entity=e,p.refMeshInstances.push(a),a.uranusPayloadMaterial=a.material,a.isStatic){const e=t.getWorldTransform(),a=e.data,s=[];for(let e=0;e<16;e++)s[e]=a[e];f.data=s,f.cullPosition=e.getTranslation()}}else if(!o){const s=e,n=s.baseEntity;let i,r,o;if(s.useBaseMatrix||n===t){const e=this.vec.set(s.position[0],s.position[1],s.position[2]),t=this.quat.setFromEulerAngles(s.rotation[0],s.rotation[1],s.rotation[2]),a=this.vec2.set(s.scale[0],s.scale[1],s.scale[2]);i=this.matrix,r=i.setTRS(e,t,a).data}else n.setPosition(s.position[0],s.position[1],s.position[2]),n.setEulerAngles(s.rotation[0],s.rotation[1],s.rotation[2]),n.setLocalScale(s.scale[0],s.scale[1],s.scale[2]),i=t.getWorldTransform(),r=i.data;if(u)o=r;else{o=[];for(let e=0;e<16;e++)o[e]=r[e]}f.data=o,f.cullPosition=i.getTranslation(),u||(s.payloads||(s.payloads={}),s.payloads[h]=f),p.singleInstance||p.refBufferInstances.push(s),-1===p.refMeshInstances.indexOf(a)&&p.refMeshInstances.push(a)}if(u&&!p.singleInstance&&(p.singleInstance=!0),l||0!==p.refMeshInstances.length||p.refMeshInstances.push(a),d)if(o){const a=e.workerPayload.cells,s=t.script?.uranusInstancerLod;a.forEach(((e,t)=>{if(e.aabb=new pc.BoundingBox(UranusUtilities.deserializeVec3(e.aabb.center),UranusUtilities.deserializeVec3(e.aabb.halfExtents)),!0===p.cells.set(t,e)){const a=p.cells.get(t);a.aabb.add(e.aabb),a.buffer=Float32Array.from(a.buffer,e.buffer)}else s&&(e.lodScript=s),p.cells.set(t,e)})),p.shouldUpdateShadows=2}else c.addInstanceToPayload(f,p,t,c.cellSize),f.data=void 0,f.cullPosition=void 0;else f.meshInstance=a,f.node=t,p.onlyCells=!1,p.shouldUpdateShadows=2;if(p.singleInstance)p.instancesCount||(delete p.instances,p.instancesCount=0),o?p.instancesCount+=e.workerPayload.instancesCount:p.instancesCount++;else if(p.instances.push(f),p.basePayload){const e=p.instances.length-1;p.basePayload.instances&&p.basePayload.instances[e]&&(f.refInstance=p.basePayload.instances[e])}return l&&!0===f.entity.enabled&&!0===UranusUtilities.itemHasTag(f.entity,this.entityDisableTag)&&window.setTimeout((()=>f.entity.enabled=!1),0),!0!==i&&(this.updateVertexBuffer(p,!0),p.shadowCaster&&(p.shouldUpdateShadows=2),this.frustumCulling||this.isMeshInstanceVisible(null,p)),p},UranusInstancer.prototype.setPayloadUpdateFrequency=function(e,t){if(t&&(e.isCellDynamic=t.isDynamic,!e.updateFrequency)){const a=e.shadowCaster?t.updateShadowsFrequency:t.updateFrequency;a>0&&(e.updateFrequency=1e3*a,e.updateFrequencyTime=e.updateFrequency,e.updateFrequencyLastNow=pc.now())}},UranusInstancer.prototype.removeMeshInstance=function(e,t,a,s){if(e.mesh.skin)return!1;if("uranus-instancer-payload"===e.node.name)return!1;let n=!1;return s||(n=this.removeFromPayload(e,t,!1)),a||(n=this.removeFromPayload(e,t,!0)),this.overrideMeshInstance(e),n},UranusInstancer.prototype.removeFromPayload=function(e,t,a,s){const n=e.uranusPayloadMaterial?e.uranusPayloadMaterial:e.material;if(!n)return!1;const i=this.getPayloadId(e,t,a,n),r=this.payloads[i];if(!r)return!1;if(e.node.uranusHasInstancingData){const t=e.node.uranusInstancingData;if((r.refPayload?r.refPayload:r).singleInstance||!s&&!t)r.refBufferInstances.length=0,r.instancesCount=0;else{s||(s=t);for(let e=0;e<s.length;e++){const t=s[e],a=r.refBufferInstances.indexOf(t);if(-1===a)continue;r.refBufferInstances.splice(a,1);const n=t.payloads[i];void 0!==n.cell&&UranusInstancerCell.prototype.removeInstanceFromPayload(n,r);const o=r.instances.indexOf(n);-1!==o&&r.instances.splice(o,1)}}}else if(!r.refPayload&&r.refMeshInstances.length>0&&r.instances){const t=r.refMeshInstances.indexOf(e);if(-1===t)return!1;const a=r.instances[t];if(UranusUtilities.itemHasTag(a.entity,this.entityDisableTag)&&!1===a.entity._destroying)return!1;void 0!==a.cell&&UranusInstancerCell.prototype.removeInstanceFromPayload(a,r),r.instances.splice(t,1),r.refMeshInstances.splice(t,1)}0===r.instancesCount||r.instances&&0===r.instances.length?this.clearPayload(r):(this.updateVertexBuffer(r,!0),r.shadowCaster&&(r.shouldUpdateShadows=2),this.frustumCulling||this.isMeshInstanceVisible(null,r))},UranusInstancer.prototype.clearPayload=function(e){e.cells=void 0,e.instances=void 0,e.vertexBuffer.destroy(),e.shadowCaster?e.layer.removeShadowCasters([e.meshInstance]):e.layer.removeMeshInstances([e.meshInstance],!0),delete this.payloads[e.id]},UranusInstancer.prototype.updateVertexBuffer=function(e,t,a){let s;if(void 0!==a)s=a;else if(e.instances)s=e.instances.length;else{s=(e.refPayload?e.refPayload:e).instancesCount}const n=e.vertexBuffer,i=n.format;if(n.numBytes=i.verticesByteSize?i.verticesByteSize:i.size*s,t||!n.originalStorage)n.originalStorage=new Float32Array(16*s),n.setData(n.originalStorage);else if(s>0){const e=n.originalStorage.subarray(0,16*s),t=n.device.gl,a=t.ARRAY_BUFFER;t.bindBuffer(a,n.impl.bufferId),t.bufferSubData(a,0,e)}e.meshInstance.instancingData.count=s,n.numVertices=s},UranusInstancer.prototype.createPayload=function(e,t,a,s,n,i,r){const o=this.getPayloadMaterial(t.material,r),l=new pc.MeshInstance(t.mesh,o,new pc.GraphNode("uranus-instancer-payload"));l.pick=!1,l.flipFaces=this.shouldFlipFaces(t.node),l.flipFacesFactor=t.node.worldTransform.scaleSign,l.castShadow=s,l.aabb.center.copy(t.aabb.center),l.aabb.halfExtents.copy(t.aabb.halfExtents),s?a.addShadowCasters([l]):a.addMeshInstances([l],!0);const c=new pc.VertexBuffer(this.app.graphicsDevice,pc.VertexFormat.defaultInstancingFormat,0,pc.BUFFER_DYNAMIC,new Float32Array);l.setInstancing(c);const d={basePayload:void 0,cells:new Map,firstTimeVisible:!0,id:e,instances:[],layer:a,lodIndex:this.hasLod?UranusInstancerLod.prototype.getLodIndexFromName(t.node.name):-1,meshInstance:l,onlyCells:!0,refBoundingBox:new pc.BoundingBox,refBufferInstances:[],refMaterial:t.material,refMeshInstances:[],refPayload:void 0,singleInstance:!1,shadowCaster:s,shouldCloneMaterial:r,vertexBuffer:c,updateFrequency:void 0,updateFrequencyTime:void 0,updateFrequencyLastNow:void 0};if(d.refBoundingBox.halfExtents.copy(t.aabb.halfExtents),s||i&&d.lodIndex>0){let e=t.node.name;i&&(e=e.replace(`_LOD${d.lodIndex}`,"_LOD0"));const s=this.payloads;let n;for(let i in s){const r=s[i],o=r.refMeshInstances[0];if(o&&!1===r.shadowCaster&&r.layer===a&&o.node.name===e&&!0===o.node.getLocalScale().equals(t.node.getLocalScale())){n=r;break}}n&&(i?(d.refPayload=n,d.cells=d.refPayload.cells,d.instances=d.refPayload.instances,d.refBufferInstances=d.refPayload.refBufferInstances,d.refMeshInstances=d.refPayload.refMeshInstances):d.basePayload=n)}return this.setPayloadCulling(this.frustumCulling,d),this.payloads[e]=d,d},UranusInstancer.prototype.setPayloadCulling=function(e,t){e?(t.meshInstance.cull=!0,t.meshInstance.isVisibleFunc=e=>this.isMeshInstanceVisible(e,t)):(t.meshInstance.cull=!1,delete t.meshInstance.isVisibleFunc)},UranusInstancer.prototype.isMeshInstanceVisible=function(e,t){if(e&&!t.shadowCaster){const a=e.node.getPosition(),s=this.viewPos;s[0]=a.x,s[1]=a.y,s[2]=a.z,t.meshInstance.setParameter("uranus_view_position",s),t.meshInstance.setParameter("uranus_view_position_alpha",s)}if(this.updatePayload(t,e),t.shadowCaster&&t.shouldUpdateShadows>=0){let e=!0;const a=t.meshInstance.aabb,s=t.instances;if(!1===t.onlyCells&&s)for(let t=0;t<s.length;t++){const n=s[t];if(n.cell)continue;const i=n.meshInstance;0!==i.visibleThisFrame&&(e?(e=!1,a.copy(i.aabb)):a.add(i.aabb))}const n=t.cells;n&&n.forEach((t=>{e?(e=!1,a.copy(t.aabb)):a.add(t.aabb)})),t.shouldUpdateShadows--}return!0},UranusInstancer.prototype.getPayloadMaterial=function(e,t){const a=t?e.clone():e;return e._uranusRequiresVertexColors&&(a._uranusRequiresVertexColors=!0),a.onUpdateShader=function(t){return t.useInstancing=!0,e._uranusRequiresVertexColors&&(t.vertexColors=!0),t},a.update(),a._uranusRequiresInstancing=!0,t&&this.app.fire("UranusInstancer:materialCloned",a),a},UranusInstancer.prototype.onUpdate=function(){const e=this.payloads;if(e&&this.cloneMaterials)for(let t in e)this.updatePayload(e[t])},UranusInstancer.prototype.onPreRender=function(){UranusInstancerLod.cellsVisCache&&UranusInstancerLod.cellsVisCache.forEach((e=>e.dirty=!0)),UranusInstancerCell.cellsVisCache&&UranusInstancerCell.cellsVisCache.forEach((e=>e.dirty=!0))},UranusInstancer.prototype.onPostRender=function(){const e=this.payloads;if(e)for(let t in e){const a=e[t],s=a.cells;s&&(-1===a.updateFrequencyTime&&(a.updateFrequencyTime=0,a.updateFrequencyLastNow=pc.now()),a.isCellDynamic&&s.forEach((e=>{if(!e.entityMoved)return!0;if(e.entityMoved=!1,this.autoDynamicCells){const t=e.instances;for(let e=0;e<t.length;e++)t[e].entity._dirtyNormal=!1}})))}},UranusInstancer.prototype.updatePayload=function(e,t){const a=e.refPayload?e.refPayload:e,s=e.cells,n=a.onlyCells;let i=0;const r=e.instances;if(!n&&r)for(let a=0;a<r.length;a++){const s=r[a];s.cell||(i=this.updateInstance(s,e,i,t))}if(s&&s.size>0){const r=e.refPayload&&!e.shadowCaster?e.refPayload:e;let o=!0,l=!0;for(const e of s.values())if(e.entityMoved){l=!1;break}if(!this.bypassCulling&&l&&r.updateFrequency){if(a.updateFrequencyTime>=0){const e=pc.now()-r.updateFrequencyLastNow;r.updateFrequencyTime+=e,r.updateFrequencyLastNow=pc.now(),r.updateFrequencyTime<r.updateFrequency&&(o=!1)}o&&(r.updateFrequencyTime=-1)}if(this.autoDynamicCells){let e=!1;if(r.isCellDynamic)e:for(const t of s.values()){const a=t.instances;if(a)for(let s=0;s<a.length;s++){void 0===t.entityMoved&&(e=!0);const n=a[s].entity;if(n&&!0===n.uranusCellDynamicBypass||!0===n._dirtyNormal){e=!0,t.entityMoved=!0;continue e}}}e&&(o=!0)}if(o)s.forEach((a=>{i=this.updateCell(a,e,i,t,a.entityMoved)}));else if(n)return}const o=i/16;this.updateVertexBuffer(e,!1,o),this.cloneMaterials&&this.checkPayloadMaterial(e)},UranusInstancer.prototype.checkPayloadMaterial=function(e){const t=e.refMeshInstances[0];if(!t)return;const a=t.material!==e.refMaterial;a&&(e.refMaterial=t.material);const s=e.refMaterial;if(s&&(s.dirty||a)){const t=this.getPayloadMaterial(s,e.shouldCloneMaterial);e.meshInstance.material=t,this.app.once("postrender",(function(){e.refMaterial.dirty=!1}),this)}},UranusInstancer.prototype.updateCell=function(e,t,a,s,n){if(!1===e.uranusCellVisibilityBypass)return a;if(s&&!this.bypassCulling){if(!1===UranusInstancerCell.prototype.isVisible(e,s,t.layer))return a;if(!1===this.cullInstanceLOD(e,t,s))return a}const i=t.vertexBuffer.originalStorage,r=e.buffer;if(e.hasEntities&&n){const t=e.instances;let s=0;for(let e=0;e<t.length;e++){const n=t[e].entity.getWorldTransform().data;for(let e=0;e<16;e++)i[a++]=n[e],r[s++]=n[e]}}else for(let e=0;e<r.length;e++)i[a++]=r[e];return a},UranusInstancer.prototype.updateInstance=function(e,t,a,s){let n;if(s&&(n=this.cullInstance(e,t,s),!n))return a;const i=t.vertexBuffer.originalStorage,r=e.data?e.data:e.node.getWorldTransform().data;for(let e=0;e<16;e++)i[a++]=r[e];return 2===n&&(i[a-3]=e.lodScript.skipShadowsOffset),a},UranusInstancer.shadowCameraName="ShadowCamera",UranusInstancer.prototype.cullInstanceLOD=function(e,t,a){let s=!0;const n=t.lodIndex,i=UranusInstancer.shadowCameraName===a.node.name&&a.farClip<2e5;if(this.hasLod&&(n>-1||i)){const r=t.shadowCaster,o=e.lodScript;if(o){const e=o.proxyMesh;if(e&&!0===e.uranusLodVisible)return!1}if(i||!r||o&&o.hasCustomShadowLod){let l;l=e.cullPosition?e.cullPosition:e.center?e.center:e.entity.getPosition();const c=r&&!i&&t.refPayload?t.refPayload.camera:a;s=o?o.isLodVisible(n,l,c,void 0,t,this.lodMultiplier)>0:UranusInstancerLod.prototype.isLodVisible(n,l,c,this.lodLevels,void 0,this.lodMultiplier)>0,r||(e.refLodIndices||(e.refLodIndices=[]),e.refLodIndices[n]=s),e.isVisible=s}else if(o&&o.skipShadowsLod){const t=e.refLodIndices;if(t){s=!1;for(let e=0;e<t.length;e++)if(!0===t[e]){s=2;break}}else s=2}else e.refLodIndices?s=e.refLodIndices[n]:e.refInstance&&(s=e.refInstance.isVisible)}return t.refPayload||(t.camera=a),e.entity&&(e.entity.uranusLodVisible=!1!==s),s},UranusInstancer.prototype.cullInstance=function(e,t,a){const s=this.bypassCulling,n=this.cullInstanceLOD(e,t,a);if(!1===n&&!s)return n;if(e.entity&&!1===e.entity.uranusZoneActive)return!1;if(s)return 2!==n||n;{const t=e.meshInstance;e.data&&t.aabb.center.copy(e.cullPosition);let s=t._isVisible(a);return t.visibleThisFrame=s,s=s>0,s&&2===n?n:s}},UranusInstancer.prototype.overrideEngine=function(){const e=pc.Layer.prototype.addMeshInstances;pc.Layer.prototype.addMeshInstances=function(t,a){if(UranusInstancer.api&&UranusInstancer.api.enabled&&UranusInstancer.api.isLayerValid(this)){let s=[];t.forEach((e=>{UranusInstancer.api.addMeshInstance(e,layer=this,a,!1)||s.push(e)})),arguments[0]=s,e.apply(this,arguments)}else e.apply(this,arguments)};const t=pc.Layer.prototype.removeMeshInstances;UranusInstancer.removeMeshInstancesFunc=t,pc.Layer.prototype.removeMeshInstances=function(e,a){if(UranusInstancer.api&&UranusInstancer.api.enabled&&UranusInstancer.api.isLayerValid(this)){let s=[];e.forEach((e=>{UranusInstancer.api.removeMeshInstance(e,layer=this,a,!1)||s.push(e)})),arguments[0]=s,t.apply(this,arguments)}else t.apply(this,arguments)};const a=pc.Layer.prototype.addShadowCasters;pc.Layer.prototype.addShadowCasters=function(e){if(UranusInstancer.api&&UranusInstancer.api.enabled&&UranusInstancer.api.isLayerValid(this)){let t=[];e.forEach((e=>{UranusInstancer.api.addMeshInstance(e,layer=this,!1,!0)||t.push(e)})),arguments[0]=t,a.apply(this,arguments)}else a.apply(this,arguments)};const s=pc.Layer.prototype.removeShadowCasters;pc.Layer.prototype.removeShadowCasters=function(e){if(UranusInstancer.api&&UranusInstancer.api.enabled&&UranusInstancer.api.isLayerValid(this)){let t=[];e.forEach((e=>{UranusInstancer.api.removeMeshInstance(e,layer=this,!1,!0)||t.push(e)})),arguments[0]=t,s.apply(this,arguments)}else s.apply(this,arguments)}},UranusInstancer.prototype.overrideMeshInstance=function(e,t){Object.defineProperty(e,"material",{set:function(e){this.clearShaders();const a=this._material;if(a&&a.removeMeshInstanceRef(this),this._material=e,this._material){this._material.addMeshInstanceRef(this),this.updateKey();if((a&&a.blendType!==pc.BLEND_NONE)!==(this._material.blendType!==pc.BLEND_NONE)){let e=this._material._scene;!e&&a&&a._scene&&(e=a._scene),e?e.layers._dirtyBlend=!0:this._material._dirtyBlend=!0}t&&this._mesh&&t()}},get:function(){return this._material},configurable:!0})};var UranusInstancerOcclusion=pc.createScript("uranusInstancerOcclusion");UranusInstancerOcclusion.attributes.add("inEditor",{type:"boolean",default:!1}),UranusInstancerOcclusion.attributes.add("occlusionType",{type:"string",default:"occluder",enum:[{Occluder:"occluder"},{Occludee:"occludee"}],title:"Occlusion Type",description:"1. Occluder: this entity will act as an occluder and obstruct occludees. 2. Occludee: this entity will act as an occludee and getting obstructed by occluders. A hardware occlusion query will execute for this entity based on its occlusion shape. The entity will be automatically change its visible status based on the query result."}),UranusInstancerOcclusion.attributes.add("occlusionShape",{type:"string",default:"calculateBounding",enum:[{"Calculate Bounding":"calculateBounding"},{"Collision Bounding":"collisionBounding"},{"Raw Geometry":"rawGeometry"},{None:"none"}],title:"Occlusion Shape",description:"1. Calculate Bounding: the script will automatically calculate the total bounding box of the model. 2. Collision Bounding: If a box collision component is provided that bounding box will be used. 3. Raw Geometry: No bounding box will be created, the raw geometry will be rendered in the Occlusion Layer. This provides accurate queries at the cost of performance. 4. None: The script will not add any model to the Occlusion Layer. Requires application restart."}),UranusInstancerOcclusion.attributes.add("isStatic",{type:"boolean",default:!0,title:"Is Static",description:"If selected the occluder will not update its position/rotation/scale per frame, this is a performance optimization."}),UranusInstancerOcclusion.attributes.add("behaviorResult",{type:"string",default:"visibilityState",enum:[{"Visibility State":"visibilityState"},{"Entity State":"entityState"},{None:"none"}],title:"Behavior Result",description:"Controls what will happen When the occlusion query returns a new visibility state (works for Occludees only). 1. Visibility State: The model will change its visibility state. 2. Entity State: The entity will change its Enabled property. 3. Nothing will happen and only onEvent will fire if provided. Useful for gameplay only queries."}),UranusInstancerOcclusion.attributes.add("refEntities",{type:"entity",array:!0,title:"Reference Entities",description:"Optionally provide one or more entities that this occludee is responsible for managing their state instead of this entity."}),UranusInstancerOcclusion.attributes.add("bypassInstancer",{type:"boolean",default:!1,title:"Bypass Instancer",description:"If selected the occludee will toggle its model/render component instead of using the instancer to handle visibility."}),UranusInstancerOcclusion.attributes.add("onEvent",{type:"string",title:"On Event",description:"If an event name is provided it will automatically fire on the pc.Application context when the visibility state changes."}),UranusInstancerOcclusion.prototype.initialize=function(){this.bounding=new pc.BoundingBox,this.occlusionEntity=void 0,this.useWorldTransform=!1,this.useCollisionBounding=!1,this.glQuery=void 0,this.enableOcclusionCulling(),this.prepareOcclusionEntity(),this.addOcclusionQuery(),this.on("state",(function(t){this.occlusionEntity&&"entityState"!==this.behaviorResult&&(this.occlusionEntity.enabled=t)})),this.on("destroy",(function(){if(this.glQuery){this.app.graphicsDevice.gl.deleteQuery(this.glQuery)}this.occlusionEntity&&this.occlusionEntity.destroy()}))},UranusInstancerOcclusion.prototype.update=function(){!1===this.isStatic&&this.occlusionEntity&&this.updateTransform()},UranusInstancerOcclusion.prototype.updateTransform=function(){const t=this.entity,e=this.occlusionEntity;if(this.useWorldTransform){const n=t.getWorldTransform();e.setPosition(n.getTranslation()),e.setEulerAngles(n.getEulerAngles()),e.setLocalScale(n.getScale())}else{const n=this.bounding;if(this.useCollisionBounding){const e=t.collision;n.center.copy(e.getShapePosition()),n.halfExtents.copy(e.halfExtents)}else t.render.meshInstances.forEach(((t,e)=>{0===e?n.copy(t.aabb):n.add(t.aabb)}));e.setPosition(n.center),e.setLocalScale(2*n.halfExtents.x,2*n.halfExtents.y,2*n.halfExtents.z)}},UranusInstancerOcclusion.prototype.prepareOcclusionEntity=function(){const t=this.app.scene.layers.getLayerByName("Occlusion");t&&("none"!==this.occlusionShape?("rawGeometry"===this.occlusionShape?(this.occlusionEntity=new pc.Entity,this.entity.render.system.cloneComponent(this.entity,this.occlusionEntity),this.occlusionEntity.render.layers=[t.id],this.app.root.addChild(this.occlusionEntity),this.useWorldTransform=!0):(this.occlusionEntity=new pc.Entity,this.occlusionEntity.addComponent("render",{type:"box",layers:[t.id]}),this.app.root.addChild(this.occlusionEntity),"collisionBounding"===this.occlusionShape&&this.entity.collision&&"box"===this.entity.collision.type&&(this.useCollisionBounding=!0)),this.updateTransform(),this.occlusionEntity.render.meshInstances.forEach((t=>t.isOccludee="occludee"===this.occlusionType))):this.occlusionEntity=this.entity)},UranusInstancerOcclusion.prototype.addOcclusionQuery=function(){if(!this.occlusionEntity||"occludee"===!this.occlusionType)return;const t=this.app.graphicsDevice.gl;this.occlusionEntity.render.meshInstances.forEach((e=>{const n={inProgress:!1,meshInstance:e,onOcclusionResult:t=>this.setVisibleState(t),query:t.createQuery()};this.glQuery=n.query,e.uranusInstancerOcclusion=n}))},UranusInstancerOcclusion.prototype.setVisibleState=function(t){const e=this.refEntities,n=e.length>0;this.bypassInstancer?"visibilityState"===this.behaviorResult?n?e.forEach((e=>e.render.enabled=t)):this.entity.render.enabled=t:"entityState"===this.behaviorResult&&(n?e.forEach((e=>e.enabled=t)):this.entity.enabled=t):"visibilityState"===this.behaviorResult?n?e.forEach((e=>e.uranusZoneActive=t)):this.entity.uranusZoneActive=t:"entityState"===this.behaviorResult&&(n?e.forEach((e=>e.enabled=t)):this.entity.enabled=t),this.onEvent&&this.app.fire(this.onEvent,t)},UranusInstancerOcclusion.cullingEnabled=!1,UranusInstancerOcclusion.layer=void 0,UranusInstancerOcclusion.nextLayer=void 0,UranusInstancerOcclusion.bypassCulling=void 0,UranusInstancerOcclusion.toggleDebugger=function(){const t=UranusInstancerOcclusion.nextLayer;t&&(t.clearColorBuffer=!t.clearColorBuffer,t.clearDepthBuffer=!t.clearDepthBuffer)},UranusInstancerOcclusion.setOcclusionState=function(t){UranusInstancerOcclusion.layer.opaqueMeshInstances.forEach((e=>{const n=e.uranusInstancerOcclusion;e.visible=t,!1===t&&n&&(n.onOcclusionResult(!0),n.inProgress=!1)}))},UranusInstancerOcclusion.prototype.enableOcclusionCulling=function(){if(UranusInstancerOcclusion.cullingEnabled)return;UranusInstancerOcclusion.cullingEnabled=!0;const t=this.app.scene.layers.getLayerByName("Occlusion");UranusInstancerOcclusion.layer=t,t.opaqueSortMode=pc.SORTMODE_CUSTOM,t.passThrough=!0,t.shaderPass=pc.SHADER_DEPTH;const e=this.app.scene.layers.layerList.findIndex((t=>"Occlusion"===t.name))+1,n=this.app.scene.layers.layerList[e];UranusInstancerOcclusion.nextLayer=n,n.clearColorBuffer=!0,n.clearDepthBuffer=!0,t.customCalculateSortValues=function(t,e,n,i){this._calculateSortDistances(t,e,n,i)},t.customSortCallback=function(t,e){return t.isOccludee||e.isOccludee?t.isOccludee&&e.isOccludee?e.zdist-t.zdist:t.isOccludee?1:-1:t.zdist-e.zdist},pc.app.renderer.drawInstance=function(t,e,n,i,s){const o=e.instancingData;if(o)o.count>0&&(this._instancedDrawCalls++,t.setVertexBuffer(o.vertexBuffer),t.draw(n.primitive[i],o.count));else{const o=e.node.worldTransform;this.modelMatrixId.setValue(o.data),s&&this.normalMatrixId.setValue(e.node.normalMatrix.data);const c=pc.app.graphicsDevice.gl,a=e.uranusInstancerOcclusion;if(a&&a.inProgress&&c.getQueryParameter(a.query,c.QUERY_RESULT_AVAILABLE)){const t=!!c.getQueryParameter(a.query,c.QUERY_RESULT);a.onOcclusionResult(t),a.inProgress=!1}a&&!a.inProgress&&c.beginQuery(c.ANY_SAMPLES_PASSED_CONSERVATIVE,a.query),t.draw(n.primitive[i]),a&&!a.inProgress&&(c.endQuery(c.ANY_SAMPLES_PASSED_CONSERVATIVE),a.inProgress=!0)}}.bind(pc.app.renderer)};var UranusInstancerZone=pc.createScript("uranusInstancerZone");UranusInstancerZone.attributes.add("inEditor",{type:"boolean",default:!1}),UranusInstancerZone.attributes.add("activeCameras",{type:"entity",array:!0,title:"Active Cameras",description:"A list of entities to be used for calculating the state of the occludees from. Requires a collider together with a dynamic or kinematic rigidbody."}),UranusInstancerZone.attributes.add("occluder",{type:"entity",title:"Occluder",description:"Reference an entity with a collision component attached that will act as the occluder zone. When the active camera enters the zone, all occludees will be visible."}),UranusInstancerZone.attributes.add("filters",{type:"entity",title:"Filters",description:"Optionally reference an entity with a collision component attached that will filter the occludees based on their world position. Any occludee outside of the collision trigger will be discarded and not parsed. Support collision shapes are box and sphere."}),UranusInstancerZone.attributes.add("bypassInstancer",{type:"boolean",default:!1,title:"Bypass Instancer",description:"If selected the occluder will toggle the model/render component instead of using the instancer to toggle visibility."}),UranusInstancerZone.attributes.add("occludees",{type:"entity",array:!0,title:"Occludees",description:"A list of one or more entities to find occludees. Occludees will be any render component attached to them and on their children."}),UranusInstancerZone.prototype.initialize=function(){this.lastOccluder=void 0,this.occludeeEntities=[],this.activeCamera=void 0,this.camerasInTriggers={},this.activeState=void 0,this.boundingBox=new pc.BoundingBox,this.prepare(),this.attachListeners(),this.on("attr:occluder",(function(){this.detachListeners(),this.attachListeners()})),this.on("destroy",this.onDestroy)},UranusInstancerZone.prototype.prepare=function(){let e=this.filters?this.filters.findComponents("collision"):[];this.occludees.forEach((t=>{const n=t.findComponents("render");let i=this.filterOccludees(n,e);i=i.filter((e=>!0===e.entity.enabled&&!0===e.enabled)),this.occludeeEntities=this.occludeeEntities.concat(i.map((e=>e.entity)))}))},UranusInstancerZone.prototype.filterOccludees=function(e,t){if(t.length>0){let n=[];const i=this.boundingBox;e:for(const s of t){let t;switch(s.type){case"box":i.center.copy(s.entity.getPosition()),i.halfExtents.copy(s.halfExtents);break;case"sphere":t=s.entity.getPosition();break;default:continue e}for(const r of e){const e=r.entity.getPosition();let o=!1;switch(s.type){case"box":o=i.containsPoint(e);break;case"sphere":o=t.distance(e)<=s.radius;break;default:continue e}o&&-1===n.indexOf(r)&&n.push(r)}}return n}return e},UranusInstancerZone.prototype.onDestroy=function(){this.detachListeners()},UranusInstancerZone.prototype.attachListeners=function(){if(!this.occluder)return;this.occluder.findComponents("collision").forEach((e=>{e.on("triggerenter",this.onTriggerEnter,this),e.on("triggerleave",this.onTriggerLeave,this)})),this.lastOccluder=this.occluder},UranusInstancerZone.prototype.detachListeners=function(){if(!this.lastOccluder)return;this.occluder.findComponents("collision").forEach((e=>{e.off("triggerenter",this.onTriggerEnter,this),e.off("triggerleave",this.onTriggerLeave,this)})),this.lastOccluder=void 0},UranusInstancerZone.prototype.onTriggerEnter=function(e){e===this.activeCamera&&(this.camerasInTriggers[e._guid]||(this.camerasInTriggers[e._guid]=0),this.camerasInTriggers[e._guid]++)},UranusInstancerZone.prototype.onTriggerLeave=function(e){e===this.activeCamera&&this.camerasInTriggers[e._guid]--},UranusInstancerZone.prototype.isActive=function(){return this.activeCamera&&this.camerasInTriggers&&this.camerasInTriggers[this.activeCamera._guid]>0},UranusInstancerZone.prototype.update=function(e){let t;if(this.activeCameras.forEach((e=>{e.enabled&&(t=e)})),!t){const e=this.app.scene.layers.cameras;if(0===e.length)return;t=e[e.length-1].entity}this.activeCamera=t;const n=this.isActive();n!==this.activeState&&(this.activeState=n,this.setOccluderState(n))},UranusInstancerZone.prototype.setOccluderState=function(e){this.bypassInstancer?this.occludeeEntities.forEach((t=>{const n=t.render?t.render:t.model;n&&(n.enabled=e)})):this.occludeeEntities.forEach((t=>t.uranusZoneActive=e))};var UranusGraphicsSettings=pc.createScript("uranusGraphicsSettings");UranusGraphicsSettings.attributes.add("inEditor",{type:"boolean",default:!1}),UranusGraphicsSettings.attributes.add("showDialog",{type:"boolean",default:!0,title:"Show Dialog"}),UranusGraphicsSettings.attributes.add("startingPreset",{type:"string",default:"desktop",title:"Starting Preset"}),UranusGraphicsSettings.attributes.add("autoSelectPreset",{type:"boolean",default:!0,title:"Auto Select Preset",description:"If selected a graphics preset will automatically be selected based on the device platform."}),UranusGraphicsSettings.attributes.add("lobbyEntity",{type:"entity",title:"Lobby Entity",description:"If an entity is provided the lobby entity will be enabled as soon as the settings dialog is enabled."}),UranusGraphicsSettings.attributes.add("startEntity",{type:"entity",title:"Start Entity",description:"If an entity is provided a start button will be created to enable that entity on user's action. The lobby entity will be disabled at the same time."}),UranusGraphicsSettings.attributes.add("playerControllers",{type:"entity",array:!0,title:"Player Controllers",description:"One or more player controllers to be used with the Toggle Controller button."}),UranusGraphicsSettings.attributes.add("defaultController",{type:"entity",title:"Default Controller",description:"The default controller the game will start with."}),UranusGraphicsSettings.attributes.add("grassObjects",{type:"entity",array:!0,title:"Grass Objects",description:"A list of entities to be disabled if grass is disabled in settings."}),UranusGraphicsSettings.attributes.add("terrainEntities",{type:"entity",array:!0,title:"Terrain Entities",description:"If one or more terrain entities are provided, they will be binded to the terrain shadows toggle."}),UranusGraphicsSettings.attributes.add("minTerrainLod",{type:"number",title:"Min Terrain Lod",description:"The minimum terrain LOD when no shadows are cast from the terain."}),UranusGraphicsSettings.attributes.add("soundVolume",{type:"number",default:.25,min:0,max:1,title:"Sound Volume"}),UranusGraphicsSettings.attributes.add("mapButton",{type:"boolean",default:!1,title:"Map Button"}),UranusGraphicsSettings.attributes.add("downgradePreset",{type:"json",schema:[{name:"minPreset",type:"string",default:"android",title:"Min Preset",description:"Preset to fall back to if minimum FPS threshold is crossed. Leave blank to disable the check."},{name:"minFps",type:"number",default:20,min:1,title:"Min FPS",description:"The minimum FPS limit."},{name:"minTime",type:"number",default:3,min:0,title:"Min Time",description:"The time in seconds the FPS should be lower than the limit to force a downgrade."},{name:"startTime",type:"number",default:5,min:0,title:"Start Time",description:"The time in seconds counting from the application start the downgrade check should be enabled. Set to 0 to keep it always enabled."}],title:"Downgrade Preset"}),UranusGraphicsSettings.attributes.add("presets",{type:"json",array:!0,schema:[{name:"id",type:"string",default:"mobile",title:"ID"},{name:"title",type:"string",default:"Mobile",title:"Title",description:"The title of the preset shown in the dialog."},{name:"platforms",type:"string",default:"mobile",title:"Platforms"},{name:"resolution",type:"number",min:0,max:2,default:1,title:"Resolution",description:"This defines how much the resolution will be downscaled or upscaled in relation to the viewport resolution. Leverage the browser bilinear filtering to increase performance by rendering your application in a lower resolution. Or render to a higher resolution for reducing anti alias."},{name:"devicePixelRatio",type:"number",min:0,max:1,default:0,title:"Device Pixel Ratio",description:"A normalized value 0-1 to indicate min/max device pixel ratio."},{name:"fogNoise",type:"boolean",default:!1,title:"Fog Noise",description:"Requires page reload."},{name:"grass",type:"boolean",default:!1,title:"Grass",description:"Requires page reload."},{name:"lights",type:"boolean",default:!1,title:"Lights"},{name:"lodMultiplier",type:"number",min:.25,max:3,default:1,title:"LOD Multiplier"},{name:"localShadows",type:"boolean",default:!1,title:"Local Shadows"},{name:"postEffects",type:"boolean",default:!1,title:"Post Effects"},{name:"postEffectsTypes",type:"string",default:"ssao,bloom,fxaa,vignette,chromaticAberration,sharpen,bokeh",title:"Post Effects Types"},{name:"planarReflections",type:"boolean",default:!1,title:"Planar Reflections"},{name:"playerParticles",type:"boolean",default:!0,title:"Player Particles"},{name:"sunShadows",type:"boolean",default:!1,title:"Sun Shadows"},{name:"shadowsCascades",type:"number",min:1,max:4,precision:0,default:2,title:"Shadows Cascades"},{name:"shadowsDistance",type:"number",min:1,max:1e3,precision:0,default:600,title:"Shadows Distance"},{name:"skyClouds",type:"boolean",default:!1,title:"Sky Clouds"},{name:"surfaceBlend",type:"boolean",default:!1,title:"Surface Blend"}]}),UranusGraphicsSettings.postEffectsTypes=["ssao","bloom","fxaa","vignette","chromaticAberration","sharpen","bokeh","hueSaturation"],UranusGraphicsSettings.prototype.initialize=function(){UranusGraphicsSettings.api=this,this.activePreset=void 0,this.dialogPane=void 0,this.dialogInputs={},this.buttons={},this.activePlayerController=this.playerControllers[0],this.gameStarted=!1,this.gameStartTime=0,this.prepare(),this.updateSettings(),this.showDialog&&(this.lobbyEntity&&(this.lobbyEntity.enabled=!0),this.startEntity&&(this.startEntity.enabled=!1),this.createDialog()),this.on("attr",((t,e)=>{"startingPreset"===t?this.setSelectedPreset(e):this.setSelectedPreset(this.startingPreset),this.updateSettings()})),this.app.on("UranusGraphicsSettings:startGame",this.startGame,this),this.app.on("UranusGraphicsSettings:setButtonState",this.setButtonState,this),this.app.on("UranusGraphicsSettings:setPreset",(function(t){t?this.setSelectedPreset(t):this.setSelectedPreset(this.startingPreset),this.updateSettings()}),this)},UranusGraphicsSettings.prototype.prepare=function(){if(this.app.systems.sound.volume=this.soundVolume,this.autoSelectPreset){const t=this.presets.slice().reverse().find((t=>{if(!t.platforms)return!1;let e=!1;return t.platforms.split(",").forEach((t=>{!e&&pc.platform[t]&&(e=!0)})),e}));t&&(this.startingPreset=t.id)}const t=this.getPresetByName(this.startingPreset);this.activePreset=JSON.parse(JSON.stringify(t)),this.activePresetID=this.activePreset.id,this.activePreset.id=void 0},UranusGraphicsSettings.prototype.update=function(t){const e=this.downgradePreset,i=e.minPreset;if(this.gameStartTime+=t,e&&(0===e.startTime||this.gameStartTime<=e.startTime)&&i!==this.activePresetID){const s=pc.app.stats?.frame?.fps;s>0&&s<=e.minFps?(void 0===this.downgradeTimer&&(this.downgradeTimer=e.minTime),this.downgradeTimer-=t,this.downgradeTimer<=0&&(this.downgradeTimer=void 0,this.app.fire("UranusGraphicsSettings:setPreset",i))):this.downgradeTimer=void 0}},UranusGraphicsSettings.prototype.setSelectedPreset=function(t){if(t){const e=this.getPresetByName(t);for(let t in e)"id"!==t?this.activePreset[t]=e[t]:this.activePresetID=e[t]}},UranusGraphicsSettings.prototype.getPresetByName=function(t){return this.presets.find((e=>e.id===t))},UranusGraphicsSettings.prototype.getScriptInstancesByType=function(t){return this.app.root.find((e=>e.script&&e.script[t])).map((e=>e.script[t]))},UranusGraphicsSettings.prototype.getEntitiesByTag=function(t){return this.app.root.findByTag(t)},UranusGraphicsSettings.prototype.getCameras=function(){return this.app.root.findComponents("camera")},UranusGraphicsSettings.prototype.getLights=function(){return this.app.root.findComponents("light")},UranusGraphicsSettings.prototype.addComponentLayer=function(t,e){const i=this.app.scene.layers.getLayerByName(e);if(!i)return;const s=t.layers;if(!s)return;-1===s.indexOf(i.id)&&s.push(i.id),t.layers=s},UranusGraphicsSettings.prototype.removeComponentLayer=function(t,e){const i=this.app.scene.layers.getLayerByName(e);if(!i)return;const s=t.layers;if(!s)return;const a=s.indexOf(i.id);s.splice(a,1),t.layers=s},UranusGraphicsSettings.prototype.getDevicePixelRatio=function(t){return 1+(window.devicePixelRatio-1)*t},UranusGraphicsSettings.prototype.updateSettings=function(t){t&&this.setSelectedPreset(t);const e=this.activePreset,i=this.getScriptInstancesByType("uranusGraphicsResolution")[0];if(i&&(i.resolution=e.resolution),this.app.graphicsDevice.maxPixelRatio=this.getDevicePixelRatio(e.devicePixelRatio),this.grassObjects.forEach((t=>t.enabled=e.grass)),!this.gameStarted){this.getScriptInstancesByType("uranusEffectsEnvironmentFog").forEach((t=>t.fogNoise=e.fogNoise))}UranusInstancer.api&&(UranusInstancer.api.lodMultiplier=e.lodMultiplier),this.app.root.findComponents("light").forEach((t=>{if("directional"===t.type)return!0;t.enabled=e.lights}));this.getScriptInstancesByType("uranusEffectsPlanarReflections").forEach((t=>{t.reflectionLayersOriginal||(t.reflectionLayersOriginal=t.reflectionLayers.slice()),e.planarReflections?t.reflectionLayers=t.reflectionLayersOriginal:t.reflectionLayersOriginal.indexOf("SkyReflection")>-1?t.reflectionLayers=["SkyReflection"]:t.reflectionLayers=[]}));const s=this.getLights();s.forEach((t=>{if("directional"!==t.type)return!0;void 0===t.castShadowsOriginal&&(t.castShadowsOriginal=t.castShadows),t.castShadowsOriginal&&(t.castShadows=e.sunShadows,t.numCascades=e.shadowsCascades,t.shadowDistance=e.shadowsDistance)})),s.forEach((t=>{if("directional"===t.type)return!0;void 0===t.castShadowsOriginal&&(t.castShadowsOriginal=t.castShadows),t.castShadowsOriginal&&(t.castShadows=e.localShadows,t.light.castShadowsUser=e.localShadows)}));this.getCameras().forEach((t=>{const i=t.entity;UranusGraphicsSettings.postEffectsTypes.forEach((t=>{i.script&&i.script[t]&&(i.script[t].enabled=!1)})),e.postEffectsTypes.split(",").forEach((t=>{i.script&&i.script[t]&&(i.script[t].enabled=e.postEffects)}))}));this.getScriptInstancesByType("uranusEffectsSkybox").forEach((t=>t.renderClouds=e.skyClouds));this.getScriptInstancesByType("uranusEffectsMaterialSurfaceColor").forEach((t=>{t.surfaceBlendOriginal||(t.surfaceBlendOriginal=t.surfaceBlend),t.surfaceBlendOriginal&&(t.enabled=e.surfaceBlend)})),this.app.fire("UranusGraphicsSettings:onPresetChange",this.activePresetID,e)},UranusGraphicsSettings.prototype.createDialog=function(){const t=new pcui.Container({id:"uranus-graphics-settings",grid:!1,scrollable:!0});t.style.position="absolute",t.style.right="10px",t.style.top="10px",t.style.zIndex="9999",t.style.backgroundColor="rgba(54, 67, 70, 0.64)",t.style.backdropFilter="blur(32px)",t.style.borderRadius="6px",t.style.opacity="0.8",t.style.boxShadow="2px 2px 5px rgba(0,0,0,0.3)",document.body.appendChild(t.dom);const e=new pcui.Panel({flex:!0,collapsed:!0,collapsible:!0,collapseHorizontally:!0,scrollable:!0,headerText:"Settings"}),i=e.content;e.style.width="350px",e.on("collapse",(function(){t.style.opacity="0.5"})),e.on("expand",(function(){t.style.opacity="1.0"})),t.dom.appendChild(e.dom),this.dialogPane=i.dom,this.createDialogSettings(e.content),this.addDivider(),this.createDialogButtons()},UranusGraphicsSettings.prototype.addDivider=function(){const t=new pcui.Divider;this.dialogPane.appendChild(t.dom)},UranusGraphicsSettings.prototype.createDialogSettings=function(t){this.createDialogInput(t,"SelectInput",void 0,"Graphics Preset",{options:this.presets.map(((t,e)=>({v:t.id,t:t.title}))),value:this.startingPreset},(t=>{this.updateSettings(t);for(let t in this.activePreset){const e=this.dialogInputs[t];e&&(e.value=this.activePreset[t])}})),this.createDialogInput(t,"SliderInput",void 0,"Time of Day",{min:0,max:24,precision:2,value:12},(t=>{this.app.fire("UranusEffectsSkybox:setTime",t)}));const e=new pcui.Panel({flex:!0,collapsed:!0,collapsible:!0,scrollable:!0,headerText:"Graphics"});this.dialogPane.appendChild(e.dom),this.createDialogInput(e,"SliderInput","resolution","Resolution",{min:.01,max:2,precision:2,value:this.activePreset.resolution},(t=>{this.activePreset.resolution=t,this.updateSettings()})),this.createDialogInput(e,"SliderInput","devicePixelRatio","Device Pixel Ratio",{min:0,max:2,precision:2,value:this.activePreset.devicePixelRatio},(t=>{this.app.graphicsDevice.maxPixelRatio=this.getDevicePixelRatio(t)})),this.createDialogInput(e,"BooleanInput","fogNoise","Fog Noise *",{value:this.activePreset.fogNoise},(t=>{this.activePreset.fogNoise=t,this.updateSettings()})),this.createDialogInput(e,"BooleanInput","grass","Grass *",{value:this.activePreset.grass},(t=>{this.activePreset.grass=t,this.updateSettings()})),this.createDialogInput(e,"BooleanInput","lights","Local Lights",{value:this.activePreset.lights},(t=>{this.activePreset.lights=t,this.updateSettings()})),this.createDialogInput(e,"SliderInput","lodMultiplier","LOD Multiplier",{min:.25,max:3,precision:2,value:this.activePreset.lodMultiplier},(t=>{this.activePreset.lodMultiplier=t,this.updateSettings()})),this.createDialogInput(e,"BooleanInput","planarReflections","Planar Reflections",{value:this.activePreset.planarReflections},(t=>{this.activePreset.planarReflections=t,this.updateSettings()})),this.createDialogInput(e,"BooleanInput","localShadows","Local Shadows",{value:this.activePreset.localShadows},(t=>{this.activePreset.localShadows=t,this.updateSettings()})),this.createDialogInput(e,"BooleanInput","postEffects","Post Effects",{value:this.activePreset.postEffects},(t=>{this.activePreset.postEffects=t,this.updateSettings()})),this.createDialogInput(e,"TextInput","postEffectsTypes","Post Effects Types",{value:this.activePreset.postEffectsTypes},(t=>{this.activePreset.postEffectsTypes=t,this.updateSettings()})),this.createDialogInput(e,"SliderInput","shadowsCascades","Shadows Cascades",{min:1,max:4,precision:0,value:this.activePreset.shadowsCascades},(t=>{this.activePreset.shadowsCascades=t,this.updateSettings()})),this.createDialogInput(e,"SliderInput","shadowsDistance","Shadows Distance",{min:200,max:1e3,precision:0,value:this.activePreset.shadowsDistance},(t=>{this.activePreset.shadowsDistance=t,this.updateSettings()})),this.createDialogInput(e,"BooleanInput","skyClouds","Sky Clouds",{value:this.activePreset.skyClouds},(t=>{this.activePreset.skyClouds=t,this.updateSettings()})),this.createDialogInput(e,"BooleanInput","sunShadows","Sun Shadows",{value:this.activePreset.sunShadows},(t=>{this.activePreset.sunShadows=t,this.updateSettings()})),this.createDialogInput(e,"BooleanInput","surfaceBlend","Surface Blend",{value:this.activePreset.surfaceBlend},(t=>{this.activePreset.surfaceBlend=t,this.updateSettings()}));const i=new pcui.LabelGroup({text:"* requires reload",flexShrink:0});i.label.width=320,i.style.textAlign="right",i.style.fontSize="13px",e.dom.appendChild(i.dom)},UranusGraphicsSettings.prototype.createDialogInput=function(t,e,i,s,a,n){const r=new pcui.LabelGroup({text:s,flexShrink:0});r.label.width=150;const o=new pcui[e](a);i&&(this.dialogInputs[i]=o),o.on("change",n),r.dom.appendChild(o.dom),t.dom.appendChild(r.dom)},UranusGraphicsSettings.prototype.createDialogButtons=function(){const t=new pcui.Panel({collapsible:!1,headerText:"Actions"}),e=t.content;if(this.startEntity){const t=new pcui.Button({text:"Start Game"});this.buttons.startGame=t,t.on("click",(()=>{t.enabled=!1,window.setTimeout((()=>{this.startGame()}),200)})),e.dom.appendChild(t.dom)}if(this.playerControllers.length>1){const t=new pcui.Button({text:"Toggle Controller"});t.enabled=!1;const i="toggleController";this.buttons[i]=t,t.on("click",(()=>{this.toggleController(),this.app.fire(`UranusGraphicsSettings:onButtonClick:${i}`)})),e.dom.appendChild(t.dom)}if(this.mapButton){const t=new pcui.Button({text:"Toggle Map"});t.enabled=!1;const i="toggleMap";this.buttons[i]=t,t.on("click",(()=>{this.app.fire(`UranusGraphicsSettings:onButtonClick:${i}`)})),e.dom.appendChild(t.dom)}this.dialogPane.appendChild(t.dom)},UranusGraphicsSettings.prototype.startGame=function(){this.gameStarted=!0,this.setButtonState("startGame",!1),this.playerControllers.length>1&&this.setButtonState("toggleController",!0),this.defaultController&&this.enableController(this.defaultController),this.lobbyEntity&&(this.lobbyEntity.enabled=!1),this.startEntity&&(this.startEntity.enabled=!0),this.enableController(this.activePlayerController),this.app.fire("UranusGraphicsSettings:onGameStart")},UranusGraphicsSettings.prototype.setButtonState=function(t,e){const i=this.buttons[t];i&&(i.enabled=e)},UranusGraphicsSettings.prototype.enableController=function(t){if(!t)return;this.playerControllers.forEach((t=>t.enabled=!1)),this.app.mouse.disablePointerLock(),t.enabled=!0;const e=this.activePlayerController;this.activePlayerController=t,this.activeControllerUpdateEffects(),this.app.fire("UranusGraphicsSettings:changeController",this.activePlayerController,e)},UranusGraphicsSettings.prototype.activeControllerUpdateEffects=function(){const t=this.activePlayerController.findComponent("camera"),e=t.entity;if(this.activePreset.postEffects&&t){t.postEffects.destroy();try{t.postEffects=new pc.PostEffectQueue(this.app,e)}catch(t){}this.activePreset.postEffectsTypes.split(",").forEach((t=>{e.script&&e.script[t]&&(e.script[t].enabled=!1,e.script[t].enabled=!0)}))}},UranusGraphicsSettings.prototype.toggleController=function(t){t||(t=this.playerControllers.findIndex((t=>t===this.activePlayerController))),++t>=this.playerControllers.length&&(t=0);const e=this.playerControllers[t];!e.tags.has("settings-controller-mouse")||this.app.mouse?this.enableController(e):this.toggleController(t)};var UranusGraphicsResolution=pc.createScript("uranusGraphicsResolution");UranusGraphicsResolution.attributes.add("inEditor",{type:"boolean",default:!1}),UranusGraphicsResolution.attributes.add("resolution",{type:"number",min:.01,max:2,default:1,title:"Resolution",description:"This defines how much the resolution will be downscaled or upscaled in relation to the viewport resolution. Leverage the browser bilinear filtering to increase performance by rendering your application in a lower resolution. Or render to a higher resolution for reducing anti alias."}),UranusGraphicsResolution.prototype.initialize=function(){this.lastEntryWidth=void 0,this.lastEntryHeight=void 0,this.lastResolution=void 0,this.prepare(),this.on("attr:resolution",this.updateResolution)},UranusGraphicsResolution.prototype.prepare=function(){this.resizeObserver=new ResizeObserver(this.updateResolution.bind(this)),this.resizeObserver.observe(this.app.graphicsDevice.canvas)},UranusGraphicsResolution.prototype.updateResolution=function(t){let i=!1;if(t[0]&&(i=!0,this.lastEntryWidth=t[0].contentRect.width,this.lastEntryHeight=t[0].contentRect.height),this.lastResolution===this.resolution&&!i)return;const e=this.lastEntryWidth*this.resolution,s=this.lastEntryHeight*this.resolution;isNaN(e)||isNaN(s)||(this.app.setCanvasResolution(pc.RESOLUTION_FIXED,e,s),this.app.setCanvasFillMode(pc.FILLMODE_FILL_WINDOW,e,s),this.lastResolution=this.resolution)};var UranusControllerPicker=pc.createScript("uranusControllerPicker");UranusControllerPicker.attributes.add("activeCameras",{type:"entity",array:!0,title:"Active Cameras",description:"A list of cameras that can be used for picking. Only the last enabled camera will be used each time."}),UranusControllerPicker.attributes.add("playerEntities",{type:"entity",array:!0,title:"Player Entities",description:"A list of player entities that the picker event will fire on."}),UranusControllerPicker.attributes.add("pickerEvent",{type:"string",title:"Picker Event",description:"The entity event to fire on pick."}),UranusControllerPicker.attributes.add("excludeEntities",{type:"entity",array:!0,title:"Exclude Entities",description:"A list of entities to exclude from picking. Requires application restart."}),UranusControllerPicker.attributes.add("useRaycastAll",{type:"boolean",default:!1,title:"Use Raycast All",description:"If selected the raycaster will do a raycastAll and return a list of entities instead of the first one. The list of entities will be sorted by distance and the first entity that matches all filters will be selected."}),UranusControllerPicker.prototype.initialize=function(){this.excludeList=this.excludeEntities.map((t=>t._guid)),this.app.mouse.on(pc.EVENT_MOUSEUP,this.mouseUp,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.touchStart,this)},UranusControllerPicker.prototype.getActiveCamera=function(){let t;if(this.activeCameras.length>0)this.activeCameras.forEach((e=>{e.enabled&&(t=e)}));else{const e=this.app.scene.layers.cameras,i=e[e.length-1];if(!i)return;t=i.entity}return t},UranusControllerPicker.prototype.mouseUp=function(t){t.element===this.app.graphicsDevice.canvas&&t.button===pc.MOUSEBUTTON_LEFT&&this.doRaycast(t)},UranusControllerPicker.prototype.touchStart=function(t){t.element===this.app.graphicsDevice.canvas&&(1==t.touches.length&&this.doRaycast(t.touches[0]),t.event.preventDefault())},UranusControllerPicker.prototype.doRaycast=function(t){const e=this.getActiveCamera();if(!e)return;const i=e.camera.screenToWorld(t.x,t.y,e.camera.nearClip),r=e.camera.screenToWorld(t.x,t.y,e.camera.farClip);let a;if(this.useRaycastAll){results=this.app.systems.rigidbody.raycastAll(i,r);const t=e.getPosition(),s=[];results.forEach((e=>{this.excludeList.indexOf(e.entity._guid)>-1||(e.distance=t.distance(e.point),s.push(e))})),s.sort(((t,e)=>t.distance>e.distance?1:-1)),a=s[0]}else a=this.app.systems.rigidbody.raycastFirst(i,r);a&&this.playerEntities.forEach((t=>{t.fire(this.pickerEvent,a.point,a)}))};pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);if(this._add.length){for(let t=0;t<this._add.length;t++)this._tweens.indexOf(this._add[t])>-1||this._tweens.push(this._add[t]);this._add.length=0}}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this},from:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,s;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,s))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,void 0!==this._properties.w?(this._fromQuat.copy(this.target),this._toQuat.set(i,e,s,this._properties.w)):(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),this._toQuat.setFromEulerAngles(i,e,s)))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},onUpdate:function(t){return this.on("update",t),this},onComplete:function(t){return this.on("complete",t),this},onLoop:function(t){return this.on("loop",t),this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time-=this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,s,n=0===this.duration?1:this.time/this.duration,r=this.easing(n);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],s=this._ev[h],this.target[h]=e+(s-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties){var e=this._sv[i];this._sv[i]=this._ev[i],this._ev[i]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},BounceIn=function(t){return 1-BounceOut(1-t)};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,s=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=s*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*.5+1)}}}()),function(){pc.AppBase.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.AppBase.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.AppBase.getApplication();t&&t.addTweenManager()}();// pcui-4.0.11.min.js
(()=>{"use strict";var e={d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t);var i={};e.r(i),e.d(i,{ArrayInput:()=>me,BindingBase:()=>r,BindingElementToObservers:()=>a,BindingObserversToElement:()=>d,BindingTwoWay:()=>u,BooleanInput:()=>we,Button:()=>W,Canvas:()=>Ce,Code:()=>Te,ColorPicker:()=>Ne,Container:()=>F,Divider:()=>Be,Element:()=>R,GradientPicker:()=>Et,GridView:()=>Lt,GridViewItem:()=>Dt,InfoBox:()=>Nt,InputElement:()=>te,Label:()=>j,LabelGroup:()=>qt,Menu:()=>$t,MenuItem:()=>Jt,NumericInput:()=>ae,Overlay:()=>Re,Panel:()=>ee,Progress:()=>ni,RadioButton:()=>Mt,SelectInput:()=>gt,SliderInput:()=>ci,Spinner:()=>pi,TextAreaInput:()=>wi,TextInput:()=>Ve,TreeView:()=>Fi,TreeViewItem:()=>zi,VectorInput:()=>ji,revision:()=>Wi,version:()=>qi});class n{constructor(e,t,i){this.owner=e,this.name=t,this.fn=i}unbind(){this.owner&&(this.owner.unbind(this.name,this.fn),this.owner=null,this.name=null,this.fn=null)}call(){this.fn&&this.fn.call(this.owner,arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7])}on(e,t){return this.owner.on(e,t)}}class s{constructor(){Object.defineProperty(this,"_events",{enumerable:!1,configurable:!1,writable:!0,value:{}}),this._suspendEvents=!1,this._additionalEmitters=[]}set suspendEvents(e){this._suspendEvents=!!e}get suspendEvents(){return this._suspendEvents}on(e,t){const i=this._events[e];return void 0===i?this._events[e]=[t]:-1===i.indexOf(t)&&i.push(t),new n(this,e,t)}once(e,t){const i=this.on(e,((e,n,s,o,r,l,a,h)=>{t.call(this,e,n,s,o,r,l,a,h),i.unbind()}));return i}emit(e,t,i,n,s,o,r,l,a){if(this._suspendEvents)return;let h=this._events[e];if(h&&h.length){h=h.slice(0);for(let d=0;d<h.length;d++)if(h[d])try{h[d].call(this,t,i,n,s,o,r,l,a)}catch(t){console.info("%c%s %c(event error)","color: #06f",e,"color: #f00"),console.log(t.stack)}}return this._additionalEmitters.length&&this._additionalEmitters.slice().forEach((h=>{h.emit(e,t,i,n,s,o,r,l,a)})),this}unbind(e,t){if(e){const i=this._events[e];if(!i)return this;if(t){const n=i.indexOf(t);-1!==n&&(1===i.length?delete this._events[e]:i.splice(n,1))}else delete this._events[e]}else this._events={};return this}addEmitter(e){this._additionalEmitters.includes(e)||this._additionalEmitters.push(e)}removeEmitter(e){const t=this._additionalEmitters.indexOf(e);-1!==t&&this._additionalEmitters.splice(t,1)}}class o extends s{constructor(e,t={}){if(super(),this._destroyed=!1,this._path="",this._keys=[],this._data={},this._pathsWithDuplicates=null,t.pathsWithDuplicates){this._pathsWithDuplicates={};for(let e=0;e<t.pathsWithDuplicates.length;e++)this._pathsWithDuplicates[t.pathsWithDuplicates[e]]=!0}this.patch(e),this._parent=t.parent||null,this._parentPath=t.parentPath||"",this._parentField=t.parentField||null,this._parentKey=t.parentKey||null,this._latestFn=t.latestFn||null,this._silent=!1;const i=function(e){return function(t,i,n,s){if(!this._parent)return;let o,r=this._parentKey;!r&&this._parentField instanceof Array&&(r=this._parentField.indexOf(this),-1===r)||(t=this._parentPath+"."+r+"."+t,this._silent&&(o=this._parent.silence()),this._parent.emit(t+":"+e,i,n,s),this._parent.emit("*:"+e,t,i,n,s),this._silent&&this._parent.silenceRestore(o))}};this.on("*:set",i("set")),this.on("*:unset",i("unset")),this.on("*:insert",i("insert")),this.on("*:remove",i("remove")),this.on("*:move",i("move"))}static _splitPath(e){const t=o._splitPathsCache;let i=t[e];return i?i=i.slice():(i=e.split("."),t[e]=i),i}silence(){this._silent=!0;const e=this.history&&this.history.enabled;e&&(this.history.enabled=!1);const t=this.sync&&this.sync.enabled;return t&&(this.sync.enabled=!1),[e,t]}silenceRestore(e){this._silent=!1,e[0]&&(this.history.enabled=!0),e[1]&&(this.sync.enabled=!0)}_prepare(e,t,i,n,s){let r,l;const a=(e._path?e._path+".":"")+t,h=typeof i;if(e._keys.push(t),"object"===h&&i instanceof Array){for(e._data[t]=i.slice(0),r=0;r<e._data[t].length;r++)"object"==typeof e._data[t][r]&&null!==e._data[t][r]?e._data[t][r]instanceof Array?e._data[t][r].slice(0):e._data[t][r]=new o(e._data[t][r],{parent:this,parentPath:a,parentField:e._data[t],parentKey:null}):(l=this.silence(),this.emit(a+"."+r+":set",e._data[t][r],null,s),this.emit("*:set",a+"."+r,e._data[t][r],null,s),this.silenceRestore(l));n&&(l=this.silence()),this.emit(a+":set",e._data[t],null,s),this.emit("*:set",a,e._data[t],null,s),n&&this.silenceRestore(l)}else if("object"===h&&i instanceof Object){for(r in"object"!=typeof e._data[t]&&(e._data[t]={_path:a,_keys:[],_data:{}}),i)"object"==typeof i[r]?this._prepare(e._data[t],r,i[r],!0,s):(l=this.silence(),e._data[t]._data[r]=i[r],e._data[t]._keys.push(r),this.emit(a+"."+r+":set",i[r],null,s),this.emit("*:set",a+"."+r,i[r],null,s),this.silenceRestore(l));n&&(l=this.silence()),this.emit(a+":set",i,void 0,s),this.emit("*:set",a,i,void 0,s),n&&this.silenceRestore(l)}else n&&(l=this.silence()),e._data[t]=i,this.emit(a+":set",i,void 0,s),this.emit("*:set",a,i,void 0,s),n&&this.silenceRestore(l);return!0}set(e,t,i,n,s){let r,l,a=o._splitPath(e);const h=a.length,d=a[h-1];let c,u,p=this,g="",_=this;for(r=0;r<h-1;r++)p instanceof Array?(p=p[a[r]],p instanceof o&&(e=a.slice(r+1).join("."),_=p)):(r<h&&"object"!=typeof p._data[a[r]]&&(p._data[a[r]]&&_.unset((p.__path?p.__path+".":"")+a[r]),p._data[a[r]]={_path:e,_keys:[],_data:{}},p._keys.push(a[r])),r===h-1&&p.__path&&(g=p.__path+"."+a[r]),p=p._data[a[r]]);if(p instanceof Array){const r=parseInt(d,10);if(p[r]===t&&!s)return;return l=p[r],l=l instanceof o?l.json():_.json(l),p[r]=t,t instanceof o&&(t._parent=_,t._parentPath=g,t._parentField=p,t._parentKey=null),i&&(c=_.silence()),_.emit(e+":set",t,l,n),_.emit("*:set",e,t,l,n),i&&_.silenceRestore(c),!0}if(p._data&&!p._data.hasOwnProperty(d))return"object"==typeof t?_._prepare(p,d,t,!1,n):(p._data[d]=t,p._keys.push(d),i&&(c=_.silence()),_.emit(e+":set",t,null,n),_.emit("*:set",e,t,null,n),i&&_.silenceRestore(c),!0);if("object"==typeof t&&t instanceof Array){if(t.equals(p._data[d])&&!s)return!1;if(l=p._data[d],l instanceof o||(l=_.json(l)),p._data[d]&&p._data[d].length===t.length){for(c=_.silence(),0===t.length&&(p._data[d]=t),r=0;r<p._data[d].length;r++)p._data[d][r]instanceof o?p._data[d][r].patch(t[r],!0):p._data[d][r]!==t[r]&&(p._data[d][r]=t[r],_.emit(e+"."+r+":set",p._data[d][r],l&&l[r]||null,n),_.emit("*:set",e+"."+r,p._data[d][r],l&&l[r]||null,n));_.silenceRestore(c)}else{for(p._data[d]=[],t.forEach((e=>{this._doInsert(p,d,e,void 0,!0)})),c=_.silence(),r=0;r<p._data[d].length;r++)_.emit(e+"."+r+":set",p._data[d][r],l&&l[r]||null,n),_.emit("*:set",e+"."+r,p._data[d][r],l&&l[r]||null,n);_.silenceRestore(c)}return i&&(c=_.silence()),_.emit(e+":set",t,l,n),_.emit("*:set",e,t,l,n),i&&_.silenceRestore(c),!0}if("object"==typeof t&&t instanceof Object){let s,h=!1;l=p._data[d],l instanceof o||(l=_.json(l)),a=Object.keys(t),p._data[d]&&p._data[d]._data||(p._data[d]?_.unset((p.__path?p.__path+".":"")+d):h=!0,p._data[d]={_path:e,_keys:[],_data:{}});for(const i in p._data[d]._data)t.hasOwnProperty(i)?p._data[d]._data.hasOwnProperty(i)?_._equals(p._data[d]._data[i],t[i])||(s=_.set(e+"."+i,t[i],!0),s&&(h=!0)):(s=_._prepare(p._data[d],i,t[i],!0,n),s&&(h=!0)):(s=_.unset(e+"."+i,!0),s&&(h=!0));for(r=0;r<a.length;r++)void 0===t[a[r]]&&p._data[d]._data.hasOwnProperty(a[r])?(s=_.unset(e+"."+a[r],!0),s&&(h=!0)):"object"==typeof t[a[r]]?p._data[d]._data.hasOwnProperty(a[r])?(s=_.set(e+"."+a[r],t[a[r]],!0),s&&(h=!0)):(s=_._prepare(p._data[d],a[r],t[a[r]],!0,n),s&&(h=!0)):_._equals(p._data[d]._data[a[r]],t[a[r]])||("object"==typeof t[a[r]]?(s=_.set(p._data[d]._path+"."+a[r],t[a[r]],!0),s&&(h=!0)):p._data[d]._data[a[r]]!==t[a[r]]&&(h=!0,-1===p._data[d]._keys.indexOf(a[r])&&p._data[d]._keys.push(a[r]),p._data[d]._data[a[r]]=t[a[r]],c=_.silence(),_.emit(p._data[d]._path+"."+a[r]+":set",p._data[d]._data[a[r]],null,n),_.emit("*:set",p._data[d]._path+"."+a[r],p._data[d]._data[a[r]],null,n),_.silenceRestore(c)));if(h){i&&(c=_.silence());const e=_.json(p._data[d]);return _.emit(p._data[d]._path+":set",e,l,n),_.emit("*:set",p._data[d]._path,e,l,n),i&&_.silenceRestore(c),!0}return!1}return u=!p.hasOwnProperty("_data")&&p.hasOwnProperty(d)?p:p._data,!(u[d]===t&&!s||(i&&(c=_.silence()),l=u[d],l instanceof o||(l=_.json(l)),u[d]=t,_.emit(e+":set",t,l,n),_.emit("*:set",e,t,l,n),i&&_.silenceRestore(c),0))}has(e){const t=o._splitPath(e);let i=this;for(let e=0,n=t.length;e<n;e++){if(null==i)return;i=i._data?i._data[t[e]]:i[t[e]]}return void 0!==i}get(e,t){const i=o._splitPath(e);let n=this;for(let e=0;e<i.length;e++){if(null==n)return;n=n._data?n._data[i[e]]:n[i[e]]}return t?n:null==n?null:this.json(n)}getRaw(e){return this.get(e,!0)}_equals(e,t){return e===t||!!(e instanceof Array&&t instanceof Array&&e.equals(t))}unset(e,t,i){let n;const s=o._splitPath(e),r=s[s.length-1];let l=this,a=this;for(n=0;n<s.length-1;n++)l instanceof Array?(l=l[s[n]],l instanceof o&&(e=s.slice(n+1).join("."),a=l)):l=l._data[s[n]];if(!l._data||!l._data.hasOwnProperty(r))return!1;let h,d=l._data[r];if(d instanceof o||(d=a.json(d)),l._data[r]&&l._data[r]._data)for(n=l._data[r]._keys.length-1;n>=0;n--)a.unset(e+"."+l._data[r]._keys[n],!0);return l._keys.splice(l._keys.indexOf(r),1),delete l._data[r],t&&(h=a.silence()),a.emit(e+":unset",d,i),a.emit("*:unset",e,d,i),t&&a.silenceRestore(h),!0}remove(e,t,i,n){const s=o._splitPath(e),r=s[s.length-1];let l=this,a=this;for(let t=0;t<s.length-1;t++)if(l instanceof Array)l=l[parseInt(s[t],10)],l instanceof o&&(e=s.slice(t+1).join("."),a=l);else{if(!l._data||!l._data.hasOwnProperty(s[t]))return;l=l._data[s[t]]}if(!(l._data&&l._data.hasOwnProperty(r)&&l._data[r]instanceof Array))return;const h=l._data[r];if(h.length<t)return;let d,c=h[t];return c instanceof o?c._parent=null:c=a.json(c),h.splice(t,1),i&&(d=a.silence()),a.emit(e+":remove",c,t,n),a.emit("*:remove",e,c,t,n),i&&a.silenceRestore(d),!0}removeValue(e,t,i,n){const s=o._splitPath(e),r=s[s.length-1];let l=this,a=this;for(let t=0;t<s.length-1;t++)if(l instanceof Array)l=l[parseInt(s[t],10)],l instanceof o&&(e=s.slice(t+1).join("."),a=l);else{if(!l._data||!l._data.hasOwnProperty(s[t]))return;l=l._data[s[t]]}if(!(l._data&&l._data.hasOwnProperty(r)&&l._data[r]instanceof Array))return;const h=l._data[r],d=h.indexOf(t);if(-1===d)return;if(h.length<d)return;let c;return(t=h[d])instanceof o?t._parent=null:t=a.json(t),h.splice(d,1),i&&(c=a.silence()),a.emit(e+":remove",t,d,n),a.emit("*:remove",e,t,d,n),i&&a.silenceRestore(c),!0}insert(e,t,i,n,s){const r=o._splitPath(e),l=r[r.length-1];let a=this,h=this;for(let t=0;t<r.length-1;t++)if(a instanceof Array)a=a[parseInt(r[t],10)],a instanceof o&&(e=r.slice(t+1).join("."),h=a);else{if(!a._data||!a._data.hasOwnProperty(r[t]))return;a=a._data[r[t]]}if(!(a._data&&a._data.hasOwnProperty(l)&&a._data[l]instanceof Array))return;const d=a._data[l];let c;return t=h._doInsert(a,l,t,i),void 0===i&&(i=d.length-1),n&&(c=h.silence()),h.emit(e+":insert",t,i,s),h.emit("*:insert",e,t,i,s),n&&h.silenceRestore(c),!0}_doInsert(e,t,i,n,s){const r=e._data[t];"object"!=typeof i||i instanceof o||null===i||(i=i instanceof Array?i.slice(0):new o(i));const l=e._path?`${e._path}.${t}`:t;if(null===i||s||this._pathsWithDuplicates&&this._pathsWithDuplicates[l]||-1===r.indexOf(i))return void 0===n?r.push(i):r.splice(n,0,i),i instanceof o?(i._parent=this,i._parentPath=l,i._parentField=r,i._parentKey=null):i=this.json(i),i}move(e,t,i,n,s){const r=o._splitPath(e),l=r[r.length-1];let a=this,h=this;for(let t=0;t<r.length-1;t++)if(a instanceof Array)a=a[parseInt(r[t],10)],a instanceof o&&(e=r.slice(t+1).join("."),h=a);else{if(!a._data||!a._data.hasOwnProperty(r[t]))return;a=a._data[r[t]]}if(!(a._data&&a._data.hasOwnProperty(l)&&a._data[l]instanceof Array))return;const d=a._data[l];if(d.length<t||d.length<i||t===i)return;let c,u=d[t];return d.splice(t,1),-1===i&&(i=d.length),d.splice(i,0,u),u instanceof o||(u=h.json(u)),n&&(c=h.silence()),h.emit(e+":move",u,i,t,s),h.emit("*:move",e,u,i,t,s),n&&h.silenceRestore(c),!0}patch(e,t){if("object"==typeof e){for(const t in e)"object"!=typeof e[t]||this._data.hasOwnProperty(t)?this._data[t]!==e[t]&&this.set(t,e[t]):this._prepare(this,t,e[t]);if(t)for(const t in this._data)e.hasOwnProperty(t)||this.unset(t)}}json(e){let t,i,n={};const s=void 0===e?this:e;let o,r;if(s instanceof Object&&s._keys){o=s._keys.length;for(let e=0;e<o;e++){t=s._keys[e];const o=s._data[t],l=typeof o;if("object"===l&&o instanceof Array)for(n[t]=o.slice(0),r=n[t].length,i=0;i<r;i++)"object"==typeof n[t][i]&&(n[t][i]=this.json(n[t][i]));else n[t]="object"===l&&o instanceof Object?this.json(o):o}}else{if(null===s)return null;if("object"==typeof s&&s instanceof Array)for(n=s.slice(0),o=n.length,i=0;i<o;i++)n[i]=this.json(n[i]);else if("object"==typeof s)for(t in s)s.hasOwnProperty(t)&&(n[t]=s[t]);else n=s}return n}forEach(e,t,i=""){const n=t||this;for(let t=0;t<n._keys.length;t++){const s=n._keys[t],o=n._data[s],r=this.schema&&this.schema.has(i+s)&&this.schema.get(i+s).type.name.toLowerCase()||typeof o;"object"===r&&o instanceof Array?e(i+s,"array",o,s):"object"===r&&o instanceof Object?(e(i+s,"object",o,s),this.forEach(e,o,i+s+".")):e(i+s,r,o,s)}}latest(){return this._latestFn?this._latestFn():this}destroy(){this._destroyed||(this._destroyed=!0,this.emit("destroy"),this.unbind())}set latestFn(e){this._latestFn=e}get latestFn(){return this._latestFn}}o._splitPathsCache={};var r=class extends s{constructor(e){super(),this._observers=[],this._paths=[],this._applyingChange=!1,this._linked=!1,this._element=e.element,this._history=e.history,this._historyPrefix=e.historyPrefix,this._historyPostfix=e.historyPostfix,this._historyName=e.historyName,this._historyCombine=e.historyCombine||!1}_pathAt(e,t){return e[t]||e[0]}link(e,t){this._observers&&this.unlink(),this._observers=Array.isArray(e)?e:[e],this._paths=Array.isArray(t)?t:[t],this._linked=!0}unlink(){this._observers=[],this._paths=[],this._linked=!1}clone(){throw new Error("BindingBase#clone: Not implemented")}setValue(e){}setValues(e){}addValue(e){}addValues(e){}removeValue(e){}removeValues(e){}set element(e){this._element=e}get element(){return this._element}set applyingChange(e){this._applyingChange!==e&&(this._applyingChange=e,this.emit("applyingChange",e))}get applyingChange(){return this._applyingChange}get linked(){return this._linked}set historyCombine(e){this._historyCombine=e}get historyCombine(){return this._historyCombine}set historyName(e){this._historyName=e}get historyName(){return this._historyName}set historyPrefix(e){this._historyPrefix=e}get historyPrefix(){return this._historyPrefix}set historyPostfix(e){this._historyPostfix=e}get historyPostfix(){return this._historyPostfix}set historyEnabled(e){this._history&&(this._history.enabled=e)}get historyEnabled(){return this._history&&this._history.enabled}get observers(){return this._observers}get paths(){return this._paths}};class l extends r{clone(){return new l({history:this._history,historyPrefix:this._historyPrefix,historyPostfix:this._historyPostfix,historyName:this._historyName,historyCombine:this._historyCombine})}_getHistoryActionName(e){return`${this._historyPrefix||""}${this._historyName||e[0]}${this._historyPostfix||""}`}_setValue(e,t){if(this.applyingChange)return;if(!this._observers.length)return;this.applyingChange=!0;const i=this._observers.slice(),n=this._paths.slice(),s={observers:i,paths:n},o=()=>{this._setValueToObservers(i,n,e,t),this.emit("history:redo",s)};if(this._history){let e=[];e=1===i.length&&n.length>1?n.map((e=>i[0].has(e)?i[0].get(e):void 0)):i.map(((e,t)=>{const i=this._pathAt(n,t);return e.has(i)?e.get(i):void 0})),this.emit("history:init",s),this._history.add({name:this._getHistoryActionName(n),redo:o,combine:this._historyCombine,undo:()=>{this._setValueToObservers(i,n,e,!0),this.emit("history:undo",s)}})}o(),this.applyingChange=!1}_setValueToObservers(e,t,i,n){if(1===e.length&&t.length>1)for(let n=0;n<t.length;n++){const s=e[0].latest();if(!s)continue;let o=!1;s.history&&(o=s.history.enabled,s.history.enabled=!1);const r=t[n],l=i[n];void 0!==i?this._observerSet(s,r,l):s.unset(r),o&&(s.history.enabled=!0)}else for(let s=0;s<e.length;s++){const o=e[s].latest();if(!o)continue;let r=!1;o.history&&(r=o.history.enabled,o.history.enabled=!1);const l=this._pathAt(t,s),a=n?i[s]:i;void 0!==i?this._observerSet(o,l,a):o.unset(l),r&&(o.history.enabled=!0)}}_observerSet(e,t,i){const n=t.lastIndexOf(".");if(n>0&&!e.has(t.substring(0,n)))return;const s=Array.isArray(i);e.set(t,s&&i?i.slice():i)}_addValues(e){if(this.applyingChange)return;if(!this._observers)return;this.applyingChange=!0;const t=this._observers.slice(),i=this._paths.slice(),n=[];for(let s=0;s<t.length;s++){const o=this._pathAt(i,s),r=t[s];e.forEach((e=>{-1===r.get(o).indexOf(e)&&n.push({observer:r,path:o,value:e})}))}const s=()=>{for(const e of n){const t=e.observer.latest();if(!t)continue;const i=e.path;let n=!1;t.history&&(n=t.history.enabled,t.history.enabled=!1),t.insert(i,e.value),n&&(t.history.enabled=!0)}};this._history&&n.length&&this._history.add({name:this._getHistoryActionName(i),redo:s,combine:this._historyCombine,undo:()=>{for(const e of n){const t=e.observer.latest();if(!t)continue;const i=e.path;let n=!1;t.history&&(n=t.history.enabled,t.history.enabled=!1),t.removeValue(i,e.value),n&&(t.history.enabled=!0)}}}),s(),this.applyingChange=!1}_removeValues(e){if(this.applyingChange)return;if(!this._observers)return;this.applyingChange=!0;const t=this._observers.slice(),i=this._paths.slice(),n=[];for(let s=0;s<t.length;s++){const o=this._pathAt(i,s),r=t[s];e.forEach((e=>{const t=r.get(o).indexOf(e);-1!==t&&n.push({observer:r,path:o,value:e,index:t})}))}const s=()=>{for(const e of n){const t=e.observer.latest();if(!t)continue;const i=e.path;let n=!1;t.history&&(n=t.history.enabled,t.history.enabled=!1),t.removeValue(i,e.value),n&&(t.history.enabled=!0)}};this._history&&n.length&&this._history.add({name:this._getHistoryActionName(i),redo:s,combine:this._historyCombine,undo:()=>{for(const e of n){const t=e.observer.latest();if(!t)continue;const i=e.path;let n=!1;t.history&&(n=t.history.enabled,t.history.enabled=!1),-1===t.get(i).indexOf(e.value)&&t.insert(i,e.value,e.index),n&&(t.history.enabled=!0)}}}),s(),this.applyingChange=!1}setValue(e){this._setValue(e,!1)}setValues(e){e=e.slice().map((e=>Array.isArray(e)?e.slice():e)),this._setValue(e,!0)}addValue(e){this._addValues([e])}addValues(e){this._addValues(e)}removeValue(e){this._removeValues([e])}removeValues(e){this._removeValues(e)}}var a=l;class h extends r{constructor(e={}){super(e),this._events=[],this._updateTimeout=null,this._deferUpdateElement=()=>{this.applyingChange||(this.applyingChange=!0,this._updateTimeout=window.setTimeout((()=>{this._updateElement()})))},this._customUpdate=e.customUpdate}_linkObserver(e,t){this._events.push(e.on(t+":set",this._deferUpdateElement)),this._events.push(e.on(t+":unset",this._deferUpdateElement)),this._events.push(e.on(t+":insert",this._deferUpdateElement)),this._events.push(e.on(t+":remove",this._deferUpdateElement))}_updateElement(){this._updateTimeout&&(window.clearTimeout(this._updateTimeout),this._updateTimeout=null),this._updateTimeout=null,this.applyingChange=!0,this._element&&("function"==typeof this._customUpdate?this._customUpdate(this._element,this._observers,this._paths):1===this._observers.length?this._paths.length>1?this._element.value=this._paths.map((e=>this._observers[0].has(e)?this._observers[0].get(e):void 0)):this._element.value=this._observers[0].has(this._paths[0])?this._observers[0].get(this._paths[0]):void 0:this._element.values=this._observers.map(((e,t)=>{const i=this._pathAt(this._paths,t);return e.has(i)?e.get(i):void 0})),this.applyingChange=!1)}link(e,t){if(super.link(e,t),this._element){const e=this._element.renderChanges;this._element.renderChanges=!1,this._updateElement(),this._element.renderChanges=e}if(1===this._observers.length&&this._paths.length>1)for(let e=0;e<this._paths.length;e++)this._linkObserver(this._observers[0],this._paths[e]);else for(let e=0;e<this._observers.length;e++)this._linkObserver(this._observers[e],this._pathAt(this._paths,e))}unlink(){for(const e of this._events)e.unbind();this._events.length=0,this._updateTimeout&&(window.clearTimeout(this._updateTimeout),this._updateTimeout=null),super.unlink()}clone(){return new h({customUpdate:this._customUpdate})}}var d=h;class c extends r{constructor(e={}){super(e),this._bindingElementToObservers=e.bindingElementToObservers||new a(e),this._bindingObserversToElement=e.bindingObserversToElement||new d(e),this._bindingElementToObservers.on("applyingChange",(e=>{this.applyingChange=e})),this._bindingElementToObservers.on("history:init",(e=>{this.emit("history:init",e)})),this._bindingElementToObservers.on("history:undo",(e=>{this.emit("history:undo",e)})),this._bindingElementToObservers.on("history:redo",(e=>{this.emit("history:redo",e)})),this._bindingObserversToElement.on("applyingChange",(e=>{this.applyingChange=e}))}link(e,t){super.link(e,t),this._bindingElementToObservers.link(e,t),this._bindingObserversToElement.link(e,t)}unlink(){this._bindingElementToObservers.unlink(),this._bindingObserversToElement.unlink(),super.unlink()}clone(){return new c({bindingElementToObservers:this._bindingElementToObservers.clone(),bindingObserversToElement:this._bindingObserversToElement.clone()})}setValue(e){this._bindingElementToObservers.setValue(e)}setValues(e){this._bindingElementToObservers.setValues(e)}addValue(e){this._bindingElementToObservers.addValue(e)}addValues(e){this._bindingElementToObservers.addValues(e)}removeValue(e){this._bindingElementToObservers.removeValue(e)}removeValues(e){this._bindingElementToObservers.removeValues(e)}set element(e){this._element=e,this._bindingElementToObservers.element=e,this._bindingObserversToElement.element=e}get element(){return this._element}set applyingChange(e){super.applyingChange!==e&&(this._bindingElementToObservers.applyingChange=e,this._bindingObserversToElement.applyingChange=e,super.applyingChange=e)}get applyingChange(){return super.applyingChange}set historyCombine(e){this._bindingElementToObservers.historyCombine=e}get historyCombine(){return this._bindingElementToObservers.historyCombine}set historyPrefix(e){this._bindingElementToObservers.historyPrefix=e}get historyPrefix(){return this._bindingElementToObservers.historyPrefix}set historyPostfix(e){this._bindingElementToObservers.historyPostfix=e}get historyPostfix(){return this._bindingElementToObservers.historyPostfix}set historyEnabled(e){this._bindingElementToObservers.historyEnabled=e}get historyEnabled(){return this._bindingElementToObservers.historyEnabled}}var u=c;function p(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Array){const t=[];for(let i=0;i<e.length;i++)t[i]=p(e[i]);return t}const t={};for(const i in e)e.hasOwnProperty(i)&&(t[i]=p(e[i]));return t}function g(e,t){if(!e)return!1;if(!t)return!1;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(e[i]instanceof Array&&t[i]instanceof Array){if(!e[i].equals(t[i]))return!1}else if(e[i]!==t[i])return!1;return!0}const _="pcui-flex",m="pcui-grid",f="pcui-hidden",v="pcui-scrollable",b="pcui-resizable",y="pcui-readonly",w="pcui-disabled",x="pcui-collapsible",C="pcui-collapsed",k="pcui-focus",A="pcui-multiple-values",E="pcui-error",T="flash",I="pcui-not-flexible",S="font-regular",M="font-bold",z=["flexDirection","flexGrow","flexBasis","flexShrink","flexWrap","alignItems","alignSelf","justifyContent","justifySelf"],O=new Map;class H extends s{constructor(e={}){var t,i,n;if(super(),this._destroyed=!1,this._parent=null,this._eventsParent=[],this._flashTimeout=null,this._suppressChange=!1,this._onMouseOver=e=>{this.emit("hover",e)},this._onMouseOut=e=>{this.emit("hoverend",e)},"string"==typeof e.dom?this._dom=document.createElement(e.dom):e.dom instanceof Node?this._dom=e.dom:this._dom=document.createElement("div"),void 0!==e.id&&(this._dom.id=e.id),this._dom.ui=this,this._onClickEvt=this._onClick.bind(this),this._dom.addEventListener("click",this._onClickEvt),this._dom.addEventListener("mouseover",this._onMouseOver),this._dom.addEventListener("mouseout",this._onMouseOut),this._dom.classList.add("pcui-element",S),e.class){const t=Array.isArray(e.class)?e.class:[e.class];for(const e of t)this._dom.classList.add(e)}this.enabled=void 0===e.enabled||e.enabled,this._hiddenParents=!e.isRoot,this.hidden=null!==(t=e.hidden)&&void 0!==t&&t,this.readOnly=null!==(i=e.readOnly)&&void 0!==i&&i,this.ignoreParent=null!==(n=e.ignoreParent)&&void 0!==n&&n,void 0!==e.width&&(this.width=e.width),void 0!==e.height&&(this.height=e.height),void 0!==e.tabIndex&&(this.tabIndex=e.tabIndex);for(const t in e)void 0!==e[t]&&-1!==z.indexOf(t)&&(this[t]=e[t]);e.binding&&(this.binding=e.binding)}destroy(){if(this._destroyed)return;if(this._destroyed=!0,this.binding?this.binding=null:this.unlink(),this.parent){const e=this.parent;for(const e of this._eventsParent)e.unbind();this._eventsParent.length=0,e.remove&&!e._destroyed&&e.remove(this),this._parent=null,!e._destroyed&&this._dom&&this._dom.parentElement&&this._dom.parentElement.removeChild(this._dom)}const e=this._dom;e&&(e.removeEventListener("click",this._onClickEvt),e.removeEventListener("mouseover",this._onMouseOver),e.removeEventListener("mouseout",this._onMouseOut),delete e.ui,this._dom=null),this._flashTimeout&&window.clearTimeout(this._flashTimeout),this.emit("destroy",e,this),this.unbind()}link(e,t){this._binding&&this._binding.link(e,t)}unlink(){this._binding&&this._binding.unlink()}flash(){this._flashTimeout||(this.class.add(T),this._flashTimeout=window.setTimeout((()=>{this._flashTimeout=null,this.class.remove(T)}),200))}_onClick(e){this.enabled&&this.emit("click",e)}_onHiddenToRootChange(e){this.emit(e?"hideToRoot":"showToRoot")}_onEnabledChange(e){e?this.class.remove(w):this.class.add(w),this.emit(e?"enable":"disable")}_onParentDestroy(){this.destroy()}_onParentDisable(){this._ignoreParent||this._enabled&&this._onEnabledChange(!1)}_onParentEnable(){this._ignoreParent||this._enabled&&this._onEnabledChange(!0)}_onParentShowToRoot(){const e=this.hiddenToRoot;this._hiddenParents=!1,e!==this.hiddenToRoot&&this._onHiddenToRootChange(this.hiddenToRoot)}_onParentHideToRoot(){const e=this.hiddenToRoot;this._hiddenParents=!0,e!==this.hiddenToRoot&&this._onHiddenToRootChange(this.hiddenToRoot)}_onReadOnlyChange(e){e?this.class.add(y):this.class.remove(y),this.emit("readOnly",e)}_onParentReadOnlyChange(e){this._ignoreParent||(e?this._readOnly||this._onReadOnlyChange(!0):this._readOnly||this._onReadOnlyChange(!1))}unbind(e,t){return super.unbind(e,t)}static register(e,t,i){O.set(e,{cls:t,defaultArguments:i})}static unregister(e){O.delete(e)}static create(e,t){const i=O.get(e);if(i)return new(0,i.cls)(Object.assign(Object.assign({},i.defaultArguments),t));console.error("Invalid type passed to Element.create:",e)}set enabled(e){if(this._enabled===e)return;const t=this.enabled;this._enabled=e,t!==e&&this._onEnabledChange(e)}get enabled(){return this._ignoreParent?this._enabled:this._enabled&&(!this._parent||this._parent.enabled)}set ignoreParent(e){this._ignoreParent=e,this._onEnabledChange(this.enabled),this._onReadOnlyChange(this.readOnly)}get ignoreParent(){return this._ignoreParent}get dom(){return this._dom}set parent(e){if(e===this._parent)return;const t=this.enabled,i=this.readOnly,n=this.hiddenToRoot;if(this._parent){for(let e=0;e<this._eventsParent.length;e++)this._eventsParent[e].unbind();this._eventsParent.length=0}this._parent=e,this._parent?(this._eventsParent.push(this._parent.once("destroy",this._onParentDestroy.bind(this))),this._eventsParent.push(this._parent.on("disable",this._onParentDisable.bind(this))),this._eventsParent.push(this._parent.on("enable",this._onParentEnable.bind(this))),this._eventsParent.push(this._parent.on("readOnly",this._onParentReadOnlyChange.bind(this))),this._eventsParent.push(this._parent.on("showToRoot",this._onParentShowToRoot.bind(this))),this._eventsParent.push(this._parent.on("hideToRoot",this._onParentHideToRoot.bind(this))),this._hiddenParents=this._parent.hiddenToRoot):this._hiddenParents=!0,this.emit("parent",this._parent);const s=this.enabled;s!==t&&this._onEnabledChange(s);const o=this.readOnly;o!==i&&this._onReadOnlyChange(o);const r=this.hiddenToRoot;r!==n&&this._onHiddenToRootChange(r)}get parent(){return this._parent}set hidden(e){if(e===this._hidden)return;const t=this.hiddenToRoot;this._hidden=e,e?this.class.add(f):this.class.remove(f),this.emit(e?"hide":"show"),this.hiddenToRoot!==t&&this._onHiddenToRootChange(this.hiddenToRoot)}get hidden(){return this._hidden}get hiddenToRoot(){return this._hidden||this._hiddenParents}set readOnly(e){this._readOnly!==e&&(this._readOnly=e,this._onReadOnlyChange(e))}get readOnly(){return this._ignoreParent?this._readOnly:this._readOnly||!(!this._parent||!this._parent.readOnly)}set error(e){this._hasError!==e&&(this._hasError=e,e?this.class.add(E):this.class.remove(E))}get error(){return this._hasError}get style(){return this._dom.style}get class(){return this._dom.classList}set width(e){"number"==typeof e&&(e=String(e)+"px"),this.style.width=e}get width(){return this._dom.clientWidth}set height(e){"number"==typeof e&&(e=String(e)+"px"),this.style.height=e}get height(){return this._dom.clientHeight}set tabIndex(e){this._dom.tabIndex=e}get tabIndex(){return this._dom.tabIndex}set binding(e){if(this._binding===e)return;let t,i;this._binding&&(t=this._binding.observers,i=this._binding.paths,this.unlink(),this._binding.element=null,this._binding=null),this._binding=e,this._binding&&(this._binding.element=this,t&&i&&this.link(t,i))}get binding(){return this._binding}get destroyed(){return this._destroyed}set flexDirection(e){this.style.flexDirection=e}get flexDirection(){return this.style.flexDirection}set flexGrow(e){this.style.flexGrow=e}get flexGrow(){return this.style.flexGrow}set flexBasis(e){this.style.flexBasis=e}get flexBasis(){return this.style.flexBasis}set flexShrink(e){this.style.flexShrink=e}get flexShrink(){return this.style.flexShrink}set flexWrap(e){this.style.flexWrap=e}get flexWrap(){return this.style.flexWrap}set alignItems(e){this.style.alignItems=e}get alignItems(){return this.style.alignItems}set alignSelf(e){this.style.alignSelf=e}get alignSelf(){return this.style.alignSelf}set justifyContent(e){this.style.justifyContent=e}get justifyContent(){return this.style.justifyContent}set justifySelf(e){this.style.justifySelf=e}get justifySelf(){return this.style.justifySelf}set disabled(e){this.enabled=!e}get disabled(){return!this.enabled}set element(e){this._dom=e}get element(){return this.dom}set innerElement(e){this._domContent=e}get innerElement(){return this._domContent}}H.EVENT_ENABLE="enable",H.EVENT_DISABLE="disable",H.EVENT_HIDE="hide",H.EVENT_HIDE_TO_ROOT="hideToRoot",H.EVENT_SHOW="show",H.EVENT_SHOW_TO_ROOT="showToRoot",H.EVENT_READ_ONLY="readOnly",H.EVENT_PARENT="parent",H.EVENT_CLICK="click",H.EVENT_HOVER="hover",H.EVENT_HOVER_END="hoverend",H.EVENT_DESTROY="destroy";var R=H;const D=[null,"top","right","bottom","left"],V=b+"-resizing",P="pcui-container",L=P+"-dragged",U=L+"-child";class N extends R{constructor(e={}){var t;super(e),this._scrollable=!1,this._flex=!1,this._grid=!1,this._domResizeHandle=null,this._resizeTouchId=null,this._resizeData=null,this._resizeHorizontally=!0,this._resizeMin=100,this._resizeMax=300,this._draggedStartIndex=-1,this._onScroll=e=>{this.emit("scroll",e)},this._onResizeStart=e=>{e.preventDefault(),e.stopPropagation(),window.addEventListener("mousemove",this._onResizeMove),window.addEventListener("mouseup",this._onResizeEnd),this._resizeStart()},this._onResizeMove=e=>{e.preventDefault(),e.stopPropagation(),this._resizeMove(e.clientX,e.clientY)},this._onResizeEnd=e=>{e.preventDefault(),e.stopPropagation(),window.removeEventListener("mousemove",this._onResizeMove),window.removeEventListener("mouseup",this._onResizeEnd),this._resizeEnd()},this._onResizeTouchStart=e=>{e.preventDefault(),e.stopPropagation();for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t];i.target===this._domResizeHandle&&(this._resizeTouchId=i.identifier)}window.addEventListener("touchmove",this._onResizeTouchMove),window.addEventListener("touchend",this._onResizeTouchEnd),this._resizeStart()},this._onResizeTouchMove=e=>{for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t];if(i.identifier===this._resizeTouchId){e.stopPropagation(),e.preventDefault(),this._resizeMove(i.clientX,i.clientY);break}}},this._onResizeTouchEnd=e=>{for(let t=0;t<e.changedTouches.length;t++)if(e.changedTouches[t].identifier!==this._resizeTouchId){this._resizeTouchId=null,e.preventDefault(),e.stopPropagation(),window.removeEventListener("touchmove",this._onResizeTouchMove),window.removeEventListener("touchend",this._onResizeTouchEnd),this._resizeEnd();break}},this.class.add(P),this.domContent=this._dom,e.scrollable&&(this.scrollable=!0),this.flex=!!e.flex;let i=!!e.grid;i&&this.flex&&(console.error('Invalid Container arguments: "grid" and "flex" cannot both be true.'),i=!1),this.grid=i,this.resizable=null!==(t=e.resizable)&&void 0!==t?t:null,void 0!==e.resizeMin&&(this.resizeMin=e.resizeMin),void 0!==e.resizeMax&&(this.resizeMax=e.resizeMax)}destroy(){this._destroyed||(this.domContent=null,this._domResizeHandle&&(this._domResizeHandle.removeEventListener("mousedown",this._onResizeStart),window.removeEventListener("mousemove",this._onResizeMove),window.removeEventListener("mouseup",this._onResizeEnd),this._domResizeHandle.removeEventListener("touchstart",this._onResizeTouchStart),window.removeEventListener("touchmove",this._onResizeTouchMove),window.removeEventListener("touchend",this._onResizeTouchEnd)),super.destroy())}append(e){const t=this._getDomFromElement(e);this._domContent.appendChild(t),this._onAppendChild(e)}appendBefore(e,t){const i=this._getDomFromElement(e);this._domContent.appendChild(i);const n=t&&this._getDomFromElement(t);this._domContent.insertBefore(i,n),this._onAppendChild(e)}appendAfter(e,t){const i=this._getDomFromElement(e),n=t&&this._getDomFromElement(t),s=n?n.nextSibling:null;s?this._domContent.insertBefore(i,s):this._domContent.appendChild(i),this._onAppendChild(e)}prepend(e){const t=this._getDomFromElement(e),i=this._domContent.firstChild;i?this._domContent.insertBefore(t,i):this._domContent.appendChild(t),this._onAppendChild(e)}remove(e){if(e.parent!==this)return;const t=this._getDomFromElement(e);this._domContent.removeChild(t),this._onRemoveChild(e)}move(e,t){let i=-1;for(let t=0;t<this.dom.childNodes.length;t++)if(this.dom.childNodes[t].ui===e){i=t;break}-1===i?this.appendBefore(e,this.dom.childNodes[t]):t!==i&&(this.remove(e),t<i?this.appendBefore(e,this.dom.childNodes[t]):this.appendAfter(e,this.dom.childNodes[t-1]))}clear(){let e=this._domContent.childNodes.length;for(;e--;){const t=this._domContent.childNodes[e];t.ui&&t.ui!==this&&t.ui.destroy()}this._domResizeHandle&&(this._domResizeHandle.removeEventListener("mousedown",this._onResizeStart),this._domResizeHandle.removeEventListener("touchstart",this._onResizeTouchStart),this._domResizeHandle=null),this._domContent.innerHTML="",this.resizable&&(this._createResizeHandle(),this._dom.appendChild(this._domResizeHandle))}_getDomFromElement(e){return e.dom?e.dom:e.element?e.element:e}_onAppendChild(e){e.parent=this,this.emit("append",e)}_onRemoveChild(e){e.parent=null,this.emit("remove",e)}_createResizeHandle(){const e=document.createElement("div");e.classList.add("pcui-resizable-handle"),e.ui=this,e.addEventListener("mousedown",this._onResizeStart),e.addEventListener("touchstart",this._onResizeTouchStart,{passive:!1}),this._domResizeHandle=e}_resizeStart(){this.class.add(V)}_resizeMove(e,t){if(this._resizeData){if(this._resizeHorizontally){let t=this._resizeData.x-e;"right"===this._resizable&&(t=-t),this.width=4+Math.max(this._resizeMin,Math.min(this._resizeMax,this._resizeData.width+t))}else{let e=this._resizeData.y-t;"bottom"===this._resizable&&(e=-e),this.height=Math.max(this._resizeMin,Math.min(this._resizeMax,this._resizeData.height+e))}this.emit("resize")}else this._resizeData={x:e,y:t,width:this.dom.clientWidth,height:this.dom.clientHeight}}_resizeEnd(){this._resizeData=null,this.class.remove(V)}resize(e,t){e=e||0,t=t||0,this._resizeStart(),this._resizeMove(0,0),this._resizeMove(4-e,-t),this._resizeEnd()}_getDraggedChildIndex(e){for(let t=0;t<this.dom.childNodes.length;t++)if(this.dom.childNodes[t].ui===e)return t;return-1}_onChildDragStart(e,t){this.class.add(U),this._draggedStartIndex=this._getDraggedChildIndex(t),t.class.add(L),this.emit("child:dragstart",t,this._draggedStartIndex)}_onChildDragMove(e,t){const i=this.dom.getBoundingClientRect(),n=e.clientX<i.left||e.clientX>i.right||e.clientY<i.top||e.clientY>i.bottom,s=this._getDraggedChildIndex(t);if(n)return t.class.remove(L),void(this._draggedStartIndex!==s&&(this.remove(t),this._draggedStartIndex<s?this.appendBefore(t,this.dom.childNodes[this._draggedStartIndex]):this.appendAfter(t,this.dom.childNodes[this._draggedStartIndex-1])));t.class.add(L);const o=e.clientY-i.top;let r=null;for(let e=0;e<this.dom.childNodes.length;e++){const i=this.dom.childNodes[e].ui,n=i.dom.offsetTop;if(e<s){if(o<=n+i.header.height){r=e;break}}else if(e>s&&o+t.height>=n+i.height){r=e;break}}null!==r&&s!==r&&(this.remove(t),r<s?this.appendBefore(t,this.dom.childNodes[r]):this.appendAfter(t,this.dom.childNodes[r-1]))}_onChildDragEnd(e,t){this.class.remove(U),t.class.remove(L);const i=this._getDraggedChildIndex(t);this.emit("child:dragend",t,i,this._draggedStartIndex),this._draggedStartIndex=-1}forEachChild(e){for(let t=0;t<this.dom.childNodes.length;t++){const i=this.dom.childNodes[t].ui;if(i&&!1===e(i,t))break}}_buildDomNode(e){const t=Object.keys(e);let i;return t.includes("root")?(i=this._buildDomNode(e.root),e.children.forEach((e=>{const t=this._buildDomNode(e);null!==t&&i.append(t)}))):(i=e[t[0]],this[`_${t[0]}`]=i),i}buildDom(e){e.forEach((e=>{const t=this._buildDomNode(e);this.append(t)}))}set flex(e){e!==this._flex&&(this._flex=e,e?this.class.add(_):this.class.remove(_))}get flex(){return this._flex}set grid(e){e!==this._grid&&(this._grid=e,e?this.class.add(m):this.class.remove(m))}get grid(){return this._grid}set scrollable(e){this._scrollable!==e&&(this._scrollable=e,e?this.class.add(v):this.class.remove(v))}get scrollable(){return this._scrollable}set resizable(e){e!==this._resizable&&(-1!==D.indexOf(e)?(this._resizable&&this.class.remove(`${b}-${this._resizable}`),this._resizable=e,this._resizeHorizontally="right"===e||"left"===e,e?(this.class.add(b),this.class.add(`${b}-${e}`),this._domResizeHandle||this._createResizeHandle(),this._dom.appendChild(this._domResizeHandle)):(this.class.remove(b),this._domResizeHandle&&this._dom.removeChild(this._domResizeHandle))):console.error("Invalid resizable value: must be one of "+D.join(",")))}get resizable(){return this._resizable}set resizeMin(e){this._resizeMin=Math.max(0,Math.min(e,this._resizeMax))}get resizeMin(){return this._resizeMin}set resizeMax(e){this._resizeMax=Math.max(this._resizeMin,e)}get resizeMax(){return this._resizeMax}set domContent(e){this._domContent!==e&&(this._domContent&&this._domContent.removeEventListener("scroll",this._onScroll),this._domContent=e,this._domContent&&this._domContent.addEventListener("scroll",this._onScroll))}get domContent(){return this._domContent}}N.EVENT_APPEND="append",N.EVENT_REMOVE="remove",N.EVENT_SCROLL="scroll",N.EVENT_RESIZE="resize",R.register("container",N);var F=N;class B extends R{constructor(e={}){var t,i,n;super(Object.assign({dom:"span"},e)),this.class.add("pcui-label"),this._unsafe=null!==(t=e.unsafe)&&void 0!==t&&t,this.text=null!==(n=null!==(i=e.text)&&void 0!==i?i:e.value)&&void 0!==n?n:"",e.allowTextSelection&&this.class.add("pcui-default-mousedown"),e.nativeTooltip&&(this.dom.title=this.text),this.placeholder=e.placeholder,this.renderChanges=e.renderChanges,this.on("change",(()=>{this.renderChanges&&this.flash()}))}_updateText(e){return this.class.remove(A),this._text!==e&&(this._text=e,this._unsafe?this._dom.innerHTML=e:this._dom.textContent=e,this.emit("change",e),!0)}set text(e){null==e&&(e=""),this._updateText(e)&&this._binding&&this._binding.setValue(e)}get text(){return this._text}set value(e){this.text=e}get value(){return this.text}set values(e){e.some((t=>t!==e[0]))?(this._updateText(""),this.class.add(A)):this._updateText(e[0])}set placeholder(e){e?this.dom.setAttribute("placeholder",e):this.dom.removeAttribute("placeholder")}get placeholder(){return this.dom.getAttribute("placeholder")}set renderChanges(e){this._renderChanges=e}get renderChanges(){return this._renderChanges}}R.register("label",B);var j=B;class q extends R{constructor(e={}){super(Object.assign({dom:"button"},e)),this._onKeyDown=e=>{"Escape"===e.key?this.blur():"Enter"===e.key&&this._onClick(e)},this.class.add("pcui-button"),this._unsafe=e.unsafe,this.text=e.text,this.size=e.size,this.icon=e.icon,this.dom.addEventListener("keydown",this._onKeyDown)}destroy(){this._destroyed||(this.dom.removeEventListener("keydown",this._onKeyDown),super.destroy())}_onClick(e){this.blur(),this.readOnly||super._onClick(e)}focus(){this.dom.focus()}blur(){this.dom.blur()}set text(e){this._text!==e&&(this._text=e,this._unsafe?this.dom.innerHTML=e:this.dom.textContent=e)}get text(){return this._text}set icon(e){this._icon!==e&&e.match(/^E[0-9]{0,4}$/)&&(this._icon=e,e?this.dom.setAttribute("data-icon",String.fromCodePoint(parseInt(e,16))):this.dom.removeAttribute("data-icon"))}get icon(){return this._icon}set size(e){this._size!==e&&(this._size&&(this.class.remove("pcui-"+this._size),this._size=null),this._size=e,this._size&&this.class.add("pcui-"+this._size))}get size(){return this._size}}R.register("button",q);var W=q;const K="pcui-panel",X=K+"-header",G=X+"-title",Y=K+"-content",J=K+"-horizontal",Z=K+"-sortable-icon",Q=K+"-remove";class $ extends F{constructor(e={}){var t;const i=Object.assign(Object.assign({},e),{flex:!0});delete i.grid,delete i.flexDirection,delete i.scrollable,super(i),this._reflowTimeout=null,this._widthBeforeCollapse=null,this._heightBeforeCollapse=null,this._iconSort=null,this._btnRemove=null,this._onHeaderClick=e=>{this._collapsible&&(e.target!==this.header.dom&&e.target!==this._labelTitle.dom||(this.collapsed=!this.collapsed))},this._onDragStart=e=>{this.enabled&&!this.readOnly&&(e.stopPropagation(),e.preventDefault(),window.addEventListener("mouseup",this._onDragEndEvt),window.addEventListener("mouseleave",this._onDragEndEvt),window.addEventListener("mousemove",this._onDragMove),this.emit("dragstart"),this.parent&&this.parent._onChildDragStart&&this.parent._onChildDragStart(e,this))},this._onDragMove=e=>{this.emit("dragmove"),this.parent&&this.parent._onChildDragStart&&this.parent._onChildDragMove(e,this)},this.class.add(K),e.panelType&&this.class.add(K+"-"+e.panelType),this._suspendReflow=!0,this._initializeHeader(e),this._initializeContent(e),this.headerSize=null!==(t=e.headerSize)&&void 0!==t?t:32,this.collapsible=e.collapsible||!1,this.collapsed=e.collapsed||!1,this.collapseHorizontally=e.collapseHorizontally||!1,this.sortable=e.sortable||!1,this.removable=e.removable||!!e.onRemove||!1,this.domContent=this._containerContent.dom,this._suspendReflow=!1,this._reflow(),this._onDragEndEvt=this._onDragEnd.bind(this)}destroy(){this._destroyed||(this._reflowTimeout&&(cancelAnimationFrame(this._reflowTimeout),this._reflowTimeout=null),window.removeEventListener("mouseup",this._onDragEndEvt),window.removeEventListener("mouseleave",this._onDragEndEvt),window.removeEventListener("mousemove",this._onDragMove),super.destroy())}_initializeHeader(e){this._containerHeader=new F({flex:!0,flexDirection:"row",class:[X,M]}),this._labelTitle=new j({text:e.headerText,class:[G,M]}),this._containerHeader.append(this._labelTitle),this._containerHeader.dom.addEventListener("click",this._onHeaderClick),this.append(this._containerHeader)}_onClickRemove(e){e.preventDefault(),e.stopPropagation(),this.emit("click:remove")}_initializeContent(e){this._containerContent=new F({class:Y,grid:e.grid,flex:e.flex,flexDirection:e.flexDirection,scrollable:e.scrollable,dom:e.content}),this.append(this._containerContent)}_reflow(){this._suspendReflow||(this._reflowTimeout&&(cancelAnimationFrame(this._reflowTimeout),this._reflowTimeout=null),!this.hidden&&this.collapsible&&(this.collapsed&&this.collapseHorizontally?this._containerHeader.style.top=-this.headerSize+"px":this._containerHeader.style.top="",this._reflowTimeout=requestAnimationFrame((()=>{this._reflowTimeout=null,this.collapsed?(this._widthBeforeCollapse||(this._widthBeforeCollapse=this.style.width),this._heightBeforeCollapse||(this._heightBeforeCollapse=this.style.height),this._collapseHorizontally?(this.height="",this.width=this.headerSize):this.height=this.headerSize,this.class.add(C)):(this.class.remove(C),this._collapseHorizontally?(this.height="",null!==this._widthBeforeCollapse&&(this.width=this._widthBeforeCollapse)):null!==this._heightBeforeCollapse&&(this.height=this._heightBeforeCollapse),this._widthBeforeCollapse=null,this._heightBeforeCollapse=null)}))))}_onDragEnd(e){window.removeEventListener("mouseup",this._onDragEndEvt),window.removeEventListener("mouseleave",this._onDragEndEvt),window.removeEventListener("mousemove",this._onDragMove),this._draggedChild===this&&(this._draggedChild=null),this.emit("dragend"),this.parent&&this.parent._onChildDragStart&&this.parent._onChildDragEnd(e,this)}set collapsible(e){e!==this._collapsible&&(this._collapsible=e,e?this.class.add(x):this.class.remove(x),this._reflow(),this.collapsed&&this.emit(e?"collapse":"expand"))}get collapsible(){return this._collapsible}set collapsed(e){this._collapsed!==e&&(this._collapsed=e,this._reflow(),this.collapsible&&this.emit(e?"collapse":"expand"))}get collapsed(){return this._collapsed}set sortable(e){this._sortable!==e&&(this._sortable=e,e?(this._iconSort=new j({class:Z}),this._iconSort.dom.addEventListener("mousedown",this._onDragStart),this.header.prepend(this._iconSort)):this._iconSort&&(this._iconSort.destroy(),this._iconSort=null))}get sortable(){return this._sortable}set removable(e){this.removable!==e&&(e?(this._btnRemove=new W({icon:"E289",class:Q}),this._btnRemove.on("click",this._onClickRemove.bind(this)),this.header.append(this._btnRemove)):(this._btnRemove.destroy(),this._btnRemove=null))}get removable(){return!!this._btnRemove}set collapseHorizontally(e){this._collapseHorizontally!==e&&(this._collapseHorizontally=e,e?this.class.add(J):this.class.remove(J),this._reflow())}get collapseHorizontally(){return this._collapseHorizontally}get content(){return this._containerContent}get header(){return this._containerHeader}set headerText(e){this._labelTitle.text=e}get headerText(){return this._labelTitle.text}set headerSize(e){this._headerSize=e;const t=this._containerHeader.dom.style;t.height=Math.max(0,e)+"px",t.lineHeight=t.height,this._reflow()}get headerSize(){return this._headerSize}}$.EVENT_COLLAPSE="collapse",$.EVENT_EXPAND="expand",R.register("panel",$);var ee=$,te=class extends R{constructor(e={}){var t,i,n,s,o;super(e),this._onInputFocus=e=>{this.class.add(k),this.emit("focus",e),this._prevValue=this._domInput.value},this._onInputBlur=e=>{this.class.remove(k),this.emit("blur",e)},this._onInputKeyUp=e=>{"Escape"!==e.key&&this._onInputChange(e),this.emit("keyup",e)},this._onInputCtxMenu=e=>{this._domInput.select()},this._updateInputReadOnly=()=>{!this.enabled||this.readOnly?this._domInput.setAttribute("readonly","true"):this._domInput.removeAttribute("readonly")},this.class.add("pcui-input-element");let r=e.input;r||(r=document.createElement("input"),r.type="text"),r.ui=this,r.tabIndex=0,r.autocomplete="off",this._onInputKeyDownEvt=this._onInputKeyDown.bind(this),this._onInputChangeEvt=this._onInputChange.bind(this),r.addEventListener("change",this._onInputChangeEvt),r.addEventListener("keydown",this._onInputKeyDownEvt),r.addEventListener("focus",this._onInputFocus),r.addEventListener("blur",this._onInputBlur),r.addEventListener("contextmenu",this._onInputCtxMenu,!1),this.dom.appendChild(r),this._domInput=r,this._suspendInputChangeEvt=!1,void 0!==e.value&&(this._domInput.value=e.value),this.placeholder=null!==(t=e.placeholder)&&void 0!==t?t:"",this.renderChanges=null!==(i=e.renderChanges)&&void 0!==i&&i,this.blurOnEnter=null===(n=e.blurOnEnter)||void 0===n||n,this.blurOnEscape=null===(s=e.blurOnEscape)||void 0===s||s,this.keyChange=null!==(o=e.keyChange)&&void 0!==o&&o,this._prevValue=null,this.on("change",(()=>{this.renderChanges&&this.flash()})),this.on("disable",this._updateInputReadOnly),this.on("enable",this._updateInputReadOnly),this.on("readOnly",this._updateInputReadOnly),this._updateInputReadOnly()}destroy(){if(this._destroyed)return;const e=this._domInput;e.removeEventListener("change",this._onInputChangeEvt),e.removeEventListener("keydown",this._onInputKeyDownEvt),e.removeEventListener("focus",this._onInputFocus),e.removeEventListener("blur",this._onInputBlur),e.removeEventListener("keyup",this._onInputKeyUp),e.removeEventListener("contextmenu",this._onInputCtxMenu),super.destroy()}_onInputKeyDown(e){if("Enter"===e.key&&this.blurOnEnter)this._suspendInputChangeEvt=this.keyChange,this._domInput.blur(),this._suspendInputChangeEvt=!1;else if("Escape"===e.key){this._suspendInputChangeEvt=!0;const t=this._domInput.value;this._domInput.value=this._prevValue,this._suspendInputChangeEvt=!1,this.keyChange&&t!==this._prevValue&&this._onInputChange(e),this.blurOnEscape&&this._domInput.blur()}this.emit("keydown",e)}_onInputChange(e){}focus(e){this._domInput.focus(),e&&this._domInput.select()}blur(){this._domInput.blur()}set placeholder(e){e?this.dom.setAttribute("placeholder",e):this.dom.removeAttribute("placeholder")}get placeholder(){var e;return null!==(e=this.dom.getAttribute("placeholder"))&&void 0!==e?e:""}set keyChange(e){this._keyChange!==e&&(this._keyChange=e,e?this._domInput.addEventListener("keyup",this._onInputKeyUp):this._domInput.removeEventListener("keyup",this._onInputKeyUp))}get keyChange(){return this._keyChange}get input(){return this._domInput}set blurOnEnter(e){this._blurOnEnter=e}get blurOnEnter(){return this._blurOnEnter}set blurOnEscape(e){this._blurOnEscape=e}get blurOnEscape(){return this._blurOnEscape}set renderChanges(e){this._renderChanges=e}get renderChanges(){return this._renderChanges}};const ie="pcui-numeric-input",ne=ie+"-slider-control",se=ne+"-active",oe=ne+"-hidden",re=/,/g;class le extends te{constructor(e={}){var t,i,n,s;const o=Object.assign({},e);delete o.value,delete o.renderChanges,super(o),this._sliderUsed=!1,this._onSliderMouseWheel=e=>{this._updatePosition(e.deltaY,e.shiftKey)},this._onSliderMouseMove=e=>{this._updatePosition(e.movementX,e.shiftKey)},this._onSliderMouseDown=()=>{this._sliderControl.dom.requestPointerLock(),this._sliderMovement=0,this._sliderPrevValue=this.value,this._sliderUsed=!0,this.binding&&(this._historyCombine=this.binding.historyCombine,this._historyPostfix=this.binding.historyPostfix,this.binding.historyCombine=!0,this.binding.historyPostfix=`(${Date.now()})`)},this._onSliderMouseUp=()=>{document.exitPointerLock(),this._sliderUsed&&(this._sliderUsed=!1,this.value=this._sliderPrevValue+this._sliderMovement,this.binding&&(this.binding.historyCombine=this._historyCombine,this.binding.historyPostfix=this._historyPostfix,this._historyCombine=!1,this._historyPostfix=null),this.focus())},this._onPointerLockChange=()=>{this._isScrolling()?(this._sliderControl.dom.addEventListener("mousemove",this._onSliderMouseMove,!1),this._sliderControl.dom.addEventListener("wheel",this._onSliderMouseWheel,{passive:!0}),this._sliderControl.class.add(se)):(this._sliderControl.dom.removeEventListener("mousemove",this._onSliderMouseMove,!1),this._sliderControl.dom.removeEventListener("wheel",this._onSliderMouseWheel),this._sliderControl.class.remove(se))},this.class.add(ie),this._min=null!==(t=e.min)&&void 0!==t?t:null,this._max=null!==(i=e.max)&&void 0!==i?i:null,this._allowNull=null!==(n=e.allowNull)&&void 0!==n&&n,this._precision=null!==(s=e.precision)&&void 0!==s?s:7,Number.isFinite(e.step)?this._step=e.step:e.precision?this._step=10/Math.pow(10,e.precision):this._step=1,Number.isFinite(e.stepPrecision)?this._stepPrecision=e.stepPrecision:this._stepPrecision=.1*this._step,this._oldValue=void 0,Number.isFinite(e.value)?this.value=e.value:this._allowNull||(this.value=0),this._historyCombine=!1,this._historyPostfix=null,this._sliderPrevValue=0,this.renderChanges=e.renderChanges,e.hideSlider||(this._sliderControl=new R,this._sliderControl.class.add(ne),this.dom.append(this._sliderControl.dom),this._sliderControl.dom.addEventListener("mousedown",this._onSliderMouseDown),this._sliderControl.dom.addEventListener("mouseup",this._onSliderMouseUp),document.addEventListener("pointerlockchange",this._onPointerLockChange,!1))}destroy(){this.destroyed||(this._sliderControl&&(this._sliderControl.dom.removeEventListener("mousedown",this._onSliderMouseDown),this._sliderControl.dom.removeEventListener("mouseup",this._onSliderMouseUp),this._sliderControl.dom.removeEventListener("mousemove",this._onSliderMouseMove,!1),this._sliderControl.dom.removeEventListener("wheel",this._onSliderMouseWheel),document.removeEventListener("pointerlockchange",this._onPointerLockChange,!1)),super.destroy())}_updatePosition(e,t){this._sliderMovement+=e/100*(t?this._stepPrecision:this._step),this.value=this._sliderPrevValue+this._sliderMovement}_onInputChange(e){this.value=this._normalizeValue(this._domInput.value)}_onInputKeyDown(e){if(this.enabled&&!this.readOnly){if("ArrowUp"===e.key||"ArrowDown"===e.key){const t="ArrowDown"===e.key?-1:1;this.value+=(e.shiftKey?this._stepPrecision:this._step)*t}super._onInputKeyDown(e)}}_isScrolling(){return!!this._sliderControl&&document.pointerLockElement===this._sliderControl.dom}_normalizeValue(e){try{if("string"==typeof e){if("0"===e)return 0;if(null!==(e=(e=(e=e.replace(re,".")).replace(/\s/g,"")).match(/^[*/+\-0-9().]+$/))&&e[0].length<20){let t=e[0];["+","-","/","*"].forEach((e=>{const i=t.split(e);i.forEach(((e,t)=>{i[t]=i[t].replace(/^0+/,"")})),t=i.join(e)})),e=Function('"use strict";return ('+t+")")()}}}catch(t){e=null}if(null===e||isNaN(e)){if(this._allowNull)return null;e=0}return null!==this.min&&e<this.min&&(e=this.min),null!==this.max&&e>this.max&&(e=this.max),null!==this.precision&&(e=parseFloat(Number(e).toFixed(this.precision))),e}_updateValue(e,t){const i=e!==this._oldValue||t;return this._oldValue=e,this._domInput.value=null===e?"":String(e),this.class.remove(A),i&&this.emit("change",e),i}set value(e){e=this._normalizeValue(e);const t=this.class.contains(A)&&null===e&&this._allowNull;this._updateValue(e,t)&&this.binding&&this.binding.setValue(e),this._sliderControl&&this._sliderControl.class.remove(oe)}get value(){const e=this._domInput.value;return""!==e?parseFloat(e):null}set values(e){const t=e.map((e=>this._normalizeValue(e)));t.some((e=>e!==t[0]))?(this._updateValue(null),this.class.add(A),this._sliderControl&&this._sliderControl.class.add(oe)):(this._updateValue(t[0]),this._sliderControl&&this._sliderControl.class.remove(oe))}set min(e){this._min!==e&&(this._min=e,null!==this._min&&(this.value=this.value))}get min(){return this._min}set max(e){this._max!==e&&(this._max=e,null!==this._max&&(this.value=this.value))}get max(){return this._max}set precision(e){this._precision!==e&&(this._precision=e,null!==this._precision&&(this.value=this.value))}get precision(){return this._precision}set step(e){this._step=e}get step(){return this._step}}R.register("number",le,{renderChanges:!0});var ae=le;const he="pcui-array-input",de="pcui-array-empty",ce=he+"-size",ue=he+"-items",pe=he+"-item",ge=pe+"-delete";class _e extends R{constructor(e={}){var t,i,n;const s=new F({dom:e.dom,flex:!0}),o=Object.assign(Object.assign({},e),{dom:s.dom});delete o.binding,super(o),this._suspendSizeChangeEvt=!1,this._suspendArrayElementEvts=!1,this._arrayElementChangeTimeout=null,this._container=s,this._container.parent=this,this.class.add(he,de),this._usePanels=null!==(t=e.usePanels)&&void 0!==t&&t,this._fixedSize=!!e.fixedSize,this._inputSize=new ae({class:[ce],placeholder:"Array Size",value:0,hideSlider:!0,step:1,precision:0,min:0,readOnly:this._fixedSize}),this._inputSize.on("change",(e=>{this._onSizeChange(e)})),this._inputSize.on("focus",(()=>{this.emit("focus")})),this._inputSize.on("blur",(()=>{this.emit("blur")})),this._container.append(this._inputSize),this._containerArray=new F({class:ue,hidden:!0}),this._containerArray.on("append",(()=>{this._containerArray.hidden=!1})),this._containerArray.on("remove",(()=>{this._containerArray.hidden=0===this._arrayElements.length})),this._container.append(this._containerArray),this._getDefaultFn=null!==(i=e.getDefaultFn)&&void 0!==i?i:null;let r=e.elementArgs&&e.elementArgs.type||e.type;_e.DEFAULTS.hasOwnProperty(r)||(r="string"),this._valueType=r,this._elementType=null!==(n=e.type)&&void 0!==n?n:"string",e.elementArgs?this._elementArgs=e.elementArgs:(delete o.dom,this._elementArgs=o),this._arrayElements=[],this.binding=e.binding,this._values=[],e.value&&(this.value=e.value),this.renderChanges=e.renderChanges||!1}destroy(){this._destroyed||(this._arrayElements.length=0,super.destroy())}_onSizeChange(e){if(0===e?this.class.add(de):this.class.remove(de),null===e)return;if(this._suspendSizeChangeEvt)return;let t;const i=()=>{if(this._getDefaultFn)t=this._getDefaultFn();else if(t=_e.DEFAULTS[this._valueType],"curveset"===this._valueType){if(t=p(t),Array.isArray(this._elementArgs.curves))for(let e=0;e<this._elementArgs.curves.length;e++)t.keys.push([0,0])}else if("gradient"===this._valueType&&(t=p(t),this._elementArgs.channels))for(let e=0;e<this._elementArgs.channels;e++)t.keys.push([0,1])},n=this._values.map((n=>{if(n)if(n.length<e){const s=new Array(e-n.length);for(let e=0;e<s.length;e++)s[e]=p(_e.DEFAULTS[this._valueType]),void 0===t&&i(),s[e]=p(t);n=n.concat(s)}else{const t=new Array(e);for(let i=0;i<e;i++)t[i]=p(n[i]);n=t}else{n=new Array(e);for(let s=0;s<e;s++)n[s]=p(_e.DEFAULTS[this._valueType]),void 0===t&&i(),n[s]=p(t)}return n}));if(!n.length){const s=new Array(e);for(let n=0;n<e;n++)s[n]=p(_e.DEFAULTS[this._valueType]),void 0===t&&i(),s[n]=p(t);n.push(s)}this._updateValues(n,!0)}_createArrayElement(){const e=Object.assign({},this._elementArgs);let t;e.binding?e.binding=e.binding.clone():this._binding&&(e.binding=this._binding.clone()),e.renderChanges=!1,t=this._usePanels?new ee({headerText:`[${this._arrayElements.length}]`,removable:!this._fixedSize,collapsible:!0,class:[pe,pe+"-"+this._elementType]}):new F({flex:!0,flexDirection:"row",alignItems:"center",class:[pe,pe+"-"+this._elementType]}),"json"===this._elementType&&e.attributes&&(e.attributes=e.attributes.map((e=>{if(!e.path)return e;const t=(e=Object.assign({},e)).path.split(".");return t.splice(t.length-1,0,this._arrayElements.length),e.path=t.join("."),e})));const i=R.create(this._elementType,e);t.append(i),i.renderChanges=this.renderChanges;const n={container:t,element:i};if(this._arrayElements.push(n),this._usePanels)t.on("click:remove",(()=>{this._removeArrayElement(n)}));else if(!this._fixedSize){const e=new W({icon:"E289",size:"small",class:ge,tabIndex:-1});e.on("click",(()=>{this._removeArrayElement(n)})),t.append(e)}return i.on("change",(e=>{this._onArrayElementChange(n,e)})),this._containerArray.append(t),n}_removeArrayElement(e){const t=this._arrayElements.indexOf(e);if(-1===t)return;const i=this._values.map((e=>e?(e.splice(t,1),e):null));this._updateValues(i,!0)}_onArrayElementChange(e,t){if(this._suspendArrayElementEvts)return;const i=this._arrayElements.indexOf(e);-1!==i&&(this._values.forEach((e=>{e&&e.length>i&&(e[i]=t)})),this._arrayElementChangeTimeout=window.setTimeout((()=>{this._arrayElementChangeTimeout=null,this.emit("change",this.value)})))}_linkArrayElement(e,t){const i=this._binding.observers,n=this._binding.paths,s=1===n.length||i.length!==n.length;e.unlink(),e.value=null,this.emit("unlinkElement",e,t);const o=s?n[0]+`.${t}`:n.map((e=>`${e}.${t}`));e.link(i,o),this.emit("linkElement",e,t,o)}_updateValues(e,t){this._values=e||[],this._suspendArrayElementEvts=!0,this._suspendSizeChangeEvt=!0,t&&this._binding&&this._binding.setValues(e);const i=[],n=[];e.forEach((e=>{e&&(n.push(e.length),e.forEach(((e,t)=>{i[t]||(i[t]=[]),i[t].push(e)})))}));let s=-1;for(let t=0;t<i.length&&i[t].length===e.length;t++)this._arrayElements[t]||this._createArrayElement(),this._binding&&this._binding.observers?this._linkArrayElement(this._arrayElements[t].element,t):i[t].length>1?this._arrayElements[t].element.values=i[t]:this._arrayElements[t].element.value=i[t][0],s=t;for(let e=this._arrayElements.length-1;e>s;e--)this._arrayElements[e].container.destroy(),this._arrayElements.splice(e,1);this._inputSize.values=n,this._suspendSizeChangeEvt=!1,this._suspendArrayElementEvts=!1,this._arrayElementChangeTimeout&&(window.clearTimeout(this._arrayElementChangeTimeout),this._arrayElementChangeTimeout=null),this.emit("change",this.value)}focus(){this._inputSize.focus()}blur(){this._inputSize.blur()}unlink(){super.unlink(),this._arrayElements.forEach((e=>{e.element.unlink()}))}link(e,t){super.link(e,t),this._arrayElements.forEach(((e,t)=>{this._linkArrayElement(e.element,t)}))}forEachArrayElement(e){this._containerArray.forEachChild(((t,i)=>e(t.dom.firstChild.ui,i)))}set binding(e){super.binding=e,this._arrayElements.forEach((t=>{t.element.binding=e?e.clone():null}))}get binding(){return super.binding}set value(e){Array.isArray(e)||(e=[]),g(this.value||[],e)||this._updateValues(new Array(this._values.length||1).fill(e),!0)}get value(){return this._arrayElements.map((e=>e.element.value))}set values(e){g(this._values,e)||this._updateValues(e,!1)}set renderChanges(e){this._renderChanges=e,this._arrayElements.forEach((t=>{t.element.renderChanges=e}))}get renderChanges(){return this._renderChanges}}_e.DEFAULTS={boolean:!1,number:0,string:"",vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0]};for(const e in _e.DEFAULTS)R.register(`array:${e}`,_e,{type:e,renderChanges:!0});R.register("array:select",_e,{type:"select",renderChanges:!0});var me=_e;const fe="pcui-boolean-input",ve=fe+"-ticked",be=fe+"-toggle";class ye extends R{constructor(e={}){var t;super(Object.assign({tabIndex:0},e)),this._onKeyDown=e=>{"Escape"!==e.key?this.enabled&&!this.readOnly&&" "===e.key&&(e.stopPropagation(),e.preventDefault(),this.value=!this.value):this.blur()},this._onFocus=()=>{this.emit("focus")},this._onBlur=()=>{this.emit("blur")},"toggle"===e.type?this.class.add(be):this.class.add(fe),this.class.add(I),this.dom.addEventListener("keydown",this._onKeyDown),this.dom.addEventListener("focus",this._onFocus),this.dom.addEventListener("blur",this._onBlur),this._value=null,void 0!==e.value&&(this.value=e.value),this.renderChanges=null!==(t=e.renderChanges)&&void 0!==t&&t}destroy(){this._destroyed||(this.dom.removeEventListener("keydown",this._onKeyDown),this.dom.removeEventListener("focus",this._onFocus),this.dom.removeEventListener("blur",this._onBlur),super.destroy())}_onClick(e){return this.enabled&&this.focus(),this.enabled&&!this.readOnly&&(this.value=!this.value),super._onClick(e)}_updateValue(e){return this.class.remove(A),e!==this.value&&(this._value=e,e?this.class.add(ve):this.class.remove(ve),this.renderChanges&&this.flash(),this.emit("change",e),!0)}focus(){this.dom.focus()}blur(){this.dom.blur()}set value(e){this._updateValue(e)&&this._binding&&this._binding.setValue(e)}get value(){return this._value}set values(e){e.some((t=>t!==e[0]))?(this._updateValue(null),this.class.add(A)):this._updateValue(e[0])}set renderChanges(e){this._renderChanges=e}get renderChanges(){return this._renderChanges}}R.register("boolean",ye,{renderChanges:!0});var we=ye;class xe extends R{constructor(e={}){super(Object.assign({dom:"canvas"},e)),this._width=300,this._height=150,this._ratio=1,this.class.add("pcui-canvas");const{useDevicePixelRatio:t=!1}=e;this._ratio=t?window.devicePixelRatio:1,this.dom.onselectstart=e=>!1}resize(e,t){if(this._width===e&&this._height===t)return;this._width=e,this._height=t;const i=this._dom;i.width=this.pixelWidth,i.height=this.pixelHeight,i.style.width=e+"px",i.style.height=t+"px",this.emit("resize",e,t)}set width(e){if(this._width===e)return;this._width=e;const t=this._dom;t.width=this.pixelWidth,t.style.width=e+"px",this.emit("resize",this._width,this._height)}get width(){return this._width}set height(e){if(this._height===e)return;this._height=e;const t=this._dom;t.height=this.pixelHeight,t.style.height=e+"px",this.emit("resize",this._width,this._height)}get height(){return this._height}get pixelWidth(){return Math.floor(this._width*this._ratio)}get pixelHeight(){return Math.floor(this._height*this._ratio)}get pixelRatio(){return this._ratio}}R.register("canvas",xe);var Ce=xe;const ke="pcui-code",Ae=ke+"-inner";class Ee extends F{constructor(e={}){super(e),this.class.add(ke),this._inner=new j({class:Ae}),this.append(this._inner),e.text&&(this.text=e.text)}set text(e){this._text=e,this._inner.text=e}get text(){return this._text}}R.register("code",Ee);var Te=Ee;const Ie="pcui-overlay",Se=Ie+"-inner",Me=Ie+"-clickable",ze=Ie+"-transparent",Oe=Ie+"-content";class He extends F{constructor(e={}){super(e),this._onMouseDown=e=>{this.clickable&&(document.body.blur(),requestAnimationFrame((()=>{this.hidden=!0})),e.preventDefault())},this.class.add(Ie),this._domClickableOverlay=document.createElement("div"),this._domClickableOverlay.ui=this,this._domClickableOverlay.classList.add(Se),this.dom.appendChild(this._domClickableOverlay),this._domClickableOverlay.addEventListener("mousedown",this._onMouseDown),this.domContent=document.createElement("div"),this.domContent.ui=this,this.domContent.classList.add(Oe),this.dom.appendChild(this.domContent),this.clickable=e.clickable||!1,this.transparent=e.transparent||!1}destroy(){this._destroyed||(this._domClickableOverlay.removeEventListener("mousedown",this._onMouseDown),super.destroy())}position(e,t){const i=this._domClickableOverlay.getBoundingClientRect(),n=this.domContent.getBoundingClientRect();e=Math.max(0,Math.min(i.width-n.width,e)),t=Math.max(0,Math.min(i.height-n.height,t)),this.domContent.style.position="absolute",this.domContent.style.left=`${e}px`,this.domContent.style.top=`${t}px`}set clickable(e){e?this.class.add(Me):this.class.remove(Me)}get clickable(){return this.class.contains(Me)}set transparent(e){e?this.class.add(ze):this.class.remove(ze)}get transparent(){return this.class.contains(ze)}}R.register("overlay",He);var Re=He;class De extends te{constructor(e={}){super(e),this.class.add("pcui-text-input"),e.onValidate&&(this.onValidate=e.onValidate)}_onInputChange(e){if(!this._suspendInputChangeEvt){if(this._onValidate){const e=!this._onValidate(this.value);if(this.error=e,e)return}else this.error=!1;this.emit("change",this.value),this._binding&&this._binding.setValue(this.value)}}_updateValue(e){if(this.class.remove(A),e&&"object"==typeof e)if(Array.isArray(e)){let t=!1;for(let i=0;i<e.length;i++)if(e[i]&&"object"==typeof e[i]){t=!0;break}e=t?"[Not available]":e.map((e=>null===e?"null":e)).join(",")}else e="[Not available]";return e!==this.value&&(this._suspendInputChangeEvt=!0,this._domInput.value=null==e?"":String(e),this._suspendInputChangeEvt=!1,this.emit("change",e),!0)}set value(e){const t=this._updateValue(e);t&&(this.error=!1),t&&this._binding&&this._binding.setValue(e)}get value(){return this._domInput.value}set values(e){e.some((t=>t!==e[0]))?(this._updateValue(null),this.class.add(A)):this._updateValue(e[0])}set onValidate(e){this._onValidate=e}get onValidate(){return this._onValidate}}R.register("string",De,{renderChanges:!0});var Ve=De;function Pe(e){const t=e[0]/255,i=e[1]/255,n=e[2]/255;let s,o;const r=Math.max(t,i,n),l=r-Math.min(t,i,n),a=e=>(r-e)/6/l+.5;if(0===l)return s=o=0,[s,o,r];o=l/r;const h=a(t),d=a(i),c=a(n);return t===r?s=c-d:i===r?s=1/3+h-c:n===r&&(s=2/3+d-h),s<0?s+=1:s>1&&(s-=1),[s,o,r]}function Le(e){const t=e[0],i=e[1],n=e[2];let s,o,r;const l=Math.floor(6*t),a=6*t-l,h=n*(1-i),d=n*(1-a*i),c=n*(1-(1-a)*i);switch(l%6){case 0:s=n,o=c,r=h;break;case 1:s=d,o=n,r=h;break;case 2:s=h,o=n,r=c;break;case 3:s=h,o=d,r=n;break;case 4:s=c,o=h,r=n;break;case 5:s=n,o=h,r=d}return[Math.round(255*s),Math.round(255*o),Math.round(255*r)]}class Ue extends R{constructor(e={}){var t,i,n;super(e),this._historyCombine=!1,this._historyPostfix=null,this._size=144,this._directInput=!0,this._colorHSV=[0,0,0],this._pickerChannels=[],this._channelsNumber=4,this._changing=!1,this._dragging=!1,this._callingCallback=!1,this._evtColorPick=null,this._evtColorToPicker=null,this._evtColorPickStart=null,this._evtColorPickEnd=null,this._onKeyDown=e=>{"Escape"===e.key&&this.blur(),"Enter"===e.key&&this.enabled&&!this.readOnly&&(e.stopPropagation(),e.preventDefault())},this._onFocus=e=>{this.emit("focus")},this._onBlur=e=>{this.emit("blur")},this._pickRectMouseMove=e=>{this._changing=!0;const t=this._pickRect.getBoundingClientRect(),i=Math.max(0,Math.min(this._size,Math.floor(e.clientX-t.left))),n=Math.max(0,Math.min(this._size,Math.floor(e.clientY-t.top)));this._colorHSV[1]=i/this._size,this._colorHSV[2]=1-n/this._size,this._directInput=!1;const s=Le(this._colorHSV);for(let e=0;e<3;e++)this._pickerChannels[e].value=s[e];this._fieldHex.value=this._getHex(),this._directInput=!0,this._pickRectHandle.style.left=Math.max(4,Math.min(this._size-4,i))+"px",this._pickRectHandle.style.top=Math.max(4,Math.min(this._size-4,n))+"px",this._changing=!1},this._pickRectMouseUp=()=>{window.removeEventListener("mousemove",this._pickRectMouseMove,!1),window.removeEventListener("mouseup",this._pickRectMouseUp,!1),this._dragging=!1,this.emit("picker:color:end")},this._pickHueMouseMove=e=>{this._changing=!0;const t=this._pickHue.getBoundingClientRect(),i=Math.max(0,Math.min(this._size,Math.floor(e.clientY-t.top)))/this._size,n=Le([i,this._colorHSV[1],this._colorHSV[2]]);this._colorHSV[0]=i,this._directInput=!1;for(let e=0;e<3;e++)this._pickerChannels[e].value=n[e];this._fieldHex.value=this._getHex(),this._onChangeRgb(),this._directInput=!0,this._changing=!1},this._pickHueMouseUp=()=>{window.removeEventListener("mousemove",this._pickHueMouseMove,!1),window.removeEventListener("mouseup",this._pickHueMouseUp,!1),this._dragging=!1,this.emit("picker:color:end")},this._pickOpacityMouseMove=e=>{this._changing=!0;const t=this._pickOpacity.getBoundingClientRect(),i=1-Math.max(0,Math.min(this._size,Math.floor(e.clientY-t.top)))/this._size;this._directInput=!1,this._pickerChannels[3].value=Math.max(0,Math.min(255,Math.round(255*i))),this._fieldHex.value=this._getHex(),this._directInput=!0,this._changing=!1},this._pickOpacityMouseUp=()=>{window.removeEventListener("mousemove",this._pickOpacityMouseMove,!1),window.removeEventListener("mouseup",this._pickOpacityMouseUp,!1),this._dragging=!1,this.emit("picker:color:end")},this.class.add("pcui-color-input",I),this._domColor=document.createElement("div"),this.dom.appendChild(this._domColor),this.dom.addEventListener("keydown",this._onKeyDown),this.dom.addEventListener("focus",this._onFocus),this.dom.addEventListener("blur",this._onBlur),this.on("click",(()=>{this.enabled&&!this.readOnly&&this._openColorPicker()})),this._value=null!==(t=e.value)&&void 0!==t?t:[0,0,255,1],this._channels=null!==(i=e.channels)&&void 0!==i?i:3,this._setValue(this._value),this.renderChanges=null!==(n=e.renderChanges)&&void 0!==n&&n,this.on("change",(()=>{this.renderChanges&&this.flash()})),this._overlay=new Re({class:"picker-color",clickable:!0,hidden:!0,transparent:!0}),this.dom.appendChild(this._overlay.dom),this._pickRect=document.createElement("div"),this._pickRect.classList.add("pick-rect"),this._overlay.append(this._pickRect),this._pickRect.addEventListener("mousedown",function(e){this._pickRectMouseMove(e),window.addEventListener("mousemove",this._pickRectMouseMove,!1),window.addEventListener("mouseup",this._pickRectMouseUp,!1),e.stopPropagation(),e.preventDefault(),this.dragging=!0,this.emit("picker:color:start")}.bind(this)),this._pickRectWhite=document.createElement("div"),this._pickRectWhite.classList.add("white"),this._pickRect.appendChild(this._pickRectWhite),this._pickRectBlack=document.createElement("div"),this._pickRectBlack.classList.add("black"),this._pickRect.appendChild(this._pickRectBlack),this._pickRectHandle=document.createElement("div"),this._pickRectHandle.classList.add("handle"),this._pickRect.appendChild(this._pickRectHandle),this._pickHue=document.createElement("div"),this._pickHue.classList.add("pick-hue"),this._overlay.append(this._pickHue),this._pickHue.addEventListener("mousedown",function(e){this._pickHueMouseMove(e),window.addEventListener("mousemove",this._pickHueMouseMove,!1),window.addEventListener("mouseup",this._pickHueMouseUp,!1),e.stopPropagation(),e.preventDefault(),this.dragging=!0,this.emit("picker:color:start")}.bind(this)),this._pickHueHandle=document.createElement("div"),this._pickHueHandle.classList.add("handle"),this._pickHue.appendChild(this._pickHueHandle),this._pickOpacity=document.createElement("div"),this._pickOpacity.classList.add("pick-opacity"),this._overlay.append(this._pickOpacity),this._pickOpacity.addEventListener("mousedown",function(e){this._pickOpacityMouseMove(e),window.addEventListener("mousemove",this._pickOpacityMouseMove,!1),window.addEventListener("mouseup",this._pickOpacityMouseUp,!1),e.stopPropagation(),e.preventDefault(),this.dragging=!0,this.emit("picker:color:start")}.bind(this)),this._pickOpacityHandle=document.createElement("div"),this._pickOpacityHandle.classList.add("handle"),this._pickOpacity.appendChild(this._pickOpacityHandle),this._panelFields=document.createElement("div"),this._panelFields.classList.add("fields"),this._overlay.append(this._panelFields),this._overlay.on("hide",(()=>{this._evtColorPick.unbind(),this._evtColorPick=null,this._evtColorToPicker.unbind(),this._evtColorToPicker=null,this._evtColorPickStart.unbind(),this._evtColorPickStart=null,this._evtColorPickEnd.unbind(),this._evtColorPickEnd=null}));const s=e=>new ae({class:["field","field-"+e],precision:0,step:1,min:0,max:255,placeholder:e}),o=s("r");o.on("change",(()=>{this._onChangeRgb()})),this._pickerChannels.push(o),this._panelFields.appendChild(o.dom);const r=s("g");r.on("change",(()=>{this._onChangeRgb()})),this._pickerChannels.push(r),this._panelFields.appendChild(r.dom);const l=s("b");l.on("change",(()=>{this._onChangeRgb()})),this._pickerChannels.push(l),this._panelFields.appendChild(l.dom);const a=s("a");a.on("change",(e=>{this._onChangeAlpha(e)})),this._pickerChannels.push(a),this._panelFields.appendChild(a.dom),this._fieldHex=new Ve({class:["field","field-hex"],placeholder:"#"}),this._fieldHex.on("change",(()=>{this._onChangeHex()})),this._panelFields.appendChild(this._fieldHex.dom)}destroy(){this._destroyed||(this.dom.removeEventListener("keydown",this._onKeyDown),this.dom.removeEventListener("focus",this._onFocus),this.dom.removeEventListener("blur",this._onBlur),super.destroy())}focus(){this.dom.focus()}blur(){this.dom.blur()}_setColorPickerPosition(e,t){this._overlay.position(e,t)}_setPickerColor(e){if(!this._changing&&!this._dragging){if(this._channelsNumber>=3){const t=Pe(e);this._colorHSV[0]=t[0],this._colorHSV[1]=t[1],this._colorHSV[2]=t[2]}this._directInput=!1;for(let t=0;t<e.length;t++)this._pickerChannels[t].value=e[t];this._fieldHex.value=this._getHex(),this._directInput=!0}}_openColorPicker(){this._callPicker(this.value.map((e=>Math.floor(255*e)))),this._evtColorPick=this.on("picker:color",(e=>{this.value=e.map((e=>e/255))})),this._evtColorPickStart=this.on("picker:color:start",(()=>{this.binding?(this._historyCombine=this.binding.historyCombine,this._historyPostfix=this.binding.historyPostfix,this.binding.historyCombine=!0,this._binding.historyPostfix=`(${Date.now()})`):(this._historyCombine=!1,this._historyPostfix=null)})),this._evtColorPickEnd=this.on("picker:color:end",(()=>{this.binding&&(this.binding.historyCombine=this._historyCombine,this.binding.historyPostfix=this._historyPostfix)}));const e=this._overlay.dom.getBoundingClientRect(),t=this.dom.getBoundingClientRect();this._setColorPickerPosition(t.left-e.width,t.top+25),this._evtColorToPicker=this.on("change",(()=>{this._setPickerColor(this.value.map((e=>Math.floor(255*e))))}))}_callPicker(e){for(let t=0;t<4;t++)e.length-1<t?this._overlay.class.remove("c-"+(t+1)):this._overlay.class.add("c-"+(t+1));if(this._channelsNumber=e.length,this._channelsNumber>=3){const t=Pe(e);this._colorHSV[0]=t[0],this._colorHSV[1]=t[1],this._colorHSV[2]=t[2]}this._directInput=!1;for(let t=0;t<e.length;t++)this._pickerChannels[t].value=e[t];this._fieldHex.value=this._getHex(),this._directInput=!0,this._overlay.hidden=!1,this._fieldHex.dom.focus(),window.setTimeout((()=>{this._fieldHex.dom.focus()}),100)}_valueToColor(e){return e=Math.floor(255*e),Math.max(0,Math.min(e,255))}_setValue(e){const t=this._valueToColor(e[0]),i=this._valueToColor(e[1]),n=this._valueToColor(e[2]),s=e[3];1===this._channels?this._domColor.style.backgroundColor=`rgb(${t}, ${t}, ${t})`:3===this._channels?this._domColor.style.backgroundColor=`rgb(${t}, ${i}, ${n})`:4===this._channels&&(this._domColor.style.backgroundColor=`rgba(${t}, ${i}, ${n}, ${s})`)}_updateValue(e){let t=!1;for(let i=0;i<e.length;i++)this._value[i]!==e[i]&&(t=!0,this._value[i]=e[i]);return this.class.remove(A),t&&(this._setValue(e),this.emit("change",e)),t}_getHex(){let e="";for(let t=0;t<this._channelsNumber;t++)e+=("00"+this._pickerChannels[t].value.toString(16)).slice(-2).toUpperCase();return e}_onChangeHex(){if(!this._directInput)return;this._changing=!0;const e=this._fieldHex.value.trim().toLowerCase();if(/^([0-9a-f]{2}){3,4}$/.test(e))for(let t=0;t<this._channelsNumber;t++)this._pickerChannels[t].value=parseInt(e.slice(2*t,2*t+2),16);this._changing=!1}_onChangeRgb(){const e=this._pickerChannels.map((function(e){return e.value||0})).slice(0,this._channelsNumber),t=Pe(e);if(this._directInput){const i=e[0]+e[1]+e[2];765!==i&&0!==i&&(this._colorHSV[0]=t[0]),this._colorHSV[1]=t[1],this._colorHSV[2]=t[2],this._dragging=!0,this.emit("picker:color:start")}if(this._pickHueHandle.style.top=Math.floor(this._size*this._colorHSV[0])+"px",this._pickRectHandle.style.left=Math.max(4,Math.min(this._size-4,this._size*this._colorHSV[1]))+"px",this._pickRectHandle.style.top=Math.max(4,Math.min(this._size-4,this._size*(1-this._colorHSV[2])))+"px",this._channelsNumber>=3){const t=Le([this._colorHSV[0],1,1]).join(",");this._pickRect.style.backgroundColor="rgb("+t+")",this._pickRectHandle.style.backgroundColor="rgb("+e.slice(0,3).join(",")+")",this._pickHueHandle.style.backgroundColor="rgb("+t+")"}this.callCallback()}_onChangeAlpha(e){4===this._channelsNumber&&(this._pickOpacityHandle.style.top=Math.floor(this._size*(1-Math.max(0,Math.min(255,e))/255))+"px",this._pickOpacityHandle.style.backgroundColor=`rgb(${e}, ${e}, ${e})`,this.callCallback())}callbackHandle(){this._callingCallback=!1,this.emit("picker:color",this._pickerChannels.map((function(e){return e.value||0})).slice(0,this._channelsNumber))}callCallback(){this._callingCallback||(this._callingCallback=!0,window.setTimeout((()=>{this.callbackHandle()}),1e3/60))}set value(e){e=e||[0,0,0,0],this._updateValue(e)&&this._binding&&this._binding.setValue(e)}get value(){return this._value.slice(0,this._channels)}set values(e){let t=!1;const i=e[0];for(let n=1;n<e.length;n++)if(Array.isArray(i)){if(!i.equals(e[n])){t=!0;break}}else if(i!==e[n]){t=!0;break}t?(this.value=null,this.class.add(A)):this.value=e[0]}set channels(e){this._channels!==e&&(this._channels=Math.max(0,Math.min(e,4)),this._setValue(this.value))}get channels(){return this._channels}set renderChanges(e){this._renderChanges=e}get renderChanges(){return this._renderChanges}}R.register("rgb",Ue),R.register("rgba",Ue,{channels:4});var Ne=Ue;class Fe extends R{constructor(e={}){super(e),this.class.add("pcui-divider")}}R.register("divider",Fe);var Be=Fe;const je=(e,t)=>{if(0===e.length)return t.length;if(0===t.length)return e.length;if(e===t)return 0;const i=[];for(let e=0;e<=t.length;e++)i[e]=[e];for(let t=0;t<=e.length;t++)i[0][t]=t;for(let n=1;n<=t.length;n++)for(let s=1;s<=e.length;s++)t.charAt(n-1)===e.charAt(s-1)?i[n][s]=i[n-1][s-1]:i[n][s]=Math.min(i[n-1][s-1]+1,Math.min(i[n][s-1]+1,i[n-1][s]+1));return i[t.length][e.length]},qe=(e,t)=>{if(e===t)return e.length;let i=0;const n=new Set;for(let e=0;e<t.length;e++)n.add(t.charAt(e));for(let t=0;t<e.length;t++)n.has(e.charAt(t))&&i++;return i},We=e=>{const t=[],i=e.replace(/([^A-Z])([A-Z][^A-Z])/g,"$1 $2").replace(/([A-Z0-9]{2,})/g," $1").split(/(\s|\-|_)/g);for(let e=0;e<i.length;e++)i[e]=i[e].toLowerCase().trim(),i[e]&&"-"!==i[e]&&"_"!==i[e]&&t.push(i[e]);return t},Ke=(e,t,i)=>{const n=[];for(const s of e){if(s.subFull!==1/0){n.push(s),s.edits===1/0&&(s.edits=0),s.sub===1/0&&(s.sub=s.subFull);continue}if(s.name===t||0===s.name.indexOf(t)){n.push(s),s.edits===1/0&&(s.edits=0),s.sub===1/0&&(s.sub=0);continue}if(qe(t,s.name)/t.length<i.containsCharsTolerance)continue;let e=1/0,o=1/0;for(let n=0;n<s.tokens.length;n++){if(s.tokens[n]===t){e=0,o=n;break}const r=je(t,s.tokens[n]);(o===1/0||r<e)&&-1!==s.tokens[n].indexOf(t)?(o=n,e=r):o===1/0&&r<e&&r/Math.max(t.length,s.tokens[n].length)<=i.editsDistanceTolerance&&(e=r)}e!==1/0&&(n.push(s),s.edits=s.edits===1/0?e:s.edits+e,s.sub=s.sub===1/0?o:s.sub+o)}return n},Xe=(e,t="",i={})=>{if(!(t=t.toLowerCase().trim()))return[];const n=We(t);if(!n.length)return[];i.containsCharsTolerance=i.containsCharsTolerance||.5,i.editsDistanceTolerance=i.editsDistanceTolerance||.5;let s=[];for(const i of e){const e=i[0].toLowerCase().trim().indexOf(t);s.push({name:i[0],item:i[1],tokens:We(i[0]),edits:1/0,subFull:-1!==e?e:1/0,sub:1/0})}for(let e=0;e<n.length;e++)s=Ke(s,n[e],i);s.sort(((e,t)=>e.subFull!==t.subFull?e.subFull-t.subFull:e.sub!==t.sub?e.sub-t.sub:e.edits!==t.edits?e.edits-t.edits:e.name.length-t.name.length));let o=s.map((e=>e.item));return i.hasOwnProperty("limitResults")&&o.length>i.limitResults&&(o=o.slice(0,i.limitResults)),o},Ge="pcui-select-input",Ye=Ge+"-container-value",Je=Ge+"-multi",Ze=Ge+"-disabled-value",Qe=Ge+"-has-disabled-value",$e=Ge+"-value",et=Ge+"-icon",tt=Ge+"-textinput",it=Ge+"-list",nt=Ge+"-tags",st=Ge+"-tags-empty",ot=Ge+"-tag",rt=Ge+"-tag-not-everywhere",lt=Ge+"-shadow",at=Ge+"-fit-height",ht="pcui-selected",dt=Ge+"-label-highlighted",ct=Ge+"-create-new",ut="pcui-open";class pt extends R{constructor(e={}){var t,i,n,s;const o=new F({dom:e.dom});super(Object.assign(Object.assign({},e),{dom:o.dom})),this._timeoutLabelValueTabIndex=null,this._valueToText={},this._valueToLabel={},this._labelToValue=new Map,this._labelHighlighted=null,this._disabledOptions={},this._prefix="",this._onInputChange=e=>{this._suspendInputChange||this._lastInputValue!==e&&(this.open(),this._lastInputValue=e,this._filterOptions(e))},this._onInputKeyDown=e=>{if("Enter"===e.key&&this.enabled&&!this.readOnly){let t;if(e.stopPropagation(),e.preventDefault(),t=this._labelHighlighted&&this._labelToValue.has(this._labelHighlighted)?this._labelToValue.get(this._labelHighlighted):this._input.value,void 0!==t)return this.focus(),this.close(),void(this._valueToText[t]?this._onSelectValue(t):this._allowCreate&&(this._createFn?this._createFn(t):this._onSelectValue(t)))}this._onKeyDown(e)},this._onWindowMouseDown=e=>{this.dom.contains(e.target)||this.close()},this._onKeyDown=e=>{if("Escape"!==e.key)if("Tab"!==e.key){if(this.enabled&&!this.readOnly)if("Enter"!==e.key||this._allowInput){if("ArrowUp"===e.key||"ArrowDown"===e.key)if(e.stopPropagation(),e.preventDefault(),(this._allowInput||this.multiSelect)&&this._containerOptions.hidden)this.open();else if(this._containerOptions.hidden){if(!this._options.length)return;let t=-1;for(let e=0;e<this._options.length;e++)if(this._options[e].v===this.value){t=e;break}"ArrowUp"===e.key?t--:"ArrowDown"===e.key&&t++,t>=0&&t<this._options.length&&this._onSelectValue(this._options[t].v)}else{if(!this._containerOptions.dom.childNodes.length)return;if(this._labelHighlighted){let t=this._labelHighlighted.dom;do{"ArrowUp"===e.key?t=t.previousSibling:"ArrowDown"===e.key&&(t=t.nextSibling)}while(t&&t.ui.hidden);t&&this._highlightLabel(t.ui)}else this._highlightLabel(this._containerOptions.dom.childNodes[0].ui)}}else this._labelHighlighted&&this._labelToValue.has(this._labelHighlighted)&&(this._onSelectValue(this._labelToValue.get(this._labelHighlighted)),this.close())}else this.close();else this.close()},this._onMouseDown=()=>{this._allowInput||this.focus()},this._onFocus=()=>{this.class.add(k),this.emit("focus"),this._input.hidden||this.open()},this._onBlur=()=>{this.class.remove(k),this.emit("blur")},this._onWheel=e=>{e.stopPropagation()},this._container=o,this._container.parent=this,this.class.add(Ge),this._containerValue=new F({class:Ye}),this._container.append(this._containerValue),this._domShadow=document.createElement("div"),this._domShadow.classList.add(lt),this._containerValue.append(this._domShadow),this._allowInput=e.allowInput,this._allowInput&&this.class.add("pcui-select-input-allow-input"),this._allowCreate=e.allowCreate,this._createFn=e.createFn,this._createLabelText=e.createLabelText,this._labelValue=new j({class:$e,tabIndex:0}),this._labelValue.on("click",(()=>{this.enabled&&!this.readOnly&&this.toggle()})),this._containerValue.append(this._labelValue),this._labelIcon=new j({class:et,hidden:e.allowInput&&e.multiSelect}),this._containerValue.append(this._labelIcon),this._input=new Ve({class:tt,blurOnEnter:!1,keyChange:!0}),this._containerValue.append(this._input),this._lastInputValue="",this._suspendInputChange=!1,this._input.on("change",this._onInputChange),this._input.on("keydown",this._onInputKeyDown),this._input.on("focus",this._onFocus),this._input.on("blur",this._onBlur),e.placeholder&&(this.placeholder=e.placeholder),this._containerOptions=new F({class:it,hidden:!0}),this._containerValue.append(this._containerOptions),this._containerTags=new F({class:nt,flex:!0,flexDirection:"row",hidden:!0}),this._container.append(this._containerTags),e.multiSelect&&(this.class.add(Je),this._containerTags.hidden=!1),this._labelValue.dom.addEventListener("keydown",this._onKeyDown),this._labelValue.dom.addEventListener("focus",this._onFocus),this._labelValue.dom.addEventListener("blur",this._onBlur),this._labelValue.dom.addEventListener("mousedown",this._onMouseDown),this._containerOptions.dom.addEventListener("wheel",this._onWheel,{passive:!0}),this.on("hide",(()=>{this.close()})),this._type=null!==(t=e.type)&&void 0!==t?t:"string",this.invalidOptions=null!==(i=e.invalidOptions)&&void 0!==i?i:[],this.options=null!==(n=e.options)&&void 0!==n?n:[],this._optionsFn=e.optionsFn,this._allowNull=e.allowNull,this._values=null,void 0!==e.value?this.value=e.value:e.defaultValue?this.value=e.defaultValue:this.value=null,this._renderChanges=e.renderChanges,this.on("change",(()=>{this._updateInputFieldsVisibility(),this.renderChanges&&!this.multiSelect&&this._labelValue.flash()})),this._updateInputFieldsVisibility(!1),this._onSelect=e.onSelect,this.fallbackOrder=e.fallbackOrder,this.disabledOptions=e.disabledOptions,this._prefix=null!==(s=e.prefix)&&void 0!==s?s:""}destroy(){this._destroyed||(this._labelValue.dom.removeEventListener("keydown",this._onKeyDown),this._labelValue.dom.removeEventListener("mousedown",this._onMouseDown),this._labelValue.dom.removeEventListener("focus",this._onFocus),this._labelValue.dom.removeEventListener("blur",this._onBlur),this._containerOptions.dom.removeEventListener("wheel",this._onWheel),window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("mousedown",this._onWindowMouseDown),this._timeoutLabelValueTabIndex&&(cancelAnimationFrame(this._timeoutLabelValueTabIndex),this._timeoutLabelValueTabIndex=null),super.destroy())}_initializeCreateLabel(){const e=new F({class:ct,flex:!0,flexDirection:"row"}),t=new j({text:this._input.value,tabIndex:-1});e.append(t);let i=this._input.on("change",(i=>{t.destroyed||(t.text=i,this.invalidOptions&&-1!==this.invalidOptions.indexOf(i)?e.hidden||(e.hidden=!0,this._resizeShadow()):e.hidden&&(e.hidden=!1,this._resizeShadow()))}));e.on("click",(e=>{e.stopPropagation();const i=t.text;this.focus(),this.close(),this._createFn?this._createFn(i):i&&this._onSelectValue(i)})),t.on("destroy",(()=>{i.unbind(),i=null}));const n=new j({text:this._createLabelText});return e.append(n),this._containerOptions.append(e),e}_convertSingleValue(e){if(null===e&&this._allowNull)return e;if("string"===this._type)e=e?e.toString():"";else if("number"===this._type)e=e?parseInt(e,10):0;else if("boolean"===this._type)return!!e;return e}_convertValue(e){return null===e&&this._allowNull?e:this.multiSelect?Array.isArray(e)?e.map((e=>this._convertSingleValue(e))):e:this._convertSingleValue(e)}_onSelectValue(e){if(e=this._convertSingleValue(e),this.multiSelect)if(this._values){let t=!1;this._values.forEach((i=>{i?-1===i.indexOf(e)&&(i.push(e),t=!0):(i=[e],t=!0)})),t&&(this._onMultipleValuesChange(this._values),this.emit("change",this.value),this._binding&&this._binding.addValues([e]))}else this._value&&Array.isArray(this._value)?-1===this._value.indexOf(e)&&(this._value.push(e),this._addTag(e),this.emit("change",this.value),this._binding&&this._binding.addValues([e])):this.value=[e];else this.value=e}_highlightLabel(e){if(this._labelHighlighted!==e&&(this._labelHighlighted&&this._labelHighlighted.class.remove(dt),this._labelHighlighted=e,this._labelHighlighted)){this._labelHighlighted.class.add(dt);const e=this._labelHighlighted.dom.offsetTop,t=this._containerOptions.dom.scrollTop;e<t?this._containerOptions.dom.scrollTop=e:e+this._labelHighlighted.height>this._containerOptions.height+t&&(this._containerOptions.dom.scrollTop=e+this._labelHighlighted.height-this._containerOptions.height)}}_onValueChange(e){if(this.multiSelect){if(this._labelValue.value="",this._containerTags.clear(),this._containerTags.class.add(st),e&&Array.isArray(e)){for(const t of e){this._addTag(t);const e=this._valueToLabel[t];e&&e.class.add(ht)}for(const t in this._valueToLabel){const i=this._valueToLabel[t];-1!==e.indexOf(this._convertSingleValue(t))?i.class.add(ht):i.class.remove(ht)}}}else{this._labelValue.value=this._prefix+(this._valueToText[e]||""),e=""+e;for(const t in this._valueToLabel){const i=this._valueToLabel[t];t===e?i.class.add(ht):i.class.remove(ht)}}}_onMultipleValuesChange(e){this._labelValue.value="",this._containerTags.clear(),this._containerTags.class.add(st);const t={},i={};e.forEach((e=>{e&&e.forEach((e=>{t[e]?i[e]++:(t[e]=this._addTag(e),i[e]=1)}))}));for(const n in i)if(i[n]!==e.length){t[n].class.add(rt);const e=this._valueToLabel[n];e&&e.class.remove(ht)}}_addTag(e){const t=new F({flex:!0,flexDirection:"row",class:ot});t.append(new j({text:this._valueToText[e]||e}));const i=new W({size:"small",icon:"E132",tabIndex:-1});t.append(i),i.on("click",(()=>this._removeTag(t,e))),this._containerTags.append(t),this._containerTags.class.remove(st);const n=this._valueToLabel[e];return n&&n.class.add(ht),t.value=e,t}_removeTag(e,t){e.destroy();const i=this._valueToLabel[t];if(i&&i.class.remove(ht),this._values)this._values.forEach((e=>{if(!e)return;const i=e.indexOf(t);-1!==i&&e.splice(i,1)}));else if(this._value&&Array.isArray(this._value)){const e=this._value.indexOf(t);-1!==e&&this._value.splice(e,1)}this.emit("change",this.value),this._binding&&this._binding.removeValues([t])}_filterOptions(e){const t=this._containerOptions.dom;for(;t.firstChild;)t.removeChild(t.lastChild);if(e){const i=this.options.map((e=>[e.t,e.v]));Xe(i,e).forEach((e=>{const i=this._valueToLabel[e];t.appendChild(i.dom)}))}else for(const e of this._options){const i=this._valueToLabel[e.v];t.appendChild(i.dom)}this._createLabelContainer&&t.appendChild(this._createLabelContainer.dom),t.firstChild&&this._highlightLabel(t.firstChild.ui),this._resizeShadow()}_resizeShadow(){this._domShadow.style.height=this._containerValue.height+this._containerOptions.height+"px"}_updateInputFieldsVisibility(e){let t=!1,i=!1;this._allowInput&&(e?(t=!0,i=!0):t=this.multiSelect||!this._valueToLabel[this.value]),this._labelValue.hidden=t,this._labelIcon.hidden=t,this._input.hidden=!t,i&&this._input.focus(),this._labelValue.hidden||(this._labelValue.tabIndex=-1,this._timeoutLabelValueTabIndex||(this._timeoutLabelValueTabIndex=requestAnimationFrame((()=>{this._timeoutLabelValueTabIndex=null,this._labelValue.tabIndex=0}))))}focus(){this._input.hidden?this._labelValue.dom.focus():this._input.focus()}blur(){this._allowInput?this._input.blur():this._labelValue.dom.blur()}open(){if(!this._containerOptions.hidden||!this.enabled||this.readOnly)return;if(this._updateInputFieldsVisibility(!0),this._optionsFn&&(this.options=this._optionsFn()),0===this._containerOptions.dom.childNodes.length)return;this._containerOptions.forEachChild((e=>{e.hidden=!1,this._labelToValue.get(e)===this.value&&this._highlightLabel(e)})),this._labelHighlighted||this._highlightLabel(this._containerOptions.dom.childNodes[0].ui),this._containerOptions.hidden=!1,this.class.add(ut),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("mousedown",this._onWindowMouseDown);const e=(this._allowInput?this._input.dom:this._labelValue.dom).getBoundingClientRect();let t=e.bottom+this._containerOptions.height+25>=window.innerHeight;t&&e.top-this._containerOptions.height<0&&(t=!1,this._containerOptions.style.maxHeight=window.innerHeight-e.bottom-25+"px"),t?this.class.add(at):this.class.remove(at),this._resizeShadow()}close(){this._containerOptions.style.maxHeight="",this._highlightLabel(null),this._updateInputFieldsVisibility(!1),this._suspendInputChange=!0,this._input.value="",this._lastInputValue&&(this._lastInputValue="",this._filterOptions(null)),this._suspendInputChange=!1,this._containerOptions.hidden||(this._containerOptions.hidden=!0,this._domShadow.style.height="",this.class.remove(ut),window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("mousedown",this._onWindowMouseDown))}toggle(){this._containerOptions.hidden?this.open():this.close()}unlink(){super.unlink(),this._containerOptions.hidden||this.close()}_updateValue(e){e!==this._value&&(this._value=e,this._onValueChange(e),this._suppressChange||this.emit("change",e),this._binding&&this._binding.setValue(e))}_updateDisabledValue(e){const t={};this._containerOptions.forEachChild((e=>{t[e.dom.id]=e,this._disabledOptions[e.dom.id]?(e.enabled=!1,e.text=this._disabledOptions[e.dom.id]):(e.enabled=!0,e.text=this._valueToText[e.dom.id]),e.class.remove(Ze)}));const i=this._disabledOptions[e]?e:null;let n=null;if(i){if(this._fallbackOrder)for(let t=0;t<this._fallbackOrder.length;t++)if(this._fallbackOrder[t]!==e){n=this._fallbackOrder[t];break}this.disabledValue=i,t[i].class.add(Ze)}else this._disabledValue?(n=this._disabledValue,this.disabledValue=null):(n=e,this.disabledValue=null);return n}set options(e){if(!this._options||JSON.stringify(this._options)!==JSON.stringify(e)){this._containerOptions.clear(),this._labelHighlighted=null,this._valueToText={},this._valueToLabel={},this._options=e;for(const e of this._options){if(this._valueToText[e.v]=e.t,""===e.v)return;const t=new j({text:e.t,tabIndex:-1,id:e.v});this._labelToValue.set(t,e.v),this._valueToLabel[e.v]=t,t.on("click",(t=>{t.stopPropagation(),this._onSelectValue(e.v),this.close(),this._onSelect&&this._onSelect(this.value)})),this._containerOptions.append(t)}this._createLabelContainer=null,this._createLabelText&&(this._createLabelContainer=this._initializeCreateLabel()),this.multiSelect&&this._values?this._onMultipleValuesChange(this._values):this._onValueChange(this.value),this._lastInputValue&&this._filterOptions(this._lastInputValue)}}get options(){return this._options.slice()}set invalidOptions(e){this._invalidOptions=e||null}get invalidOptions(){return this._invalidOptions}set disabledValue(e){this._disabledValue=e,null!==this._disabledValue?this.class.add(Qe):this.class.remove(Qe)}set disabledOptions(e){if(JSON.stringify(this._disabledOptions)===JSON.stringify(e))return;this._disabledOptions=e||{};const t=this._updateDisabledValue(this._value);this._updateValue(t)}set fallbackOrder(e){this._fallbackOrder=e||null}get multiSelect(){return this.class.contains(Je)}set value(e){this._values=null,this._suspendInputChange=!0,this._input.value="",this._lastInputValue&&(this._lastInputValue="",this._filterOptions(null)),this._suspendInputChange=!1,this.class.remove(A),e=this._convertValue(e),(!(this._value===e||this.multiSelect&&this._value&&this._value.equals(e))||null===e&&this._allowNull&&this.class.contains(A))&&(this.disabledValue=null,this._updateValue(e))}get value(){if(!this.multiSelect)return this._value;const e=[];return this._containerTags.dom.childNodes.forEach((t=>{e.push(t.ui.value)})),e}set values(e){e=e.map((e=>this._convertValue(e)));let t=!1;const i=e[0],n=this.multiSelect;this._values=null;for(let s=1;s<e.length;s++)if(!(e[s]===i||n&&e[s]&&e[s].equals(i))){t=!0;break}t?(this._labelValue.values=e,n?(this._values=e,this._value=null,this._onMultipleValuesChange(this._values),this.emit("change",this.value)):null!==this._value&&(this._value=null,this.emit("change",null)),this.class.add(A)):this.value=e[0]}set placeholder(e){this._input.placeholder=e}get placeholder(){return this._input.placeholder}set renderChanges(e){this._renderChanges=e}get renderChanges(){return this._renderChanges}}R.register("select",pt,{renderChanges:!0}),R.register("multiselect",pt,{multiSelect:!0,renderChanges:!0}),R.register("tags",pt,{allowInput:!0,allowCreate:!0,multiSelect:!0,renderChanges:!0});var gt=pt;const _t={DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,clamp:function(e,t,i){return e>=i?i:e<=t?t:e},intToBytes24:function(e){return[e>>16&255,e>>8&255,255&e]},intToBytes32:function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},bytesToInt24:function(e,t,i){return e.length&&(i=e[2],t=e[1],e=e[0]),e<<16|t<<8|i},bytesToInt32:function(e,t,i,n){return e.length&&(n=e[3],i=e[2],t=e[1],e=e[0]),(e<<24|t<<16|i<<8|n)>>>0},lerp:function(e,t,i){return e+(t-e)*_t.clamp(i,0,1)},lerpAngle:function(e,t,i){return t-e>180&&(t-=360),t-e<-180&&(t+=360),_t.lerp(e,t,_t.clamp(i,0,1))},powerOfTwo:function(e){return 0!==e&&!(e&e-1)},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},nearestPowerOfTwo:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.log(2)))},random:function(e,t){const i=t-e;return Math.random()*i+e},smoothstep:function(e,t,i){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*(3-2*i)},smootherstep:function(e,t,i){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*i*(i*(6*i-15)+10)},roundUp:function(e,t){return 0===t?e:Math.ceil(e/t)*t},between:function(e,t,i,n){const s=Math.min(t,i),o=Math.max(t,i);return n?e>=s&&e<=o:e>s&&e<o}},mt=function(){const e={},t=["Array","Object","Function","Date","RegExp","Float32Array"];for(let i=0;i<t.length;i++)e["[object "+t[i]+"]"]=t[i].toLowerCase();return e}();function ft(e){if(null===e)return"null";const t=typeof e;return"undefined"===t||"number"===t||"string"===t||"boolean"===t?t:mt[Object.prototype.toString.call(e)]}function vt(e,t){for(const i in t){const n=t[i];"object"===ft(n)?e[i]=vt({},n):"array"===ft(n)?e[i]=vt([],n):e[i]=n}return e}class bt{constructor(e,t=0){this._curve=void 0,this._left=-1/0,this._right=1/0,this._recip=0,this._p0=0,this._p1=0,this._m0=0,this._m1=0,this._curve=e,this._reset(t)}evaluate(e,t=!1){let i;(t||e<this._left||e>=this._right)&&this._reset(e);const n=this._curve.type;if(5===n)i=this._p0;else{const t=0===this._recip?0:(e-this._left)*this._recip;i=0===n?_t.lerp(this._p0,this._p1,t):1===n?_t.lerp(this._p0,this._p1,t*t*(3-2*t)):this._evaluateHermite(this._p0,this._p1,this._m0,this._m1,t)}return i}_reset(e){const t=this._curve.keys,i=t.length;if(i)if(e<t[0][0])this._left=-1/0,this._right=t[0][0],this._recip=0,this._p0=this._p1=t[0][1],this._m0=this._m1=0;else if(e>=t[i-1][0])this._left=t[i-1][0],this._right=1/0,this._recip=0,this._p0=this._p1=t[i-1][1],this._m0=this._m1=0;else{let i=0;for(;e>=t[i+1][0];)i++;this._left=t[i][0],this._right=t[i+1][0];const n=1/(this._right-this._left);this._recip=isFinite(n)?n:0,this._p0=t[i][1],this._p1=t[i+1][1],this._isHermite()&&this._calcTangents(t,i)}else this._left=-1/0,this._right=1/0,this._recip=0,this._p0=this._p1=this._m0=this._m1=0}_isHermite(){return 2===this._curve.type||3===this._curve.type||4===this._curve.type}_calcTangents(e,t){let i;const n=e[t],s=e[t+1];let o;if(i=0===t?[e[0][0]+(e[0][0]-e[1][0]),e[0][1]+(e[0][1]-e[1][1])]:e[t-1],o=t===e.length-2?[e[t+1][0]+(e[t+1][0]-e[t][0]),e[t+1][1]+(e[t+1][1]-e[t][1])]:e[t+2],4===this._curve.type){const e=2*(s[0]-n[0])/(s[0]-i[0]),t=2*(s[0]-n[0])/(o[0]-n[0]);this._m0=this._curve.tension*(isFinite(e)?e:0)*(s[1]-i[1]),this._m1=this._curve.tension*(isFinite(t)?t:0)*(o[1]-n[1])}else{const e=(s[0]-n[0])/(n[0]-i[0]),t=(s[0]-n[0])/(o[0]-s[0]),r=n[1]+(i[1]-n[1])*(isFinite(e)?e:0),l=s[1]+(o[1]-s[1])*(isFinite(t)?t:0),a=2===this._curve.type?.5:this._curve.tension;this._m0=a*(s[1]-r),this._m1=a*(l-n[1])}}_evaluateHermite(e,t,i,n,s){const o=s*s,r=s+s,l=1-s,a=l*l;return e*((1+r)*a)+i*(s*a)+t*(o*(3-r))+n*(o*(s-1))}}class yt{constructor(e){if(this.keys=[],this.type=1,this.tension=.5,this._eval=new bt(this),e)for(let t=0;t<e.length-1;t+=2)this.keys.push([e[t],e[t+1]]);this.sort()}get length(){return this.keys.length}add(e,t){const i=this.keys,n=i.length;let s=0;for(;s<n&&!(i[s][0]>e);s++);const o=[e,t];return this.keys.splice(s,0,o),o}get(e){return this.keys[e]}sort(){this.keys.sort((function(e,t){return e[0]-t[0]}))}value(e){return this._eval.evaluate(e,!0)}closest(e){const t=this.keys,i=t.length;let n=2,s=null;for(let o=0;o<i;o++){const i=Math.abs(e-t[o][0]);if(!(n>=i))break;n=i,s=t[o]}return s}clone(){const e=new this.constructor;return e.keys=vt(e.keys,this.keys),e.type=this.type,e.tension=this.tension,e}quantize(e){e=Math.max(e,2);const t=new Float32Array(e),i=1/(e-1);t[0]=this._eval.evaluate(0,!0);for(let n=1;n<e;n++)t[n]=this._eval.evaluate(i*n);return t}quantizeClamped(e,t,i){const n=this.quantize(e);for(let e=0;e<n.length;++e)n[e]=Math.min(i,Math.max(t,n[e]));return n}}class wt{constructor(){if(this.curves=[],this._type=1,arguments.length>1)for(let e=0;e<arguments.length;e++)this.curves.push(new yt(arguments[e]));else if(0===arguments.length)this.curves.push(new yt);else{const e=arguments[0];if("number"==typeof e)for(let t=0;t<e;t++)this.curves.push(new yt);else for(let t=0;t<e.length;t++)this.curves.push(new yt(e[t]))}}get length(){return this.curves.length}set type(e){this._type=e;for(let t=0;t<this.curves.length;t++)this.curves[t].type=e}get type(){return this._type}get(e){return this.curves[e]}value(e,t=[]){const i=this.curves.length;t.length=i;for(let n=0;n<i;n++)t[n]=this.curves[n].value(e);return t}clone(){const e=new this.constructor;e.curves=[];for(let t=0;t<this.curves.length;t++)e.curves.push(this.curves[t].clone());return e._type=this._type,e}quantize(e){e=Math.max(e,2);const t=this.curves.length,i=new Float32Array(e*t),n=1/(e-1);for(let s=0;s<t;s++){const o=new bt(this.curves[s]);for(let r=0;r<e;r++)i[r*t+s]=o.evaluate(n*r)}return i}quantizeClamped(e,t,i){const n=this.quantize(e);for(let e=0;e<n.length;++e)n[e]=Math.min(i,Math.max(t,n[e]));return n}}const xt="pcui-multiple-values",Ct=/keys/,kt=/type/;class At extends R{constructor(e={}){var t;super(e),this._onKeyDown=e=>{"Escape"===e.key&&this.blur(),"Enter"!==e.key||!this.enabled||this.readOnly||this.class.contains(xt)||(e.stopPropagation(),e.preventDefault(),this._openGradientPicker())},this._onFocus=e=>{this.emit("focus")},this._onBlur=e=>{this.emit("blur")},this._onAnchorsMouseDown=e=>{if(-1===this.STATE.hoveredAnchor){const t=this.calcNormalizedCoord(e.clientX,e.clientY,this.getClientRect(this.UI.anchors.dom));this.insertAnchor(t[0],this.evaluateGradient(t[0])),this.STATE.anchors=this.calcAnchorTimes(),this.selectAnchor(this.STATE.anchors.indexOf(t[0]))}else this.STATE.hoveredAnchor!==this.STATE.selectedAnchor&&this.selectAnchor(this.STATE.hoveredAnchor);this.UI.anchors.dom.style.cursor="grabbing",this.UI.anchorAddCrossHair.style.visibility="hidden",this.dragStart(),this.UI.draggingAnchor=!0},this._onAnchorsMouseMove=e=>{const t=this.calcNormalizedCoord(e.clientX,e.clientY,this.getClientRect(this.UI.anchors.dom));if(this.UI.draggingAnchor)this.dragUpdate(_t.clamp(t[0],0,1)),this.UI.anchorAddCrossHair.style.visibility="hidden";else if(t[0]>=0&&t[0]<=1&&t[1]>=0&&t[1]<=1){let e=-1,i=0;for(let n=0;n<this.STATE.anchors.length;++n){const s=Math.abs(this.STATE.anchors[n]-t[0]);(-1===e||s<i)&&(e=n,i=s)}const n=-1!==e&&i<.02?e:-1;n!==this.STATE.hoveredAnchor&&(this.selectHovered(n),this.render()),-1===n?(this.UI.anchorAddCrossHair.style.visibility="visible",this.UI.anchors.dom.style.cursor="none"):this.UI.anchorAddCrossHair.style.visibility="hidden",this.UI.showCrosshairPosition.innerText=Math.round(100*t[0]).toString(),this.UI.anchorAddCrossHair.style.left=(2.5+320*t[0]).toString()+"px"}else-1!==this.STATE.hoveredAnchor?(this.UI.anchorAddCrossHair.style.visibility="hidden",this.selectHovered(-1),this.render()):this.UI.anchorAddCrossHair.style.visibility="hidden"},this._onAnchorsMouseUp=e=>{this.UI.draggingAnchor&&(this.dragEnd(),this.UI.draggingAnchor=!1),this.UI.anchors.dom.style.cursor="pointer"},this.class.add("pcui-gradient"),this._canvas=new Ce({useDevicePixelRatio:!0}),this.dom.appendChild(this._canvas.dom),this._canvas.parent=this,this._canvas.on("resize",(()=>{this._renderGradient()}));const i=this._canvas.dom;function n(e,t){return function(i){t.apply(e,[i])}}function s(e){const t=new ae({precision:1,step:1,min:0,max:255});return t.renderChanges=!1,t.placeholder=e,t.on("change",this.fieldChangeHandler),this._fields.appendChild(t.dom),t}this._checkerboardPattern=this._createCheckerboardPattern(i.getContext("2d")),this._resizeInterval=window.setInterval((()=>{this._canvas.resize(this.width,this.height)}),50),this.dom.addEventListener("keydown",this._onKeyDown),this.dom.addEventListener("focus",this._onFocus),this.dom.addEventListener("blur",this._onBlur),this.on("click",(()=>{!this.enabled||this.readOnly||this.class.contains(xt)||this._openGradientPicker()})),this.renderChanges=null===(t=e.renderChanges)||void 0===t||t,this.on("change",(()=>{this.renderChanges&&this.flash()})),this.Helpers={rgbaStr:function(e,t){t||(t=1);let i=e.map((function(e,i){return i<3?Math.round(e*t):e})).join(",");for(let n=e.length;n<4;++n)i+=","+(n<3?t:1);return"rgba("+i+")"},hexStr:function(e){return e.map((function(e){return("00"+e.toString(16)).slice(-2).toUpperCase()})).join("")},toHsva:function(e){const t=Pe(e.map((function(e){return 255*e})));return t.push(e.length>3?e[3]:1),t},toRgba:function(e){const t=Le(e).map((function(e){return e/255}));return t.push(e.length>3?e[3]:1),t},normalizedCoord:function(e,t,i){const n=e.dom.getBoundingClientRect();return[(t-n.left)/n.width,(i-n.top)/n.height]}},this._panel=new ee,this._panel.class.add("color-panel"),this.dom.appendChild(this._panel.dom),this._colorRect=new Ce({useDevicePixelRatio:!0}),this._colorRect.class.add("color-rect"),this._panel.append(this._colorRect.dom),this._colorRect.resize(140,140),this._colorHandle=document.createElement("div"),this._colorHandle.classList.add("color-handle"),this._panel.append(this._colorHandle),this._hueRect=new Ce({useDevicePixelRatio:!0}),this._hueRect.class.add("hue-rect"),this._panel.append(this._hueRect.dom),this._hueRect.resize(20,140),this._hueHandle=document.createElement("div"),this._hueHandle.classList.add("hue-handle"),this._panel.append(this._hueHandle),this._alphaRect=new Ce({useDevicePixelRatio:!0}),this._alphaRect.class.add("alpha-rect"),this._panel.append(this._alphaRect.dom),this._alphaRect.resize(20,140),this._alphaHandle=document.createElement("div"),this._alphaHandle.classList.add("alpha-handle"),this._panel.append(this._alphaHandle),this._fields=document.createElement("div"),this._fields.classList.add("fields"),this._panel.append(this._fields),this.fieldChangeHandler=n(this,this._onFieldChanged),this.hexChangeHandler=n(this,this._onHexChanged),this.downHandler=n(this,this._onMouseDown),this.moveHandler=n(this,this._onMouseMove),this.upHandler=n(this,this._onMouseUp),this._rField=s.call(this,"r"),this._gField=s.call(this,"g"),this._bField=s.call(this,"b"),this._aField=s.call(this,"a"),this._hexField=new Ve,this._hexField.renderChanges=!1,this._hexField.placeholder="#",this._hexField.on("change",this.hexChangeHandler),this._fields.appendChild(this._hexField.dom),this._colorRect.dom.addEventListener("mousedown",this.downHandler),this._hueRect.dom.addEventListener("mousedown",this.downHandler),this._alphaRect.dom.addEventListener("mousedown",this.downHandler),this._generateHue(this._hueRect),this._generateAlpha(this._alphaRect),this._hsva=[-1,-1,-1,1],this._storeHsva=[0,0,0,1],this._dragMode=0,this._changing=!1,this.CONSTANTS={bg:"#2c393c",anchorRadius:5,selectedRadius:7},this.UI={root:this.dom,overlay:new Re,panel:document.createElement("div"),gradient:new Ce({useDevicePixelRatio:!0}),checkerPattern:this.createCheckerPattern(),anchors:new Ce({useDevicePixelRatio:!0}),footer:new ee,typeLabel:new j({text:"Type"}),typeCombo:new gt({options:[{t:"0",v:"placeholder"}],type:"number"}),positionLabel:new j({text:"Position"}),positionEdit:new ae({min:0,max:100,step:1}),copyButton:new W,pasteButton:new W,deleteButton:new W,showSelectedPosition:new ae({min:0,max:100,step:1,hideSlider:!0}),showCrosshairPosition:document.createElement("div"),anchorAddCrossHair:document.createElement("div"),colorPicker:null},this.STATE={curves:[],keystore:[],anchors:[],hoveredAnchor:-1,selectedAnchor:-1,selectedValue:[],changing:!1,draggingAnchor:!1,typeMap:{}},this.UI.root.appendChild(this.UI.overlay.dom),this.UI.overlay.class.add("picker-gradient"),this.UI.overlay.center=!1,this.UI.overlay.transparent=!0,this.UI.overlay.hidden=!0,this.UI.overlay.clickable=!0,this.UI.overlay.dom.style.position="fixed",this.UI.overlay.on("show",(()=>{this.onOpen()})),this.UI.overlay.on("hide",(()=>{this.onClose()})),this.UI.panel.classList.add("picker-gradient-panel"),this.UI.overlay.append(this.UI.panel),this.UI.panel.appendChild(this.UI.gradient.dom),this.UI.gradient.class.add("picker-gradient-gradient"),this.UI.gradient.resize(320,28),this.UI.panel.appendChild(this.UI.anchors.dom),this.UI.anchors.class.add("picker-gradient-anchors"),this.UI.anchors.resize(320,28),this.UI.panel.appendChild(this.UI.footer.dom),this.UI.footer.append(this.UI.typeLabel),this.UI.footer.class.add("picker-gradient-footer"),this.UI.footer.append(this.UI.typeCombo),this.UI.typeCombo.value=-1,this.UI.typeCombo.on("change",(e=>{this._onTypeChanged(e)})),this.UI.positionEdit.style.width="40px",this.UI.positionEdit.renderChanges=!1,this.UI.showSelectedPosition.on("change",(e=>{this.STATE.changing||this.moveSelectedAnchor(e/100)})),this.UI.copyButton.on("click",(()=>{this.doCopy()})),this.UI.copyButton.class.add("copy-curve-button"),this.UI.footer.append(this.UI.copyButton),this.UI.pasteButton.on("click",(()=>{this.doPaste()})),this.UI.pasteButton.class.add("paste-curve-button"),this.UI.footer.append(this.UI.pasteButton),this.UI.deleteButton.on("click",(()=>{this.doDelete()})),this.UI.deleteButton.class.add("delete-curve-button"),this.UI.footer.append(this.UI.deleteButton),this.UI.panel.appendChild(this._panel.dom),this.UI.panel.append(this.UI.showSelectedPosition.dom),this.UI.showSelectedPosition.class.add("show-selected-position"),this.UI.showSelectedPosition._domInput.classList.add("show-selected-position-input");const o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("fill-rule","evenodd"),o.setAttribute("clip-rule","evenodd"),o.setAttribute("d","M8.5 17C7.35596 17 6.26043 16.7741 5.2134 16.3222C4.16637 15.8703 3.26152 15.2629 2.49882 14.4997C1.73612 13.7366 1.12899 12.8312 0.677391 11.7835C0.225795 10.7359 0 9.6397 0 8.49498C0 7.35026 0.225795 6.25409 0.677391 5.20644C1.12899 4.15879 1.73612 3.25507 2.49882 2.49527C3.26152 1.73548 4.16637 1.12965 5.2134 0.677791C6.26043 0.225928 7.35596 0 8.5 0C9.64404 0 10.7396 0.225928 11.7866 0.677791C12.8336 1.12965 13.7385 1.73548 14.5012 2.49527C15.2639 3.25507 15.871 4.15879 16.3226 5.20644C16.7742 6.25409 17 7.35026 17 8.49498C17 9.6397 16.7742 10.7359 16.3226 11.7835C15.871 12.8312 15.2639 13.7366 14.5012 14.4997C13.7385 15.2629 12.8336 15.8703 11.7866 16.3222C10.7396 16.7741 9.64404 17 8.5 17ZM8.5 2.2593C7.64364 2.2593 6.82576 2.42498 6.04634 2.75635C5.26692 3.08772 4.59622 3.53288 4.03424 4.09185C3.47225 4.65082 3.02568 5.31354 2.69451 6.08004C2.36334 6.84653 2.19776 7.6515 2.19776 8.49498C2.19776 9.6397 2.47875 10.6957 3.04073 11.663C3.60272 12.6303 4.36707 13.3952 5.33383 13.9575C6.30058 14.5198 7.35596 14.8009 8.5 14.8009C9.34298 14.8009 10.1475 14.6353 10.9135 14.3039C11.6796 13.9725 12.3419 13.5257 12.9005 12.9634C13.4592 12.4011 13.9041 11.73 14.2352 10.9501C14.5664 10.1702 14.732 9.35184 14.732 8.49498C14.732 7.6515 14.5664 6.84653 14.2352 6.08004C13.9041 5.31354 13.4592 4.65082 12.9005 4.09185C12.3419 3.53288 11.6796 3.08772 10.9135 2.75635C10.1475 2.42498 9.34298 2.2593 8.5 2.2593ZM9.52361 9.73007V12.9533H7.40614V9.73007H4.11452V7.61134H7.40614V4.31778H9.52361V7.61134H12.745V9.73007H9.52361Z"),o.setAttribute("fill","#FF6600");const r=document.createElementNS("http://www.w3.org/2000/svg","svg"),l=document.createElement("div");r.appendChild(o),r.setAttribute("width","17"),r.setAttribute("height","17"),r.setAttribute("viewBox","0 0 17 17"),this.UI.showCrosshairPosition.classList.add("show-crosshair-position"),l.classList.add("crosshair-bar"),this.UI.anchorAddCrossHair.appendChild(r),this.UI.anchorAddCrossHair.appendChild(l),this.UI.anchorAddCrossHair.appendChild(this.UI.showCrosshairPosition),this.UI.anchorAddCrossHair.classList.add("anchor-crosshair"),this.UI.anchorAddCrossHair.style.visibility="hidden",this.UI.panel.append(this.UI.anchorAddCrossHair),this.on("changing",(function(e){this.colorSelectedAnchor(e,!0)})),this._copiedData=null,this._channels=e.channels||3,this._value=this._getDefaultValue(),e.value&&(this.value=e.value)}destroy(){this._destroyed||(this.dom.removeEventListener("keydown",this._onKeyDown),this.dom.removeEventListener("focus",this._onFocus),this.dom.removeEventListener("blur",this._onBlur),window.clearInterval(this._resizeInterval),super.destroy())}_createCheckerboardPattern(e){const t=document.createElement("canvas"),i=12;t.width=24,t.height=24;const n=t.getContext("2d");return n.fillStyle="#",n.fillStyle="#949a9c",n.fillRect(0,0,i,i),n.fillRect(i,i,i,i),n.fillStyle="#657375",n.fillRect(i,0,i,i),n.fillRect(0,i,i,i),e.createPattern(t,"repeat")}_getDefaultValue(){return{type:4,keys:new Array(this._channels).fill([0,0]),betweenCurves:!1}}_openGradientPicker(){this.callOpenGradientPicker([this.value||this._getDefaultValue()]);const e=this.getGradientPickerRect(),t=this.dom.getBoundingClientRect();this.positionGradientPicker(t.right-e.width,t.bottom),this._evtPickerChanged=this.on("picker:curve:change",this._onPickerChange.bind(this)),this._evtRefreshPicker=this.on("change",(()=>this.setGradientPicker([this.value])))}_onPickerChange(e,t){const i=this.value||this._getDefaultValue();Ct.test(e[0])?this.value={type:i.type,keys:t,betweenCurves:!1}:kt.test(e[0])&&(this.value={type:t[0],keys:i.keys,betweenCurves:!1})}_renderGradient(){const e=this._canvas.dom.getContext("2d"),t=this._canvas.width,i=this._canvas.height,n=this._canvas.pixelRatio;if(e.setTransform(n,0,0,n,0,0),e.fillStyle=this._checkerboardPattern,e.fillRect(0,0,t,i),!this.value||!this.value.keys||!this.value.keys.length)return;const s=[],o=1===this.channels?new wt([this.value.keys]):new wt(this.value.keys);o.type=this.value.type;const r=e.createLinearGradient(0,0,t,0);for(let e=2;e<t;e+=2){o.value(e/t,s);const i=Math.round(255*(s[0]||0)),n=Math.round(255*(s[1]||0)),l=Math.round(255*(s[2]||0)),a=4===this.channels?s[3]||0:1;r.addColorStop(e/t,`rgba(${i}, ${n}, ${l}, ${a})`)}e.fillStyle=r,e.fillRect(0,0,t,i)}focus(){this.dom.focus()}blur(){this.dom.blur()}set channels(e){this._channels!==e&&(this._channels=Math.max(1,Math.min(e,4)),this.value&&this._renderGradient())}get channels(){return this._channels}set value(e){this._value=e,this.class.remove(xt),this._renderGradient(),this.emit("change",e),this.setValue([e])}get value(){return this._value}set values(e){this.class.add(xt),this._renderGradient()}_generateHue(e){const t=e.dom.getContext("2d"),i=e.pixelWidth,n=e.pixelHeight,s=t.createLinearGradient(0,0,0,n);for(let e=0;e<=6;e+=1)s.addColorStop(e/6,this.Helpers.rgbaStr(Le([e/6,1,1])));t.fillStyle=s,t.fillRect(0,0,i,n)}_generateAlpha(e){const t=e.dom.getContext("2d"),i=e.pixelWidth,n=e.pixelHeight,s=t.createLinearGradient(0,0,0,n);s.addColorStop(0,"rgb(255, 255, 255)"),s.addColorStop(1,"rgb(0, 0, 0)"),t.fillStyle=s,t.fillRect(0,0,i,n)}_generateGradient(e,t){const i=e.dom.getContext("2d"),n=e.pixelWidth,s=e.pixelHeight;let o=i.createLinearGradient(0,0,n,0);o.addColorStop(0,this.Helpers.rgbaStr([255,255,255,255])),o.addColorStop(1,this.Helpers.rgbaStr([t[0],t[1],t[2],255])),i.fillStyle=o,i.fillRect(0,0,n,s),o=i.createLinearGradient(0,0,0,s),o.addColorStop(0,"rgba(0, 0, 0, 0)"),o.addColorStop(1,"rgba(0, 0, 0, 255)"),i.fillStyle=o,i.fillRect(0,0,n,s)}_onFieldChanged(){if(!this._changing){const e=[this._rField.value,this._gField.value,this._bField.value,this._aField.value].map((function(e){return e/255}));this.hsva=this.Helpers.toHsva(e),this.colorSelectedAnchor(this.color)}}_onHexChanged(){if(!this._changing){const e=this._hexField.value.trim().toLowerCase();if(/^([0-9a-f]{2}){3,4}$/.test(e)){const t=[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)];this.hsva=Pe(t).concat([this.hsva[3]]),this.colorSelectedAnchor(this.color)}}}_onMouseDown(e){e.currentTarget===this._colorRect.dom?this._dragMode=1:e.currentTarget===this._hueRect.dom?this._dragMode=2:this._dragMode=3,this._storeHsva=this._hsva.slice(),this._onMouseMove(e),window.addEventListener("mousemove",this.moveHandler),window.addEventListener("mouseup",this.upHandler)}_onMouseMove(e){let t;if(1===this._dragMode){const i=this.Helpers.normalizedCoord(this._colorRect,e.pageX,e.pageY),n=_t.clamp(i[0],0,1),s=_t.clamp(i[1],0,1);t=[this.hsva[0],n,1-s,this._hsva[3]]}else if(2===this._dragMode){const i=this.Helpers.normalizedCoord(this._hueRect,e.pageX,e.pageY);t=[_t.clamp(i[1],0,1),this.hsva[1],this.hsva[2],this.hsva[3]]}else{const i=this.Helpers.normalizedCoord(this._alphaRect,e.pageX,e.pageY),n=_t.clamp(i[1],0,1);t=[this.hsva[0],this.hsva[1],this.hsva[2],1-n]}t[0]===this._hsva[0]&&t[1]===this._hsva[1]&&t[2]===this._hsva[2]&&t[3]===this._hsva[3]||(this.hsva=t,this.emit("changing",this.color))}_onMouseUp(e){window.removeEventListener("mousemove",this.moveHandler),window.removeEventListener("mouseup",this.upHandler),this._storeHsva[0]===this._hsva[0]&&this._storeHsva[1]===this._hsva[1]&&this._storeHsva[2]===this._hsva[2]&&this._storeHsva[3]===this._hsva[3]||this.colorSelectedAnchor(this.color)}set hsva(e){const t=Le(e),i=Le([e[0],1,1]);e[0]!==this._hsva[0]&&this._generateGradient(this._colorRect,i);const n=this._colorRect.dom,s=n.getBoundingClientRect(),o=s.width-2,r=s.height-2;this._colorHandle.style.backgroundColor=this.Helpers.rgbaStr(t),this._colorHandle.style.left=n.offsetLeft-7+Math.floor(o*e[1])+"px",this._colorHandle.style.top=n.offsetTop-7+Math.floor(r*(1-e[2]))+"px",this._hueHandle.style.backgroundColor=this.Helpers.rgbaStr(i),this._hueHandle.style.top=n.offsetTop-3+Math.floor(140*e[0])+"px",this._hueHandle.style.left="162px",this._alphaHandle.style.backgroundColor=this.Helpers.rgbaStr(Le([0,0,e[3]])),this._alphaHandle.style.top=n.offsetTop-3+Math.floor(140*(1-e[3]))+"px",this._alphaHandle.style.left="194px",this._changing=!0,this._rField.value=t[0],this._gField.value=t[1],this._bField.value=t[2],this._aField.value=Math.round(255*e[3]),this._hexField.value=this.Helpers.hexStr(t),this._changing=!1,this._hsva=e}get hsva(){return this._hsva}set color(e){const t=this.Helpers.toHsva(e);0===t[0]&&0===t[1]&&-1!==this._hsva[0]&&(t[0]=this._hsva[0]),this.hsva=t}get color(){return this.Helpers.toRgba(this._hsva)}set editAlpha(e){e?(this._alphaRect.dom.style.display="inline",this._alphaHandle.style.display="block",this._aField.dom.style.display="inline-block"):(this._alphaRect.dom.style.display="none",this._alphaHandle.style.display="none",this._aField.dom.style.display="none")}get editAlpha(){return this.editAlpha}open(){this.UI.overlay.hidden=!1}close(){this.UI.overlay.hidden=!0}onOpen(){window.addEventListener("mousemove",this._onAnchorsMouseMove),window.addEventListener("mouseup",this._onAnchorsMouseUp),this.UI.anchors.dom.addEventListener("mousedown",this._onAnchorsMouseDown)}onClose(){this.STATE.hoveredAnchor=-1,window.removeEventListener("mousemove",this._onAnchorsMouseMove),window.removeEventListener("mouseup",this._onAnchorsMouseUp),this.UI.anchors.dom.removeEventListener("mousedown",this._onAnchorsMouseDown),this._evtRefreshPicker.unbind(),this._evtRefreshPicker=null,this._evtPickerChanged.unbind(),this._evtPickerChanged=null}onDeleteKey(){if(!this.UI.overlay.hidden&&-1!==this.STATE.selectedAnchor){const e=this.STATE.anchors[this.STATE.selectedAnchor];this.STATE.selectedAnchor=-1,this.deleteAnchor(e)}}_onTypeChanged(e){e=this.STATE.typeMap[e];const t=[],i=[];for(let n=0;n<this.STATE.curves.length;++n)t.push(n.toString()+".type"),i.push(e);this.emit("picker:curve:change",t,i)}render(){this.renderGradient(),this.renderAnchors()}renderGradient(){const e=this.UI.gradient.dom.getContext("2d"),t=this.UI.gradient.width,i=this.UI.gradient.height,n=this.UI.gradient.pixelRatio;e.setTransform(n,0,0,n,0,0),e.fillStyle=this.UI.checkerPattern,e.fillRect(0,0,t,i);const s=e.createLinearGradient(0,0,t,0);for(let e=0;e<=t;e+=2){const i=e/t;s.addColorStop(i,this.Helpers.rgbaStr(this.evaluateGradient(i),255))}if(e.fillStyle=s,e.fillRect(0,0,t,i),-1!==this.STATE.selectedAnchor){const n=[this.STATE.anchors[this.STATE.selectedAnchor]*t,i],s=this.UI.draggingAnchor?-30:-6;e.beginPath(),e.rect(n[0]-.5,n[1],1,s),e.fillStyle="rgb(41, 53, 56)",e.fill()}}renderAnchors(){const e=this.UI.anchors.dom.getContext("2d"),t=this.UI.anchors.width,i=this.UI.anchors.height,n=this.UI.anchors.pixelRatio;e.setTransform(n,0,0,n,0,0),e.fillStyle=this.CONSTANTS.bg,e.fillRect(0,0,t,i);for(let t=0;t<this.STATE.anchors.length;++t)t!==this.STATE.hoveredAnchor&&t!==this.STATE.selectedAnchor&&this.renderAnchor(e,this.STATE.anchors[t]);-1!==this.STATE.hoveredAnchor&&this.STATE.hoveredAnchor!==this.STATE.selectedAnchor&&this.renderAnchor(e,this.STATE.anchors[this.STATE.hoveredAnchor],"hovered"),-1!==this.STATE.selectedAnchor&&this.renderAnchor(e,this.STATE.anchors[this.STATE.selectedAnchor],"selected")}renderAnchor(e,t,i){const n=[t*this.UI.anchors.width,this.UI.anchors.height/2],s="selected"===i?this.CONSTANTS.selectedRadius:this.CONSTANTS.anchorRadius;"selected"===i&&(e.beginPath(),e.rect(n[0]-.5,n[1],1,-n[1]),e.fillStyle="rgb(41, 53, 56)",e.fill()),"selected"!==i&&"hovered"!==i||(e.beginPath(),e.arc(n[0],n[1],s+2,0,2*Math.PI,!1),e.fillStyle="rgb(255, 255, 255)",e.fill()),e.beginPath(),e.arc(n[0],n[1],s+1,0,2*Math.PI,!1),e.fillStyle=this.Helpers.rgbaStr(this.evaluateGradient(t,1),255),e.fill()}evaluateGradient(e,t){const i=[];for(let t=0;t<3;++t)i.push(this.STATE.curves[t].value(e));return t?i.push(t):this.STATE.curves.length>3?i.push(this.STATE.curves[3].value(e)):i.push(1),i}calcAnchorTimes(){let e=[];for(let t=0;t<this.STATE.curves.length;t++){const i=this.STATE.curves[t];for(let t=0;t<i.keys.length;++t)e.push(i.keys[t][0])}return e.sort(),e=e.filter((function(e,t,i){return!t||e!==i[t-1]})),e}calcNormalizedCoord(e,t,i){return[(e-i.left)/i.width,(t-i.top)/i.height]}getClientRect(e){const t=window.getComputedStyle(e),i=parseFloat(t.paddingTop),n=parseFloat(t.paddingRight),s=parseFloat(t.paddingBottom),o=parseFloat(t.paddingLeft),r=e.getBoundingClientRect();return new DOMRect(r.x+o,r.y+i,r.width-n-o,r.height-i-s)}selectHovered(e){this.STATE.hoveredAnchor=e,this.UI.anchors.dom.style.cursor=-1===e?"":"pointer"}selectAnchor(e){if(this.STATE.selectedAnchor=e,this.STATE.changing=!0,-1===e)this.UI.positionEdit.value="",this.color=[0,0,0];else{const t=this.STATE.anchors[e];this.UI.positionEdit.value=Math.round(100*t),this.STATE.selectedValue=this.evaluateGradient(t),this.color=this.STATE.selectedValue,this.UI.showSelectedPosition.dom.style.left=(this.STATE.anchors[e]*this.UI.gradient.width-4).toString()+"px",this.UI.showSelectedPosition.value=Math.round(100*this.STATE.anchors[e])}this.STATE.changing=!1,this.render()}dragStart(){if(-1===this.STATE.selectedAnchor)return;const e=this.STATE.anchors[this.STATE.selectedAnchor];this.STATE.keystore=[];for(let t=0;t<this.STATE.curves.length;++t){const i=[];this.STATE.curves[t].keys.forEach((function(t){t[0]!==e&&i.push([t[0],t[1]])})),this.STATE.keystore.push(i)}}dragUpdate(e){if(-1!==this.STATE.selectedAnchor){for(let t=0;t<this.STATE.curves.length;++t){const i=this.STATE.curves[t],n=this.STATE.keystore[t];i.keys=n.map((function(e){return[e[0],e[1]]})).filter((function(t){return t[0]!==e})),i.keys.push([e,this.STATE.selectedValue[t]]),i.sort()}this.STATE.anchors=this.calcAnchorTimes(),this.selectAnchor(this.STATE.anchors.indexOf(e))}}dragEnd(){-1!==this.STATE.selectedAnchor&&this.emitCurveChange()}insertAnchor(e,t){for(let i=0;i<this.STATE.curves.length;++i){const n=this.STATE.curves[i].keys;let s=0;for(;s<n.length&&!(n[s][0]>=e);)++s;s<n.length&&n[s][0]===e?n[s][1]=t[i]:n.splice(s,0,[e,t[i]])}this.emitCurveChange()}deleteAnchor(e){for(let t=0;t<this.STATE.curves.length;++t){const i=this.STATE.curves[t];for(let t=0;t<i.keys.length;++t)if(i.keys[t][0]===e){i.keys.splice(t,1);break}}this.selectHovered(-1),this.emitCurveChange()}moveSelectedAnchor(e){-1!==this.STATE.selectedAnchor&&(this.dragStart(),this.dragUpdate(e),this.dragEnd())}colorSelectedAnchor(e,t){if(-1!==this.STATE.selectedAnchor){const i=this.STATE.anchors[this.STATE.selectedAnchor];for(let t=0;t<this.STATE.curves.length;++t){const n=this.STATE.curves[t];for(let s=0;s<n.keys.length;++s)if(n.keys[s][0]===i){n.keys[s][1]=e[t];break}}this.STATE.selectedValue=e,t?this.render():this.emitCurveChange()}}emitCurveChange(){const e=[],t=[];this.STATE.curves.forEach((function(i,n){e.push("0.keys."+n);const s=[];i.keys.forEach((function(e){s.push(e[0],e[1])})),t.push(s)})),this.emit("picker:curve:change",e,t)}doCopy(){const e={type:this.STATE.curves[0].type,keys:this.STATE.curves.map((function(e){return[].concat(...e.keys)}))};this._copiedData=e}doPaste(){const e=this._copiedData;if(null!==e){const t={type:e.type,keys:[]};for(let i=0;i<this.STATE.curves.length;++i)i<e.keys.length?t.keys.push(e.keys[i]):t.keys.push([].concat(...this.STATE.curves[i].keys));this.setValue([t]),this.emitCurveChange()}}doDelete(){const e=this.STATE.selectedAnchor;if(-1!==e&&1!==this.STATE.curves[0].keys.length){for(let t=0;t<this.STATE.curves.length;++t)this.STATE.curves[t].keys.splice(e,1);this.emitCurveChange()}}createCheckerPattern(){const e=new Ce;e.width=16,e.height=16;const t=e.dom,i=t.getContext("2d");return i.fillStyle="#949a9c",i.fillRect(0,0,8,8),i.fillRect(8,8,8,8),i.fillStyle="#657375",i.fillRect(8,0,8,8),i.fillRect(0,8,8,8),i.createPattern(t,"repeat")}setValue(e,t){if(!(e instanceof Array)||1!==e.length||void 0===e[0].keys||3!==e[0].keys.length&&4!==e[0].keys.length)return;this.STATE.typeMap={0:5,1:0,2:4};const i=Object.fromEntries(Object.entries(this.STATE.typeMap).map((([e,t])=>[t,e])));5!==e[0].type&&0!==e[0].type&&4!==e[0].type&&(this.STATE.typeMap[3]=e[0].type),this.UI.typeCombo.options=[{v:0,t:"Step"},{v:1,t:"Linear"},{v:2,t:"Spline"}],this.UI.typeCombo.value=-1===this.UI.typeCombo.value?i[this.value.type]:this.UI.typeCombo.value,this.STATE.curves=[],e[0].keys.forEach((t=>{const i=new yt(t);i.type=e[0].type,this.STATE.curves.push(i)})),this.STATE.anchors=this.calcAnchorTimes(),0===this.STATE.anchors.length?this.selectAnchor(-1):this.selectAnchor(_t.clamp(this.STATE.selectedAnchor,0,this.STATE.anchors.length-1)),this.editAlpha=this.STATE.curves.length>3}callOpenGradientPicker(e,t){this.setValue(e,t),this.open()}getGradientPickerRect(){return this.UI.overlay.dom.getBoundingClientRect()}positionGradientPicker(e,t){t+this.UI.panel.clientHeight>window.innerHeight&&(t=window.innerHeight-this.UI.panel.clientHeight),this.UI.overlay.position(e,t)}setGradientPicker(e,t){this.setValue(e,t)}}R.register("div",At);var Et=At;const Tt="pcui-radio-button",It=Tt+"-selected";class St extends R{constructor(e={}){super(Object.assign({tabIndex:0},e)),this._onKeyDown=e=>{"Escape"!==e.key?this.enabled&&!this.readOnly&&" "===e.key&&(e.stopPropagation(),e.preventDefault(),this.value=!this.value):this.blur()},this._onFocus=e=>{this.emit("focus")},this._onBlur=e=>{this.emit("blur")},this.class.add(Tt),this.class.add(I),this.dom.addEventListener("keydown",this._onKeyDown),this.dom.addEventListener("focus",this._onFocus),this.dom.addEventListener("blur",this._onBlur),this.value=e.value,this._renderChanges=e.renderChanges}destroy(){this._destroyed||(this.dom.removeEventListener("keydown",this._onKeyDown),this.dom.removeEventListener("focus",this._onFocus),this.dom.removeEventListener("blur",this._onBlur),super.destroy())}_onClick(e){return this.enabled&&this.focus(),this.enabled&&!this.readOnly&&(this.value=!this.value),super._onClick(e)}_updateValue(e){return this.class.remove(A),e!==this.value&&(this._value=e,e?this.class.add(It):this.class.remove(It),this.renderChanges&&this.flash(),this.emit("change",e),!0)}focus(){this.dom.focus()}blur(){this.dom.blur()}set value(e){this._updateValue(e)&&this._binding&&this._binding.setValue(e)}get value(){return this._value}set values(e){e.some((t=>t!==e[0]))?(this._updateValue(null),this.class.add(A)):this._updateValue(e[0])}set renderChanges(e){this._renderChanges=e}get renderChanges(){return this._renderChanges}}R.register("radio",St,{renderChanges:!0});var Mt=St;const zt="pcui-gridview-item",Ot=zt+"-selected",Ht=zt+"-text";class Rt extends F{constructor(e={}){var t,i,n;super(Object.assign({tabIndex:0},e)),this._onRadioButtonClick=()=>{this._radioButton.value=this.selected},this._onFocus=()=>{this.emit("focus")},this._onBlur=()=>{this.emit("blur")},this.allowSelect=null===(t=e.allowSelect)||void 0===t||t,this._type=null!==(i=e.type)&&void 0!==i?i:null,this._selected=!1,"radio"===e.type?(this.class.add("pcui-gridview-radio-container"),this._radioButton=new Mt({class:"pcui-gridview-radiobtn",binding:new d}),this._radioButton.dom.removeEventListener("click",this._radioButton._onClick),this._radioButton.dom.addEventListener("click",this._onRadioButtonClick),this.append(this._radioButton)):this.class.add(zt),this._labelText=new j({class:Ht,binding:new d,text:null!==(n=e.text)&&void 0!==n?n:""}),this.append(this._labelText),this.dom.addEventListener("focus",this._onFocus),this.dom.addEventListener("blur",this._onBlur)}destroy(){this._destroyed||(this.dom.removeEventListener("focus",this._onFocus),this.dom.removeEventListener("blur",this._onBlur),super.destroy())}focus(){this.dom.focus()}blur(){this.dom.blur()}link(e,t){this._labelText.link(e,t)}unlink(){this._labelText.unlink()}set allowSelect(e){this._allowSelect=e}get allowSelect(){return this._allowSelect}set selected(e){e&&this.focus(),this._selected!==e&&(this._selected=e,e?(this._radioButton?this._radioButton.value=e:this.class.add(Ot),this.emit("select",this)):(this._radioButton?this._radioButton.value=!1:this.class.remove(Ot),this.emit("deselect",this)))}get selected(){return this._selected}set text(e){this._labelText.text=e}get text(){return this._labelText.text}get nextSibling(){let e=this.dom.nextSibling;for(;e;){if(e.ui instanceof Rt&&!e.ui.hidden)return e.ui;e=e.nextSibling}return null}get previousSibling(){let e=this.dom.previousSibling;for(;e;){if(e.ui instanceof Rt&&!e.ui.hidden)return e.ui;e=e.previousSibling}return null}}var Dt=Rt;const Vt="pcui-gridview",Pt=Vt+"-vertical";var Lt=class extends F{constructor(e={}){var t,i;super(e),this._filterAnimationFrame=null,this._filterCanceled=!1,this._selected=[],this._vertical=!!e.vertical,this.class.add(this._vertical?Pt:Vt),this.on("append",(e=>{this._onAppendGridViewItem(e)})),this.on("remove",(e=>{this._onRemoveGridViewItem(e)})),this._filterFn=e.filterFn,this._multiSelect=null===(t=e.multiSelect)||void 0===t||t,this._allowDeselect=null===(i=e.allowDeselect)||void 0===i||i}_onAppendGridViewItem(e){if(!(e instanceof Dt))return;let t;t=this._clickFn?e.on("click",(t=>this._clickFn(t,e))):e.on("click",(t=>this._onClickItem(t,e)));let i,n=e.on("select",(()=>this._onSelectItem(e)));this._allowDeselect&&(i=e.on("deselect",(()=>this._onDeselectItem(e)))),this._filterFn&&!this._filterFn(e)&&(e.hidden=!0),e.once("griditem:remove",(()=>{t.unbind(),t=null,n.unbind(),n=null,this._allowDeselect&&(i.unbind(),i=null)}))}_onRemoveGridViewItem(e){e instanceof Dt&&(e.selected=!1,e.emit("griditem:remove"),e.unbind("griditem:remove"))}_onClickItem(e,t){if((e.ctrlKey||e.metaKey)&&this._multiSelect)t.selected=!t.selected;else if(e.shiftKey&&this._multiSelect){const e=this._selected[this._selected.length-1];if(e)if(e.dom.compareDocumentPosition(t.dom)&Node.DOCUMENT_POSITION_FOLLOWING){let i=e.nextSibling;for(;i&&(i.selected=!0,i!==t);)i=i.nextSibling}else{let i=e.previousSibling;for(;i&&(i.selected=!0,i!==t);)i=i.previousSibling}else t.selected=!0}else{let e=!1,i=this._selected.length;for(;i--;)this._selected[i]&&this._selected[i]!==t&&(this._selected[i].selected=!1,e=!0);t.selected=!!e||!t.selected}}_onSelectItem(e){this._selected.push(e),this.emit("select",e)}_onDeselectItem(e){const t=this._selected.indexOf(e);-1!==t&&(this._selected.splice(t,1),this.emit("deselect",e))}deselect(){let e=this._selected.length;for(;e--;)this._selected[e]&&(this._selected[e].selected=!1)}filter(){this.forEachChild((e=>{e instanceof Dt&&(e.hidden=this._filterFn&&!this._filterFn(e))}))}filterAsync(e=100){let t=0;const i=this.dom.childNodes,n=i.length;this.emit("filter:start"),this._filterCanceled=!1;const s=()=>{this._filterAnimationFrame=null;let o=0;for(;t<n&&o<e;t++){if(this._filterCanceled)return this._filterCanceled=!1,void this.emit("filter:cancel");const e=i[t].ui;e instanceof Dt&&(this._filterFn&&!this._filterFn(e)?e.hidden=!0:(e.hidden=!1,o++))}t<n?(this.emit("filter:delay"),this._filterAnimationFrame=requestAnimationFrame(s)):this.emit("filter:end")};s()}filterAsyncCancel(){this._filterAnimationFrame?(cancelAnimationFrame(this._filterAnimationFrame),this._filterAnimationFrame=null):this._filterCanceled=!0}destroy(){this._destroyed||(this._filterAnimationFrame&&(cancelAnimationFrame(this._filterAnimationFrame),this._filterAnimationFrame=null),super.destroy())}get selected(){return this._selected.slice()}get vertical(){return this._vertical}};class Ut extends F{constructor(e={}){var t,i,n,s;super(e),this._titleElement=new R,this._textElement=new R,this.class.add("pcui-infobox"),this.append(this._titleElement),this.append(this._textElement),this._unsafe=null!==(t=e.unsafe)&&void 0!==t&&t,this.icon=null!==(i=e.icon)&&void 0!==i?i:"",this.title=null!==(n=e.title)&&void 0!==n?n:"",this.text=null!==(s=e.text)&&void 0!==s?s:""}set icon(e){this._icon!==e&&(this._icon=e,e?this.dom.setAttribute("data-icon",String.fromCodePoint(parseInt(e,16))):this.dom.removeAttribute("data-icon"))}get icon(){return this._icon}set title(e){this._title!==e&&(this._title=e,this._unsafe?this._titleElement.dom.innerHTML=e:this._titleElement.dom.textContent=e)}get title(){return this._title}set text(e){this._text!==e&&(this._text=e,this._unsafe?this._textElement.dom.innerHTML=e:this._textElement.dom.textContent=e)}get text(){return this._text}}R.register("infobox",Ut);var Nt=Ut;const Ft="pcui-label-group",Bt=Ft+"-align-top";class jt extends F{constructor(e={}){var t,i;super(e),this.class.add(Ft),this._label=new j({text:null!==(t=e.text)&&void 0!==t?t:"Label",nativeTooltip:e.nativeTooltip}),this.append(this._label),this._field=null!==(i=e.field)&&void 0!==i?i:null,this._field&&this.append(this._field),this.labelAlignTop=e.labelAlignTop}get label(){return this._label}get field(){return this._field}set text(e){this._label.text=e}get text(){return this._label.text}set labelAlignTop(e){e?this.class.add(Bt):this.class.remove(Bt)}get labelAlignTop(){return this.class.contains(Bt)}}R.register("labelgroup",jt);var qt=jt;const Wt="pcui-menu-item",Kt=Wt+"-content",Xt=Wt+"-children",Gt=Wt+"-has-children";class Yt extends F{constructor(e={}){super(e),this._numChildren=0,this._icon=null,this._menu=null,this._onClickMenuItem=e=>{e.preventDefault(),e.stopPropagation(),this.enabled&&(this._onSelect&&this._onSelect(e),this.emit("select"),this.menu&&(this.menu.hidden=!0))},this.class.add(Wt),this._containerContent=new F({class:Kt,flex:!0,flexDirection:"row"}),this.append(this._containerContent),this._labelText=new j,this._containerContent.append(this._labelText),this._containerItems=new F({class:Xt}),this.append(this._containerItems),this.domContent=this._containerItems.dom,this.text=e.text||"Untitled",this.dom.addEventListener("click",this._onClickMenuItem),e.value&&(this.value=e.value),e.icon&&(this.icon=e.icon),e.binding&&(this.binding=e.binding),this.onIsEnabled=e.onIsEnabled,this.onSelect=e.onSelect,this.onIsVisible=e.onIsVisible,e.items&&e.items.forEach((e=>{const t=new Yt(e);this.append(t)}))}destroy(){this.destroyed||(this.dom.removeEventListener("click",this._onClickMenuItem),super.destroy())}_onAppendChild(e){super._onAppendChild(e),this._numChildren++,e instanceof Yt&&(this.class.add(Gt),e.menu=this.menu)}_onRemoveChild(e){e instanceof Yt&&(this._numChildren--,0===this._numChildren&&this.class.remove(Gt),e.menu=null),super._onRemoveChild(e)}link(e,t){super.link(e,t),this._labelText.link(e,t)}unlink(){super.unlink(),this._labelText.unlink()}select(){this.enabled&&(this._onSelect&&this._onSelect(),this.emit("select"),this.menu&&(this.menu.hidden=!0))}set text(e){this._labelText.text=e}get text(){return this._labelText.text}set value(e){this.text=e}get value(){return this.text}set values(e){this._labelText.values=e}set icon(e){this._icon!==e&&e.match(/^E[0-9]{0,4}$/)&&(this._icon=e,e?this._labelText.dom.setAttribute("data-icon",String.fromCodePoint(parseInt(e,16))):this._labelText.dom.removeAttribute("data-icon"))}get icon(){return this._icon}set binding(e){this._labelText.binding=e}get binding(){return this._labelText.binding}set menu(e){if(this._menu=e,!this._containerItems.destroyed)for(const t of this._containerItems.dom.childNodes)t.ui instanceof Yt&&(t.ui.menu=e)}get menu(){return this._menu}set onSelect(e){this._onSelect=e}get onSelect(){return this._onSelect}set onIsEnabled(e){this._onIsEnabled=e}get onIsEnabled(){return this._onIsEnabled}set onIsVisible(e){this._onIsVisible=e}get onIsVisible(){return this._onIsVisible}get hasChildren(){return this._numChildren>0}set renderChanges(e){this._renderChanges=e}get renderChanges(){return this._renderChanges}}var Jt=Yt;const Zt="pcui-menu",Qt=Zt+"-items";var $t=class extends F{constructor(e={}){var t;super(Object.assign({tabIndex:1},e)),this._onClickMenu=e=>{this._containerMenuItems.dom.contains(e.target)||(this.hidden=!0)},this._onFocus=e=>{this.emit("focus")},this._onBlur=e=>{this.emit("blur")},this._onKeyDown=e=>{this.hidden||"Escape"===e.key&&(this.hidden=!0)},this.hidden=null===(t=e.hidden)||void 0===t||t,this.class.add(Zt),this._containerMenuItems=new F({class:Qt,flex:!0,flexDirection:"column"}),this.append(this._containerMenuItems),this.domContent=this._containerMenuItems.dom,this.on("click",this._onClickMenu),this.on("show",(()=>{this._onShowMenu()})),this.dom.addEventListener("contextmenu",this._onClickMenu),this.dom.addEventListener("keydown",this._onKeyDown),e.items&&e.items.forEach((e=>{const t=new Jt(e);this.append(t)}))}destroy(){this.destroyed||(this.dom.removeEventListener("keydown",this._onKeyDown),this.dom.removeEventListener("contextmenu",this._onClickMenu),this.dom.removeEventListener("focus",this._onFocus),this.dom.removeEventListener("blur",this._onBlur),super.destroy())}_onAppendChild(e){e instanceof Jt&&(e.menu=this)}_onRemoveChild(e){e instanceof Jt&&(e.menu=null)}_filterMenuItems(e){if(e instanceof Jt){e.onIsEnabled&&(e.enabled=e.onIsEnabled()),e.onIsVisible&&(e.hidden=!e.onIsVisible());for(const t of e._containerItems.dom.childNodes)this._filterMenuItems(t.ui)}}_onShowMenu(){this.focus();for(const e of this._containerMenuItems.dom.childNodes)this._filterMenuItems(e.ui)}_limitSubmenuAtScreenEdges(e){if(!(e instanceof Jt&&e.hasChildren))return;const t=e._containerItems;t.style.top="",t.style.left="",t.style.right="";const i=t.dom.getBoundingClientRect();i.bottom>window.innerHeight&&(t.style.top=-(i.bottom-window.innerHeight)+"px"),i.right>window.innerWidth&&(t.style.left="auto",t.style.right="100%");for(const e of t.dom.childNodes)this._limitSubmenuAtScreenEdges(e.ui)}focus(){this.dom.focus()}blur(){this.dom.blur()}position(e,t){const i=this._containerMenuItems.dom.getBoundingClientRect();let n=e||0,s=t||0;s+i.height>window.innerHeight?s=window.innerHeight-i.height:s<0&&(s=0),n+i.width>window.innerWidth?n=window.innerWidth-i.width:n<0&&(n=0),this._containerMenuItems.style.left=n+"px",this._containerMenuItems.style.top=s+"px";for(const e of this._containerMenuItems.dom.childNodes)this._limitSubmenuAtScreenEdges(e.ui)}clear(){this._containerMenuItems.clear()}};const ei="pcui-progress",ti=ei+"-inner";class ii extends F{constructor(e={}){super(e),this._inner=new R({class:ti}),this.class.add(ei),this.append(this._inner),void 0!==e.value&&(this.value=e.value)}set value(e){this._value!==e&&(this._value=e,this._inner.width=`${this._value}%`,this.emit("change",e))}get value(){return this._value}}R.register("progress",ii);var ni=ii;const si="pcui-slider",oi=si+"-container",ri=si+"-bar",li=si+"-handle",ai=si+"-active",hi=/Chrome\//.test(navigator.userAgent);class di extends R{constructor(e={}){var t,i,n,s,o;super(e),this._historyCombine=!1,this._historyPostfix=null,this._cursorHandleOffset=0,this._touchId=null,this._onMouseDown=e=>{0===e.button&&this.enabled&&!this.readOnly&&this._onSlideStart(e.pageX)},this._onMouseMove=e=>{e.stopPropagation(),e.preventDefault(),this._onSlideMove(e.pageX)},this._onMouseUp=e=>{e.stopPropagation(),e.preventDefault(),this._onSlideEnd(e.pageX)},this._onTouchStart=e=>{if(this.enabled&&!this.readOnly)for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t],n=i.target;if(n.ui&&n.ui===this){this._touchId=i.identifier,this._onSlideStart(i.pageX);break}}},this._onTouchMove=e=>{for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t];if(i.identifier===this._touchId){e.stopPropagation(),e.preventDefault(),this._onSlideMove(i.pageX);break}}},this._onTouchEnd=e=>{for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t];if(i.identifier===this._touchId){e.stopPropagation(),e.preventDefault(),this._onSlideEnd(i.pageX),this._touchId=null;break}}},this._onKeyDown=e=>{if("Escape"===e.key)return void this.blur();if(!this.enabled||this.readOnly)return;if("ArrowLeft"!==e.key&&"ArrowRight"!==e.key)return;e.stopPropagation(),e.preventDefault();let t="ArrowLeft"===e.key?-1:1;e.shiftKey&&(t*=10),this.value+=t*this.step},this.class.add(si);const r=new ae({allowNull:e.allowNull,hideSlider:!0,min:e.min,max:e.max,keyChange:e.keyChange,placeholder:e.placeholder,precision:null!==(t=e.precision)&&void 0!==t?t:2,renderChanges:e.renderChanges,step:e.step});r.on("change",(e=>{this._onValueChange(e)})),r.on("focus",(()=>{this.emit("focus")})),r.on("blur",(()=>{this.emit("blur")})),r.parent=this,this.dom.appendChild(r.dom),this._numericInput=r,this._sliderMin=null!==(n=null!==(i=e.sliderMin)&&void 0!==i?i:e.min)&&void 0!==n?n:0,this._sliderMax=null!==(o=null!==(s=e.sliderMax)&&void 0!==s?s:e.max)&&void 0!==o?o:1,this._domSlider=document.createElement("div"),this._domSlider.classList.add(oi),this.dom.appendChild(this._domSlider),this._domBar=document.createElement("div"),this._domBar.classList.add(ri),this._domBar.ui=this,this._domSlider.appendChild(this._domBar),this._domHandle=document.createElement("div"),this._domHandle.ui=this,this._domHandle.tabIndex=0,this._domHandle.classList.add(li),this._domBar.appendChild(this._domHandle),this._domSlider.addEventListener("mousedown",this._onMouseDown),this._domSlider.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this._domHandle.addEventListener("keydown",this._onKeyDown),void 0!==e.value&&(this.value=e.value),void 0!==e.values&&(this.values=e.values),0===this.value&&this._updateHandle(0)}destroy(){this._destroyed||(this._domSlider.removeEventListener("mousedown",this._onMouseDown),this._domSlider.removeEventListener("touchstart",this._onTouchStart),this._domHandle.removeEventListener("keydown",this._onKeyDown),this.dom.removeEventListener("mouseup",this._onMouseUp),this.dom.removeEventListener("mousemove",this._onMouseMove),this.dom.removeEventListener("touchmove",this._onTouchMove),this.dom.removeEventListener("touchend",this._onTouchEnd),super.destroy())}_updateHandle(e){const t=100*Math.max(0,Math.min(1,((e||0)-this._sliderMin)/(this._sliderMax-this._sliderMin))),i=this._domHandle.getBoundingClientRect().width;this._domHandle.style.left=`calc(${t}% + ${i/2}px)`}_onValueChange(e){this._updateHandle(e),this._suppressChange||this.emit("change",e),this._binding&&this._binding.setValue(e)}_calculateCursorHandleOffset(e){const t=hi?2:0,i=this._domHandle.getBoundingClientRect(),n=i.left-t,s=i.right;return this._cursorHandleOffset=e>=n&&e<=s?e-(n+(s-n)/2):0,this._cursorHandleOffset}_onSlideStart(e){this._domHandle.focus(),null===this._touchId?(window.addEventListener("mousemove",this._onMouseMove),window.addEventListener("mouseup",this._onMouseUp)):(window.addEventListener("touchmove",this._onTouchMove),window.addEventListener("touchend",this._onTouchEnd)),this.class.add(ai),this._calculateCursorHandleOffset(e)||this._onSlideMove(e),this.binding&&(this._historyCombine=this.binding.historyCombine,this._historyPostfix=this.binding.historyPostfix,this.binding.historyCombine=!0,this.binding.historyPostfix=`(${Date.now()})`)}_onSlideMove(e){const t=this._domBar.getBoundingClientRect();e-=this._cursorHandleOffset;let i=Math.max(0,Math.min(1,(e-t.left)/t.width))*(this._sliderMax-this._sliderMin)+this._sliderMin;i=parseFloat(i.toFixed(this.precision)),this.value=i}_onSlideEnd(e){this._calculateCursorHandleOffset(e)||this._onSlideMove(e),this.class.remove(ai),null===this._touchId?(window.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("mouseup",this._onMouseUp)):(window.removeEventListener("touchmove",this._onTouchMove),window.removeEventListener("touchend",this._onTouchEnd)),this.binding&&(this.binding.historyCombine=this._historyCombine,this.binding.historyPostfix=this._historyPostfix,this._historyCombine=!1,this._historyPostfix=null)}focus(){this._numericInput.focus()}blur(){this._domHandle.blur(),this._numericInput.blur()}set sliderMin(e){this._sliderMin!==e&&(this._sliderMin=e,this._updateHandle(this.value))}get sliderMin(){return this._sliderMin}set sliderMax(e){this._sliderMax!==e&&(this._sliderMax=e,this._updateHandle(this.value))}get sliderMax(){return this._sliderMax}set value(e){this._numericInput.value=e,this._numericInput.class.contains(A)?this.class.add(A):this.class.remove(A)}get value(){return this._numericInput.value}set values(e){this._numericInput.values=e,this._numericInput.class.contains(A)?this.class.add(A):this.class.remove(A)}set renderChanges(e){this._numericInput.renderChanges=e}get renderChanges(){return this._numericInput.renderChanges}set min(e){this._numericInput.min=e}get min(){return this._numericInput.min}set max(e){this._numericInput.max=e}get max(){return this._numericInput.max}set step(e){this._numericInput.step=e}get step(){return this._numericInput.step}set precision(e){this._numericInput.precision=e}get precision(){return this._numericInput.precision}set keyChange(e){this._numericInput.keyChange=e}get keyChange(){return this._numericInput.keyChange}set placeholder(e){this._numericInput.placeholder=e}get placeholder(){return this._numericInput.placeholder}}R.register("slider",di,{renderChanges:!0});var ci=di;class ui extends R{constructor(e={}){var t,i;if((null!==(t=e.type)&&void 0!==t?t:"small-thick")===ui.TYPE_SMALL_THICK){const t=function(e,t){const i=t||document.createElementNS("http://www.w3.org/2000/svg","svg");return i.classList.add("spin"),i.setAttribute("width",e),i.setAttribute("height",e),i.setAttribute("viewBox","0 0 14 14"),i.setAttribute("fill","none"),i.innerHTML='<path d="M7 14C3.13871 14 0 10.8613 0 7C0 3.13871 3.13871 0 7 0C10.8613 0 14 3.13871 14 7C14 10.8613 10.8613 14 7 14ZM7 2.25806C4.38064 2.25806 2.25806 4.38064 2.25806 7C2.25806 9.61935 4.38064 11.7419 7 11.7419C9.61935 11.7419 11.7419 9.61935 11.7419 7C11.7419 4.38064 9.61935 2.25806 7 2.25806Z" fill="#773417"/><path class="pcui-spinner-highlight" d="M7 14V11.7419C9.61935 11.7419 11.7419 9.61935 11.7419 7H14C14 10.8613 10.8613 14 7 14Z" fill="#FF6600"/>',i}(null!==(i=e.size)&&void 0!==i?i:12,e.dom);e=Object.assign(Object.assign({},e),{dom:t})}super(e),this.class.add("pcui-spinner")}}ui.TYPE_SMALL_THICK="small-thick";var pi=ui;const gi="pcui-text-area-input",_i=gi+"-resizable",mi=_i+"-none",fi=_i+"-both",vi=_i+"-horizontal",bi=_i+"-vertical";class yi extends Ve{constructor(e={}){switch(super(e=Object.assign({input:document.createElement("textarea")},e)),this.class.add(gi),e.resizable){case"both":this.class.add(fi);break;case"horizontal":this.class.add(vi);break;case"vertical":this.class.add(bi);break;default:this.class.add(mi)}}_onInputKeyDown(e){("Escape"===e.key&&this.blurOnEscape||"Enter"===e.key&&this.blurOnEnter&&!e.shiftKey)&&this._domInput.blur(),this.emit("keydown",e)}}R.register("text",yi,{renderChanges:!0});var wi=yi;const xi="pcui-treeview-item",Ci=xi+"-icon",ki=xi+"-text",Ai=xi+"-selected",Ei=xi+"-open",Ti=xi+"-contents",Ii=xi+"-empty",Si=xi+"-rename";class Mi extends F{constructor(e={}){var t,i,n,s;super(e),this._numChildren=0,this._onContentKeyDown=e=>{"INPUT"!==e.target.tagName&&this.allowSelect&&this._treeView&&this._treeView._onChildKeyDown(e,this)},this._onContentMouseDown=e=>{this._treeView&&this._treeView.allowDrag&&this._allowDrag&&(this._treeView._updateModifierKeys(e),e.stopPropagation())},this._onContentMouseUp=e=>{e.stopPropagation(),e.preventDefault(),window.removeEventListener("mouseup",this._onContentMouseUp),this._treeView&&this._treeView._onChildDragEnd(e,this)},this._onContentMouseOver=e=>{e.stopPropagation(),this._treeView&&this._treeView._onChildDragOver(e,this),this.emit("hover",e)},this._onContentDragStart=e=>{e.stopPropagation(),e.preventDefault(),this._treeView&&this._treeView.allowDrag&&(this.class.contains(Si)||(this._treeView._onChildDragStart(e,this),window.addEventListener("mouseup",this._onContentMouseUp)))},this._onContentClick=e=>{if(!this.allowSelect||0!==e.button)return;if("INPUT"===e.target.tagName)return;e.stopPropagation();const t=this._containerContents.dom.getBoundingClientRect();this._numChildren>0&&e.clientX-t.left<0?(this.open=!this.open,e.altKey&&this._dfs((e=>{e.open=this.open})),this.focus()):this._treeView&&this._treeView._onChildClick(e,this)},this._onContentDblClick=e=>{if(!this._treeView||!this._treeView.allowRenaming||0!==e.button)return;if("INPUT"===e.target.tagName)return;e.stopPropagation();const t=this._containerContents.dom.getBoundingClientRect();this.numChildren&&e.clientX-t.left<0||(this.allowSelect&&(this._treeView.deselect(),this._treeView._onChildClick(e,this)),this.rename())},this._onContentContextMenu=e=>{this._treeView&&this._treeView._onContextMenu&&this._treeView._onContextMenu(e,this)},this._onContentFocus=e=>{this.emit("focus")},this._onContentBlur=e=>{this.emit("blur")},this.class.add(xi,Ii),this._containerContents=new F({class:Ti,flex:!0,flexDirection:"row",tabIndex:0}),this.append(this._containerContents),this._containerContents.dom.draggable=!0,this._labelIcon=new j({class:Ci}),this._containerContents.append(this._labelIcon),this.icon=null!==(t=e.icon)&&void 0!==t?t:"E360",this._labelText=new j({class:ki}),this._containerContents.append(this._labelText),this.allowSelect=null===(i=e.allowSelect)||void 0===i||i,this.allowDrop=null===(n=e.allowDrop)||void 0===n||n,this.allowDrag=null===(s=e.allowDrag)||void 0===s||s,e.text&&(this.text=e.text),e.selected&&(this.selected=e.selected);const o=this._containerContents.dom;o.addEventListener("focus",this._onContentFocus),o.addEventListener("blur",this._onContentBlur),o.addEventListener("keydown",this._onContentKeyDown),o.addEventListener("dragstart",this._onContentDragStart),o.addEventListener("mousedown",this._onContentMouseDown),o.addEventListener("mouseover",this._onContentMouseOver),o.addEventListener("click",this._onContentClick),o.addEventListener("dblclick",this._onContentDblClick),o.addEventListener("contextmenu",this._onContentContextMenu)}destroy(){if(this._destroyed)return;const e=this._containerContents.dom;e.removeEventListener("focus",this._onContentFocus),e.removeEventListener("blur",this._onContentBlur),e.removeEventListener("keydown",this._onContentKeyDown),e.removeEventListener("dragstart",this._onContentDragStart),e.removeEventListener("mousedown",this._onContentMouseDown),e.removeEventListener("mouseover",this._onContentMouseOver),e.removeEventListener("click",this._onContentClick),e.removeEventListener("dblclick",this._onContentDblClick),e.removeEventListener("contextmenu",this._onContentContextMenu),window.removeEventListener("mouseup",this._onContentMouseUp),super.destroy()}_onAppendChild(e){super._onAppendChild(e),e instanceof Mi&&(this._numChildren++,this._parent!==this._treeView&&this.class.remove(Ii),this._treeView&&this._treeView._onAppendTreeViewItem(e))}_onRemoveChild(e){e instanceof Mi&&(this._numChildren--,0===this._numChildren&&this.class.add(Ii),this._treeView&&this._treeView._onRemoveTreeViewItem(e)),super._onRemoveChild(e)}_dfs(e){e(this);let t=this.firstChild;for(;t;)t._dfs(e),t=t.nextSibling}rename(){this.class.add(Si);const e=new Ve({renderChanges:!1,value:this.text,class:S});e.on("blur",(()=>{e.destroy()})),e.on("destroy",(()=>{this.class.remove(Si),this.focus()})),e.on("change",(t=>{(t=t.trim())&&(this.text=t,e.destroy())})),e.on("disable",(()=>{e.input.removeAttribute("readonly")})),this._containerContents.append(e),e.focus(!0)}focus(){this._containerContents.dom.focus()}blur(){this._containerContents.dom.blur()}set selected(e){e!==this.selected?e?(this._containerContents.class.add(Ai),this.emit("select",this),this._treeView&&this._treeView._onChildSelected(this),this.focus()):(this._containerContents.class.remove(Ai),this.blur(),this.emit("deselect",this),this._treeView&&this._treeView._onChildDeselected(this)):e&&this.focus()}get selected(){return this._containerContents.class.contains(Ai)}set text(e){this._labelText.value!==e&&(this._labelText.value=e,this._treeView&&this._treeView._onChildRename(this,e))}get text(){return this._labelText.value}get textLabel(){return this._labelText}get iconLabel(){return this._labelIcon}set open(e){if(this.open!==e)if(e){if(!this.numChildren)return;this.class.add(Ei),this.emit("open",this)}else this.class.remove(Ei),this.emit("close",this)}get open(){return this.class.contains(Ei)||this.parent===this._treeView}set parentsOpen(e){let t=this.parent;for(;t&&t instanceof Mi;)t.open=e,t=t.parent}get parentsOpen(){let e=this.parent;for(;e&&e instanceof Mi;){if(!e.open)return!1;e=e.parent}return!0}set allowDrop(e){this._allowDrop=e}get allowDrop(){return this._allowDrop}set allowDrag(e){this._allowDrag=e}get allowDrag(){return this._allowDrag}set allowSelect(e){this._allowSelect=e}get allowSelect(){return this._allowSelect}set treeView(e){this._treeView=e}get treeView(){return this._treeView}get numChildren(){return this._numChildren}get firstChild(){if(this._numChildren)for(const e of this.dom.childNodes)if(e.ui instanceof Mi)return e.ui;return null}get lastChild(){if(this._numChildren)for(let e=this.dom.childNodes.length-1;e>=0;e--)if(this.dom.childNodes[e].ui instanceof Mi)return this.dom.childNodes[e].ui;return null}get nextSibling(){let e=this.dom.nextSibling;for(;e&&!(e.ui instanceof Mi);)e=e.nextSibling;return e&&e.ui}get previousSibling(){let e=this.dom.previousSibling;for(;e&&!(e.ui instanceof Mi);)e=e.previousSibling;return e&&e.ui}set icon(e){this._icon!==e&&e.match(/^E[0-9]{0,4}$/)&&(this._icon=e,e?this._labelIcon.dom.setAttribute("data-icon",String.fromCodePoint(parseInt(e,16))):this._labelIcon.dom.removeAttribute("data-icon"))}get icon(){return this._icon}}Mi.EVENT_SELECT="select",Mi.EVENT_DESELECT="deselect",Mi.EVENT_OPEN="open",Mi.EVENT_CLOSE="close";var zi=Mi;const Oi="pcui-treeview",Hi=Oi+"-item-dragged",Ri=Oi+"-drag-handle",Di=Oi+"-filtering",Vi=Di+"-result",Pi="inside",Li="before",Ui="after";class Ni extends F{constructor(e={}){var t,i,n;super(e),this._selectedItems=[],this._dragItems=[],this._dragging=!1,this._dragOverItem=null,this._dragArea=Pi,this._dragScroll=0,this._dragScrollInterval=null,this._pressedCtrl=!1,this._pressedShift=!1,this._filter=null,this._filterResults=[],this._updateModifierKeys=e=>{this._pressedCtrl=e.ctrlKey||e.metaKey,this._pressedShift=e.shiftKey},this._onMouseLeave=e=>{this._allowDrag&&this._dragging&&(this._dragOverItem=null,this._updateDragHandle())},this._onMouseMove=e=>{if(!this._dragging)return;const t=this.dom.getBoundingClientRect();this._dragScroll=0;let i=t.top,n=t.bottom;if(this._dragScrollElement!==this){const e=this._dragScrollElement.dom.getBoundingClientRect();i=Math.max(i+this._dragScrollElement.dom.scrollTop,e.top),n=Math.min(n+this._dragScrollElement.dom.scrollTop,e.bottom)}i=Math.max(0,i),n=Math.min(n,document.body.clientHeight),e.pageY<i+32&&this._dragScrollElement.dom.scrollTop>0?this._dragScroll=-1:e.pageY>n-32&&this._dragScrollElement.dom.scrollHeight>this._dragScrollElement.height+this._dragScrollElement.dom.scrollTop&&(this._dragScroll=1)},this._onDragMove=e=>{if(e.preventDefault(),e.stopPropagation(),!this._allowDrag||!this._dragOverItem)return;const t=this._dragHandle.dom.getBoundingClientRect(),i=Math.floor((e.clientY-t.top)/t.height*5),n=this._dragArea,s=this._dragOverItem;if(this._dragOverItem.parent===this){let e=!1;for(let t=0;t<this._dragItems.length;t++)if(this._dragItems[t].parent===this._dragOverItem){e=!0,this._dragOverItem=null;break}e||(this._dragArea=Pi)}else{let e=!1;for(let t=0;t<this._dragItems.length;t++)if(this._dragItems[t].dom.contains(this._dragOverItem.dom)){e=!0;break}if(e)this._dragOverItem=null;else if(this._allowReordering&&i<=1&&-1===this._dragItems.indexOf(this._dragOverItem.previousSibling))this._dragArea=Li;else if(this._allowReordering&&i>=4&&-1===this._dragItems.indexOf(this._dragOverItem.nextSibling)&&(0===this._dragOverItem.numChildren||!this._dragOverItem.open))this._dragArea=Ui;else{let e=!1;if(this._allowReordering&&this._dragOverItem.open)for(let t=0;t<this._dragItems.length;t++)if(this._dragItems[t].parent===this._dragOverItem){e=!0,this._dragArea=Li;break}e||(this._dragArea=Pi)}}n===this._dragArea&&s===this._dragOverItem||this._updateDragHandle()},this.class.add(Oi),this._allowDrag=null===(t=e.allowDrag)||void 0===t||t,this._allowReordering=null===(i=e.allowReordering)||void 0===i||i,this._allowRenaming=null!==(n=e.allowRenaming)&&void 0!==n&&n,this._dragHandle=new R({class:Ri}),this._dragScrollElement=e.dragScrollElement||this,this.append(this._dragHandle),this._onContextMenu=e.onContextMenu,this._onReparentFn=e.onReparent,this._wasDraggingAllowedBeforeFiltering=this._allowDrag,window.addEventListener("keydown",this._updateModifierKeys),window.addEventListener("keyup",this._updateModifierKeys),window.addEventListener("mousedown",this._updateModifierKeys),this.dom.addEventListener("mouseleave",this._onMouseLeave),this._dragHandle.dom.addEventListener("mousemove",this._onDragMove),this._dragHandle.on("destroy",(e=>{e.removeEventListener("mousemove",this._onDragMove)}))}destroy(){this._destroyed||(window.removeEventListener("keydown",this._updateModifierKeys),window.removeEventListener("keyup",this._updateModifierKeys),window.removeEventListener("mousedown",this._updateModifierKeys),window.removeEventListener("mousemove",this._onMouseMove),this.dom.removeEventListener("mouseleave",this._onMouseLeave),this._dragScrollInterval&&(window.clearInterval(this._dragScrollInterval),this._dragScrollInterval=null),super.destroy())}_findNextVisibleTreeItem(e){if(e.numChildren>0&&e.open)return e.firstChild;const t=e.nextSibling;if(t)return t;let i=e.parent;if(!(i instanceof zi))return null;let n=i.nextSibling;for(;!n&&(i=i.parent,i instanceof zi);)n=i.nextSibling;return n}_findLastVisibleChildTreeItem(e){if(!e.numChildren||!e.open)return null;let t=e.lastChild;for(;t&&t.numChildren&&t.open;)t=t.lastChild;return t}_findPreviousVisibleTreeItem(e){const t=e.previousSibling;if(t)return t.numChildren>0&&t.open?this._findLastVisibleChildTreeItem(t):t;const i=e.parent;return i instanceof zi?i:null}_getChildrenRange(e,t){const i=[];if(this._filterResults.length){const n=this.dom.querySelectorAll(`.${Oi}-item.${Vi}`);let s=-1,o=-1;for(let r=0;r<n.length;r++){const l=n[r].ui;if(l===e?s=r:l===t&&(o=r),-1!==s&&-1!==o){const e=s<o?o:s;for(let t=s<o?s:o;t<=e;t++)i.push(n[t].ui);break}}}else{let n=e;const s=e.dom.getBoundingClientRect(),o=t.dom.getBoundingClientRect();if(s.top<o.top)for(;n&&n!==t;)n=this._findNextVisibleTreeItem(n),n&&n!==t&&i.push(n);else for(;n&&n!==t;)n=this._findPreviousVisibleTreeItem(n),n&&n!==t&&i.push(n);i.push(t)}return i}_onAppendChild(e){super._onAppendChild(e),e instanceof zi&&this._onAppendTreeViewItem(e)}_onRemoveChild(e){e instanceof zi&&this._onRemoveTreeViewItem(e),super._onRemoveChild(e)}_onAppendTreeViewItem(e){e.treeView=this,this._filter&&this._searchItems([[e.text,e]],this._filter),e.forEachChild((e=>{e instanceof zi&&this._onAppendTreeViewItem(e)}))}_onRemoveTreeViewItem(e){e.selected=!1,e.forEachChild((e=>{e instanceof zi&&this._onRemoveTreeViewItem(e)}))}_onChildKeyDown(e,t){if(-1!==["Tab","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].indexOf(e.key))if(e.preventDefault(),e.stopPropagation(),"ArrowDown"===e.key){if(this._selectedItems.length){const e=this._findNextVisibleTreeItem(t);e&&(this._pressedShift||this._pressedCtrl?e.selected=!0:this._selectSingleItem(e))}}else if("ArrowUp"===e.key){if(this._selectedItems.length){const e=this._findPreviousVisibleTreeItem(t);e&&(this._pressedShift||this._pressedCtrl?e.selected=!0:this._selectSingleItem(e))}}else"ArrowLeft"===e.key?t.parent!==this&&(t.open=!1):"ArrowRight"===e.key&&(t.open=!0)}_onChildClick(e,t){if(0===e.button&&t.allowSelect)if(this._pressedCtrl)t.selected=!t.selected;else if(this._pressedShift){if(!this._selectedItems.length||1===this._selectedItems.length&&this._selectedItems[0]===t)return void(t.selected=!0);const e=this._selectedItems[this._selectedItems.length-1];this._openHierarchy(e),this._getChildrenRange(e,t).forEach((e=>{e.allowSelect&&(e.selected=!0)}))}else this._selectSingleItem(t)}_traverseDepthFirst(e){function t(i){if(i&&i instanceof zi&&(e(i),i.numChildren))for(const e of i.dom.childNodes)t(e.ui)}for(const e of this.dom.childNodes)t(e.ui)}_getTreeOrder(){const e=new Map;let t=0;return this._traverseDepthFirst((i=>{e.set(i,t++)})),e}_getChildIndex(e,t){return Array.prototype.indexOf.call(t.dom.childNodes,e.dom)-1}_onChildDragStart(e,t){if(this.allowDrag&&!this._dragging){if(this._dragItems=[],-1!==this._selectedItems.indexOf(t)){const e=[];let t=-1;for(let i=0;i<this._selectedItems.length;i++){let n=this._selectedItems[i].parent,s=0,o=!1;for(;n&&n instanceof zi;){if(-1!==this._selectedItems.indexOf(n)){o=!0;break}s++,n=n.parent}if(!o){if(-1===t)t=s;else if(t!==s)return;e.push(this._selectedItems[i])}}this._dragItems=e}else t.class.add(Hi),this._dragItems.push(t);this._dragItems.length&&(this._dragItems.forEach((e=>{e.class.add(Hi)})),this.isDragging=!0,this.emit("dragstart",this._dragItems.slice()))}}_onChildDragEnd(e,t){if(!this.allowDrag||!this._dragging)return;this._dragItems.forEach((e=>e.class.remove(Hi)));let i=!1;for(let e=0;e<this._dragItems.length;e++)if(this._dragItems[e].parent===this){i=!0;break}if(!i&&this._dragOverItem){if(this._dragItems.length>1){const e=this._getTreeOrder();this._dragItems.sort(((t,i)=>e.get(t)-e.get(i)))}if(this._dragItems.length){const e=[];if(this._onReparentFn){const t=[],i=e=>{let i=t.findIndex((t=>t.parent===e));return-1===i&&(t.push({parent:e,children:[...e.dom.childNodes]}),i=t.length-1),t[i].children};this._dragItems.forEach((t=>{if(t.parent===this._dragOverItem&&this._dragArea===Pi)return;e.push({item:t,oldParent:t.parent});const n=i(t.parent),s=n.indexOf(t.dom);n.splice(s,1)})),e.forEach(((t,n)=>{if(this._dragArea===Li){t.newParent=this._dragOverItem.parent;const e=i(this._dragOverItem.parent),n=e.indexOf(this._dragOverItem.dom);e.splice(n,0,t.item.dom),t.newChildIndex=n}else if(this._dragArea===Pi){t.newParent=this._dragOverItem;const e=i(this._dragOverItem);e.push(t.item.dom),t.newChildIndex=e.length-1}else if(this._dragArea===Ui){t.newParent=this._dragOverItem.parent;const s=i(this._dragOverItem.parent),o=n>0?e[n-1].item:this._dragOverItem,r=s.indexOf(o.dom);s.splice(r+1,0,t.item.dom),t.newChildIndex=r+1}t.newChildIndex--}))}else this._dragItems.forEach((t=>{t.parent===this._dragOverItem&&this._dragArea===Pi||(e.push({item:t,oldParent:t.parent}),t.parent.remove(t))})),e.forEach(((t,i)=>{this._dragArea===Li?(t.newParent=this._dragOverItem.parent,t.newParent.appendBefore(t.item,this._dragOverItem),t.newChildIndex=this._getChildIndex(t.item,t.newParent)):this._dragArea===Pi?(t.newParent=this._dragOverItem,t.newParent.append(t.item),t.newParent.open=!0,t.newChildIndex=this._getChildIndex(t.item,t.newParent)):this._dragArea===Ui&&(t.newParent=this._dragOverItem.parent,t.newParent.appendAfter(t.item,i>0?e[i-1].item:this._dragOverItem),t.newChildIndex=this._getChildIndex(t.item,t.newParent))}));e.length&&(this._onReparentFn&&this._onReparentFn(e),this.emit("reparent",e))}}this._dragItems=[],this.isDragging=!1,this.emit("dragend")}_onChildDragOver(e,t){this._allowDrag&&this._dragging&&(t.allowDrop&&-1===this._dragItems.indexOf(t)?this._dragOverItem=t:this._dragOverItem=null,this._updateDragHandle(),this._onDragMove(e))}_scrollWhileDragging(){this._dragging&&0!==this._dragScroll&&(this._dragScrollElement.dom.scrollTop+=8*this._dragScroll,this._dragOverItem=null,this._updateDragHandle())}_updateDragHandle(e,t){if(t||this._allowDrag&&this._dragging)if(e||(e=this._dragOverItem),e&&!e.hidden&&e.parentsOpen){const t=e._containerContents.dom.getBoundingClientRect();this._dragHandle.hidden=!1,this._dragHandle.class.remove(Ui,Li,Pi),this._dragHandle.class.add(this._dragArea);const i=t.top;let n=t.left,s=t.width;if(this.dom.parentElement){const e=this.dom.parentElement.getBoundingClientRect();n=Math.max(n,e.left),s=Math.min(s,this.dom.parentElement.clientWidth-n+e.left)}this._dragHandle.style.top=i+"px",this._dragHandle.style.left=n+"px",this._dragHandle.style.width=s-7+"px"}else this._dragHandle.hidden=!0}_openHierarchy(e){e.parentsOpen=!0}_selectSingleItem(e){let t=this._selectedItems.length,i=!1;for(;t--;)this._selectedItems[t]&&this._selectedItems[t]!==e&&(this._selectedItems[t].selected=!1,i=!0);e.selected=!!i||!e.selected}_onChildSelected(e){this._selectedItems.push(e),this._openHierarchy(e),this.emit("select",e)}_onChildDeselected(e){const t=this._selectedItems.indexOf(e);-1!==t&&(this._selectedItems.splice(t,1),this.emit("deselect",e))}_onChildRename(e,t){if(this._filter){e.class.remove(Vi);const t=this._filterResults.indexOf(e);-1!==t&&this._filterResults.splice(t,1),this._searchItems([[e.text,e]],this._filter)}this.emit("rename",e,t)}_searchItems(e,t){const i=Xe(e,t);i.length&&i.forEach((e=>{this._filterResults.push(e),e.class.add(Vi)}))}_applyFilter(e){this._clearFilter(),this._wasDraggingAllowedBeforeFiltering=this._allowDrag,this._allowDrag=!1,this.class.add(Di);const t=[];this._traverseDepthFirst((e=>{t.push([e.text,e])})),this._searchItems(t,e)}_clearFilter(){this._filterResults.forEach((e=>{e.destroyed||e.class.remove(Vi)})),this._filterResults.length=0,this.class.remove(Di),this._allowDrag=this._wasDraggingAllowedBeforeFiltering}showDragHandle(e){this._updateDragHandle(e,!0)}deselect(){let e=this._selectedItems.length;for(;e--;)this._selectedItems[e]&&(this._selectedItems[e].selected=!1)}clearTreeItems(){let e=this.dom.childNodes.length;for(;e--;){const t=this.dom.childNodes[e];if(!t)continue;const i=t.ui;i instanceof zi&&i.destroy()}this._selectedItems=[],this._dragItems=[],this._allowDrag=this._wasDraggingAllowedBeforeFiltering}set allowDrag(e){this._allowDrag=e,this._filter&&(this._wasDraggingAllowedBeforeFiltering=e)}get allowDrag(){return this._allowDrag}set allowReordering(e){this._allowReordering=e}get allowReordering(){return this._allowReordering}set allowRenaming(e){this._allowRenaming=e}get allowRenaming(){return this._allowRenaming}set isDragging(e){this._dragging!==e&&(e?(this._dragging=!0,this._updateDragHandle(),(this.scrollable||this._dragScrollElement!==this)&&(window.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("mousemove",this._onMouseMove),this._dragScrollInterval||(this._dragScrollInterval=window.setInterval((()=>{this._scrollWhileDragging()}),1e3/60)))):(this._dragOverItem=null,this._updateDragHandle(),this._dragging=!1,window.removeEventListener("mousemove",this._onMouseMove),this._dragScrollInterval&&(window.clearInterval(this._dragScrollInterval),this._dragScrollInterval=null)))}get isDragging(){return this._dragging}get selected(){return this._selectedItems.slice()}set filter(e){this._filter!==e&&(this._filter=e,e?this._applyFilter(e):this._clearFilter())}get filter(){return this._filter}get pressedCtrl(){return this._pressedCtrl}get pressedShift(){return this._pressedShift}}Ni.EVENT_DRAGSTART="dragstart",Ni.EVENT_DRAGEND="dragend",Ni.EVENT_REPARENT="reparent",Ni.EVENT_SELECT="select",Ni.EVENT_DESELECT="deselect",Ni.EVENT_RENAME="rename";var Fi=Ni;class Bi extends R{constructor(e={}){var t,i,n;const s=Object.assign({},e);delete s.binding,super(s),this._inputs=[],this._applyingChange=!1,this.class.add("pcui-vector-input");const o=Math.max(2,Math.min(4,null!==(t=e.dimensions)&&void 0!==t?t:3));for(let t=0;t<o;t++){const s=new ae({min:e.min,max:e.max,precision:null!==(i=e.precision)&&void 0!==i?i:7,step:null!==(n=e.step)&&void 0!==n?n:1,stepPrecision:e.stepPrecision,renderChanges:e.renderChanges,placeholder:e.placeholder?Array.isArray(e.placeholder)?e.placeholder[t]:e.placeholder:null});s.on("change",(()=>{this._onInputChange()})),s.on("focus",(()=>{this.emit("focus")})),s.on("blur",(()=>{this.emit("blur")})),this.dom.appendChild(s.dom),s.parent=this,this._inputs.push(s)}e.binding&&(this.binding=e.binding),void 0!==e.value&&(this.value=e.value)}_onInputChange(){this._applyingChange||(this._inputs.some((e=>e.class.contains(A)))?this.class.add(A):this.class.remove(A),this.emit("change",this.value))}_updateValue(e){return this.class.remove(A),JSON.stringify(this.value)!==JSON.stringify(e)&&(this._applyingChange=!0,this._inputs.forEach(((t,i)=>{const n=t.binding;let s=!1;n&&(s=n.applyingChange,n.applyingChange=!0),t.value=e&&void 0!==e[i]?e[i]:null,n&&(n.applyingChange=s)})),this.emit("change",this.value),this._applyingChange=!1,!0)}link(e,t){if(super.link(e,t),e=Array.isArray(e)?e:[e],1===(t=Array.isArray(t)?t:[t]).length||e.length!==t.length)for(let i=0;i<this._inputs.length;i++)this._inputs[i].link(e,t[0]+`.${i}`);else for(let i=0;i<this._inputs.length;i++)this._inputs[i].link(e,t.map((e=>`${e}.${i}`)))}unlink(){super.unlink();for(const e of this._inputs)e.unlink()}focus(){this._inputs[0].focus()}blur(){for(const e of this._inputs)e.blur()}set value(e){if("string"==typeof e)try{if(e=JSON.parse(e),Array.isArray(e)&&e.some((e=>!Number.isFinite(e))))throw new Error("VectorInput value set to string which doesn't contain an array of numbers")}catch(t){console.error(t),e=[]}Array.isArray(e)||(e=[]),this._updateValue(e)&&this._binding&&this._binding.setValue(e)}get value(){return this._inputs.map((e=>e.value))}set values(e){e=this._inputs.map(((t,i)=>e.map((e=>e?e[i]:void 0)))),this._inputs.forEach(((t,i)=>{t.values=e[i]}))}set binding(e){super.binding=e;for(const t of this._inputs)t.binding=e?e.clone():null}get binding(){return super.binding}set placeholder(e){for(let t=0;t<this._inputs.length;t++)this._inputs[t].placeholder=e[t]||e||null}get placeholder(){return this._inputs.map((e=>e.placeholder))}get inputs(){return this._inputs.slice()}set renderChanges(e){for(const t of this._inputs)t.renderChanges=e}get renderChanges(){return this._inputs[0].renderChanges}set min(e){for(const t of this._inputs)t.min=e}get min(){return this._inputs[0].min}set max(e){for(const t of this._inputs)t.max=e}get max(){return this._inputs[0].max}set precision(e){for(const t of this._inputs)t.precision=e}get precision(){return this._inputs[0].precision}set step(e){for(const t of this._inputs)t.step=e}get step(){return this._inputs[0].step}}R.register("vec2",Bi,{dimensions:2,renderChanges:!0}),R.register("vec3",Bi,{dimensions:3,renderChanges:!0}),R.register("vec4",Bi,{dimensions:4,renderChanges:!0});var ji=Bi;const qi="4.0.11",Wi="7d89890";!function(e){if("undefined"==typeof window)return;const t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t)}('@charset "UTF-8";\n@font-face {\n  font-family: pc-icon;\n  src: url("data:application/font-woff;charset=utf-7;base64,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") format("woff");\n  font-weight: normal;\n  font-style: normal;\n}\n.font-icon, .pcui-menu-item-content > .pcui-label[data-icon]::before, .pcui-menu-item-has-children > .pcui-menu-item-content > .pcui-label::after, .pcui-treeview-item:not(.pcui-treeview-item-empty) > .pcui-treeview-item-contents::before, .pcui-treeview-item-icon::after, .pcui-select-input-create-new > .pcui-label:last-child::before, .pcui-container.pcui-select-input-list .pcui-label.pcui-selected::after, .pcui-label.pcui-select-input-disabled-value::after, .pcui-label.pcui-select-input-icon::after, .pcui-infobox[data-icon]:not(.pcui-hidden)::before, .pcui-panel.pcui-collapsible > .pcui-panel-header::before, .picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .delete-curve-button::after, .picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .paste-curve-button::after, .picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .copy-curve-button::after, .picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .pcui-button, .pcui-button[data-icon]::before, .pcui-boolean-input.pcui-boolean-input-ticked::after {\n  font-family: pc-icon;\n}\n\n.font-thin {\n  font-weight: 100;\n  font-style: normal;\n}\n\n.font-light {\n  font-weight: 200;\n  font-style: normal;\n}\n\n.font-regular, .pcui-element {\n  font-weight: normal;\n  font-style: normal;\n}\n\n.font-bold {\n  font-weight: bold;\n  font-style: normal;\n}\n\n.fixed-font, .pcui-select-input-tag > .pcui-label, .pcui-container.pcui-select-input-list .pcui-label, .pcui-select-input-value, .pcui-label.pcui-multiple-values::before, .pcui-text-area-input > textarea, .pcui-input-element.pcui-multiple-values::before, .pcui-input-element > input {\n  font-family: inconsolatamedium, Monaco, Menlo, "Ubuntu Mono", Consolas, source-code-pro, monospace;\n  font-weight: normal;\n  font-size: 12px;\n}\n\n.pcui-no-select, .pcui-treeview, .pcui-overlay-inner, .picker-color > .pcui-overlay-content > .pick-opacity, .picker-color > .pcui-overlay-content > .pick-hue, .picker-color > .pcui-overlay-content > .pick-rect, .pcui-color-input, .pcui-canvas, .pcui-button, .pcui-label.pcui-selectable:hover, .pcui-slider {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n          user-select: none;\n}\n\n.pcui-flex, .pcui-gridview-radio-container, .pcui-gridview-item, .pcui-gridview-vertical, .pcui-gridview, .pcui-label-group, .pcui-select-input-container-value, .pcui-select-input, .pcui-overlay, .pcui-panel-header > .pcui-panel-sortable-icon, .pcui-vector-input {\n  flex-direction: column;\n}\n.pcui-flex:not(.pcui-hidden), .pcui-gridview-radio-container:not(.pcui-hidden), .pcui-gridview-item:not(.pcui-hidden), .pcui-gridview-vertical:not(.pcui-hidden), .pcui-gridview:not(.pcui-hidden), .pcui-label-group:not(.pcui-hidden), .pcui-select-input-container-value:not(.pcui-hidden), .pcui-select-input:not(.pcui-hidden), .pcui-overlay:not(.pcui-hidden), .pcui-panel-header > .pcui-panel-sortable-icon:not(.pcui-hidden), .pcui-vector-input:not(.pcui-hidden) {\n  display: flex;\n}\n\n.pcui-grid {\n  display: grid;\n}\n\n.pcui-scrollable {\n  overflow: auto;\n}\n\n@-webkit-keyframes pcui-flash-animation {\n  from {\n    outline-color: #f60;\n  }\n  to {\n    outline-color: rgba(255, 102, 0, 0);\n  }\n}\n\n@keyframes pcui-flash-animation {\n  from {\n    outline-color: #f60;\n  }\n  to {\n    outline-color: rgba(255, 102, 0, 0);\n  }\n}\n.pcui-element {\n  border: 0 solid #232e30;\n}\n.pcui-element.flash {\n  outline: 1px solid #f60;\n  -webkit-animation: pcui-flash-animation 200ms ease-in-out forwards;\n          animation: pcui-flash-animation 200ms ease-in-out forwards;\n}\n.pcui-element:focus {\n  outline: none;\n}\n.pcui-element::-moz-focus-inner {\n  border: 0;\n}\n\n.pcui-element.pcui-hidden {\n  display: none;\n}\n\n.pcui-input-element {\n  display: inline-block;\n  border: 1px solid #293538;\n  border-radius: 2px;\n  box-sizing: border-box;\n  margin: 6px;\n  min-height: 24px;\n  height: 24px;\n  background-color: #2c393c;\n  vertical-align: top;\n  transition: color 100ms, background-color 100ms, box-shadow 100ms;\n  position: relative;\n  color: #b1b8ba;\n}\n.pcui-input-element > input {\n  height: 100%;\n  width: calc(100% - 16px);\n  padding: 0 6px;\n  line-height: 1;\n  color: inherit;\n  background: transparent;\n  border: none;\n  outline: none;\n  box-shadow: none;\n}\n.pcui-input-element::before {\n  color: inherit;\n}\n\n.pcui-input-element.pcui-multiple-values::before {\n  position: absolute;\n  padding: 0 8px;\n  content: "...";\n  white-space: nowrap;\n  top: 5px;\n  font-size: 12px;\n}\n\n.pcui-input-element:not(.pcui-disabled, .pcui-readonly):hover {\n  background-color: #293538;\n  color: #fff;\n}\n.pcui-input-element:not(.pcui-disabled, .pcui-readonly):not(.pcui-error):hover {\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-input-element:not(.pcui-disabled, .pcui-readonly).pcui-focus {\n  background-color: #20292b;\n  box-shadow: 0 0 0 1px rgba(255, 102, 0, 0.3);\n}\n\n.pcui-input-element.pcui-focus::after, .pcui-input-element.pcui-focus::before, .pcui-input-element:hover::after, .pcui-input-element:hover::before {\n  display: none;\n}\n\n.pcui-input-element.pcui-readonly {\n  background-color: rgba(44, 57, 60, 0.7);\n  border-color: transparent;\n}\n\n.pcui-input-element.pcui-disabled {\n  color: #5b7073;\n}\n\n.pcui-input-element.pcui-error {\n  color: #b1b8ba;\n  box-shadow: 0 0 0 1px #d34141;\n}\n\n.pcui-input-element[placeholder] {\n  position: relative;\n}\n.pcui-input-element[placeholder]::after {\n  content: attr(placeholder);\n  background-color: #2c393c;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 0 8px;\n  line-height: 22px;\n  font-size: 10px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #829193;\n  pointer-events: none;\n}\n\n.pcui-text-area-input {\n  min-height: 48px;\n  height: auto;\n}\n.pcui-text-area-input > textarea {\n  resize: none;\n  height: 100%;\n  width: calc(100% - 16px);\n  padding: 0 8px;\n  line-height: 22px;\n  color: inherit;\n  background: transparent;\n  border: none;\n  outline: none;\n  box-shadow: none;\n  min-height: 44px;\n  min-width: 172px;\n}\n\n.pcui-text-area-input.pcui-text-area-input-resizable-none > textarea {\n  resize: none;\n}\n\n.pcui-text-area-input.pcui-text-area-input-resizable-both > textarea {\n  resize: both;\n}\n\n.pcui-text-area-input.pcui-text-area-input-resizable-horizontal > textarea {\n  resize: horizontal;\n}\n\n.pcui-text-area-input.pcui-text-area-input-resizable-vertical > textarea {\n  resize: vertical;\n}\n\n.pcui-numeric-input-slider-control {\n  display: none;\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  right: 3px;\n  border: 2px solid #20292b;\n  background-color: #293538;\n  border-radius: 100px;\n  z-index: 9999;\n  -webkit-transform: translateY(-50%);\n          transform: translateY(-50%);\n  top: 50%;\n  cursor: ew-resize;\n}\n\n.pcui-numeric-input-slider-control::after {\n  content: "\\e408";\n  font-size: 15px;\n  font-family: pc-icon;\n  position: absolute;\n  left: -5px;\n  top: -5px;\n  -webkit-transform: rotateZ(90deg);\n          transform: rotateZ(90deg);\n}\n\n.pcui-numeric-input-slider-control:hover {\n  opacity: 0.5;\n  color: #b1b8ba;\n}\n\n.pcui-numeric-input-slider-control-active {\n  opacity: 1 !important;\n  color: #7f7 !important;\n}\n\n.pcui-numeric-input-slider-control-hidden {\n  display: none !important;\n}\n\n.pcui-numeric-input:hover .pcui-numeric-input-slider-control {\n  display: block;\n}\n\n.pcui-numeric-input.pcui-disabled:hover .pcui-numeric-input-slider-control {\n  display: none;\n}\n\n.pcui-numeric-input.pcui-disabled .pcui-numeric-input-slider-control,\n.pcui-numeric-input.pcui-readonly .pcui-numeric-input-slider-control {\n  display: none;\n}\n\n.pcui-slider {\n  display: inline-flex;\n  height: 24px;\n  margin: 6px;\n  align-items: center;\n}\n.pcui-slider > .pcui-numeric-input {\n  flex: 1;\n  margin-left: 0;\n}\n\n.pcui-slider-container {\n  flex: 3;\n}\n\n.pcui-slider-bar {\n  position: relative;\n  width: calc(100% - 18px);\n  height: 4px;\n  margin: 9px 8px;\n  background-color: #2c393c;\n  border: 1px solid #293538;\n}\n\n.pcui-slider-handle {\n  position: absolute;\n  top: -7px;\n  left: 0;\n  margin-left: -9px;\n  width: 8px;\n  height: 16px;\n  background-color: #5b7073;\n  border: 1px solid #293538;\n  transition: left 100ms ease;\n}\n.pcui-slider-handle:hover, .pcui-slider-handle:focus {\n  outline: none;\n}\n\n.pcui-slider-active {\n  cursor: ew-resize;\n}\n.pcui-slider-active .pcui-slider-bar {\n  border-color: #20292b;\n  background-color: #20292b;\n}\n.pcui-slider-active .pcui-slider-handle {\n  border-color: #20292b;\n  background-color: #fff;\n  transition: none;\n}\n\n.pcui-slider:not(.pcui-disabled, .pcui-readonly):hover {\n  cursor: pointer;\n}\n.pcui-slider:not(.pcui-disabled, .pcui-readonly) .pcui-slider-handle:focus, .pcui-slider:not(.pcui-disabled, .pcui-readonly) .pcui-slider-handle:hover {\n  cursor: ew-resize;\n  outline: none;\n  border-color: #20292b;\n  background-color: #fff;\n}\n\n.pcui-slider.pcui-readonly .pcui-numeric-input {\n  flex: 1;\n}\n.pcui-slider.pcui-readonly .pcui-slider-bar {\n  display: none;\n}\n\n.pcui-slider.pcui-multiple-values .pcui-slider-handle {\n  display: none;\n}\n\n.pcui-vector-input {\n  flex-direction: row;\n  align-items: center;\n}\n.pcui-vector-input > .pcui-numeric-input {\n  flex: 1;\n  margin: 6px 3px;\n}\n.pcui-vector-input > .pcui-numeric-input:first-child {\n  margin-left: 0;\n}\n.pcui-vector-input > .pcui-numeric-input:last-child {\n  margin-right: 0;\n}\n\n.pcui-boolean-input {\n  display: inline-block;\n  position: relative;\n  box-sizing: border-box;\n  background-color: #2c393c;\n  color: #fff;\n  width: 14px;\n  height: 14px;\n  line-height: 1;\n  overflow: hidden;\n  margin: 6px;\n  transition: opacity 100ms, background-color 100ms, box-shadow 100ms;\n}\n.pcui-boolean-input:focus {\n  outline: none;\n}\n\n.pcui-boolean-input.pcui-boolean-input-ticked {\n  background-color: #b1b8ba;\n}\n.pcui-boolean-input.pcui-boolean-input-ticked::after {\n  content: "\\e372";\n  color: #20292b;\n  background-color: inherit;\n  font-size: 19px;\n  display: block;\n  margin-top: -2px;\n  margin-left: -2px;\n}\n\n.pcui-boolean-input:not(.pcui-disabled, .pcui-readonly):hover, .pcui-boolean-input:not(.pcui-disabled, .pcui-readonly):focus {\n  cursor: pointer;\n  background-color: #293538;\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-boolean-input:not(.pcui-disabled, .pcui-readonly).pcui-boolean-input-ticked:hover, .pcui-boolean-input:not(.pcui-disabled, .pcui-readonly).pcui-boolean-input-ticked:focus {\n  background-color: #b1b8ba;\n}\n\n.pcui-boolean-input.pcui-disabled {\n  opacity: 0.4;\n}\n\n.pcui-boolean-input.pcui-multiple-values::after {\n  position: absolute;\n  font-size: 17px;\n  font-weight: bold;\n  color: #b1b8ba;\n  left: 4px;\n  top: -3px;\n  content: "-";\n}\n\n.pcui-boolean-input-toggle {\n  display: inline-block;\n  position: relative;\n  width: 30px;\n  height: 16px;\n  border-radius: 8px;\n  flex-shrink: 0;\n  border: 1px solid #293538;\n  box-sizing: border-box;\n  background-color: #364346;\n  color: #fff;\n  line-height: 1;\n  overflow: hidden;\n  margin: 6px;\n  transition: opacity 100ms, background-color 100ms, box-shadow 100ms;\n}\n.pcui-boolean-input-toggle:focus {\n  outline: none;\n}\n.pcui-boolean-input-toggle::after {\n  content: " ";\n  position: absolute;\n  top: 1px;\n  left: 1px;\n  width: 12px;\n  height: 12px;\n  border-radius: 6px;\n  background-color: #5b7073;\n  transition: left 100ms ease, background-color 100ms ease;\n}\n\n.pcui-boolean-input-toggle.pcui-boolean-input-ticked {\n  border-color: #293538;\n}\n.pcui-boolean-input-toggle.pcui-boolean-input-ticked::after {\n  left: 15px;\n  background-color: #69b875;\n}\n\n.pcui-boolean-input-toggle:not(.pcui-disabled, .pcui-readonly):hover, .pcui-boolean-input-toggle:not(.pcui-disabled, .pcui-readonly):focus {\n  cursor: pointer;\n  border-color: #20292b;\n  background-color: #20292b;\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-boolean-input-toggle:not(.pcui-disabled, .pcui-readonly):hover::after, .pcui-boolean-input-toggle:not(.pcui-disabled, .pcui-readonly):focus::after {\n  background-color: #d34141;\n}\n.pcui-boolean-input-toggle:not(.pcui-disabled, .pcui-readonly).pcui-boolean-input-ticked:hover, .pcui-boolean-input-toggle:not(.pcui-disabled, .pcui-readonly).pcui-boolean-input-ticked:focus {\n  border-color: #20292b;\n  background-color: #20292b;\n}\n.pcui-boolean-input-toggle:not(.pcui-disabled, .pcui-readonly).pcui-boolean-input-ticked::after {\n  background-color: #7f7;\n}\n\n.pcui-boolean-input-toggle.pcui-readonly {\n  opacity: 0.7;\n}\n\n.pcui-boolean-input-toggle.pcui-disabled {\n  opacity: 0.4;\n}\n\n.pcui-boolean-input-toggle.pcui-multiple-values::after {\n  left: 8px;\n  background-color: rgba(155, 161, 163, 0.25);\n}\n\n.pcui-label {\n  display: inline-block;\n  box-sizing: border-box;\n  margin: 6px;\n  vertical-align: middle;\n  transition: opacity 100ms;\n  color: #b1b8ba;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  -webkit-user-select: none;\n          user-select: none;\n}\n\n.pcui-label.pcui-default-mousedown {\n  -webkit-user-select: initial;\n          user-select: initial;\n}\n\n.pcui-label.pcui-multiple-values {\n  position: relative;\n  color: transparent;\n}\n.pcui-label.pcui-multiple-values::before {\n  content: "...";\n  color: #b1b8ba;\n  white-space: nowrap;\n  font-size: 12px;\n}\n\n.pcui-label.pcui-error {\n  color: #d34141;\n}\n\n.pcui-label.pcui-selectable:hover {\n  color: #f60;\n  text-decoration: underline;\n}\n\n.pcui-label[placeholder] {\n  position: relative;\n}\n.pcui-label[placeholder]::after {\n  content: attr(placeholder);\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 0 8px;\n  color: #999;\n  pointer-events: none;\n}\n\n.pcui-button {\n  display: inline-block;\n  border: 1px solid #20292b;\n  border-radius: 2px;\n  box-sizing: border-box;\n  background-color: #2c393c;\n  color: #b1b8ba;\n  padding: 0 8px;\n  margin: 6px;\n  height: 28px;\n  line-height: 28px;\n  max-height: 100%;\n  vertical-align: middle;\n  font-size: 12px;\n  font-weight: 600;\n  text-align: center;\n  white-space: nowrap;\n  cursor: pointer;\n  transition: color 100ms, opacity 100ms, box-shadow 100ms;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.pcui-button[data-icon]::before {\n  content: attr(data-icon);\n  font-weight: 100;\n  font-size: inherit;\n  margin-right: 6px;\n  vertical-align: middle;\n}\n.pcui-button[data-icon]:empty::before {\n  margin-right: 0;\n}\n\n.pcui-button:not(.pcui-disabled, .pcui-readonly):hover, .pcui-button:not(.pcui-disabled, .pcui-readonly):focus {\n  color: #fff;\n  background-color: #2c393c;\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-button:not(.pcui-disabled, .pcui-readonly):active {\n  background-color: #20292b;\n  box-shadow: none;\n}\n\n.pcui-button.pcui-readonly {\n  opacity: 0.7;\n  cursor: default;\n}\n\n.pcui-button.pcui-disabled {\n  opacity: 0.4;\n  cursor: default;\n}\n\n.pcui-button.pcui-small {\n  height: 24px;\n  line-height: 24px;\n  font-size: 10px;\n}\n\n.pcui-code {\n  background: #20292b;\n  overflow: auto;\n}\n.pcui-code .pcui-code-inner {\n  color: #f60;\n  font-family: inconsolatamedium, Monaco, Menlo, "Ubuntu Mono", Consolas, source-code-pro, monospace;\n  font-weight: normal;\n  font-size: 10px;\n  white-space: pre;\n}\n\n.pcui-container {\n  position: relative;\n  min-width: 0;\n  min-height: 0;\n}\n\n.pcui-container.pcui-resizable > .pcui-resizable-handle {\n  position: absolute;\n  z-index: 1;\n  opacity: 0;\n  background-color: transparent;\n}\n.pcui-container.pcui-resizable > .pcui-resizable-handle:hover {\n  opacity: 1;\n}\n.pcui-container.pcui-resizable.pcui-resizable-resizing > .pcui-resizable-handle {\n  opacity: 1;\n}\n.pcui-container.pcui-resizable.pcui-resizable-left > .pcui-resizable-handle, .pcui-container.pcui-resizable.pcui-resizable-right > .pcui-resizable-handle {\n  top: 0;\n  bottom: 0;\n  width: 1px;\n  height: auto;\n  cursor: ew-resize;\n}\n.pcui-container.pcui-resizable.pcui-resizable-left > .pcui-resizable-handle {\n  left: 0;\n  border-left: 3px solid #20292b;\n}\n.pcui-container.pcui-resizable.pcui-resizable-right > .pcui-resizable-handle {\n  right: 0;\n  border-right: 3px solid #20292b;\n}\n.pcui-container.pcui-resizable.pcui-resizable-top > .pcui-resizable-handle, .pcui-container.pcui-resizable.pcui-resizable-bottom > .pcui-resizable-handle {\n  left: 0;\n  right: 0;\n  width: auto;\n  height: 1px;\n  cursor: ns-resize;\n}\n.pcui-container.pcui-resizable.pcui-resizable-top > .pcui-resizable-handle {\n  top: 0;\n  border-top: 3px solid #20292b;\n}\n.pcui-container.pcui-resizable.pcui-resizable-bottom > .pcui-resizable-handle {\n  bottom: 0;\n  border-bottom: 3px solid #20292b;\n}\n\n.pcui-container-dragged {\n  outline: 2px solid #fff;\n  box-sizing: border-box;\n  opacity: 0.7;\n  z-index: 1;\n}\n\n.pcui-container-dragged-child {\n  outline: 1px dotted #f60;\n  box-sizing: border-box;\n}\n\n.pcui-color-input {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n  width: 44px;\n  height: 24px;\n  margin: 6px;\n  vertical-align: top;\n  cursor: pointer;\n  transition: opacity 100ms;\n}\n.pcui-color-input > .pcui-overlay-clickable {\n  position: fixed;\n}\n.pcui-color-input > div {\n  position: absolute;\n  inset: 0;\n}\n.pcui-color-input::after {\n  content: " ";\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 0;\n  height: 0;\n  background-color: transparent;\n  border-bottom: 16px solid #293538;\n  border-left: 16px solid transparent;\n}\n\n.picker-color.c-1 > .pcui-overlay-content > .pick-opacity {\n  display: block;\n}\n.picker-color.c-1 > .pcui-overlay-content > .fields > .field-r {\n  display: block;\n}\n.picker-color.c-2 > .pcui-overlay-content > .fields > .field-hex {\n  display: block;\n}\n.picker-color.c-3 > .pcui-overlay-content {\n  width: 298px;\n}\n.picker-color.c-3 > .pcui-overlay-content > .pick-rect {\n  display: block;\n}\n.picker-color.c-3 > .pcui-overlay-content > .pick-hue {\n  display: block;\n}\n.picker-color.c-3 > .pcui-overlay-content > .pick-opacity {\n  display: none;\n}\n.picker-color.c-3 > .pcui-overlay-content > .fields > .field-g,\n.picker-color.c-3 > .pcui-overlay-content > .fields > .field-b {\n  display: block;\n}\n.picker-color.c-4 > .pcui-overlay-content {\n  width: 320px;\n}\n.picker-color.c-4 > .pcui-overlay-content > .pick-opacity {\n  display: block;\n}\n.picker-color.c-4 > .pcui-overlay-content > .fields > .field-a {\n  display: block;\n}\n.picker-color > .pcui-overlay-content {\n  border: 1px solid #000;\n  width: 320px;\n  height: 162px;\n  white-space: nowrap;\n  transition: none;\n}\n.picker-color > .pcui-overlay-content > .pick-rect {\n  position: relative;\n  display: none;\n  float: left;\n  width: 146px;\n  height: 146px;\n  border: 1px solid #000;\n  box-sizing: border-box;\n  margin: 8px 0 8px 8px;\n  background-color: #f00;\n  cursor: crosshair;\n}\n.picker-color > .pcui-overlay-content > .pick-rect > .white {\n  position: absolute;\n  width: 144px;\n  height: 144px;\n  top: 0;\n  left: 0;\n  background: linear-gradient(to right, rgb(255, 255, 255) 0%, rgba(255, 255, 255, 0.01) 100%);\n}\n.picker-color > .pcui-overlay-content > .pick-rect > .black {\n  position: absolute;\n  width: 144px;\n  height: 144px;\n  top: 0;\n  left: 0;\n  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.01) 0%, rgb(0, 0, 0) 100%);\n}\n.picker-color > .pcui-overlay-content > .pick-rect > .handle {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 12px;\n  height: 12px;\n  margin: -7px 0 0 -7px;\n  border: 1px solid #000;\n  outline: 1px solid #fff;\n}\n.picker-color > .pcui-overlay-content > .pick-hue {\n  position: relative;\n  display: none;\n  float: left;\n  width: 14px;\n  height: 146px;\n  margin: 8px 0 8px 8px;\n  border: 1px solid #000;\n  box-sizing: border-box;\n  cursor: crosshair;\n  background: #000;\n  background: linear-gradient(to bottom, rgb(255, 0, 0) 0%, rgb(255, 255, 0) 16.67%, rgb(0, 255, 0) 33.33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 66.67%, rgb(255, 0, 255) 83.33%, rgb(255, 0, 0) 100%);\n}\n.picker-color > .pcui-overlay-content > .pick-hue > .handle {\n  position: absolute;\n  top: 0;\n  left: -3px;\n  width: 16px;\n  height: 4px;\n  margin: -3px 0 0;\n  border: 1px solid #000;\n  outline: 1px solid #fff;\n}\n.picker-color > .pcui-overlay-content > .pick-opacity {\n  position: relative;\n  display: none;\n  float: left;\n  width: 12px;\n  height: 144px;\n  margin: 8px 0 8px 8px;\n  border: 1px solid #000;\n  cursor: crosshair;\n  background: #000;\n  background: linear-gradient(to bottom, #fff 0%, #000 100%);\n}\n.picker-color > .pcui-overlay-content > .pick-opacity > .handle {\n  position: absolute;\n  top: 0;\n  left: -3px;\n  width: 16px;\n  height: 4px;\n  margin: -3px 0 0;\n  border: 1px solid #000;\n  outline: 1px solid #fff;\n}\n.picker-color > .pcui-overlay-content > .fields {\n  float: left;\n  width: 106px;\n  height: 154px;\n  margin: 0 0 0 8px;\n  padding: 4px;\n}\n.picker-color > .pcui-overlay-content > .fields > .field {\n  display: none;\n  width: 100px;\n}\n\n.pcui-color-input.pcui-multiple-values > div {\n  display: none;\n}\n\n.pcui-color-input.pcui-readonly {\n  cursor: default;\n}\n.pcui-color-input.pcui-readonly::after {\n  display: none;\n}\n\n.pcui-color-input.pcui-disabled {\n  opacity: 0.4;\n  cursor: default;\n}\n\n.pcui-color-input:not(.pcui-disabled, .pcui-readonly):hover, .pcui-color-input:not(.pcui-disabled, .pcui-readonly):focus {\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-color-input:not(.pcui-disabled, .pcui-readonly):hover::after, .pcui-color-input:not(.pcui-disabled, .pcui-readonly):focus::after {\n  border-bottom-color: #20292b;\n}\n.pcui-color-input:not(.pcui-disabled, .pcui-readonly):active {\n  box-shadow: 0 0 0 1px rgba(255, 102, 0, 0.3);\n}\n\n.pcui-gradient {\n  display: inline-block;\n  flex: 1;\n  height: 24px;\n  box-sizing: border-box;\n  margin: 6px;\n  transition: opacity 100ms, box-shadow 100ms;\n  border: 1px solid #293538;\n  background-color: #2c393c;\n}\n.pcui-gradient > .pcui-canvas {\n  width: 100%;\n  height: 100%;\n  background-color: transparent;\n}\n\n.pcui-gradient.pcui-disabled,\n.pcui-gradient.pcui-multiple-values {\n  opacity: 0.4;\n}\n\n.pcui-gradient:not(.pcui-disabled, .pcui-readonly, .pcui-multiple-values):hover, .pcui-gradient:not(.pcui-disabled, .pcui-readonly, .pcui-multiple-values):focus {\n  cursor: pointer;\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-gradient:not(.pcui-disabled, .pcui-readonly, .pcui-multiple-values):active {\n  box-shadow: 0 0 0 1px rgba(255, 102, 0, 0.3);\n}\n\n.picker-gradient > .pcui-overlay-content {\n  width: 343px;\n  height: 262px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel {\n  height: 100%;\n  font-size: 11px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .show-selected-position {\n  position: absolute;\n  width: 18px;\n  min-height: 17px !important;\n  height: 17px !important;\n  top: 14px;\n  margin-top: 0;\n  margin-bottom: 0;\n  display: flex;\n  align-items: center;\n  text-align: center;\n  color: #9ba1a3;\n  background-color: #2c393c;\n  border-radius: 2px;\n  justify-content: center;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .show-selected-position > .show-selected-position-input {\n  width: inherit;\n  text-align: center;\n  justify-content: center;\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 22px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .anchor-crosshair {\n  position: absolute;\n  top: 41.5px;\n  pointer-events: none;\n  background: none;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .anchor-crosshair > .crosshair-bar {\n  background: #293538;\n  width: 1px;\n  height: 29px;\n  position: absolute;\n  top: -34px;\n  left: 8px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .anchor-crosshair > .show-crosshair-position {\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  font-family: inconsolatamedium, Monaco, Menlo, "Ubuntu Mono", Consolas, source-code-pro, monospace;\n  line-height: 22px;\n  position: absolute;\n  width: 18px;\n  min-height: 17px !important;\n  height: 17px !important;\n  top: 14px;\n  margin-top: 0;\n  margin-bottom: 0;\n  display: flex;\n  align-items: center;\n  text-align: center;\n  color: #9ba1a3;\n  background-color: #2c393c;\n  border-radius: 2px;\n  justify-content: center;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-gradient {\n  width: 321px;\n  height: 28px;\n  display: block;\n  padding: 8px 10px 0 11px;\n  background-color: #2c393c;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-gradient .crosshair-active {\n  cursor: none;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-anchors {\n  width: 320px;\n  height: 28px;\n  display: block;\n  padding: 0 10px 0 11px;\n  background-color: #2c393c;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer {\n  padding: 5px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-header {\n  display: none;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content {\n  display: flex;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .pcui-label {\n  align-self: center;\n  font-family: inherit;\n  font-style: normal;\n  font-weight: 600;\n  font-size: 12px;\n  line-height: 19px;\n  align-content: center;\n  height: 20px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .pcui-select-input {\n  align-self: center;\n  width: 162px;\n  height: 22px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .pcui-numeric-input {\n  align-self: center;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .pcui-button {\n  width: 22px;\n  height: 22px;\n  vertical-align: bottom;\n  margin: 0;\n  margin-right: 8px;\n  margin-top: 6px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .copy-curve-button {\n  border-color: #2c393c;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .copy-curve-button::after {\n  content: "\\e351";\n  position: absolute;\n  top: 4px;\n  left: 218px;\n  font-size: 15px;\n  text-align: center;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .paste-curve-button {\n  border-color: #2c393c;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .paste-curve-button::after {\n  content: "\\e348";\n  position: absolute;\n  top: 4px;\n  left: 248px;\n  font-size: 15px;\n  text-align: center;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .delete-curve-button {\n  border-color: #2c393c;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .picker-gradient-footer > .pcui-panel-content > .delete-curve-button::after {\n  content: "\\e125";\n  position: absolute;\n  top: 4px;\n  left: 278px;\n  font-size: 15px;\n  text-align: center;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel {\n  height: 156px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-header {\n  display: none;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .color-rect {\n  margin: 5px 10px 10px;\n  width: 140px;\n  height: 140px;\n  cursor: crosshair;\n  position: relative;\n  float: left;\n  border-width: 1px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .color-handle {\n  position: absolute;\n  width: 14px;\n  height: 14px;\n  border: 1px solid #000;\n  outline: 1px solid #fff;\n  pointer-events: none;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .hue-rect,\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .alpha-rect {\n  margin: 5px 10px 10px 0;\n  width: 20px;\n  height: 140px;\n  cursor: crosshair;\n  border-width: 1px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .hue-handle,\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .alpha-handle {\n  position: absolute;\n  width: 20px;\n  height: 4px;\n  border: 1px solid rgb(92, 82, 79);\n  outline: 1px solid #fff;\n  pointer-events: none;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .fields {\n  display: inline-block;\n  margin: 3px 0 0;\n  width: 112px;\n  height: 145px;\n  vertical-align: top;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .fields > .pcui-numeric-input {\n  margin: 2px 0;\n  width: 108px;\n}\n.picker-gradient > .pcui-overlay-content > .picker-gradient-panel > .color-panel > .pcui-panel-content > .fields > .pcui-text-input {\n  margin: 2px 0;\n  min-height: 22px;\n  min-width: 111px;\n}\n\n.pcui-panel {\n  background-color: #364346;\n}\n\n.pcui-panel-header {\n  background-color: #293538;\n  color: #fff;\n  font-size: 12px;\n  white-space: nowrap;\n  padding-left: 10px;\n  flex-shrink: 0;\n  align-items: center;\n}\n\n.pcui-panel-header-title {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 1;\n  color: inherit;\n  font-size: inherit;\n  white-space: inherit;\n  margin: 0 auto 0 0;\n}\n\n.pcui-panel-content {\n  flex: 1;\n}\n\n.pcui-panel.pcui-collapsible {\n  transition: height 100ms, width 100ms;\n}\n.pcui-panel.pcui-collapsible > .pcui-panel-header {\n  cursor: pointer;\n}\n.pcui-panel.pcui-collapsible > .pcui-panel-header::before {\n  left: 0;\n  content: "\\e179";\n  font-size: 14px;\n  margin-right: 10px;\n  text-align: center;\n  color: #f60;\n}\n.pcui-panel.pcui-collapsible > .pcui-panel-header:hover {\n  color: #fff;\n}\n.pcui-panel.pcui-collapsible > .pcui-panel-header:hover::before {\n  color: #fff;\n}\n.pcui-panel.pcui-collapsible.pcui-panel-normal > .pcui-panel-header::before {\n  content: "\\e183";\n  font-weight: 200;\n}\n.pcui-panel.pcui-collapsible > .pcui-panel-content {\n  transition: visibility 100ms;\n}\n.pcui-panel.pcui-collapsible.pcui-collapsed {\n  overflow: hidden;\n}\n.pcui-panel.pcui-collapsible.pcui-collapsed > .pcui-panel-content {\n  visibility: hidden;\n}\n.pcui-panel.pcui-collapsible.pcui-collapsed > .pcui-panel-header::before {\n  content: "\\e180";\n}\n.pcui-panel.pcui-collapsible.pcui-collapsed.pcui-panel-normal > .pcui-panel-header::before {\n  content: "\\e184";\n}\n.pcui-panel.pcui-collapsible.pcui-collapsed.pcui-panel-horizontal > .pcui-panel-header {\n  width: 2048px;\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n  -webkit-transform-origin: 0% 100%;\n          transform-origin: 0% 100%;\n}\n.pcui-panel.pcui-collapsible.pcui-collapsed.pcui-panel-horizontal > .pcui-panel-header::before {\n  content: "\\e177";\n}\n.pcui-panel.pcui-collapsible.pcui-collapsed.pcui-panel-horizontal.pcui-panel-normal > .pcui-panel-header::before {\n  content: "\\e181";\n}\n.pcui-panel.pcui-collapsible.pcui-collapsed.pcui-panel-horizontal > .pcui-panel-content {\n  transition: none;\n}\n\n.pcui-panel.pcui-resizable.pcui-collapsible.pcui-collapsed > .pcui-resizable-handle {\n  display: none;\n}\n.pcui-panel.pcui-resizable.pcui-resizable-resizing {\n  transition: none;\n}\n.pcui-panel.pcui-resizable.pcui-resizable-resizing > .pcui-panel-content {\n  transition: none;\n}\n\n.pcui-panel-header > .pcui-panel-sortable-icon {\n  color: #5b7073;\n  transition: color 100ms;\n  flex-direction: row;\n  align-items: center;\n  margin: 0 10px 0 0;\n  height: 100%;\n}\n.pcui-panel-header > .pcui-panel-sortable-icon::before {\n  content: " ";\n  border-left: 1px solid #364346;\n  margin-right: 10px;\n  height: calc(100% - 14px);\n  flex-shrink: 0;\n}\n.pcui-panel-header > .pcui-panel-sortable-icon::after {\n  content: ".. .. ..";\n  white-space: normal;\n  width: 12px;\n  line-height: 5px;\n  overflow: hidden;\n  height: 24px;\n  font-size: 22px;\n  letter-spacing: 1px;\n  flex-shrink: 0;\n}\n\n.pcui-panel:not(.pcui-disabled, .pcui-readonly) > .pcui-panel-header > .pcui-panel-sortable-icon:hover {\n  color: #fff;\n  cursor: move;\n}\n\n.pcui-panel:not(.pcui-collapsible) > .pcui-panel-header > .pcui-panel-sortable-icon::before {\n  display: none;\n}\n\n.pcui-panel-remove {\n  align-self: flex-end;\n  order: 100;\n}\n.pcui-panel-remove::before {\n  line-height: 30px;\n}\n\n.pcui-panel.pcui-readonly .pcui-panel-remove {\n  display: none;\n}\n\n.pcui-panel-header > .pcui-button {\n  flex-shrink: 0;\n  margin: 1px;\n  background-color: transparent;\n  border: 0;\n}\n\n.pcui-panel.pcui-disabled > .pcui-panel-header {\n  background-color: #303d40;\n  color: #999;\n}\n\n.pcui-subpanel {\n  box-sizing: border-box;\n  margin: 6px;\n  border: 1px solid #293538;\n  border-radius: 2px;\n  background-color: #2c393c;\n  color: #b1b8ba;\n  font-size: 12px;\n}\n.pcui-subpanel .pcui-button {\n  background-color: #364346;\n  border-color: #293538;\n}\n.pcui-subpanel .pcui-button:not(.pcui-disabled, .pcui-readonly):hover, .pcui-subpanel .pcui-button:not(.pcui-disabled, .pcui-readonly):focus {\n  background-color: #364346;\n}\n.pcui-subpanel .pcui-button:not(.pcui-disabled, .pcui-readonly):active {\n  background-color: #2c393c;\n}\n\n.pcui-overlay {\n  width: auto;\n  height: auto;\n  inset: 0;\n  z-index: 101;\n  transition: opacity 100ms, visibility 100ms;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n}\n\n.pcui-overlay-inner {\n  position: absolute;\n  width: auto;\n  height: auto;\n  inset: 0;\n  background-color: rgba(32, 41, 43, 0.7);\n}\n\n.pcui-overlay-clickable > .pcui-overlay-inner {\n  cursor: pointer;\n}\n\n.pcui-overlay-transparent > .pcui-overlay-inner {\n  background-color: transparent;\n}\n\n.pcui-overlay-content {\n  background-color: #364346;\n  transition: width 100ms, height 100ms, margin-left 100ms, margin-top 100ms;\n  box-shadow: 7px 7px 7px rgba(0, 0, 0, 0.15);\n}\n\n.pcui-divider {\n  height: 1px;\n  background-color: #2c393c;\n  margin: 6px 0;\n}\n\n.pcui-infobox {\n  box-sizing: border-box;\n  margin: 6px;\n  padding: 12px;\n  border: 1px solid #293538;\n  border-radius: 2px;\n  background-color: #2c393c;\n  color: #b1b8ba;\n  font-size: 12px;\n}\n.pcui-infobox :first-child {\n  color: #fff;\n  margin-bottom: 2px;\n}\n.pcui-infobox[data-icon]:not(.pcui-hidden) {\n  display: grid;\n  grid: auto-flow/min-content 1fr;\n}\n.pcui-infobox[data-icon]:not(.pcui-hidden)::before {\n  content: attr(data-icon);\n  font-weight: 100;\n  font-size: 16px;\n  margin-right: 12px;\n  vertical-align: middle;\n  grid-column: 1;\n  grid-row: 1/3;\n}\n\n.pcui-select-input {\n  box-sizing: border-box;\n  margin: 6px;\n  border-radius: 2px;\n  min-width: 0;\n}\n\n.pcui-select-input-container-value {\n  background-color: #2c393c;\n  transition: box-shadow 100ms, opacity 100ms;\n}\n\n.pcui-select-input-shadow {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  transition: box-shadow 100ms;\n  border-radius: 2px;\n  pointer-events: none;\n  z-index: 1;\n}\n\n.pcui-select-input-value {\n  margin: 0;\n  padding: 0 24px 0 8px;\n  height: 24px;\n  line-height: 24px;\n  font-size: 12px;\n  transition: background-color 100ms, color 100ms;\n}\n.pcui-select-input-value:not(.pcui-hidden) {\n  display: block;\n}\n\n.pcui-label.pcui-select-input-value {\n  margin: 0;\n}\n\n.pcui-select-input-textinput {\n  margin: 0;\n}\n\n.pcui-select-input-textinput:not(.pcui-disabled, .pcui-readonly, .pcui-error).pcui-focus, .pcui-select-input-textinput:not(.pcui-disabled, .pcui-readonly, .pcui-error):hover {\n  box-shadow: none;\n}\n\n.pcui-label.pcui-select-input-icon {\n  position: absolute;\n  right: 6px;\n  color: #5b7073;\n  pointer-events: none;\n  transition: color 100ms;\n  margin: 0;\n  height: 24px;\n  line-height: 24px;\n}\n.pcui-label.pcui-select-input-icon::after {\n  content: "\\e159";\n  vertical-align: middle;\n}\n\n.pcui-select-input-has-disabled-value .pcui-container.pcui-select-input-list .pcui-label.pcui-selected::after {\n  font-family: inherit;\n  content: "fallback";\n  color: #fff;\n  font-size: 10px;\n  position: absolute;\n  right: 6px;\n}\n\n.pcui-label.pcui-select-input-disabled-value::after {\n  content: "\\e133" !important;\n  position: absolute;\n  right: 6px;\n}\n\n.pcui-select-input.pcui-open .pcui-select-input-shadow {\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-select-input.pcui-open .pcui-select-input-value {\n  color: #fff;\n  background-color: #20292b;\n}\n.pcui-select-input.pcui-open .pcui-select-input-icon::after {\n  color: #fff;\n  content: "\\e157";\n}\n\n.pcui-container.pcui-select-input-list {\n  position: absolute;\n  z-index: 1;\n  top: 100%;\n  width: 100%;\n  max-height: 200px;\n  overflow-y: auto;\n  background-color: #293538;\n}\n.pcui-container.pcui-select-input-list .pcui-label {\n  font-size: 12px;\n  height: 22px;\n  line-height: 22px;\n  padding: 0 24px 0 6px;\n  margin: 0;\n  transition: background-color 100ms, color 100ms;\n}\n.pcui-container.pcui-select-input-list .pcui-label:not(.pcui-hidden) {\n  display: block;\n}\n.pcui-container.pcui-select-input-list .pcui-label.pcui-selected {\n  color: #fff;\n}\n.pcui-container.pcui-select-input-list .pcui-label.pcui-selected::after {\n  content: "\\e133";\n  color: #5b7073;\n  position: absolute;\n  right: 6px;\n}\n\n.pcui-select-input-fit-height .pcui-select-input-list {\n  top: initial;\n  bottom: 100%;\n}\n.pcui-select-input-fit-height .pcui-select-input-shadow {\n  top: initial;\n  bottom: 0;\n}\n\n.pcui-select-input-tags:not(.pcui-select-input-tags-empty) {\n  margin-top: 1px;\n  flex-wrap: wrap;\n}\n\n.pcui-select-input-tag {\n  background-color: #293538;\n  align-items: center;\n  border-radius: 2px;\n  border: 1px solid #232e30;\n  margin-right: 2px;\n  margin-top: 2px;\n  min-width: 0;\n  height: 18px;\n}\n.pcui-select-input-tag > * {\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n}\n.pcui-select-input-tag > .pcui-label {\n  padding: 0 5px 0 8px;\n}\n.pcui-select-input-tag > .pcui-button {\n  padding: 0 5px;\n  height: 18px;\n  line-height: 18px;\n  flex-shrink: 0;\n}\n.pcui-select-input-tag > .pcui-button:not(.pcui-disabled, .pcui-readonly):hover {\n  box-shadow: none;\n  color: #d34141;\n}\n\n.pcui-select-input-tag-not-everywhere > .pcui-label {\n  opacity: 0.5;\n}\n.pcui-select-input-tag-not-everywhere > .pcui-label::before {\n  content: "*";\n  margin-right: 5px;\n}\n\n.pcui-select-input:not(.pcui-disabled, .pcui-readonly) .pcui-select-input-container-value:hover .pcui-select-input-shadow {\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-select-input:not(.pcui-disabled, .pcui-readonly) .pcui-select-input-container-value:hover .pcui-select-input-icon {\n  color: #9ba1a3;\n}\n.pcui-select-input:not(.pcui-disabled, .pcui-readonly).pcui-focus .pcui-select-input-shadow {\n  box-shadow: 0 0 2px 1px rgba(255, 102, 0, 0.3);\n}\n.pcui-select-input:not(.pcui-disabled, .pcui-readonly).pcui-focus .pcui-select-input-icon {\n  color: #9ba1a3;\n}\n.pcui-select-input:not(.pcui-disabled, .pcui-readonly) .pcui-select-input-value:hover {\n  color: #fff;\n  background-color: #20292b;\n  cursor: pointer;\n}\n.pcui-select-input:not(.pcui-disabled, .pcui-readonly) .pcui-select-input-list > *:hover,\n.pcui-select-input:not(.pcui-disabled, .pcui-readonly) .pcui-select-input-list > .pcui-select-input-label-highlighted {\n  background-color: #20292b;\n  color: #fff;\n  cursor: pointer;\n}\n\n.pcui-select-input-create-new > .pcui-label {\n  padding-right: 6px;\n}\n.pcui-select-input-create-new > .pcui-label:last-child {\n  flex-shrink: 0;\n  margin-left: auto;\n}\n.pcui-select-input-create-new > .pcui-label:last-child::before {\n  content: "\\e120";\n  margin-right: 6px;\n}\n\n.pcui-select-input.pcui-disabled {\n  opacity: 0.4;\n}\n\n.pcui-select-input .pcui-label.pcui-disabled {\n  opacity: 0.4;\n}\n\n.pcui-select-input.pcui-readonly .pcui-select-input-icon {\n  display: none;\n}\n.pcui-select-input.pcui-readonly.pcui-select-input-multi .pcui-select-input-container-value {\n  display: none;\n}\n.pcui-select-input.pcui-readonly.pcui-select-input-multi .pcui-select-input-tag > .pcui-button {\n  display: none;\n}\n.pcui-select-input.pcui-readonly.pcui-select-input-allow-input:not(.pcui-select-input-multi) {\n  opacity: 0.7;\n}\n.pcui-select-input.pcui-readonly.pcui-select-input-allow-input:not(.pcui-select-input-multi) .pcui-select-input-textinput::after {\n  display: none;\n}\n\n@-webkit-keyframes animation-spin {\n  from {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  to {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes animation-spin {\n  from {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  to {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.pcui-spinner {\n  display: inline-block;\n  margin: 6px;\n  vertical-align: middle;\n}\n.pcui-spinner > path {\n  -webkit-animation-name: animation-spin;\n          animation-name: animation-spin;\n  -webkit-animation-duration: 750ms;\n          animation-duration: 750ms;\n  -webkit-animation-iteration-count: infinite;\n          animation-iteration-count: infinite;\n  -webkit-animation-timing-function: linear;\n          animation-timing-function: linear;\n  -webkit-transform-origin: center;\n          transform-origin: center;\n}\n.pcui-spinner.pcui-error > path {\n  -webkit-animation: none;\n          animation: none;\n  fill: #ff2020;\n}\n.pcui-spinner.pcui-error > path.pcui-spinner-highlight {\n  fill: #ff7777;\n}\n\n.pcui-progress {\n  height: 4px;\n  background-color: #20292b;\n  transition: opacity 100ms;\n  width: 100%;\n}\n.pcui-progress .pcui-progress-inner {\n  width: 0%;\n  height: inherit;\n  background: #f60;\n  background: linear-gradient(135deg, #ff6600 0%, #ff6600 25%, #a84300 26%, #a84300 50%, #ff6600 51%, #ff6600 75%, #a84300 76%, #a84300 100%);\n  background-position: 0 0;\n  background-size: 24px 24px;\n  background-repeat: repeat;\n  -webkit-animation: pcui-progress-background 1000ms linear infinite;\n          animation: pcui-progress-background 1000ms linear infinite;\n}\n\n.pcui-progress.pcui-error .pcui-progress-inner {\n  background: #f60;\n  background: linear-gradient(135deg, #ff7777 0%, #ff7777 25%, #ff2020 26%, #ff2020 50%, #ff7777 51%, #ff7777 75%, #ff2020 76%, #ff2020 100%);\n  background-position: 0 0;\n  background-size: 24px 24px;\n  background-repeat: repeat;\n  -webkit-animation: none;\n          animation: none;\n}\n\n@-webkit-keyframes pcui-progress-background {\n  from {\n    background-position: 0 0;\n  }\n  to {\n    background-position: 24px 0;\n  }\n}\n\n@keyframes pcui-progress-background {\n  from {\n    background-position: 0 0;\n  }\n  to {\n    background-position: 24px 0;\n  }\n}\n.pcui-treeview {\n  min-width: -webkit-max-content;\n  min-width: max-content;\n}\n\n.pcui-treeview-item {\n  position: relative;\n  padding-left: 24px;\n}\n.pcui-treeview-item::before {\n  content: " ";\n  position: absolute;\n  background-color: #313e41;\n  width: 2px;\n  left: 14px;\n  top: -12px;\n  bottom: 12px;\n}\n.pcui-treeview-item:last-child::before {\n  height: 25px;\n  bottom: auto;\n}\n\n.pcui-treeview-item.pcui-disabled > .pcui-treeview-item-contents > .pcui-treeview-item-text {\n  opacity: 0.4;\n}\n\n.pcui-treeview-item-contents {\n  position: relative;\n  color: #b1b8ba;\n  margin-left: 3px;\n  border: 1px solid transparent;\n  align-items: center;\n  height: 24px;\n  box-sizing: border-box;\n}\n.pcui-treeview-item-contents:hover {\n  cursor: pointer;\n  color: #fff;\n  background-color: #2c393c;\n}\n.pcui-treeview-item-contents:hover > .pcui-treeview-item-icon {\n  color: #fff;\n}\n\n.pcui-treeview-item-icon {\n  color: #5b7073;\n  margin: 0 2px 0 0;\n  flex-shrink: 0;\n}\n.pcui-treeview-item-icon::before {\n  content: " ";\n  position: absolute;\n  background-color: #313e41;\n  left: -12px;\n  top: 10px;\n  width: 24px;\n  height: 2px;\n}\n.pcui-treeview-item-icon::after {\n  content: attr(data-icon);\n  display: inline-block;\n  vertical-align: sub;\n  width: 22px;\n  height: 22px;\n  position: relative;\n  z-index: 1;\n  text-align: center;\n}\n\n.pcui-treeview-item-text {\n  margin: 0;\n  flex-shrink: 0;\n  position: relative;\n  z-index: 1;\n  transition: opacity 100ms;\n  padding-right: 8px;\n  color: inherit;\n}\n\n.pcui-treeview-item-contents.pcui-treeview-item-selected {\n  background-color: #20292b;\n  color: #fff;\n}\n.pcui-treeview-item-contents.pcui-treeview-item-selected > .pcui-treeview-item-icon {\n  color: #fff;\n}\n\n.pcui-treeview-item:not(.pcui-treeview-item-empty) > .pcui-treeview-item-contents::before {\n  content: "\\e120";\n  position: absolute;\n  font-size: 10px;\n  font-weight: bold;\n  text-align: center;\n  color: #b1b8ba;\n  background-color: #2c393c;\n  top: 0;\n  left: -24px;\n  width: 16px;\n  height: 16px;\n  line-height: 16px;\n  margin: 3px;\n  cursor: pointer;\n  z-index: 1;\n}\n.pcui-treeview-item:not(.pcui-treeview-item-empty).pcui-treeview-item-open > .pcui-treeview-item-contents::before {\n  content: "\\e121";\n}\n\n.pcui-treeview > .pcui-treeview-item {\n  padding-left: 0;\n}\n.pcui-treeview > .pcui-treeview-item::before {\n  content: none;\n}\n.pcui-treeview > .pcui-treeview-item > .pcui-treeview-item-contents {\n  margin-left: 0;\n}\n.pcui-treeview > .pcui-treeview-item > .pcui-treeview-item-contents > .pcui-treeview-item-icon::before {\n  content: none;\n}\n.pcui-treeview > .pcui-treeview-item > .pcui-treeview-item-contents > .pcui-treeview-item-icon::after {\n  margin-left: 0;\n}\n.pcui-treeview > .pcui-treeview-item > .pcui-treeview-item {\n  padding-left: 21px;\n}\n.pcui-treeview > .pcui-treeview-item > .pcui-treeview-item::before {\n  left: 11px;\n}\n\n.pcui-treeview:not(.pcui-treeview-filtering) > .pcui-treeview-item .pcui-treeview-item:not(.pcui-treeview-item-open, .pcui-treeview-item-empty) > .pcui-treeview-item {\n  display: none;\n}\n\n.pcui-treeview-item-dragged > .pcui-treeview-item-contents {\n  background-color: rgba(44, 57, 60, 0.5);\n  color: #fff;\n}\n\n.pcui-treeview-drag-handle {\n  position: fixed;\n  width: 32px;\n  height: 20px;\n  top: 0;\n  bottom: 0;\n  z-index: 4;\n  margin-top: -1px;\n  margin-left: -1px;\n}\n.pcui-treeview-drag-handle.before {\n  border-top: 4px solid #f60;\n  padding-right: 8px;\n  height: 24px;\n}\n.pcui-treeview-drag-handle.inside {\n  border: 4px solid #f60;\n}\n.pcui-treeview-drag-handle.after {\n  border-bottom: 4px solid #f60;\n  padding-right: 8px;\n  height: 24px;\n}\n\n.pcui-treeview-item-contents::after {\n  content: " ";\n  display: block;\n  clear: both;\n}\n\n.pcui-treeview-item.pcui-treeview-item-rename > .pcui-treeview-item-contents > .pcui-treeview-item-text {\n  display: none;\n}\n.pcui-treeview-item.pcui-treeview-item-rename > .pcui-treeview-item-contents > .pcui-text-input {\n  margin: 0;\n  flex-grow: 1;\n  box-shadow: none !important;\n  border: 0;\n  background-color: transparent;\n}\n.pcui-treeview-item.pcui-treeview-item-rename > .pcui-treeview-item-contents > .pcui-text-input > input {\n  font-family: inherit;\n  font-size: 14px;\n  padding: 0;\n}\n\n.pcui-treeview.pcui-treeview-filtering .pcui-treeview-item {\n  padding-left: 0;\n}\n.pcui-treeview.pcui-treeview-filtering .pcui-treeview-item::before {\n  display: none;\n}\n.pcui-treeview.pcui-treeview-filtering .pcui-treeview-item:not(.pcui-treeview-filtering-result) > .pcui-treeview-item-contents {\n  display: none;\n}\n.pcui-treeview.pcui-treeview-filtering .pcui-treeview-item-contents {\n  margin-left: 0;\n}\n\n.pcui-treeview-filtering-result .pcui-treeview-item-contents::before,\n.pcui-treeview-filtering-result .pcui-treeview-item-icon::before {\n  display: none;\n}\n\n.pcui-label-group {\n  align-items: center;\n  flex-flow: row nowrap;\n  margin: 6px;\n}\n.pcui-label-group > .pcui-label:first-child {\n  width: 100px;\n  flex-shrink: 0;\n  margin: 0;\n}\n.pcui-label-group > .pcui-element:not(:first-child) {\n  margin: 0 0 0 6px;\n}\n.pcui-label-group > .pcui-element:nth-child(2):not(.pcui-not-flexible) {\n  flex: 1;\n}\n.pcui-label-group > .pcui-vector-input > .pcui-numeric-input {\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.pcui-label-group-align-top > .pcui-label:first-child {\n  align-self: flex-start;\n  margin-top: 4px;\n}\n\n.pcui-label-group.pcui-disabled > .pcui-label:first-child {\n  opacity: 0.4;\n}\n\n.pcui-gridview {\n  flex-flow: row wrap;\n  align-content: flex-start;\n}\n\n.pcui-gridview-vertical {\n  flex-direction: column;\n  align-content: flex-start;\n}\n\n.pcui-gridview-item {\n  box-sizing: border-box;\n  justify-content: center;\n  align-items: center;\n  flex-shrink: 0;\n  width: 104px;\n}\n.pcui-gridview-item:not(.pcui-disabled) {\n  cursor: pointer;\n}\n.pcui-gridview-item:not(.pcui-disabled):not(.pcui-gridview-item-selected, .pcui-gridview-radiobtn, .pcui-gridview-radiobtn-selected):hover {\n  background-color: #293538;\n}\n\n.pcui-gridview-item-selected {\n  background-color: #20292b;\n}\n\n.pcui-gridview-item-text {\n  max-width: 100px;\n  font-size: 12px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin: 0;\n  padding: 0 2px;\n}\n\n.pcui-gridview-radio-container {\n  box-sizing: border-box;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  flex-shrink: 0;\n  width: 104px;\n}\n.pcui-gridview-radio-container :not(.pcui-disabled) {\n  cursor: pointer;\n}\n\n.pcui-menu {\n  position: absolute;\n  z-index: 401;\n  inset: 0;\n  width: auto;\n  height: auto;\n}\n\n.pcui-menu-items {\n  position: fixed;\n  top: 0;\n  left: 0;\n}\n\n.pcui-menu-item {\n  position: relative;\n  background-color: #20292b;\n  width: auto;\n}\n\n.pcui-menu-item-children {\n  box-shadow: 0 0 8px rgba(0, 0, 0, 0.6);\n  position: absolute;\n  z-index: 1;\n  left: 100%;\n  top: 0;\n  opacity: 0;\n  transition: opacity 100ms, visibility 100ms;\n  visibility: hidden;\n}\n\n.pcui-menu-item:hover > .pcui-menu-item-children {\n  opacity: 1;\n  visibility: visible;\n}\n\n.pcui-menu-item-has-children > .pcui-menu-item-content > .pcui-label {\n  padding-right: 32px;\n}\n.pcui-menu-item-has-children > .pcui-menu-item-content > .pcui-label::after {\n  content: "\\e160";\n  position: absolute;\n  right: 6px;\n}\n\n.pcui-menu-item-content {\n  min-width: 158px;\n  color: #9ba1a3;\n  border-bottom: 1px solid #263134;\n  cursor: pointer;\n}\n.pcui-menu-item-content:hover {\n  color: #fff;\n  background-color: #5b7073;\n}\n.pcui-menu-item-content > .pcui-label {\n  transition: none;\n}\n\n.pcui-menu-item:last-child > .pcui-menu-item-content {\n  border-bottom: none;\n}\n\n.pcui-menu-item-content > .pcui-label {\n  color: inherit;\n}\n.pcui-menu-item-content > .pcui-label[data-icon]::before {\n  content: attr(data-icon);\n  font-weight: 100;\n  font-size: inherit;\n  margin-right: 6px;\n  vertical-align: middle;\n}\n\n.pcui-menu-item.pcui-disabled .pcui-menu-item-content {\n  cursor: default;\n}\n.pcui-menu-item.pcui-disabled .pcui-menu-item-content:hover {\n  color: #9ba1a3;\n  background-color: transparent;\n}\n.pcui-menu-item.pcui-disabled .pcui-menu-item-content > .pcui-label {\n  cursor: default;\n  opacity: 0.4;\n}\n\n.pcui-radio-button {\n  display: inline-block;\n  position: relative;\n  background-color: #293538;\n  color: #fff;\n  width: 17px;\n  height: 17px;\n  border-radius: 50%;\n  overflow: hidden;\n  margin: 6px;\n  transition: opacity 100ms, background-color 100ms, box-shadow 100ms;\n}\n.pcui-radio-button::before {\n  content: "";\n  position: absolute;\n  display: block;\n  left: 50%;\n  top: 50%;\n  width: 16px;\n  min-width: 16px;\n  height: 16px;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  border-radius: 50%;\n  background-color: #293538;\n}\n.pcui-radio-button::after {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  width: 11px;\n  min-width: 11px;\n  height: 11px;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  border-radius: 50%;\n  background-color: white;\n}\n\n.pcui-radio-button-selected::before {\n  width: 16px;\n  min-width: 16px;\n  height: 16px;\n  box-sizing: border-box;\n  border: 1px solid white;\n}\n.pcui-radio-button-selected::after {\n  content: "";\n  display: block;\n}\n\n.pcui-radio-button.pcui-readonly {\n  opacity: 0.7;\n}\n\n.pcui-radio-button.pcui-disabled {\n  opacity: 0.4;\n}\n\n.pcui-radio-button:not(.pcui-disabled, .pcui-readonly):hover {\n  cursor: pointer;\n}\n.pcui-radio-button:not(.pcui-disabled, .pcui-readonly):hover::before {\n  background-color: #20292b;\n}\n\n.pcui-array-input {\n  margin: 6px;\n  min-width: 0;\n}\n.pcui-array-input > .pcui-numeric-input {\n  margin: 0 0 6px 0;\n}\n\n.pcui-array-input.pcui-array-empty > .pcui-numeric-input {\n  margin: 0;\n}\n\n.pcui-array-input-item > * {\n  margin-top: 1px;\n  margin-bottom: 1px;\n}\n.pcui-array-input-item > *:first-child:not(.pcui-not-flexible, .pcui-panel-header) {\n  flex: 1;\n}\n.pcui-array-input-item > .pcui-button {\n  margin-left: -3px;\n  margin-right: 0;\n  background-color: transparent;\n  border: 0;\n}\n\n.pcui-array-input-item-asset > .pcui-button {\n  margin-top: 36px;\n}\n\n.pcui-array-input.pcui-readonly .pcui-array-input-item-delete {\n  display: none;\n}'),window.pcui=i;var Ki=window;for(var Xi in t)Ki[Xi]=t[Xi];t.__esModule&&Object.defineProperty(Ki,"__esModule",{value:!0})})();

var RotateLocal=pc.createScript("rotateLocal");RotateLocal.attributes.add("speed",{type:"number",default:1}),RotateLocal.prototype.update=function(t){this.entity.rotateLocal(0,this.speed*t,0);const e=this.entity.children;for(let t=0;t<e.length;t++){const a=e[t].uranusInstancerCells;if(a){a[0]&&(a[0].entityMoved=!0)}}};var ObjectLaunchPad=pc.createScript("objectLaunchPad");ObjectLaunchPad.attributes.add("jumpBoost",{type:"number",default:5,title:"Jump Boost",description:"Multiplies the player jump speed to launch the player upwards."}),ObjectLaunchPad.jumpRequestEntity=void 0,ObjectLaunchPad.prototype.initialize=function(){this.timer=0,this.wait=!1,UranusControllerThirdPerson.api.entity.on("UranusControllerThirdPerson:onRaycastGround",this.onPlayerRaycastGround,this)},ObjectLaunchPad.prototype.onPlayerRaycastGround=async function(t){this.timer>0||this.wait||t.entity!==this.entity||t.entity.tags.has("uranus-multiplayer-remote-player")||(this.wait=!0,await new Promise((t=>setTimeout(t,100))),this.wait=!1,this.launchPlayer(this.jumpBoost),ObjectLaunchPad.jumpRequestEntity=this.entity,this.timer=.3)},ObjectLaunchPad.prototype.launchPlayer=function(t){UranusControllerThirdPerson.api.jumpSingleBoost=t,UranusControllerThirdPerson.api.input.jumpRequest=!0,UranusControllerThirdPerson.api.jumpTimeoutDelta=0,pc.app.fire("player:sound:play","Launchpad")},ObjectLaunchPad.prototype.update=function(t){this.timer>0?this.timer-=t:ObjectLaunchPad.jumpRequestEntity===this.entity&&(ObjectLaunchPad.jumpRequestEntity=void 0)};var ManagerSky=pc.createScript("managerSky");ManagerSky.attributes.add("localPlayer",{type:"entity",title:"Local Player",description:"The local player entity to track its position."}),ManagerSky.attributes.add("minHeight",{type:"number",default:0,title:"Min Height"}),ManagerSky.attributes.add("maxHeight",{type:"number",default:100,title:"Max Height"}),ManagerSky.attributes.add("minTime",{type:"number",default:12,title:"Min Time"}),ManagerSky.attributes.add("maxTime",{type:"number",default:24,title:"Max Time"}),ManagerSky.attributes.add("timeStep",{type:"number",default:1,title:"Time Step",description:"The sky time will update with this step."}),ManagerSky.prototype.initialize=function(){ManagerSky.api=this,this.progress=0,this.currentTime=0,this.lastUpdatedTime=1/0,this.prepare()},ManagerSky.prototype.prepare=function(){if(pc.platform.android){const t=this.app.root.findByName("Uranus Sky System").script.uranusEffectsSkyboxCubemap;t.updateFrequency=180,t.renderWidth=16}},ManagerSky.prototype.update=function(t){this.trackPlayerProgress(),this.updateSky()},ManagerSky.prototype.trackPlayerProgress=function(){if(!this.localPlayer)return;const t=this.localPlayer.getPosition().y;this.progress=pc.math.clamp((t-this.minHeight)/(this.maxHeight-this.minHeight),0,1)},ManagerSky.prototype.updateSky=function(){this.currentTime=this.progress*(this.maxTime-this.minTime)+this.minTime,this.timeStep>0&&Math.abs(this.currentTime-this.lastUpdatedTime)<this.timeStep||(this.app.fire("UranusEffectsSkybox:setTime",this.currentTime),this.lastUpdatedTime=this.currentTime)};var InterfaceGameTimer=pc.createScript("interfaceGameTimer");InterfaceGameTimer.attributes.add("displayEvent",{type:"string"}),InterfaceGameTimer.attributes.add("startEvent",{type:"string",default:"checkpoint:state:ON_ASCEND"}),InterfaceGameTimer.attributes.add("resetEvent",{type:"string",default:"checkpoint:state:ON_START"}),InterfaceGameTimer.attributes.add("pauseEvent",{type:"string",default:"interfaceGameTimer:pause"}),InterfaceGameTimer.attributes.add("resumeEvent",{type:"string",default:"interfaceGameTimer:resume"}),InterfaceGameTimer.attributes.add("autoStart",{type:"boolean",default:!1}),InterfaceGameTimer.attributes.add("startTime",{type:"number",default:0}),InterfaceGameTimer.prototype.initialize=function(){InterfaceGameTimer.api=this,this.time=this.startTime,this.isActive=!1,this.display(),this.app.on(this.resetEvent,this.reset,this),this.app.on(this.startEvent,this.start,this),this.app.on(this.pauseEvent,this.pause,this),this.app.on(this.resumeEvent,this.resume,this),this.autoStart&&this.start()},InterfaceGameTimer.prototype.update=function(t){this.isActive&&(this.time+=t,this.display())},InterfaceGameTimer.prototype.reset=function(){this.time=this.startTime,this.isActive=!1,this.display()},InterfaceGameTimer.prototype.start=function(t){this.isActive=!0},InterfaceGameTimer.prototype.pause=function(){this.isActive=!1},InterfaceGameTimer.prototype.resume=function(){this.isActive=!0},InterfaceGameTimer.prototype.stop=function(){this.reset()},InterfaceGameTimer.prototype.formatTime=function(t){var e=Math.floor(t/3600),i=Math.floor(t%3600/60),a=Math.floor(t%60);const formatTimeUnit=t=>t<10?"0"+t:t,r=formatTimeUnit(e),s=formatTimeUnit(i),n=formatTimeUnit(a);return e>0?`${r}:${s}:${n}`:`${s}:${n}`},InterfaceGameTimer.prototype.display=function(){this.displayEvent?this.app.fire(this.displayEvent,this.formatTime(this.time)):console.warn("Error: textElement or its element is null or undefined")};var ObjectCheckPoint=pc.createScript("objectCheckPoint");ObjectCheckPoint.lastCheckpoint=void 0,ObjectCheckPoint.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.entity.collision.on("triggerleave",this.onTriggerLeave,this)},ObjectCheckPoint.prototype.onTriggerEnter=async function(t){t.tags.has("uranus-multiplayer-remote-player")||this.entity.getPosition().y<=ManagerCheckpoint.api.getLastCheckpointHeight()||(this.app.fire("player:sound:play","Reward"),this.app.fire("ad:respawnCheckpointButton:hide"),this.app.fire("ad:respawnLastButton:hide"),this.app.fire("ad:saveCheckpoint:show"),ObjectCheckPoint.lastCheckpoint=this.entity)},ObjectCheckPoint.prototype.onTriggerLeave=function(t){t.tags.has("uranus-multiplayer-remote-player")||(this.app.fire("ad:saveCheckpoint:hide"),ObjectCheckPoint.lastCheckpoint=void 0)};var ManagerCheckpoint=pc.createScript("managerCheckpoint");ManagerCheckpoint.attributes.add("localPlayer",{type:"entity",title:"Local Player",description:"The local player entity to track its position."}),ManagerCheckpoint.attributes.add("resetHeight",{type:"number",default:0,title:"Reset Height",description:"This is the height where the player loses and has to start over."}),ManagerCheckpoint.attributes.add("winHeight",{type:"number",default:1e3,title:"Win Height",description:"This is the height where the player wins the game."}),ManagerCheckpoint.attributes.add("belowGroundHeight",{type:"number",default:-20,title:"Below Ground Height",description:"To catch players when they fall through the ground."}),ManagerCheckpoint.attributes.add("descendLoseDuration",{type:"number",default:.75,title:"Descend Lose Duration",description:"The minimum duration of a descend to consider losing (mainly plays a sound)."}),ManagerCheckpoint.attributes.add("respawnDuration",{type:"number",default:7,title:"Respawn Duration",description:"If a respawn checkpoint becomes available, the player has this much time to get back to it."}),ManagerCheckpoint.attributes.add("respawnOffsetHeight",{type:"number",default:10,title:"Respawn Offset Height",description:"This controls when the respawn event will fire, by subtracting this offset height from the real checkpoint position."}),ManagerCheckpoint.attributes.add("debugClearCareer",{type:"boolean",default:!1,title:"Debug Clear Career"}),ManagerCheckpoint.STATES={ON_START:1,ON_ASCEND:2,ON_DESCEND:3,ON_WIN:4},ManagerCheckpoint.prototype.initialize=function(){if(ManagerCheckpoint.api=this,this.activeState=void 0,this.currentPlayerStepY=this.localPlayer.getPosition().y,this.currentPlayerY=this.localPlayer.getPosition().y,this.lastRespawnPos=new pc.Vec3,this.lastRespawnTime=0,this.maxPlayerY=0,this.careerHeight=0,this.runID=void 0,this.currentCheckpoint=void 0,this.descendTimer=0,this.respawnTimer=void 0,this.careerUpdatedTimer=void 0,this.processingRespawnAvailable=!1,this.hasWon=!1,this.leaderboardEntry=void 0,this.uranusMultiplayerColyseusPlayer=this.localPlayer.script?.uranusMultiplayerColyseusPlayer,this.debugClearCareer)try{localStorage.removeItem("managerCheckpoint:checkpoint"),localStorage.removeItem("managerCheckpoint:career")}catch(e){}this.app.on("checkpoint:state:change",this.onStateChange,this),this.app.on("checkpoint:state:ON_START",this.onStart,this),this.app.on("checkpoint:state:ON_ASCEND",this.onAscend,this),this.app.on("checkpoint:state:ON_DESCEND",this.onDescend,this),this.app.on("checkpoint:state:ON_WIN",this.onGameWin,this),this.app.on("checkpoint:claimRespawnLast",this.claimRespawnLast,this),this.app.on("checkpoint:claimRespawnCheckpoint",this.claimRespawnCheckpoint,this),this.app.on("checkpoint:claimTravelUp",this.claimTravelUp,this),this.app.once("UranusControllerThirdPerson:ready",this.onPlayerReady,this)},ManagerCheckpoint.prototype.update=function(e){this.trackPlayerProgress(e),this.trackRespawn(e)},ManagerCheckpoint.prototype.onPlayerReady=async function(){try{const e=JSON.parse(localStorage.getItem("managerCheckpoint:checkpoint"));if(e.guid){const t=this.app.root.findByGuid(e.guid).findByName("Checkpoint");t&&(this.onCheckpoint(t,!0),this.respawnTime=e.time,await new Promise((e=>setTimeout(e,100))),this.respawnOnCheckpoint(this.currentCheckpoint.getPosition(),this.respawnTime,!1))}}catch(e){}if(this.uranusMultiplayerColyseusPlayer){const e=UranusMultiplayerRoom.active?.room;e&&this.onJoinRoom(e),this.app.once("uranusMultiplayer:room:joined",this.onJoinRoom,this)}},ManagerCheckpoint.prototype.onJoinRoom=function(e){e.onMessage("leaderboardEntry",(([e,t])=>{this.leaderboardEntry=t,t&&!this.hasWon&&(this.app.fire("player:sound:play","Win"),this.showCareerPage())}))},ManagerCheckpoint.prototype.showCareerPage=function(){InterfaceGameTimer.api.pause(),this.app.fire("page:ui-career:enable"),this.app.fire("game:paused"),this.app.once("player:sound:onPlayed:Run",(function(){InterfaceGameTimer.api.resume(),this.app.fire("game:resumed")}),this)},ManagerCheckpoint.prototype.trackPlayerProgress=function(e){if(!this.localPlayer)return;const t=this.localPlayer.getPosition().y-1,i=this.localPlayer.rigidbody.linearVelocity.y<=-30;if(this.currentPlayerY=t,t<=this.belowGroundHeight)return void this.app.fire("player:respawn");const a=this.hasWon;let n,r=!1;i?(n=ManagerCheckpoint.STATES.ON_DESCEND,!a&&t<this.lastRespawnPos.y-this.respawnOffsetHeight&&(r=!0)):n=ManagerCheckpoint.STATES.ON_ASCEND,t<=this.resetHeight&&(n=ManagerCheckpoint.STATES.ON_START,this.hasWon=!1,this.maxPlayerY=0,this.runID=pc.guid.create(),void 0===this.respawnTimer&&this.getLastCheckpointHeight()>0&&(this.respawnTimer=.01)),this.teleportingPlayer||this.updateState(n),this.activeState===ManagerCheckpoint.STATES.ON_DESCEND?(this.descendTimer+=e,r&&this.onRespawnAvailable()):this.descendTimer=0,Math.abs(t-this.currentPlayerStepY)>=.1&&(this.currentPlayerStepY=t,this.currentPlayerStepY>this.maxPlayerY&&(this.maxPlayerY=this.currentPlayerStepY),this.app.fire("checkpoint:elevation:update",t))},ManagerCheckpoint.prototype.getStateName=function(e){if(e)for(let t in ManagerCheckpoint.STATES)if(ManagerCheckpoint.STATES[t]===e)return t},ManagerCheckpoint.prototype.updateState=function(e){if(e&&this.activeState!==e){const t=this.activeState;this.activeState=e;const i=this.getStateName(e);this.app.fire(`checkpoint:state:${i}`,t),this.app.fire("checkpoint:state:change",this.activeState,t)}},ManagerCheckpoint.prototype.onCheckpoint=function(e,t){if(this.activeState!==ManagerCheckpoint.STATES.ON_WIN&&e.getPosition().y>this.getLastCheckpointHeight()&&!this.hasWon){this.currentCheckpoint=e,this.respawnTime=InterfaceGameTimer.api.time;if(this.updateCareer(this.maxPlayerY,InterfaceGameTimer.api.time,this.runID)&&(this.careerHeight=this.maxPlayerY,this.careerUpdatedTimer=5),this.maxPlayerY>=this.winHeight&&!this.hasWon&&this.updateState(ManagerCheckpoint.STATES.ON_WIN),!0!==t){try{const t=e._guid;localStorage.setItem("managerCheckpoint:checkpoint",JSON.stringify({guid:t,time:InterfaceGameTimer.api.time}))}catch(e){}this.leaderboardCheck(),ManagerInterface.api.showMessage("Checkpoint!",5)}this.app.fire("checkpoint:reached"),this.app.fire("player:sound:play","Checkpoint")}},ManagerCheckpoint.prototype.clearCheckpoint=function(){this.currentCheckpoint=void 0,this.lastRespawnPos.copy(pc.Vec3.ZERO),this.lastRespawnTime=0,this.app.fire("ad:respawnCheckpointButton:hide");try{localStorage.removeItem("managerCheckpoint:checkpoint")}catch(e){}},ManagerCheckpoint.prototype.getLastCheckpointHeight=function(){return this.currentCheckpoint?this.currentCheckpoint.getPosition().y:0},ManagerCheckpoint.prototype.onStateChange=function(e,t){t===ManagerCheckpoint.STATES.ON_DESCEND&&(this.app.fire("player:sound:stop","Fall"),this.descendTimer>=this.descendLoseDuration&&!this.hasWon&&this.app.fire("player:sound:play","Lose"))},ManagerCheckpoint.prototype.onStart=function(){this.currentPlayerStepY>=this.lastRespawnPos.y&&this.app.fire("ad:respawnLastButton:hide");const e=this.getLastCheckpointHeight();this.currentPlayerY>=e&&this.app.fire("ad:respawnCheckpointButton:hide")},ManagerCheckpoint.prototype.onAscend=function(){this.respawnTimer=void 0},ManagerCheckpoint.prototype.onDescend=function(){this.app.fire("player:sound:play","Fall")},ManagerCheckpoint.prototype.onRespawnAvailable=async function(){if(this.processingRespawnAvailable)return;this.processingRespawnAvailable=!0,await new Promise((e=>{this.respawnAvailableCallback=()=>{UranusControllerThirdPerson.api.grounded&&(UranusControllerThirdPerson.api.entity.off("UranusControllerThirdPerson:onRaycastGround",this.respawnAvailableCallback),e())},UranusControllerThirdPerson.api.entity.on("UranusControllerThirdPerson:onRaycastGround",this.respawnAvailableCallback)})),await new Promise((e=>setTimeout(e,500)));let e=!1;const t=this.currentPlayerY;if(this.lastRespawnPos.y>0&&!ObjectCheckPoint.lastCheckpoint&&(this.app.fire("ad:saveCheckpoint:hide"),this.app.fire("ad:travelUpButton:hide"),this.app.fire("ad:respawnLastButton:show"),this.app.fire("text:respawn-indicator:set",InterfaceElevationIndicator.prototype.formatHeightRaw(this.lastRespawnPos.y)),e=!0),this.currentCheckpoint&&!ObjectCheckPoint.lastCheckpoint){const i=this.getLastCheckpointHeight();i>0&&t<i&&(this.app.fire("ad:respawnCheckpointButton:show"),this.app.fire("text:checkpoint-indicator:set",InterfaceElevationIndicator.prototype.formatHeightRaw(i)),e=!0)}e&&(this.respawnTimer=.01,this.app.fire("player:sound:play","Reward")),this.processingRespawnAvailable=!1},ManagerCheckpoint.prototype.respawnOnCheckpoint=async function(e,t,i){const a=InterfaceGameTimer.api.time<=0;i&&(this.app.fire("uranusControllerPlayerEmojis:emoji","1f680.png"),await new Promise((e=>setTimeout(e,750))),ObjectLaunchPad.prototype.launchPlayer(10),await new Promise((e=>setTimeout(e,1e3)))),this.teleportingPlayer=!0,this.localPlayer.rigidbody.teleport(e.x,e.y+.5,e.z);const n=this.localPlayer.script.uranusControllerThirdPerson;n&&(n.verticalVelocity=0,n.jump=!1,n.jumpTimeoutDelta=0,n.jumpUpTimeoutDelta=0),this.app.fire("player:sound:play","Respawn"),a&&(InterfaceGameTimer.api.time=t),await new Promise((e=>setTimeout(e,100))),this.teleportingPlayer=!1},ManagerCheckpoint.prototype.claimRespawnLast=function(){this.respawnOnCheckpoint(this.lastRespawnPos,this.lastRespawnTime,!0),this.app.fire("player:sound:stop","Lose")},ManagerCheckpoint.prototype.claimRespawnCheckpoint=function(){this.currentCheckpoint&&(this.respawnOnCheckpoint(this.currentCheckpoint.getPosition(),this.respawnTime,!0),this.app.fire("player:sound:stop","Lose"))},ManagerCheckpoint.prototype.claimTravelUp=function(){ObjectPortal.lastPortal&&(this.respawnOnCheckpoint(ObjectPortal.lastPortal.getPosition(),300,!0),this.app.fire("player:sound:stop","Lose"))},ManagerCheckpoint.prototype.onGameWin=async function(){this.hasWon=!0,await new Promise((e=>setTimeout(e,1e3))),this.app.fire("player:sound:play","Win"),this.showCareerPage()},ManagerCheckpoint.prototype.leaderboardCheck=function(){if(this.uranusMultiplayerColyseusPlayer){const e=pc.math.clamp(this.maxPlayerY+1,0,this.winHeight);this.uranusMultiplayerColyseusPlayer.sendToRoom("leaderboardCheck",{elevation:InterfaceElevationIndicator.prototype.formatHeightValue(e),time:Math.floor(InterfaceGameTimer.api.time)})}},ManagerCheckpoint.prototype.getCareer=function(){try{let e=JSON.parse(localStorage.getItem("managerCheckpoint:career"));return e||(e={}),Array.isArray(e.runs)||(e.runs=[]),e}catch(e){}},ManagerCheckpoint.prototype.updateCareer=function(e,t,i){if(t<=0||this.currentElevation<this.resetHeight)return!1;const a=this.getCareer();e=pc.math.clamp(e,0,this.winHeight);let n=a.runs,r=!1;for(let i=n.length-1;i>=0;i--)if(e>n[i].elevation||e===n[i].elevation&&t<n[i].time){r=!0;break}if(r||n.length<3){const r=n.findIndex((e=>i===e.ID));r>-1?(n[r].elevation=e,n[r].time=t):n.push({elevation:e,time:t,ID:i}),a.runs=n.sort(((e,t)=>t.elevation-e.elevation)),a.runs=n.slice(0,3);try{localStorage.setItem("managerCheckpoint:career",JSON.stringify(a))}catch(e){}return 0===r}},ManagerCheckpoint.prototype.trackRespawn=function(e){if(this.activeState===ManagerCheckpoint.STATES.ON_ASCEND&&UranusControllerThirdPerson.api.grounded){const e=this.localPlayer.rigidbody.linearVelocity.length(),t=this.localPlayer.getPosition(),i=t.y-this.lastRespawnPos.y;e<1&&i>=1&&(this.lastRespawnPos.copy(t),this.lastRespawnTime=InterfaceGameTimer.api.time)}if(this.respawnTimer>0&&(this.respawnTimer+=e,this.respawnTimer>=this.respawnDuration&&(this.respawnTimer=void 0,this.clearCheckpoint(),this.app.fire("ad:respawnLastButton:hide"),this.app.fire("ad:respawnCheckpointButton:hide"))),this.careerUpdatedTimer>0&&(this.careerUpdatedTimer-=e,this.careerUpdatedTimer<=0)){const e=InterfaceElevationIndicator.prototype.formatHeightValue(this.careerHeight);ManagerInterface.api.showMessage(`Top height, ${e}m!`,5)}};var InterfaceElevationIndicator=pc.createScript("interfaceElevationIndicator");InterfaceElevationIndicator.attributes.add("displayEvent",{type:"string"}),InterfaceElevationIndicator.prototype.initialize=function(){this.displayHeight(0),this.app.on("checkpoint:elevation:update",this.displayHeight,this)},InterfaceElevationIndicator.prototype.update=function(t){},InterfaceElevationIndicator.prototype.formatHeightValue=function(t){return Math.floor(t)},InterfaceElevationIndicator.prototype.formatHeight=function(t){return`- ${this.formatHeightValue(t)} m -`},InterfaceElevationIndicator.prototype.formatHeightRaw=function(t){return`${this.formatHeightValue(t)}m`},InterfaceElevationIndicator.prototype.displayHeight=function(t){this.displayEvent?this.app.fire(this.displayEvent,this.formatHeight(t)):console.warn("Error: textElement or its element is null or undefined")};var UranusControllerVirtualButton=pc.createScript("uranusControllerVirtualButton");UranusControllerVirtualButton.attributes.add("inputEvent",{type:"string",default:"player:jump",title:"Input Event",description:"The event to fire on click."}),UranusControllerVirtualButton.attributes.add("buttonType",{type:"string",default:"click",enum:[{Click:"click"},{Pressed:"pressed"}],title:"Button Type",description:"Button type (pressed vs click)."}),UranusControllerVirtualButton.attributes.add("enableEvent",{type:"string",default:"UranusControllerThirdPerson:touchInput:enable",title:"Enable Event",description:"If an event is provided this element will be enabled as soon as this event fires."}),UranusControllerVirtualButton.attributes.add("playerEntity",{type:"entity",title:"Player Entity",description:"If a player entity is provided the event will be attached to that entity, otherwise a global Application event will be used."}),UranusControllerVirtualButton.prototype.initialize=function(){switch(this.pressed=void 0,this.prepare(),this.enableEvent&&(this.playerEntity?this.playerEntity.on(this.enableEvent,this.onEnable,this):this.app.on(this.enableEvent,this.onEnable,this)),this.buttonType){case"click":this.entity.button.on("click",this.onAction,this);break;case"pressed":this.entity.button.on("pressedstart",this.onPressedStart,this),this.entity.button.on("pressedend",this.onPressedEnd,this)}this.on("destroy",(function(){this.playerEntity?this.playerEntity.off(this.enableEvent,this.onEnable,this):this.app.off(this.enableEvent,this.onEnable,this),this.entity.button.on("click",this.onAction,this),this.entity.button.on("pressedstart",this.onPressedStart,this),this.entity.button.on("pressedend",this.onPressedEnd,this)}),this)},UranusControllerVirtualButton.prototype.prepare=function(){this.enableEvent&&(this.entity.element.enabled=!1,this.entity.button.enabled=!1)},UranusControllerVirtualButton.prototype.onEnable=function(){this.entity.element.enabled=!0,this.entity.button.enabled=!0},UranusControllerVirtualButton.prototype.onAction=function(){if(this.inputEvent){(this.playerEntity?this.playerEntity:this.app).fire(this.inputEvent)}},UranusControllerVirtualButton.prototype.onPressedStart=function(){this.pressed=!0},UranusControllerVirtualButton.prototype.onPressedEnd=function(){this.pressed=!1},UranusControllerVirtualButton.prototype.update=function(){!0===this.pressed&&this.onAction()};var UiGoogleFont=pc.createScript("uiGoogleFont");UiGoogleFont.attributes.add("fonts",{type:"string",array:!0}),UiGoogleFont.prototype.initialize=function(){WebFont.load({google:{families:this.fonts}})};var UiLoadCss=pc.createScript("uiLoadCss");UiLoadCss.attributes.add("styles",{type:"asset",assetType:"css",array:!0}),UiLoadCss.attributes.add("fontStyles",{type:"asset",assetType:"css",array:!0}),UiLoadCss.prototype.initialize=function(){this.styles.forEach(this.loadCss.bind(this))},UiLoadCss.hasQuote=/^\s*('|")/,UiLoadCss.prototype.replacePathInCSS=function(s,t){return[/(@import\s+)(')(.+?)(')/gi,/(@import\s+)(")(.+?)(")/gi,/(url\s*\()(\s*')([^']+?)(')/gi,/(url\s*\()(\s*")([^"]+?)(")/gi,/(url\s*\()(\s*)([^\s'")].*?)(\s*\))/gi].reduce(((s,e,a)=>s.replace(e,((s,e,a,i,r)=>{var o=t(i,a);return UiLoadCss.hasQuote.test(o)&&UiLoadCss.hasQuote.test(a)&&(a=r=""),e+a+o+r}))),s)},UiLoadCss.prototype.loadCss=function(s){let t=document.createElement("style"),e=s.resource;this.fontStyles.indexOf(s)>-1&&(e=this.replacePathInCSS(e,(s=>{let t=pc.path.getBasename(s);t.indexOf(".ttf")>-1&&(t+="1");const e=this.app.assets.find(t,"binary");if(!e)return;return new URL(e.getFileUrl(),document.baseURI).href}))),t.textContent=e,document.head.appendChild(t)};// bootstrap.bundle.min.js
/*!
  * Bootstrap v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).bootstrap=e()}(this,(function(){"use strict";const t=new Map,e={set(e,i,n){t.has(e)||t.set(e,new Map);const s=t.get(e);s.has(i)||0===s.size?s.set(i,n):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(s.keys())[0]}.`)},get:(e,i)=>t.has(e)&&t.get(e).get(i)||null,remove(e,i){if(!t.has(e))return;const n=t.get(e);n.delete(i),0===n.size&&t.delete(e)}},i="transitionend",n=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,((t,e)=>`#${CSS.escape(e)}`))),t),s=t=>{t.dispatchEvent(new Event(i))},o=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),r=t=>o(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(n(t)):null,a=t=>{if(!o(t)||0===t.getClientRects().length)return!1;const e="visible"===getComputedStyle(t).getPropertyValue("visibility"),i=t.closest("details:not([open])");if(!i)return e;if(i!==t){const e=t.closest("summary");if(e&&e.parentNode!==i)return!1;if(null===e)return!1}return e},l=t=>!t||t.nodeType!==Node.ELEMENT_NODE||!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled")),c=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?c(t.parentNode):null},h=()=>{},d=t=>{t.offsetHeight},u=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,f=[],p=()=>"rtl"===document.documentElement.dir,m=t=>{var e;e=()=>{const e=u();if(e){const i=t.NAME,n=e.fn[i];e.fn[i]=t.jQueryInterface,e.fn[i].Constructor=t,e.fn[i].noConflict=()=>(e.fn[i]=n,t.jQueryInterface)}},"loading"===document.readyState?(f.length||document.addEventListener("DOMContentLoaded",(()=>{for(const t of f)t()})),f.push(e)):e()},g=(t,e=[],i=t)=>"function"==typeof t?t(...e):i,_=(t,e,n=!0)=>{if(!n)return void g(t);const o=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const n=Number.parseFloat(e),s=Number.parseFloat(i);return n||s?(e=e.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(i))):0})(e)+5;let r=!1;const a=({target:n})=>{n===e&&(r=!0,e.removeEventListener(i,a),g(t))};e.addEventListener(i,a),setTimeout((()=>{r||s(e)}),o)},b=(t,e,i,n)=>{const s=t.length;let o=t.indexOf(e);return-1===o?!i&&n?t[s-1]:t[0]:(o+=i?1:-1,n&&(o=(o+s)%s),t[Math.max(0,Math.min(o,s-1))])},v=/[^.]*(?=\..*)\.|.*/,y=/\..*/,w=/::\d+$/,A={};let E=1;const T={mouseenter:"mouseover",mouseleave:"mouseout"},C=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function O(t,e){return e&&`${e}::${E++}`||t.uidEvent||E++}function x(t){const e=O(t);return t.uidEvent=e,A[e]=A[e]||{},A[e]}function k(t,e,i=null){return Object.values(t).find((t=>t.callable===e&&t.delegationSelector===i))}function L(t,e,i){const n="string"==typeof e,s=n?i:e||i;let o=I(t);return C.has(o)||(o=t),[n,s,o]}function S(t,e,i,n,s){if("string"!=typeof e||!t)return;let[o,r,a]=L(e,i,n);if(e in T){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};r=t(r)}const l=x(t),c=l[a]||(l[a]={}),h=k(c,r,o?i:null);if(h)return void(h.oneOff=h.oneOff&&s);const d=O(r,e.replace(v,"")),u=o?function(t,e,i){return function n(s){const o=t.querySelectorAll(e);for(let{target:r}=s;r&&r!==this;r=r.parentNode)for(const a of o)if(a===r)return P(s,{delegateTarget:r}),n.oneOff&&N.off(t,s.type,e,i),i.apply(r,[s])}}(t,i,r):function(t,e){return function i(n){return P(n,{delegateTarget:t}),i.oneOff&&N.off(t,n.type,e),e.apply(t,[n])}}(t,r);u.delegationSelector=o?i:null,u.callable=r,u.oneOff=s,u.uidEvent=d,c[d]=u,t.addEventListener(a,u,o)}function D(t,e,i,n,s){const o=k(e[i],n,s);o&&(t.removeEventListener(i,o,Boolean(s)),delete e[i][o.uidEvent])}function $(t,e,i,n){const s=e[i]||{};for(const[o,r]of Object.entries(s))o.includes(n)&&D(t,e,i,r.callable,r.delegationSelector)}function I(t){return t=t.replace(y,""),T[t]||t}const N={on(t,e,i,n){S(t,e,i,n,!1)},one(t,e,i,n){S(t,e,i,n,!0)},off(t,e,i,n){if("string"!=typeof e||!t)return;const[s,o,r]=L(e,i,n),a=r!==e,l=x(t),c=l[r]||{},h=e.startsWith(".");if(void 0===o){if(h)for(const i of Object.keys(l))$(t,l,i,e.slice(1));for(const[i,n]of Object.entries(c)){const s=i.replace(w,"");a&&!e.includes(s)||D(t,l,r,n.callable,n.delegationSelector)}}else{if(!Object.keys(c).length)return;D(t,l,r,o,s?i:null)}},trigger(t,e,i){if("string"!=typeof e||!t)return null;const n=u();let s=null,o=!0,r=!0,a=!1;e!==I(e)&&n&&(s=n.Event(e,i),n(t).trigger(s),o=!s.isPropagationStopped(),r=!s.isImmediatePropagationStopped(),a=s.isDefaultPrevented());const l=P(new Event(e,{bubbles:o,cancelable:!0}),i);return a&&l.preventDefault(),r&&t.dispatchEvent(l),l.defaultPrevented&&s&&s.preventDefault(),l}};function P(t,e={}){for(const[i,n]of Object.entries(e))try{t[i]=n}catch(e){Object.defineProperty(t,i,{configurable:!0,get:()=>n})}return t}function M(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function j(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}const F={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${j(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${j(e)}`)},getDataAttributes(t){if(!t)return{};const e={},i=Object.keys(t.dataset).filter((t=>t.startsWith("bs")&&!t.startsWith("bsConfig")));for(const n of i){let i=n.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1,i.length),e[i]=M(t.dataset[n])}return e},getDataAttribute:(t,e)=>M(t.getAttribute(`data-bs-${j(e)}`))};class H{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const i=o(e)?F.getDataAttribute(e,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...o(e)?F.getDataAttributes(e):{},..."object"==typeof t?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[n,s]of Object.entries(e)){const e=t[n],r=o(e)?"element":null==(i=e)?`${i}`:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(s).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${r}" but expected type "${s}".`)}var i}}class W extends H{constructor(t,i){super(),(t=r(t))&&(this._element=t,this._config=this._getConfig(i),e.set(this._element,this.constructor.DATA_KEY,this))}dispose(){e.remove(this._element,this.constructor.DATA_KEY),N.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,i=!0){_(t,e,i)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return e.get(r(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.3.1"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const B=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&"#"!==i?i.trim():null}return n(e)},z={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const i=[];let n=t.parentNode.closest(e);for(;n;)i.push(n),n=n.parentNode.closest(e);return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(",");return this.find(e,t).filter((t=>!l(t)&&a(t)))},getSelectorFromElement(t){const e=B(t);return e&&z.findOne(e)?e:null},getElementFromSelector(t){const e=B(t);return e?z.findOne(e):null},getMultipleElementsFromSelector(t){const e=B(t);return e?z.find(e):[]}},R=(t,e="hide")=>{const i=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;N.on(document,i,`[data-bs-dismiss="${n}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),l(this))return;const s=z.getElementFromSelector(this)||this.closest(`.${n}`);t.getOrCreateInstance(s)[e]()}))},q=".bs.alert",V=`close${q}`,K=`closed${q}`;class Q extends W{static get NAME(){return"alert"}close(){if(N.trigger(this._element,V).defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),N.trigger(this._element,K),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=Q.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}R(Q,"close"),m(Q);const X='[data-bs-toggle="button"]';class Y extends W{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each((function(){const e=Y.getOrCreateInstance(this);"toggle"===t&&e[t]()}))}}N.on(document,"click.bs.button.data-api",X,(t=>{t.preventDefault();const e=t.target.closest(X);Y.getOrCreateInstance(e).toggle()})),m(Y);const U=".bs.swipe",G=`touchstart${U}`,J=`touchmove${U}`,Z=`touchend${U}`,tt=`pointerdown${U}`,et=`pointerup${U}`,it={endCallback:null,leftCallback:null,rightCallback:null},nt={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class st extends H{constructor(t,e){super(),this._element=t,t&&st.isSupported()&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return it}static get DefaultType(){return nt}static get NAME(){return"swipe"}dispose(){N.off(this._element,U)}_start(t){this._supportPointerEvents?this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX):this._deltaX=t.touches[0].clientX}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),g(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=40)return;const e=t/this._deltaX;this._deltaX=0,e&&g(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(N.on(this._element,tt,(t=>this._start(t))),N.on(this._element,et,(t=>this._end(t))),this._element.classList.add("pointer-event")):(N.on(this._element,G,(t=>this._start(t))),N.on(this._element,J,(t=>this._move(t))),N.on(this._element,Z,(t=>this._end(t))))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&("pen"===t.pointerType||"touch"===t.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const ot=".bs.carousel",rt=".data-api",at="next",lt="prev",ct="left",ht="right",dt=`slide${ot}`,ut=`slid${ot}`,ft=`keydown${ot}`,pt=`mouseenter${ot}`,mt=`mouseleave${ot}`,gt=`dragstart${ot}`,_t=`load${ot}${rt}`,bt=`click${ot}${rt}`,vt="carousel",yt="active",wt=".active",At=".carousel-item",Et=wt+At,Tt={ArrowLeft:ht,ArrowRight:ct},Ct={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Ot={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class xt extends W{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=z.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===vt&&this.cycle()}static get Default(){return Ct}static get DefaultType(){return Ot}static get NAME(){return"carousel"}next(){this._slide(at)}nextWhenVisible(){!document.hidden&&a(this._element)&&this.next()}prev(){this._slide(lt)}pause(){this._isSliding&&s(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?N.one(this._element,ut,(()=>this.cycle())):this.cycle())}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding)return void N.one(this._element,ut,(()=>this.to(t)));const i=this._getItemIndex(this._getActive());if(i===t)return;const n=t>i?at:lt;this._slide(n,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&N.on(this._element,ft,(t=>this._keydown(t))),"hover"===this._config.pause&&(N.on(this._element,pt,(()=>this.pause())),N.on(this._element,mt,(()=>this._maybeEnableCycle()))),this._config.touch&&st.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const t of z.find(".carousel-item img",this._element))N.on(t,gt,(t=>t.preventDefault()));const t={leftCallback:()=>this._slide(this._directionToOrder(ct)),rightCallback:()=>this._slide(this._directionToOrder(ht)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new st(this._element,t)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=Tt[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=z.findOne(wt,this._indicatorsElement);e.classList.remove(yt),e.removeAttribute("aria-current");const i=z.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);i&&(i.classList.add(yt),i.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),n=t===at,s=e||b(this._getItems(),i,n,this._config.wrap);if(s===i)return;const o=this._getItemIndex(s),r=e=>N.trigger(this._element,e,{relatedTarget:s,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:o});if(r(dt).defaultPrevented)return;if(!i||!s)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=s;const l=n?"carousel-item-start":"carousel-item-end",c=n?"carousel-item-next":"carousel-item-prev";s.classList.add(c),d(s),i.classList.add(l),s.classList.add(l),this._queueCallback((()=>{s.classList.remove(l,c),s.classList.add(yt),i.classList.remove(yt,c,l),this._isSliding=!1,r(ut)}),i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return z.findOne(Et,this._element)}_getItems(){return z.find(At,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return p()?t===ct?lt:at:t===ct?at:lt}_orderToDirection(t){return p()?t===lt?ct:ht:t===lt?ht:ct}static jQueryInterface(t){return this.each((function(){const e=xt.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)}))}}N.on(document,bt,"[data-bs-slide], [data-bs-slide-to]",(function(t){const e=z.getElementFromSelector(this);if(!e||!e.classList.contains(vt))return;t.preventDefault();const i=xt.getOrCreateInstance(e),n=this.getAttribute("data-bs-slide-to");return n?(i.to(n),void i._maybeEnableCycle()):"next"===F.getDataAttribute(this,"slide")?(i.next(),void i._maybeEnableCycle()):(i.prev(),void i._maybeEnableCycle())})),N.on(window,_t,(()=>{const t=z.find('[data-bs-ride="carousel"]');for(const e of t)xt.getOrCreateInstance(e)})),m(xt);const kt=".bs.collapse",Lt=`show${kt}`,St=`shown${kt}`,Dt=`hide${kt}`,$t=`hidden${kt}`,It=`click${kt}.data-api`,Nt="show",Pt="collapse",Mt="collapsing",jt=`:scope .${Pt} .${Pt}`,Ft='[data-bs-toggle="collapse"]',Ht={parent:null,toggle:!0},Wt={parent:"(null|element)",toggle:"boolean"};class Bt extends W{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const i=z.find(Ft);for(const t of i){const e=z.getSelectorFromElement(t),i=z.find(e).filter((t=>t===this._element));null!==e&&i.length&&this._triggerArray.push(t)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Ht}static get DefaultType(){return Wt}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((t=>t!==this._element)).map((t=>Bt.getOrCreateInstance(t,{toggle:!1})))),t.length&&t[0]._isTransitioning)return;if(N.trigger(this._element,Lt).defaultPrevented)return;for(const e of t)e.hide();const e=this._getDimension();this._element.classList.remove(Pt),this._element.classList.add(Mt),this._element.style[e]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=`scroll${e[0].toUpperCase()+e.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(Mt),this._element.classList.add(Pt,Nt),this._element.style[e]="",N.trigger(this._element,St)}),this._element,!0),this._element.style[e]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(N.trigger(this._element,Dt).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,d(this._element),this._element.classList.add(Mt),this._element.classList.remove(Pt,Nt);for(const t of this._triggerArray){const e=z.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(Mt),this._element.classList.add(Pt),N.trigger(this._element,$t)}),this._element,!0)}_isShown(t=this._element){return t.classList.contains(Nt)}_configAfterMerge(t){return t.toggle=Boolean(t.toggle),t.parent=r(t.parent),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(Ft);for(const e of t){const t=z.getElementFromSelector(e);t&&this._addAriaAndCollapsedClass([e],this._isShown(t))}}_getFirstLevelChildren(t){const e=z.find(jt,this._config.parent);return z.find(t,this._config.parent).filter((t=>!e.includes(t)))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const i of t)i.classList.toggle("collapsed",!e),i.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return"string"==typeof t&&/show|hide/.test(t)&&(e.toggle=!1),this.each((function(){const i=Bt.getOrCreateInstance(this,e);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t]()}}))}}N.on(document,It,Ft,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();for(const t of z.getMultipleElementsFromSelector(this))Bt.getOrCreateInstance(t,{toggle:!1}).toggle()})),m(Bt);var zt="top",Rt="bottom",qt="right",Vt="left",Kt="auto",Qt=[zt,Rt,qt,Vt],Xt="start",Yt="end",Ut="clippingParents",Gt="viewport",Jt="popper",Zt="reference",te=Qt.reduce((function(t,e){return t.concat([e+"-"+Xt,e+"-"+Yt])}),[]),ee=[].concat(Qt,[Kt]).reduce((function(t,e){return t.concat([e,e+"-"+Xt,e+"-"+Yt])}),[]),ie="beforeRead",ne="read",se="afterRead",oe="beforeMain",re="main",ae="afterMain",le="beforeWrite",ce="write",he="afterWrite",de=[ie,ne,se,oe,re,ae,le,ce,he];function ue(t){return t?(t.nodeName||"").toLowerCase():null}function fe(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function pe(t){return t instanceof fe(t).Element||t instanceof Element}function me(t){return t instanceof fe(t).HTMLElement||t instanceof HTMLElement}function ge(t){return"undefined"!=typeof ShadowRoot&&(t instanceof fe(t).ShadowRoot||t instanceof ShadowRoot)}const _e={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var i=e.styles[t]||{},n=e.attributes[t]||{},s=e.elements[t];me(s)&&ue(s)&&(Object.assign(s.style,i),Object.keys(n).forEach((function(t){var e=n[t];!1===e?s.removeAttribute(t):s.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach((function(t){var n=e.elements[t],s=e.attributes[t]||{},o=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:i[t]).reduce((function(t,e){return t[e]="",t}),{});me(n)&&ue(n)&&(Object.assign(n.style,o),Object.keys(s).forEach((function(t){n.removeAttribute(t)})))}))}},requires:["computeStyles"]};function be(t){return t.split("-")[0]}var ve=Math.max,ye=Math.min,we=Math.round;function Ae(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function Ee(){return!/^((?!chrome|android).)*safari/i.test(Ae())}function Te(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n=t.getBoundingClientRect(),s=1,o=1;e&&me(t)&&(s=t.offsetWidth>0&&we(n.width)/t.offsetWidth||1,o=t.offsetHeight>0&&we(n.height)/t.offsetHeight||1);var r=(pe(t)?fe(t):window).visualViewport,a=!Ee()&&i,l=(n.left+(a&&r?r.offsetLeft:0))/s,c=(n.top+(a&&r?r.offsetTop:0))/o,h=n.width/s,d=n.height/o;return{width:h,height:d,top:c,right:l+h,bottom:c+d,left:l,x:l,y:c}}function Ce(t){var e=Te(t),i=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:n}}function Oe(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&ge(i)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function xe(t){return fe(t).getComputedStyle(t)}function ke(t){return["table","td","th"].indexOf(ue(t))>=0}function Le(t){return((pe(t)?t.ownerDocument:t.document)||window.document).documentElement}function Se(t){return"html"===ue(t)?t:t.assignedSlot||t.parentNode||(ge(t)?t.host:null)||Le(t)}function De(t){return me(t)&&"fixed"!==xe(t).position?t.offsetParent:null}function $e(t){for(var e=fe(t),i=De(t);i&&ke(i)&&"static"===xe(i).position;)i=De(i);return i&&("html"===ue(i)||"body"===ue(i)&&"static"===xe(i).position)?e:i||function(t){var e=/firefox/i.test(Ae());if(/Trident/i.test(Ae())&&me(t)&&"fixed"===xe(t).position)return null;var i=Se(t);for(ge(i)&&(i=i.host);me(i)&&["html","body"].indexOf(ue(i))<0;){var n=xe(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||e&&"filter"===n.willChange||e&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(t)||e}function Ie(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Ne(t,e,i){return ve(t,ye(e,i))}function Pe(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function Me(t,e){return e.reduce((function(e,i){return e[i]=t,e}),{})}const je={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,i=t.state,n=t.name,s=t.options,o=i.elements.arrow,r=i.modifiersData.popperOffsets,a=be(i.placement),l=Ie(a),c=[Vt,qt].indexOf(a)>=0?"height":"width";if(o&&r){var h=function(t,e){return Pe("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:Me(t,Qt))}(s.padding,i),d=Ce(o),u="y"===l?zt:Vt,f="y"===l?Rt:qt,p=i.rects.reference[c]+i.rects.reference[l]-r[l]-i.rects.popper[c],m=r[l]-i.rects.reference[l],g=$e(o),_=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,b=p/2-m/2,v=h[u],y=_-d[c]-h[f],w=_/2-d[c]/2+b,A=Ne(v,w,y),E=l;i.modifiersData[n]=((e={})[E]=A,e.centerOffset=A-w,e)}},effect:function(t){var e=t.state,i=t.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=e.elements.popper.querySelector(n)))&&Oe(e.elements.popper,n)&&(e.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Fe(t){return t.split("-")[1]}var He={top:"auto",right:"auto",bottom:"auto",left:"auto"};function We(t){var e,i=t.popper,n=t.popperRect,s=t.placement,o=t.variation,r=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,h=t.roundOffsets,d=t.isFixed,u=r.x,f=void 0===u?0:u,p=r.y,m=void 0===p?0:p,g="function"==typeof h?h({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var _=r.hasOwnProperty("x"),b=r.hasOwnProperty("y"),v=Vt,y=zt,w=window;if(c){var A=$e(i),E="clientHeight",T="clientWidth";A===fe(i)&&"static"!==xe(A=Le(i)).position&&"absolute"===a&&(E="scrollHeight",T="scrollWidth"),(s===zt||(s===Vt||s===qt)&&o===Yt)&&(y=Rt,m-=(d&&A===w&&w.visualViewport?w.visualViewport.height:A[E])-n.height,m*=l?1:-1),s!==Vt&&(s!==zt&&s!==Rt||o!==Yt)||(v=qt,f-=(d&&A===w&&w.visualViewport?w.visualViewport.width:A[T])-n.width,f*=l?1:-1)}var C,O=Object.assign({position:a},c&&He),x=!0===h?function(t,e){var i=t.x,n=t.y,s=e.devicePixelRatio||1;return{x:we(i*s)/s||0,y:we(n*s)/s||0}}({x:f,y:m},fe(i)):{x:f,y:m};return f=x.x,m=x.y,l?Object.assign({},O,((C={})[y]=b?"0":"",C[v]=_?"0":"",C.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",C)):Object.assign({},O,((e={})[y]=b?m+"px":"",e[v]=_?f+"px":"",e.transform="",e))}const Be={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,i=t.options,n=i.gpuAcceleration,s=void 0===n||n,o=i.adaptive,r=void 0===o||o,a=i.roundOffsets,l=void 0===a||a,c={placement:be(e.placement),variation:Fe(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:s,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,We(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,We(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}};var ze={passive:!0};const Re={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,i=t.instance,n=t.options,s=n.scroll,o=void 0===s||s,r=n.resize,a=void 0===r||r,l=fe(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach((function(t){t.addEventListener("scroll",i.update,ze)})),a&&l.addEventListener("resize",i.update,ze),function(){o&&c.forEach((function(t){t.removeEventListener("scroll",i.update,ze)})),a&&l.removeEventListener("resize",i.update,ze)}},data:{}};var qe={left:"right",right:"left",bottom:"top",top:"bottom"};function Ve(t){return t.replace(/left|right|bottom|top/g,(function(t){return qe[t]}))}var Ke={start:"end",end:"start"};function Qe(t){return t.replace(/start|end/g,(function(t){return Ke[t]}))}function Xe(t){var e=fe(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ye(t){return Te(Le(t)).left+Xe(t).scrollLeft}function Ue(t){var e=xe(t),i=e.overflow,n=e.overflowX,s=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+n)}function Ge(t){return["html","body","#document"].indexOf(ue(t))>=0?t.ownerDocument.body:me(t)&&Ue(t)?t:Ge(Se(t))}function Je(t,e){var i;void 0===e&&(e=[]);var n=Ge(t),s=n===(null==(i=t.ownerDocument)?void 0:i.body),o=fe(n),r=s?[o].concat(o.visualViewport||[],Ue(n)?n:[]):n,a=e.concat(r);return s?a:a.concat(Je(Se(r)))}function Ze(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function ti(t,e,i){return e===Gt?Ze(function(t,e){var i=fe(t),n=Le(t),s=i.visualViewport,o=n.clientWidth,r=n.clientHeight,a=0,l=0;if(s){o=s.width,r=s.height;var c=Ee();(c||!c&&"fixed"===e)&&(a=s.offsetLeft,l=s.offsetTop)}return{width:o,height:r,x:a+Ye(t),y:l}}(t,i)):pe(e)?function(t,e){var i=Te(t,!1,"fixed"===e);return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}(e,i):Ze(function(t){var e,i=Le(t),n=Xe(t),s=null==(e=t.ownerDocument)?void 0:e.body,o=ve(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),r=ve(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-n.scrollLeft+Ye(t),l=-n.scrollTop;return"rtl"===xe(s||i).direction&&(a+=ve(i.clientWidth,s?s.clientWidth:0)-o),{width:o,height:r,x:a,y:l}}(Le(t)))}function ei(t){var e,i=t.reference,n=t.element,s=t.placement,o=s?be(s):null,r=s?Fe(s):null,a=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(o){case zt:e={x:a,y:i.y-n.height};break;case Rt:e={x:a,y:i.y+i.height};break;case qt:e={x:i.x+i.width,y:l};break;case Vt:e={x:i.x-n.width,y:l};break;default:e={x:i.x,y:i.y}}var c=o?Ie(o):null;if(null!=c){var h="y"===c?"height":"width";switch(r){case Xt:e[c]=e[c]-(i[h]/2-n[h]/2);break;case Yt:e[c]=e[c]+(i[h]/2-n[h]/2)}}return e}function ii(t,e){void 0===e&&(e={});var i=e,n=i.placement,s=void 0===n?t.placement:n,o=i.strategy,r=void 0===o?t.strategy:o,a=i.boundary,l=void 0===a?Ut:a,c=i.rootBoundary,h=void 0===c?Gt:c,d=i.elementContext,u=void 0===d?Jt:d,f=i.altBoundary,p=void 0!==f&&f,m=i.padding,g=void 0===m?0:m,_=Pe("number"!=typeof g?g:Me(g,Qt)),b=u===Jt?Zt:Jt,v=t.rects.popper,y=t.elements[p?b:u],w=function(t,e,i,n){var s="clippingParents"===e?function(t){var e=Je(Se(t)),i=["absolute","fixed"].indexOf(xe(t).position)>=0&&me(t)?$e(t):t;return pe(i)?e.filter((function(t){return pe(t)&&Oe(t,i)&&"body"!==ue(t)})):[]}(t):[].concat(e),o=[].concat(s,[i]),r=o[0],a=o.reduce((function(e,i){var s=ti(t,i,n);return e.top=ve(s.top,e.top),e.right=ye(s.right,e.right),e.bottom=ye(s.bottom,e.bottom),e.left=ve(s.left,e.left),e}),ti(t,r,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(pe(y)?y:y.contextElement||Le(t.elements.popper),l,h,r),A=Te(t.elements.reference),E=ei({reference:A,element:v,strategy:"absolute",placement:s}),T=Ze(Object.assign({},v,E)),C=u===Jt?T:A,O={top:w.top-C.top+_.top,bottom:C.bottom-w.bottom+_.bottom,left:w.left-C.left+_.left,right:C.right-w.right+_.right},x=t.modifiersData.offset;if(u===Jt&&x){var k=x[s];Object.keys(O).forEach((function(t){var e=[qt,Rt].indexOf(t)>=0?1:-1,i=[zt,Rt].indexOf(t)>=0?"y":"x";O[t]+=k[i]*e}))}return O}function ni(t,e){void 0===e&&(e={});var i=e,n=i.placement,s=i.boundary,o=i.rootBoundary,r=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,c=void 0===l?ee:l,h=Fe(n),d=h?a?te:te.filter((function(t){return Fe(t)===h})):Qt,u=d.filter((function(t){return c.indexOf(t)>=0}));0===u.length&&(u=d);var f=u.reduce((function(e,i){return e[i]=ii(t,{placement:i,boundary:s,rootBoundary:o,padding:r})[be(i)],e}),{});return Object.keys(f).sort((function(t,e){return f[t]-f[e]}))}const si={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var s=i.mainAxis,o=void 0===s||s,r=i.altAxis,a=void 0===r||r,l=i.fallbackPlacements,c=i.padding,h=i.boundary,d=i.rootBoundary,u=i.altBoundary,f=i.flipVariations,p=void 0===f||f,m=i.allowedAutoPlacements,g=e.options.placement,_=be(g),b=l||(_!==g&&p?function(t){if(be(t)===Kt)return[];var e=Ve(t);return[Qe(t),e,Qe(e)]}(g):[Ve(g)]),v=[g].concat(b).reduce((function(t,i){return t.concat(be(i)===Kt?ni(e,{placement:i,boundary:h,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:m}):i)}),[]),y=e.rects.reference,w=e.rects.popper,A=new Map,E=!0,T=v[0],C=0;C<v.length;C++){var O=v[C],x=be(O),k=Fe(O)===Xt,L=[zt,Rt].indexOf(x)>=0,S=L?"width":"height",D=ii(e,{placement:O,boundary:h,rootBoundary:d,altBoundary:u,padding:c}),$=L?k?qt:Vt:k?Rt:zt;y[S]>w[S]&&($=Ve($));var I=Ve($),N=[];if(o&&N.push(D[x]<=0),a&&N.push(D[$]<=0,D[I]<=0),N.every((function(t){return t}))){T=O,E=!1;break}A.set(O,N)}if(E)for(var P=function(t){var e=v.find((function(e){var i=A.get(e);if(i)return i.slice(0,t).every((function(t){return t}))}));if(e)return T=e,"break"},M=p?3:1;M>0&&"break"!==P(M);M--);e.placement!==T&&(e.modifiersData[n]._skip=!0,e.placement=T,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function oi(t,e,i){return void 0===i&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function ri(t){return[zt,qt,Rt,Vt].some((function(e){return t[e]>=0}))}const ai={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,i=t.name,n=e.rects.reference,s=e.rects.popper,o=e.modifiersData.preventOverflow,r=ii(e,{elementContext:"reference"}),a=ii(e,{altBoundary:!0}),l=oi(r,n),c=oi(a,s,o),h=ri(l),d=ri(c);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":d})}},li={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,i=t.options,n=t.name,s=i.offset,o=void 0===s?[0,0]:s,r=ee.reduce((function(t,i){return t[i]=function(t,e,i){var n=be(t),s=[Vt,zt].indexOf(n)>=0?-1:1,o="function"==typeof i?i(Object.assign({},e,{placement:t})):i,r=o[0],a=o[1];return r=r||0,a=(a||0)*s,[Vt,qt].indexOf(n)>=0?{x:a,y:r}:{x:r,y:a}}(i,e.rects,o),t}),{}),a=r[e.placement],l=a.x,c=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=r}},ci={name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,i=t.name;e.modifiersData[i]=ei({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},hi={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name,s=i.mainAxis,o=void 0===s||s,r=i.altAxis,a=void 0!==r&&r,l=i.boundary,c=i.rootBoundary,h=i.altBoundary,d=i.padding,u=i.tether,f=void 0===u||u,p=i.tetherOffset,m=void 0===p?0:p,g=ii(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:h}),_=be(e.placement),b=Fe(e.placement),v=!b,y=Ie(_),w="x"===y?"y":"x",A=e.modifiersData.popperOffsets,E=e.rects.reference,T=e.rects.popper,C="function"==typeof m?m(Object.assign({},e.rects,{placement:e.placement})):m,O="number"==typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),x=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,k={x:0,y:0};if(A){if(o){var L,S="y"===y?zt:Vt,D="y"===y?Rt:qt,$="y"===y?"height":"width",I=A[y],N=I+g[S],P=I-g[D],M=f?-T[$]/2:0,j=b===Xt?E[$]:T[$],F=b===Xt?-T[$]:-E[$],H=e.elements.arrow,W=f&&H?Ce(H):{width:0,height:0},B=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},z=B[S],R=B[D],q=Ne(0,E[$],W[$]),V=v?E[$]/2-M-q-z-O.mainAxis:j-q-z-O.mainAxis,K=v?-E[$]/2+M+q+R+O.mainAxis:F+q+R+O.mainAxis,Q=e.elements.arrow&&$e(e.elements.arrow),X=Q?"y"===y?Q.clientTop||0:Q.clientLeft||0:0,Y=null!=(L=null==x?void 0:x[y])?L:0,U=I+K-Y,G=Ne(f?ye(N,I+V-Y-X):N,I,f?ve(P,U):P);A[y]=G,k[y]=G-I}if(a){var J,Z="x"===y?zt:Vt,tt="x"===y?Rt:qt,et=A[w],it="y"===w?"height":"width",nt=et+g[Z],st=et-g[tt],ot=-1!==[zt,Vt].indexOf(_),rt=null!=(J=null==x?void 0:x[w])?J:0,at=ot?nt:et-E[it]-T[it]-rt+O.altAxis,lt=ot?et+E[it]+T[it]-rt-O.altAxis:st,ct=f&&ot?function(t,e,i){var n=Ne(t,e,i);return n>i?i:n}(at,et,lt):Ne(f?at:nt,et,f?lt:st);A[w]=ct,k[w]=ct-et}e.modifiersData[n]=k}},requiresIfExists:["offset"]};function di(t,e,i){void 0===i&&(i=!1);var n,s,o=me(e),r=me(e)&&function(t){var e=t.getBoundingClientRect(),i=we(e.width)/t.offsetWidth||1,n=we(e.height)/t.offsetHeight||1;return 1!==i||1!==n}(e),a=Le(e),l=Te(t,r,i),c={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(o||!o&&!i)&&(("body"!==ue(e)||Ue(a))&&(c=(n=e)!==fe(n)&&me(n)?{scrollLeft:(s=n).scrollLeft,scrollTop:s.scrollTop}:Xe(n)),me(e)?((h=Te(e,!0)).x+=e.clientLeft,h.y+=e.clientTop):a&&(h.x=Ye(a))),{x:l.left+c.scrollLeft-h.x,y:l.top+c.scrollTop-h.y,width:l.width,height:l.height}}function ui(t){var e=new Map,i=new Set,n=[];function s(t){i.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!i.has(t)){var n=e.get(t);n&&s(n)}})),n.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){i.has(t.name)||s(t)})),n}var fi={placement:"bottom",modifiers:[],strategy:"absolute"};function pi(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function mi(t){void 0===t&&(t={});var e=t,i=e.defaultModifiers,n=void 0===i?[]:i,s=e.defaultOptions,o=void 0===s?fi:s;return function(t,e,i){void 0===i&&(i=o);var s,r,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},fi,o),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],c=!1,h={state:a,setOptions:function(i){var s="function"==typeof i?i(a.options):i;d(),a.options=Object.assign({},o,a.options,s),a.scrollParents={reference:pe(t)?Je(t):t.contextElement?Je(t.contextElement):[],popper:Je(e)};var r,c,u=function(t){var e=ui(t);return de.reduce((function(t,i){return t.concat(e.filter((function(t){return t.phase===i})))}),[])}((r=[].concat(n,a.options.modifiers),c=r.reduce((function(t,e){var i=t[e.name];return t[e.name]=i?Object.assign({},i,e,{options:Object.assign({},i.options,e.options),data:Object.assign({},i.data,e.data)}):e,t}),{}),Object.keys(c).map((function(t){return c[t]}))));return a.orderedModifiers=u.filter((function(t){return t.enabled})),a.orderedModifiers.forEach((function(t){var e=t.name,i=t.options,n=void 0===i?{}:i,s=t.effect;if("function"==typeof s){var o=s({state:a,name:e,instance:h,options:n});l.push(o||function(){})}})),h.update()},forceUpdate:function(){if(!c){var t=a.elements,e=t.reference,i=t.popper;if(pi(e,i)){a.rects={reference:di(e,$e(i),"fixed"===a.options.strategy),popper:Ce(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(t){return a.modifiersData[t.name]=Object.assign({},t.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var s=a.orderedModifiers[n],o=s.fn,r=s.options,l=void 0===r?{}:r,d=s.name;"function"==typeof o&&(a=o({state:a,options:l,name:d,instance:h})||a)}else a.reset=!1,n=-1}}},update:(s=function(){return new Promise((function(t){h.forceUpdate(),t(a)}))},function(){return r||(r=new Promise((function(t){Promise.resolve().then((function(){r=void 0,t(s())}))}))),r}),destroy:function(){d(),c=!0}};if(!pi(t,e))return h;function d(){l.forEach((function(t){return t()})),l=[]}return h.setOptions(i).then((function(t){!c&&i.onFirstUpdate&&i.onFirstUpdate(t)})),h}}var gi=mi(),_i=mi({defaultModifiers:[Re,ci,Be,_e]}),bi=mi({defaultModifiers:[Re,ci,Be,_e,li,si,hi,je,ai]});const vi=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ae,afterRead:se,afterWrite:he,applyStyles:_e,arrow:je,auto:Kt,basePlacements:Qt,beforeMain:oe,beforeRead:ie,beforeWrite:le,bottom:Rt,clippingParents:Ut,computeStyles:Be,createPopper:bi,createPopperBase:gi,createPopperLite:_i,detectOverflow:ii,end:Yt,eventListeners:Re,flip:si,hide:ai,left:Vt,main:re,modifierPhases:de,offset:li,placements:ee,popper:Jt,popperGenerator:mi,popperOffsets:ci,preventOverflow:hi,read:ne,reference:Zt,right:qt,start:Xt,top:zt,variationPlacements:te,viewport:Gt,write:ce},Symbol.toStringTag,{value:"Module"})),yi="dropdown",wi=".bs.dropdown",Ai=".data-api",Ei="ArrowUp",Ti="ArrowDown",Ci=`hide${wi}`,Oi=`hidden${wi}`,xi=`show${wi}`,ki=`shown${wi}`,Li=`click${wi}${Ai}`,Si=`keydown${wi}${Ai}`,Di=`keyup${wi}${Ai}`,$i="show",Ii='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Ni=`${Ii}.${$i}`,Pi=".dropdown-menu",Mi=p()?"top-end":"top-start",ji=p()?"top-start":"top-end",Fi=p()?"bottom-end":"bottom-start",Hi=p()?"bottom-start":"bottom-end",Wi=p()?"left-start":"right-start",Bi=p()?"right-start":"left-start",zi={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Ri={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class qi extends W{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=z.next(this._element,Pi)[0]||z.prev(this._element,Pi)[0]||z.findOne(Pi,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return zi}static get DefaultType(){return Ri}static get NAME(){return yi}toggle(){return this._isShown()?this.hide():this.show()}show(){if(l(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!N.trigger(this._element,xi,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const t of[].concat(...document.body.children))N.on(t,"mouseover",h);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add($i),this._element.classList.add($i),N.trigger(this._element,ki,t)}}hide(){if(l(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!N.trigger(this._element,Ci,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))N.off(t,"mouseover",h);this._popper&&this._popper.destroy(),this._menu.classList.remove($i),this._element.classList.remove($i),this._element.setAttribute("aria-expanded","false"),F.removeDataAttribute(this._menu,"popper"),N.trigger(this._element,Oi,t)}}_getConfig(t){if("object"==typeof(t=super._getConfig(t)).reference&&!o(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw new TypeError(`${yi.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(void 0===vi)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let t=this._element;"parent"===this._config.reference?t=this._parent:o(this._config.reference)?t=r(this._config.reference):"object"==typeof this._config.reference&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=bi(t,this._menu,e)}_isShown(){return this._menu.classList.contains($i)}_getPlacement(){const t=this._parent;if(t.classList.contains("dropend"))return Wi;if(t.classList.contains("dropstart"))return Bi;if(t.classList.contains("dropup-center"))return"top";if(t.classList.contains("dropdown-center"))return"bottom";const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?ji:Mi:e?Hi:Fi}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(F.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...g(this._config.popperConfig,[t])}}_selectMenuItem({key:t,target:e}){const i=z.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((t=>a(t)));i.length&&b(i,e,t===Ti,!i.includes(e)).focus()}static jQueryInterface(t){return this.each((function(){const e=qi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}static clearMenus(t){if(2===t.button||"keyup"===t.type&&"Tab"!==t.key)return;const e=z.find(Ni);for(const i of e){const e=qi.getInstance(i);if(!e||!1===e._config.autoClose)continue;const n=t.composedPath(),s=n.includes(e._menu);if(n.includes(e._element)||"inside"===e._config.autoClose&&!s||"outside"===e._config.autoClose&&s)continue;if(e._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const o={relatedTarget:e._element};"click"===t.type&&(o.clickEvent=t),e._completeHide(o)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),i="Escape"===t.key,n=[Ei,Ti].includes(t.key);if(!n&&!i)return;if(e&&!i)return;t.preventDefault();const s=this.matches(Ii)?this:z.prev(this,Ii)[0]||z.next(this,Ii)[0]||z.findOne(Ii,t.delegateTarget.parentNode),o=qi.getOrCreateInstance(s);if(n)return t.stopPropagation(),o.show(),void o._selectMenuItem(t);o._isShown()&&(t.stopPropagation(),o.hide(),s.focus())}}N.on(document,Si,Ii,qi.dataApiKeydownHandler),N.on(document,Si,Pi,qi.dataApiKeydownHandler),N.on(document,Li,qi.clearMenus),N.on(document,Di,qi.clearMenus),N.on(document,Li,Ii,(function(t){t.preventDefault(),qi.getOrCreateInstance(this).toggle()})),m(qi);const Vi="backdrop",Ki="show",Qi=`mousedown.bs.${Vi}`,Xi={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Yi={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Ui extends H{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return Xi}static get DefaultType(){return Yi}static get NAME(){return Vi}show(t){if(!this._config.isVisible)return void g(t);this._append();const e=this._getElement();this._config.isAnimated&&d(e),e.classList.add(Ki),this._emulateAnimation((()=>{g(t)}))}hide(t){this._config.isVisible?(this._getElement().classList.remove(Ki),this._emulateAnimation((()=>{this.dispose(),g(t)}))):g(t)}dispose(){this._isAppended&&(N.off(this._element,Qi),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add("fade"),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=r(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),N.on(t,Qi,(()=>{g(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(t){_(t,this._getElement(),this._config.isAnimated)}}const Gi=".bs.focustrap",Ji=`focusin${Gi}`,Zi=`keydown.tab${Gi}`,tn="backward",en={autofocus:!0,trapElement:null},nn={autofocus:"boolean",trapElement:"element"};class sn extends H{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return en}static get DefaultType(){return nn}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),N.off(document,Gi),N.on(document,Ji,(t=>this._handleFocusin(t))),N.on(document,Zi,(t=>this._handleKeydown(t))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,N.off(document,Gi))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const i=z.focusableChildren(e);0===i.length?e.focus():this._lastTabNavDirection===tn?i[i.length-1].focus():i[0].focus()}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?tn:"forward")}}const on=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",rn=".sticky-top",an="padding-right",ln="margin-right";class cn{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,an,(e=>e+t)),this._setElementAttributes(on,an,(e=>e+t)),this._setElementAttributes(rn,ln,(e=>e-t))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,an),this._resetElementAttributes(on,an),this._resetElementAttributes(rn,ln)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const n=this.getWidth();this._applyManipulationCallback(t,(t=>{if(t!==this._element&&window.innerWidth>t.clientWidth+n)return;this._saveInitialAttribute(t,e);const s=window.getComputedStyle(t).getPropertyValue(e);t.style.setProperty(e,`${i(Number.parseFloat(s))}px`)}))}_saveInitialAttribute(t,e){const i=t.style.getPropertyValue(e);i&&F.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){this._applyManipulationCallback(t,(t=>{const i=F.getDataAttribute(t,e);null!==i?(F.removeDataAttribute(t,e),t.style.setProperty(e,i)):t.style.removeProperty(e)}))}_applyManipulationCallback(t,e){if(o(t))e(t);else for(const i of z.find(t,this._element))e(i)}}const hn=".bs.modal",dn=`hide${hn}`,un=`hidePrevented${hn}`,fn=`hidden${hn}`,pn=`show${hn}`,mn=`shown${hn}`,gn=`resize${hn}`,_n=`click.dismiss${hn}`,bn=`mousedown.dismiss${hn}`,vn=`keydown.dismiss${hn}`,yn=`click${hn}.data-api`,wn="modal-open",An="show",En="modal-static",Tn={backdrop:!0,focus:!0,keyboard:!0},Cn={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class On extends W{constructor(t,e){super(t,e),this._dialog=z.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new cn,this._addEventListeners()}static get Default(){return Tn}static get DefaultType(){return Cn}static get NAME(){return"modal"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||N.trigger(this._element,pn,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(wn),this._adjustDialog(),this._backdrop.show((()=>this._showElement(t))))}hide(){this._isShown&&!this._isTransitioning&&(N.trigger(this._element,dn).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(An),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated())))}dispose(){N.off(window,hn),N.off(this._dialog,hn),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ui({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new sn({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=z.findOne(".modal-body",this._dialog);e&&(e.scrollTop=0),d(this._element),this._element.classList.add(An),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,N.trigger(this._element,mn,{relatedTarget:t})}),this._dialog,this._isAnimated())}_addEventListeners(){N.on(this._element,vn,(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())})),N.on(window,gn,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),N.on(this._element,bn,(t=>{N.one(this._element,_n,(e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(wn),this._resetAdjustments(),this._scrollBar.reset(),N.trigger(this._element,fn)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(N.trigger(this._element,un).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._element.style.overflowY;"hidden"===e||this._element.classList.contains(En)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(En),this._queueCallback((()=>{this._element.classList.remove(En),this._queueCallback((()=>{this._element.style.overflowY=e}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;if(i&&!t){const t=p()?"paddingLeft":"paddingRight";this._element.style[t]=`${e}px`}if(!i&&t){const t=p()?"paddingRight":"paddingLeft";this._element.style[t]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const i=On.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t](e)}}))}}N.on(document,yn,'[data-bs-toggle="modal"]',(function(t){const e=z.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),N.one(e,pn,(t=>{t.defaultPrevented||N.one(e,fn,(()=>{a(this)&&this.focus()}))}));const i=z.findOne(".modal.show");i&&On.getInstance(i).hide(),On.getOrCreateInstance(e).toggle(this)})),R(On),m(On);const xn=".bs.offcanvas",kn=".data-api",Ln=`load${xn}${kn}`,Sn="show",Dn="showing",$n="hiding",In=".offcanvas.show",Nn=`show${xn}`,Pn=`shown${xn}`,Mn=`hide${xn}`,jn=`hidePrevented${xn}`,Fn=`hidden${xn}`,Hn=`resize${xn}`,Wn=`click${xn}${kn}`,Bn=`keydown.dismiss${xn}`,zn={backdrop:!0,keyboard:!0,scroll:!1},Rn={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class qn extends W{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return zn}static get DefaultType(){return Rn}static get NAME(){return"offcanvas"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||N.trigger(this._element,Nn,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new cn).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Dn),this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(Sn),this._element.classList.remove(Dn),N.trigger(this._element,Pn,{relatedTarget:t})}),this._element,!0))}hide(){this._isShown&&(N.trigger(this._element,Mn).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add($n),this._backdrop.hide(),this._queueCallback((()=>{this._element.classList.remove(Sn,$n),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new cn).reset(),N.trigger(this._element,Fn)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=Boolean(this._config.backdrop);return new Ui({className:"offcanvas-backdrop",isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?()=>{"static"!==this._config.backdrop?this.hide():N.trigger(this._element,jn)}:null})}_initializeFocusTrap(){return new sn({trapElement:this._element})}_addEventListeners(){N.on(this._element,Bn,(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():N.trigger(this._element,jn))}))}static jQueryInterface(t){return this.each((function(){const e=qn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}N.on(document,Wn,'[data-bs-toggle="offcanvas"]',(function(t){const e=z.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),l(this))return;N.one(e,Fn,(()=>{a(this)&&this.focus()}));const i=z.findOne(In);i&&i!==e&&qn.getInstance(i).hide(),qn.getOrCreateInstance(e).toggle(this)})),N.on(window,Ln,(()=>{for(const t of z.find(In))qn.getOrCreateInstance(t).show()})),N.on(window,Hn,(()=>{for(const t of z.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(t).position&&qn.getOrCreateInstance(t).hide()})),R(qn),m(qn);const Vn={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Kn=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Qn=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Xn=(t,e)=>{const i=t.nodeName.toLowerCase();return e.includes(i)?!Kn.has(i)||Boolean(Qn.test(t.nodeValue)):e.filter((t=>t instanceof RegExp)).some((t=>t.test(i)))},Yn={allowList:Vn,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Un={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Gn={entry:"(string|element|function|null)",selector:"(string|element)"};class Jn extends H{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return Yn}static get DefaultType(){return Un}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((t=>this._resolvePossibleFunction(t))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[e,i]of Object.entries(this._config.content))this._setContent(t,i,e);const e=t.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&e.classList.add(...i.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,i]of Object.entries(t))super._typeCheckConfig({selector:e,entry:i},Gn)}_setContent(t,e,i){const n=z.findOne(i,t);n&&((e=this._resolvePossibleFunction(e))?o(e)?this._putElementInTemplate(r(e),n):this._config.html?n.innerHTML=this._maybeSanitize(e):n.textContent=e:n.remove())}_maybeSanitize(t){return this._config.sanitize?function(t,e,i){if(!t.length)return t;if(i&&"function"==typeof i)return i(t);const n=(new window.DOMParser).parseFromString(t,"text/html"),s=[].concat(...n.body.querySelectorAll("*"));for(const t of s){const i=t.nodeName.toLowerCase();if(!Object.keys(e).includes(i)){t.remove();continue}const n=[].concat(...t.attributes),s=[].concat(e["*"]||[],e[i]||[]);for(const e of n)Xn(e,s)||t.removeAttribute(e.nodeName)}return n.body.innerHTML}(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return g(t,[this])}_putElementInTemplate(t,e){if(this._config.html)return e.innerHTML="",void e.append(t);e.textContent=t.textContent}}const Zn=new Set(["sanitize","allowList","sanitizeFn"]),ts="fade",es="show",is=".modal",ns="hide.bs.modal",ss="hover",os="focus",rs={AUTO:"auto",TOP:"top",RIGHT:p()?"left":"right",BOTTOM:"bottom",LEFT:p()?"right":"left"},as={allowList:Vn,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ls={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class cs extends W{constructor(t,e){if(void 0===vi)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return as}static get DefaultType(){return ls}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),N.off(this._element.closest(is),ns,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const t=N.trigger(this._element,this.constructor.eventName("show")),e=(c(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!e)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:n}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(n.append(i),N.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(i),i.classList.add(es),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))N.on(t,"mouseover",h);this._queueCallback((()=>{N.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(this._isShown()&&!N.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(es),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))N.off(t,"mouseover",h);this._activeTrigger.click=!1,this._activeTrigger[os]=!1,this._activeTrigger[ss]=!1,this._isHovered=null,this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),N.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(ts,es),e.classList.add(`bs-${this.constructor.NAME}-auto`);const i=(t=>{do{t+=Math.floor(1e6*Math.random())}while(document.getElementById(t));return t})(this.constructor.NAME).toString();return e.setAttribute("id",i),this._isAnimated()&&e.classList.add(ts),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new Jn({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(ts)}_isShown(){return this.tip&&this.tip.classList.contains(es)}_createPopper(t){const e=g(this._config.placement,[this,t,this._element]),i=rs[e.toUpperCase()];return bi(this._element,t,this._getPopperConfig(i))}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(t){return g(t,[this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:t=>{this._getTipElement().setAttribute("data-popper-placement",t.state.placement)}}]};return{...e,...g(this._config.popperConfig,[e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if("click"===e)N.on(this._element,this.constructor.eventName("click"),this._config.selector,(t=>{this._initializeOnDelegatedTarget(t).toggle()}));else if("manual"!==e){const t=e===ss?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),i=e===ss?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");N.on(this._element,t,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusin"===t.type?os:ss]=!0,e._enter()})),N.on(this._element,i,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusout"===t.type?os:ss]=e._element.contains(t.relatedTarget),e._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},N.on(this._element.closest(is),ns,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=F.getDataAttributes(this._element);for(const t of Object.keys(e))Zn.has(t)&&delete e[t];return t={...e,..."object"==typeof t&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=!1===t.container?document.body:r(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,i]of Object.entries(this._config))this.constructor.Default[e]!==i&&(t[e]=i);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each((function(){const e=cs.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}m(cs);const hs={...cs.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ds={...cs.DefaultType,content:"(null|string|element|function)"};class us extends cs{static get Default(){return hs}static get DefaultType(){return ds}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each((function(){const e=us.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}m(us);const fs=".bs.scrollspy",ps=`activate${fs}`,ms=`click${fs}`,gs=`load${fs}.data-api`,_s="active",bs="[href]",vs=".nav-link",ys=`${vs}, .nav-item > ${vs}, .list-group-item`,ws={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},As={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Es extends W{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ws}static get DefaultType(){return As}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=r(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,"string"==typeof t.threshold&&(t.threshold=t.threshold.split(",").map((t=>Number.parseFloat(t)))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(N.off(this._config.target,ms),N.on(this._config.target,ms,bs,(t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const i=this._rootElement||window,n=e.offsetTop-this._element.offsetTop;if(i.scrollTo)return void i.scrollTo({top:n,behavior:"smooth"});i.scrollTop=n}})))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((t=>this._observerCallback(t)),t)}_observerCallback(t){const e=t=>this._targetLinks.get(`#${t.target.id}`),i=t=>{this._previousScrollData.visibleEntryTop=t.target.offsetTop,this._process(e(t))},n=(this._rootElement||document.documentElement).scrollTop,s=n>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=n;for(const o of t){if(!o.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(o));continue}const t=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&t){if(i(o),!n)return}else s||t||i(o)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=z.find(bs,this._config.target);for(const e of t){if(!e.hash||l(e))continue;const t=z.findOne(decodeURI(e.hash),this._element);a(t)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,t))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(_s),this._activateParents(t),N.trigger(this._element,ps,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains("dropdown-item"))z.findOne(".dropdown-toggle",t.closest(".dropdown")).classList.add(_s);else for(const e of z.parents(t,".nav, .list-group"))for(const t of z.prev(e,ys))t.classList.add(_s)}_clearActiveClass(t){t.classList.remove(_s);const e=z.find(`${bs}.${_s}`,t);for(const t of e)t.classList.remove(_s)}static jQueryInterface(t){return this.each((function(){const e=Es.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}N.on(window,gs,(()=>{for(const t of z.find('[data-bs-spy="scroll"]'))Es.getOrCreateInstance(t)})),m(Es);const Ts=".bs.tab",Cs=`hide${Ts}`,Os=`hidden${Ts}`,xs=`show${Ts}`,ks=`shown${Ts}`,Ls=`click${Ts}`,Ss=`keydown${Ts}`,Ds=`load${Ts}`,$s="ArrowLeft",Is="ArrowRight",Ns="ArrowUp",Ps="ArrowDown",Ms="Home",js="End",Fs="active",Hs="fade",Ws="show",Bs=":not(.dropdown-toggle)",zs='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Rs=`.nav-link${Bs}, .list-group-item${Bs}, [role="tab"]${Bs}, ${zs}`,qs=`.${Fs}[data-bs-toggle="tab"], .${Fs}[data-bs-toggle="pill"], .${Fs}[data-bs-toggle="list"]`;class Vs extends W{constructor(t){super(t),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),N.on(this._element,Ss,(t=>this._keydown(t))))}static get NAME(){return"tab"}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),i=e?N.trigger(e,Cs,{relatedTarget:t}):null;N.trigger(t,xs,{relatedTarget:e}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){t&&(t.classList.add(Fs),this._activate(z.getElementFromSelector(t)),this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),N.trigger(t,ks,{relatedTarget:e})):t.classList.add(Ws)}),t,t.classList.contains(Hs)))}_deactivate(t,e){t&&(t.classList.remove(Fs),t.blur(),this._deactivate(z.getElementFromSelector(t)),this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),N.trigger(t,Os,{relatedTarget:e})):t.classList.remove(Ws)}),t,t.classList.contains(Hs)))}_keydown(t){if(![$s,Is,Ns,Ps,Ms,js].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=this._getChildren().filter((t=>!l(t)));let i;if([Ms,js].includes(t.key))i=e[t.key===Ms?0:e.length-1];else{const n=[Is,Ps].includes(t.key);i=b(e,t.target,n,!0)}i&&(i.focus({preventScroll:!0}),Vs.getOrCreateInstance(i).show())}_getChildren(){return z.find(Rs,this._parent)}_getActiveElem(){return this._getChildren().find((t=>this._elemIsActive(t)))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const t of e)this._setInitialAttributesOnChild(t)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),i=this._getOuterElement(t);t.setAttribute("aria-selected",e),i!==t&&this._setAttributeIfNotExists(i,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=z.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const i=this._getOuterElement(t);if(!i.classList.contains("dropdown"))return;const n=(t,n)=>{const s=z.findOne(t,i);s&&s.classList.toggle(n,e)};n(".dropdown-toggle",Fs),n(".dropdown-menu",Ws),i.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,i){t.hasAttribute(e)||t.setAttribute(e,i)}_elemIsActive(t){return t.classList.contains(Fs)}_getInnerElement(t){return t.matches(Rs)?t:z.findOne(Rs,t)}_getOuterElement(t){return t.closest(".nav-item, .list-group-item")||t}static jQueryInterface(t){return this.each((function(){const e=Vs.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}N.on(document,Ls,zs,(function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),l(this)||Vs.getOrCreateInstance(this).show()})),N.on(window,Ds,(()=>{for(const t of z.find(qs))Vs.getOrCreateInstance(t)})),m(Vs);const Ks=".bs.toast",Qs=`mouseover${Ks}`,Xs=`mouseout${Ks}`,Ys=`focusin${Ks}`,Us=`focusout${Ks}`,Gs=`hide${Ks}`,Js=`hidden${Ks}`,Zs=`show${Ks}`,to=`shown${Ks}`,eo="hide",io="show",no="showing",so={animation:"boolean",autohide:"boolean",delay:"number"},oo={animation:!0,autohide:!0,delay:5e3};class ro extends W{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return oo}static get DefaultType(){return so}static get NAME(){return"toast"}show(){N.trigger(this._element,Zs).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(eo),d(this._element),this._element.classList.add(io,no),this._queueCallback((()=>{this._element.classList.remove(no),N.trigger(this._element,to),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this.isShown()&&(N.trigger(this._element,Gs).defaultPrevented||(this._element.classList.add(no),this._queueCallback((()=>{this._element.classList.add(eo),this._element.classList.remove(no,io),N.trigger(this._element,Js)}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(io),super.dispose()}isShown(){return this._element.classList.contains(io)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e}if(e)return void this._clearTimeout();const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){N.on(this._element,Qs,(t=>this._onInteraction(t,!0))),N.on(this._element,Xs,(t=>this._onInteraction(t,!1))),N.on(this._element,Ys,(t=>this._onInteraction(t,!0))),N.on(this._element,Us,(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=ro.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}return R(ro),m(ro),{Alert:Q,Button:Y,Carousel:xt,Collapse:Bt,Dropdown:qi,Modal:On,Offcanvas:qn,Popover:us,ScrollSpy:Es,Tab:Vs,Toast:ro,Tooltip:cs}}));
//# sourceMappingURL=bootstrap.bundle.min.js.map

var UiLoadHtml=pc.createScript("uiLoadHtml");UiLoadHtml.attributes.add("documents",{type:"asset",assetType:"html",array:!0}),UiLoadHtml.attributes.add("activeDocument",{type:"asset",assetType:"html"}),UiLoadHtml.prototype.initialize=function(){this.pages=[],this.activePages=[],this.excludeTags=["SCRIPT","META","TITLE","LINK"],this.documents.forEach(this.loadHtml.bind(this))},UiLoadHtml.prototype.loadHtml=function(e){const t=e.resource;var a=(new DOMParser).parseFromString(t,"text/html").querySelector("body");this.excludeTags.forEach((e=>{var t,i=a.getElementsByTagName(e);for(t=i.length-1;t>=0;t--)i[t].parentNode.removeChild(i[t])}));var i=document.createElement("div");i.id=e.name.split(".")[0],i.innerHTML=a.innerHTML,this.parseLinks(i),this.copyElementStyle(a,i),document.body.appendChild(i),this.pages.push(i),e===this.activeDocument?this.activePages.push(i):this.setState(!1,i),this.app.on(`page:${i.id}:change`,(()=>this.setState(!0,i,!0))),this.app.on(`page:${i.id}:enable`,(()=>this.setState(!0,i,!1))),this.app.on(`page:${i.id}:disable`,(()=>this.setState(!1,i,!1)))},UiLoadHtml.prototype.getActivePage=function(){if(this.activePages.length>0)return this.activePages[this.activePages.length-1]},UiLoadHtml.prototype.setState=function(e,t,a){if(a&&this.hideAll(),t.style.display=e?"block":"none",e){const e=this.getActivePage();this.app.fire(`page:${t.id}:onEnable`,t,e),this.activePages.push(t)}else{this.app.fire(`page:${t.id}:onDisable`,t);const e=this.activePages.indexOf(t);e>-1&&this.activePages.splice(e,1)}},UiLoadHtml.prototype.hideAll=function(e){this.pages.forEach((t=>{if(!e&&null!==t.getAttribute("data-page-secondary"))return!0;this.setState(!1,t)}))},UiLoadHtml.prototype.copyElementStyle=function(e,t){[...e.attributes].forEach((e=>{t.setAttribute(e.nodeName,e.nodeValue)}))},UiLoadHtml.prototype.parseLinks=function(e){e.querySelectorAll("img").forEach((e=>{const t=e.src.replace(/^.*[\\\/]/,""),a=this.app.assets.find(t,"texture");a&&(e.src=a.getFileUrl())})),e.querySelectorAll("[data-pc-trigger-click]").forEach((t=>{const a=t.getAttribute("data-pc-trigger-click"),action=()=>{null!==t.offsetParent&&"none"!==e.style.display&&this.getActivePage()===e&&t.click()};if(0===a.indexOf("input:")){const e=a.split(":");if("keyboard"===e[1]){const t=e[2];this.app.keyboard.on(pc.EVENT_KEYUP,(function(e){e.key===pc[t]&&action()}),this)}}a&&this.app.on(a,action)})),e.querySelectorAll("[data-pc-btn-click]").forEach((t=>{t.addEventListener("click",(a=>{a.preventDefault();const i=t.getAttribute("data-pc-btn-click");this.app.fire(i,e)}))})),e.querySelectorAll("[data-pc-btn-pressed]").forEach((e=>{const t=e.getAttribute("data-pc-btn-pressed"),onPressed=()=>this.app.fire(t);e.onpointerdown=e=>{e.preventDefault(),this.app.on("update",onPressed)},e.onpointerup=e=>{e.preventDefault(),this.app.off("update",onPressed)},e.onpointercancel=e=>this.app.off("update",onPressed),e.onpointerleave=e=>this.app.off("update",onPressed),e.onpointerout=e=>this.app.off("update",onPressed)})),e.querySelectorAll("[data-pc-page-change]").forEach((t=>{t.addEventListener("click",(a=>{a.preventDefault(),this.hideAll();const i=t.getAttribute("data-pc-page-change");this.app.fire(`page:${i}:enable`,e)}))})),e.querySelectorAll("[data-pc-page-open]").forEach((t=>{t.addEventListener("click",(a=>{a.preventDefault();const i=t.getAttribute("data-pc-page-open");this.app.fire(`page:${i}:enable`,e)}))})),e.querySelectorAll("[data-pc-page-close]").forEach((t=>{t.addEventListener("click",(a=>{a.preventDefault();const i=t.getAttribute("data-pc-page-close");i?this.app.fire(`page:${i}:disable`,e):this.app.fire(`page:${e.id}:disable`,e)}))})),e.querySelectorAll("[data-pc-parent-close]").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();const a=e.parentNode;a&&(a.style.display="none")}))})),e.querySelectorAll("[data-pc-text-set]").forEach((e=>{const t=e.getAttribute("data-pc-text-set");this.app.on(t,(t=>{e.textContent=t}))})),e.querySelectorAll("[data-pc-element-show]").forEach((e=>{const t=e.getAttribute("data-pc-element-show");this.app.on(t,(()=>{e.style.display="block"}))})),e.querySelectorAll("[data-pc-element-hide]").forEach((e=>{const t=e.getAttribute("data-pc-element-hide");this.app.on(t,(()=>{e.style.display="none"})),e.style.display="none"})),e.querySelectorAll("[data-pc-referrer-hide").forEach((e=>{e.getAttribute("data-pc-referrer-hide").split(",").forEach((t=>{document.referrer.indexOf(t)>-1&&(e.style.display="none")}))}))};var UiEntityState=pc.createScript("uiEntityState");UiEntityState.attributes.add("enableEvent",{type:"string"}),UiEntityState.attributes.add("disableEvent",{type:"string"}),UiEntityState.attributes.add("initialState",{type:"boolean",default:!0}),UiEntityState.prototype.initialize=function(){this.entity.enabled=this.initialState,this.enableEvent&&this.app.on(this.enableEvent,(()=>this.entity.enabled=!0)),this.disableEvent&&this.app.on(this.disableEvent,(()=>this.entity.enabled=!1))};var UiButton=pc.createScript("uiButton");UiButton.attributes.add("clickEvent",{type:"string"}),UiButton.prototype.initialize=function(){this.clickEvent&&this.entity.button.on("click",(function(){this.app.fire(this.clickEvent,this.entity)}),this)};var ManagerInterface=pc.createScript("managerInterface");ManagerInterface.attributes.add("leaderboardUrl",{type:"string"}),ManagerInterface.attributes.add("soundVolume",{type:"number",default:1,min:0,max:1}),ManagerInterface.attributes.add("localPlayer",{type:"entity"}),ManagerInterface.attributes.add("playerActions",{type:"json",array:!0,title:"player Actions",schema:[{name:"localEvent",type:"string"},{name:"appEvent",type:"string"}]}),ManagerInterface.attributes.add("debugClearInterface",{type:"boolean",default:!1,title:"Debug Clear Interface"}),ManagerInterface.prototype.postInitialize=function(){if(ManagerInterface.api=this,this.hasTouchInput=window.matchMedia("(pointer: coarse)").matches,this.settings={quality:void 0,cameraSensitivity:1,lockCameraToPlayerRotation:!1,fullscreen:void 0,mousePointerLock:pc.platform.desktop,sounds:void 0,music:void 0},this.debugClearInterface)try{localStorage.removeItem("managerInterface:controlsTutorial"),localStorage.removeItem("managerInterface:settings"),localStorage.removeItem("managerInterface:avatarID")}catch(e){}this.prepare(),this.app.on("interface:message:show",this.showMessage,this),this.app.on("interface:message:hide",this.hideMessage,this),this.app.on("uranusControllerReadyPlayerMe:characterLoading",(()=>this.app.fire("page:ui-loader:enable"))),this.app.on("uranusControllerReadyPlayerMe:characterReady",(()=>this.app.fire("page:ui-loader:disable"))),this.app.on("interface:button:play",this.onMenuPlayButton,this),this.app.on("page:ui-menu:onEnable",this.onMenuPageEnabled,this),this.app.on("page:ui-menu:onDisable",this.onMenuPageDisabled,this),this.app.on("page:ui-settings:onEnable",this.onSettingsPageEnabled,this),this.app.on("interface:settings:save",this.saveSettings,this),this.app.on("interface:locker:save",this.saveLocker,this),this.app.on("page:ui-career:onEnable",this.onCareerPageEnabled,this),this.app.on("page:ui-career:onEnable",this.onCareerPageEnabled,this),this.app.on("page:ui-controls:onEnable",this.onControlsPageEnabled,this),this.app.on("page:ui-paused:onEnable",this.onPausedPageEnabled,this),this.app.on("page:ui-paused:onDisable",this.onPausedPageDisabled,this),this.on("attr:soundVolume",(e=>this.app.systems.sound.volume=e)),this.localPlayer.on("UranusControllerThirdPerson:postInputUpdate",this.onPlayerPostInputUpdate,this)},ManagerInterface.prototype.prepare=async function(){let e;this.localPlayer&&this.playerActions.forEach((e=>{e.localEvent&&e.appEvent&&this.app.on(e.appEvent,(function(){this.localPlayer.fire(e.localEvent)}),this)}));try{e=localStorage.getItem("managerInterface:avatarID")}catch(e){}const t=UranusControllerThirdPerson.api.entity.findByTag("model-gender").map((e=>e.name));e&&-1!==t.indexOf(e)||(e=t[Math.floor(Math.random()*t.length)]),UranusControllerThirdPerson.api.loadAvatar(e);let a=!1;try{const e=JSON.parse(localStorage.getItem("managerInterface:settings"));if(e){a=!0,this.updateSettings(e);for(let t in e)this.settings.hasOwnProperty(t)&&void 0!==e[t]&&(this.settings[t]=e[t])}}catch(e){}a||this.updateSettings(this.settings);try{"true"===localStorage.getItem("managerInterface:controlsTutorial")||(await new Promise((e=>setTimeout(e,5e3))),this.app.fire("page:ui-controls:enable"),localStorage.setItem("managerInterface:controlsTutorial",!0))}catch(e){}},ManagerInterface.prototype.onPlayerPostInputUpdate=function(e){e.jumpRequest&&this.app.fire("interface:input:jump")},ManagerInterface.prototype.showMessage=function(e,t){if(this.app.fire("text:game-message:set",e),this.app.fire("text:game-message:show"),this.showMessageUpdate&&this.app.off("update",this.showMessageUpdate),t>0){let e=0;this.showMessageUpdate=a=>{e+=a,e>=t&&(this.app.off("update",this.showMessageUpdate),this.app.fire("text:game-message:hide"))},this.app.on("update",this.showMessageUpdate)}},ManagerInterface.prototype.hideMessage=function(){this.app.fire("text:game-message:hide")},ManagerInterface.prototype.onSettingsPageEnabled=function(e){this.settings.quality=UranusGraphicsSettings.api.activePresetID,e.querySelectorAll('input[name="quality"]').forEach((e=>{e.value===this.settings.quality?e.checked=!0:e.checked=!1})),this.settings.cameraSensitivity=UranusControllerThirdPerson.api.cameraSensitivity?UranusControllerThirdPerson.api.cameraSensitivity:1,e.querySelector("#settings-cameraSensitivity").value=this.settings.cameraSensitivity,e.querySelector("#settings-cameraSensitivity-value").innerText=parseFloat(this.settings.cameraSensitivity).toFixed(2),this.onChange_CameraSensitivity||(this.onChange_CameraSensitivity=e.querySelector("#settings-cameraSensitivity").onchange=t=>{const a=parseFloat(t.srcElement.value).toFixed(2);e.querySelector("#settings-cameraSensitivity-value").innerText=a}),this.settings.lockCameraToPlayerRotation=UranusControllerThirdPerson.api.lockCameraToPlayerRotation;e.querySelector("#settings-lockCameraToPlayerRotation").checked=this.settings.lockCameraToPlayerRotation,this.settings.fullscreen=null!==document.fullscreenElement;e.querySelector("#settings-fullscreen").checked=this.settings.fullscreen,this.settings.quality=UranusControllerThirdPerson.api.mousePointerLock;e.querySelector("#settings-mouse-pointer-lock").checked=this.settings.quality,this.settings.sounds=this.app.systems.sound.volume>0;e.querySelector("#settings-sounds").checked=this.settings.sounds,this.settings.music=this.entity.findByName("Music").enabled;e.querySelector("#settings-music").checked=this.settings.music},ManagerInterface.prototype.saveSettings=function(e){e.querySelectorAll('input[name="quality"]').forEach((e=>{e.checked&&(this.settings.quality=e.value)})),this.settings.cameraSensitivity=parseFloat(e.querySelector("#settings-cameraSensitivity").value);const t=e.querySelector("#settings-lockCameraToPlayerRotation");this.settings.lockCameraToPlayerRotation=t.checked;const a=e.querySelector("#settings-fullscreen");this.settings.fullscreen=a.checked;const s=e.querySelector("#settings-mouse-pointer-lock");this.settings.mousePointerLock=s.checked;const n=e.querySelector("#settings-sounds");this.settings.sounds=n.checked;const i=e.querySelector("#settings-music");this.settings.music=i.checked,this.updateSettings(this.settings);try{localStorage.setItem("managerInterface:settings",JSON.stringify(this.settings))}catch(e){}},ManagerInterface.prototype.updateSettings=function(e){void 0!==e.quality&&this.app.fire("UranusGraphicsSettings:setPreset",e.quality),this.initialCameraSpeed||(this.initialCameraSpeed={mouseSpeed:UranusControllerThirdPerson.api.mouseSpeed,touchSpeed:UranusControllerThirdPerson.api.touchSpeed,gamepadSpeed:UranusControllerThirdPerson.api.gamepadSpeed});const t=pc.math.clamp(e.cameraSensitivity,.1,2);if(UranusControllerThirdPerson.api.cameraSensitivity=t,UranusControllerThirdPerson.api.mouseSpeed=this.initialCameraSpeed.mouseSpeed*t,UranusControllerThirdPerson.api.touchSpeed=this.initialCameraSpeed.touchSpeed*t,UranusControllerThirdPerson.api.gamepadSpeed=this.initialCameraSpeed.gamepadSpeed*t,void 0!==e.lockCameraToPlayerRotation&&(UranusControllerThirdPerson.api.lockCameraToPlayerRotation=e.lockCameraToPlayerRotation,UranusControllerThirdPerson.api.rotationInertia=e.lockCameraToPlayerRotation?1.5:10),this.goFullscreen(e),void 0!==e.mousePointerLock&&(UranusControllerThirdPerson.api.mousePointerLock=e.mousePointerLock),void 0!==e.sounds&&(this.app.systems.sound.volume=e.sounds?this.soundVolume:0),void 0!==e.music){this.entity.findByName("Music").enabled=e.music;const t=this.entity.findByName("Music").sound.slot("Music");e.music?t.play():t.stop()}},ManagerInterface.prototype.goFullscreen=function(e){if(e||(e=this.settings),void 0!==e.fullscreen)try{e.fullscreen?document.documentElement.requestFullscreen():document.fullscreenElement&&document.exitFullscreen()}catch(e){}},ManagerInterface.prototype.onMenuPlayButton=function(){this.app.fire("game:resumed",!0)},ManagerInterface.prototype.onMenuPageEnabled=function(){UranusControllerThirdPerson.api&&(UranusControllerThirdPerson.api.lockPlayerPosition=!0),this.app.fire("text:version:set",window.GAME_VERSION),InterfaceGameTimer.api.pause(),this.app.fire("game:paused")},ManagerInterface.prototype.onMenuPageDisabled=function(){InterfaceGameTimer.api.resume(),UranusControllerThirdPerson.api&&(UranusControllerThirdPerson.api.lockPlayerPosition=!1)},ManagerInterface.prototype.onCareerPageEnabled=async function(e,t){const a=ManagerCheckpoint.api.getCareer();if(!a)return;e.querySelectorAll(".career-item").forEach(((e,t)=>{const s=a.runs[t];s&&(e.querySelector(".career-item-elevation").textContent=InterfaceElevationIndicator.prototype.formatHeightValue(s.elevation),e.querySelector(".career-item-time").textContent=InterfaceGameTimer.prototype.formatTime(s.time))}));const s=e.querySelectorAll("tbody tr");s.forEach((e=>e.style.display="none"));const n=ManagerCheckpoint.api.leaderboardEntry;(await(await fetch(this.leaderboardUrl)).json()).entries.forEach(((t,a)=>{const i=s[a];i.classList.remove("entry-success"),i.cells[0].innerHTML=t.username,i.cells[1].innerHTML=InterfaceElevationIndicator.prototype.formatHeightValue(t.elevation)+"m",i.cells[2].innerHTML=InterfaceGameTimer.prototype.formatTime(t.time),n&&n.username===t.username&&(e.querySelector("#career-global").click(),i.classList.add("entry-success"),e.querySelector(".modal-body").scrollTop=i.offsetTop),i.style.display="table-row"}))},ManagerInterface.prototype.onPausedPageEnabled=function(){this.app.timeScale=0,this.app.autoRender=!1,this.app.systems.sound.volume=0,pc.Mouse.isPointerLocked()&&this.app.mouse.disablePointerLock()},ManagerInterface.prototype.onPausedPageDisabled=function(){this.app.autoRender=!0,this.app.timeScale=1,this.app.systems.sound.volume=!0===this.settings.sounds||void 0===this.settings.sounds?this.soundVolume:0},ManagerInterface.prototype.onControlsPageEnabled=function(e){if(this.hasTouchInput){const t=e.querySelector("#controls-touch");t&&t.click()}},ManagerInterface.prototype.saveLocker=function(e){const t=e.querySelector(".carousel-item.active");if(!t)return;const a=t.id;UranusControllerThirdPerson.api.loadAvatar(a);try{localStorage.setItem("managerInterface:avatarID",a)}catch(e){}};var ObjectBillboardElevation=pc.createScript("objectBillboardElevation");ObjectBillboardElevation.attributes.add("overrideHeight",{type:"entity",title:"Override Height",description:"If an entity is referenced here, that height will be used instead."}),ObjectBillboardElevation.highest=0,ObjectBillboardElevation.prototype.initialize=function(){let t=this.entity.parent;this.overrideHeight&&(t=this.overrideHeight);const e=t.getPosition().y-1;e>=ObjectBillboardElevation.highest&&(ObjectBillboardElevation.highest=e,this.onHighestElevation(e)),this.entity.element.text=InterfaceElevationIndicator.prototype.formatHeightValue(e)+"m"},ObjectBillboardElevation.prototype.update=function(){const t=this.entity.parent.parent.uranusInstancerCells;if(t){const e=t[0];e&&(this.entity.element.enabled=!0===e.isVisible)}},ObjectBillboardElevation.prototype.onHighestElevation=function(t){const e=this.app.root.findByName("Billboard Guide").findComponent("element");e.textOriginal||(e.textOriginal=e.text);const i=e.textOriginal.replace("{elevation}",Math.floor(t+1).toString());e.text=i,ManagerCheckpoint.api.winHeight=t};var ManagerPoki=pc.createScript("managerPoki");ManagerPoki.prototype.initialize=function(){ManagerPoki.api=this,this.booted=!1,this.hasStarted=!1,this.prepare(),this.init(),this.app.once("player:sound:onPlayed:Run",(function(){this.hasStarted=!0,this.onGameResumed()}),this),this.app.on("game:paused",this.onGamePaused,this),this.app.on("game:resumed",this.onGameResumed,this),this.app.on("ad:watch:saveCheckpoint",(function(){this.onWatchReward((()=>{ObjectCheckPoint.lastCheckpoint&&ManagerCheckpoint.api.onCheckpoint(ObjectCheckPoint.lastCheckpoint)}))}),this),this.app.on("ad:watch:respawnLast",(function(){this.app.fire("ad:respawnLastButton:hide"),this.app.fire("ad:respawnCheckpointButton:hide"),this.app.fire("ad:travelUpButton:hide"),this.onWatchReward((()=>this.app.fire("checkpoint:claimRespawnLast")))}),this),this.app.on("ad:watch:respawnCheckpoint",(function(){this.app.fire("ad:respawnLastButton:hide"),this.app.fire("ad:respawnCheckpointButton:hide"),this.app.fire("ad:travelUpButton:hide"),this.onWatchCommercial((()=>this.app.fire("checkpoint:claimRespawnCheckpoint")))}),this),this.app.on("ad:watch:travelUp",(function(){this.app.fire("ad:respawnLastButton:hide"),this.app.fire("ad:respawnCheckpointButton:hide"),this.app.fire("ad:travelUpButton:hide"),this.onWatchReward((()=>this.app.fire("checkpoint:claimTravelUp")))}),this)},ManagerPoki.prototype.prepare=function(){window.addEventListener("keydown",(e=>{["ArrowDown","ArrowUp"," "].includes(e.key)&&e.preventDefault()})),window.addEventListener("wheel",(e=>e.preventDefault()),{passive:!1}),-1===window.location.href.indexOf("playcanvas.com")&&(this.beaconPing(),window.setInterval((()=>this.beaconPing()),48e4))},ManagerPoki.prototype.beaconPing=function(){navigator.sendBeacon("https://leveldata.poki.io/simplyup-ping","1d0c459f-0f6e-4d55-bf7f-5e552b37defe")},ManagerPoki.prototype.init=function(){PokiSDK.gameLoadingFinished(),this.booted=!0},ManagerPoki.prototype.onGamePaused=function(){this.booted&&this.hasStarted&&PokiSDK.gameplayStop()},ManagerPoki.prototype.onGameResumed=function(e){this.booted&&this.hasStarted&&(e&&this.onWatchCommercial(),PokiSDK.gameplayStart())},ManagerPoki.prototype.onWatchReward=async function(e){this.booted?(this.app.fire("uranusControllerPlayerEmojis:emoji","1f4fa.png"),await new Promise((e=>setTimeout(e,0))),ManagerInterface.api.onPausedPageEnabled(),this.app.fire("page:ui-paused:change"),await new Promise((e=>setTimeout(e,0))),PokiSDK.rewardedBreak((()=>{})).then((a=>{this.app.fire("page:ui-game:change"),ManagerInterface.api.onPausedPageDisabled(),a?e&&e():-1===document.referrer.indexOf("poki.")&&this.app.fire("player:sound:play","Wrong",!0)}))):e&&e()},ManagerPoki.prototype.onWatchCommercial=function(e){this.booted?PokiSDK.commercialBreak((async()=>{this.app.fire("uranusControllerPlayerEmojis:emoji","1f4fa.png"),await new Promise((e=>setTimeout(e,0))),ManagerInterface.api.onPausedPageEnabled(),this.app.fire("page:ui-paused:change"),await new Promise((e=>setTimeout(e,0)))})).then((()=>{e&&e(),this.app.fire("page:ui-game:change"),ManagerInterface.api.onPausedPageDisabled()})):e&&e()};pc.script.createLoadingScreen((function(A){var k,R;k=["body {","    background-color: #283538;","}","","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background: url('data:image/jpeg;base64,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');","    background-size: cover;","    background-position: center;","    z-index: 2000;","}","","#application-splash {","    position: absolute;","    top: calc(40% - 28px);","    width: 264px;","    left: calc(50% - 132px);","}","","#application-splash img {","    width: 100%;","    max-width: 150px;","    margin: 0px auto;","    display: block;","}","","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 5px;","    border-radius: 5px;","    width: 100%;","    background-color: #e9e9e9;","    box-shadow: 0px 4px 3px rgba(0,0,0,0.4);","}","","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #ef801e;","}","","#progress-bar-website {","    color: #fff;","    text-shadow: 0px 4px 3px rgba(0,0,0,0.4);","    font-size: 20px;","    text-decoration: none;","    text-align: center;","    width: 100%;","    display: block;","    margin-top: 10px;","}","","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(R=document.createElement("style")).type="text/css",R.styleSheet?R.styleSheet.cssText=k:R.appendChild(document.createTextNode(k)),document.head.appendChild(R),function(){var A=document.createElement("div");A.id="application-splash-wrapper",document.body.appendChild(A);var k=document.createElement("div");k.id="application-splash",A.appendChild(k),k.style.display="none";var R=document.createElement("img");R.src="data:image/png;base64,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",k.appendChild(R),R.onload=function(){k.style.display="block"};var V=document.createElement("div");V.id="progress-bar-container",k.appendChild(V);var b=document.createElement("div");b.id="progress-bar",V.appendChild(b);var e=document.createElement("a");e.id="progress-bar-website",e.href="https://solargames.io",e.target="_blank",e.textContent="solargames.io",V.appendChild(e)}(),A.on("preload:end",(function(){A.off("preload:progress")})),A.on("preload:progress",(function(A){var k=document.getElementById("progress-bar");k&&(A=Math.min(1,Math.max(0,A)),k.style.width=100*A+"%")})),A.on("start",(function(){var A=document.getElementById("application-splash-wrapper");A.parentElement.removeChild(A)}))}));var UranusControllerPlayerSound=pc.createScript("uranusControllerPlayerSound");UranusControllerPlayerSound.attributes.add("playerEntity",{type:"entity",title:"Player Entity",description:"The player entity to be used to add sounds to."}),UranusControllerPlayerSound.attributes.add("playEvent",{type:"string",default:"player:sound:play",title:"Play Event",description:"A global app wide event that can be used to fire custom sounds on the local player. Pass the slot name as an argument."}),UranusControllerPlayerSound.attributes.add("stopEvent",{type:"string",default:"player:sound:stop",title:"Stop Event",description:"A global app wide event that can be used to fire custom sounds on the local player. Pass the slot name as an argument."}),UranusControllerPlayerSound.prototype.initialize=function(){this.previousState=void 0,this.activeState=void 0,this.anim=void 0,this.activeSlot=void 0,this.prepare(),this.on("destroy",this.onDestroy)},UranusControllerPlayerSound.prototype.prepare=function(){if(this.playerEntity)if(this.anim=this.playerEntity.anim,this.isRemotePlayer=this.playerEntity.tags.has("uranus-multiplayer-remote-player"),this.uranusMultiplayerColyseusPlayer=this.playerEntity.script?.uranusMultiplayerColyseusPlayer,this.isRemotePlayer){if(this.uranusMultiplayerColyseusPlayer){const t=UranusMultiplayerRoom.active?.room;t&&this.onJoinRoom(t),this.app.once("uranusMultiplayer:room:joined",this.onJoinRoom,this)}}else this.playEvent&&this.app.on(this.playEvent,this.playSound,this),this.stopEvent&&this.app.on(this.stopEvent,this.stopSound,this)},UranusControllerPlayerSound.prototype.onDestroy=function(){this.playEvent&&this.app.off(this.playEvent,this.playSound,this),this.stopEvent&&this.app.off(this.stopEvent,this.stopSound,this),this.app.off("uranusMultiplayer:room:joined",this.onJoinRoom,this)},UranusControllerPlayerSound.prototype.onJoinRoom=function(t){t.onMessage("player:sound:play",(([t,e])=>{this.playerEntity.name===t&&this.playSound(e.slot,!0)})),t.onMessage("player:sound:stop",(([t,e])=>{this.playerEntity.name===t&&this.stopSound(e.slot)}))},UranusControllerPlayerSound.prototype.update=function(t){if(!this.anim)return;if(this.playerEntity.uranusPlayerAway)return;const e=this.anim.baseLayer.activeState;this.activeState&&e===this.activeState||(this.setStateSound(e),this.previousState=this.activeState,this.activeState=e)},UranusControllerPlayerSound.prototype.getRandomSlot=function(t){const e=Object.values(t);return e[Math.floor(Math.random()*e.length)]},UranusControllerPlayerSound.prototype.setStateSound=function(t){this.activeSlot&&!this.activeSlot.overlap&&this.activeSlot.stop();const e=this.playSound(t,!0);e&&(this.activeSlot=e)},UranusControllerPlayerSound.prototype.getSound=function(t){const e=this.playerEntity.script.uranusControllerThirdPerson.gender,o=this.entity.findOne((o=>{if(o.name===t){if(!o.tags.has("sound-gender"))return!0;if(o.tags.has(`sound-gender-${e}`))return!0}}));if(o)return this.getRandomSlot(o.sound.slots)},UranusControllerPlayerSound.prototype.playSound=function(t,e){const o=this.getSound(t);if(o){if(o.play(),!0!==e&&!this.isRemotePlayer&&this.uranusMultiplayerColyseusPlayer){const e=this.playerEntity.getPosition();this.uranusMultiplayerColyseusPlayer.sendToRoom("player:sound:play",{x:e.x,y:e.y,z:e.z,slot:t})}return this.isRemotePlayer||this.app.fire(`player:sound:onPlayed:${t}`),o}},UranusControllerPlayerSound.prototype.stopSound=function(t,e){const o=this.getSound(t);o&&(o.stop(),!0!==e&&!this.isRemotePlayer&&this.uranusMultiplayerColyseusPlayer&&this.uranusMultiplayerColyseusPlayer.sendToRoom("player:sound:stop",{slot:t}))};var UranusMultiplayerColyseusServer=pc.createScript("uranusMultiplayerColyseusServer");UranusMultiplayerColyseusServer.attributes.add("inEditor",{type:"boolean",default:!1}),UranusMultiplayerColyseusServer.attributes.add("servers",{type:"json",array:!0,schema:[{name:"serverUrl",type:"string",title:"Server Url",description:"The remote server connection url."},{name:"chance",type:"number",min:0,max:1,default:.5,title:"Chance",description:"The remote server chance to be selected between other same region servers. Use to direct traffic to larger servers."},{name:"region",type:"string",default:["Africa","Asia","America","Europe","Pacific","Atlantic","Australia","Indian","Antractica"],array:!0,title:"Region",description:"The regions this server url will be used for. This check uses internally the current timezone to match the user to a region. Leave empty to bypass this check and use this server globally. If a user is coming from a non listed region, one will be randomnly selected."}]}),UranusMultiplayerColyseusServer.attributes.add("serverRemoteList",{type:"string",default:"",title:"Server Remote List",description:"Optionally reference a remote .json file that contains server info, instead of hardcoding them with the build."}),UranusMultiplayerColyseusServer.attributes.add("localServerUrl",{type:"string",default:"ws://localhost:2567",title:"Local Server Url",description:"The local server connection url (optional to be used with isLocal)."}),UranusMultiplayerColyseusServer.attributes.add("isLocal",{type:"boolean",default:!1,title:"Is Local",description:"If selected the client will connect to the local server."}),UranusMultiplayerColyseusServer.prototype.initialize=async function(){if(this.serverUrl=await this.getServer(),!this.serverUrl)return;"true"===UranusUtilities.getUrlParam("uranusMultiplayerServerIsLocal")&&(this.isLocal=!0);const e=UranusUtilities.getUrlParam("uranusMultiplayerServerUrl");e&&(this.serverUrl=e);const r=this.isLocal?this.localServerUrl:this.serverUrl;window.Colyseus&&(this.app.colyseus=new Colyseus.Client(r),this.app.fire("uranusMultiplayerColyseusServer:ready"))},UranusMultiplayerColyseusServer.prototype.getServer=async function(){const e=UranusUtilities.getUrlParam("uranusServerUrl");if(e)return e;if(this.serverRemoteList){const e=await(await fetch(this.serverRemoteList+`?t=${Date.now()}`)).json();e&&(this.servers=e)}let r,t;try{const e=UranusUtilities.getUrlParam("uranusServerRegion");r=e||Intl.DateTimeFormat().resolvedOptions().timeZone.split("/")[0]}catch(e){}if(r){const e=this.servers.filter((e=>e.region.length>0&&e.region.indexOf(r)>-1));t=this.getRandomServer(e)}return t||(t=this.getRandomServer(this.servers)),t?.serverUrl},UranusMultiplayerColyseusServer.prototype.getRandomServer=function(e){const r=e.map((e=>void 0!==e.chance?e.chance:.5));let t;for(t=1;t<r.length;t++)r[t]+=r[t-1];const s=Math.random()*r[r.length-1];for(t=0;t<r.length&&!(r[t]>s);t++);return e[t]};var UranusMultiplayerColyseusRoom=pc.createScript("uranusMultiplayerColyseusRoom");UranusMultiplayerColyseusRoom.attributes.add("inEditor",{type:"boolean",default:!1}),UranusMultiplayerColyseusRoom.attributes.add("roomType",{type:"string",default:"my_room",title:"Room Type",description:"The room type to connect on the server. It will either join an existing room or create a new one."}),UranusMultiplayerColyseusRoom.attributes.add("areaId",{type:"string",default:"my_area",title:"Area ID",description:"Define the room area ID to join or create a local instance of that room."}),UranusMultiplayerColyseusRoom.attributes.add("playerTemplates",{type:"asset",assetType:"template",array:!0,title:"Player Templates",description:"A list of template assets to spawn remote players from."}),UranusMultiplayerColyseusRoom.attributes.add("localPlayer",{type:"entity",title:"Local Player",description:"The local player entity. The name of this entity will be used to track the right template to spawn from the Player Templates list in remote clients."}),UranusMultiplayerColyseusRoom.attributes.add("localRoom",{type:"boolean",default:!1,title:"Local Room",description:"If local is set to true the room will include only a specified world area. Entering/leaving that area will trigger room connect/disconnect events. A collision component is required to be set for that area."}),UranusMultiplayerColyseusRoom.attributes.add("isMaster",{type:"boolean",default:!0,title:"Is Master",description:"If selected this room will become the active one when the client joins. Deselect for secondary parallel rooms like chat rooms."}),UranusMultiplayerRoom={},UranusMultiplayerRoom.active=void 0,UranusMultiplayerColyseusRoom.prototype.initialize=function(){this.room=void 0,this.remotePlayers=void 0,this.prepare(),this.on("destroy",this.onDestroy)},UranusMultiplayerColyseusRoom.prototype.prepare=function(){this.localRoom&&this.entity.collision?(this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.entity.collision.on("triggerleave",this.onTriggerLeave,this)):this.joinRoom()},UranusMultiplayerColyseusRoom.prototype.onDestroy=function(){this.localRoom&&this.entity.collision&&(this.entity.collision.off("triggerenter",this.onTriggerEnter,this),this.entity.collision.off("triggerleave",this.onTriggerLeave,this)),this.leaveRoom()},UranusMultiplayerColyseusRoom.prototype.onTriggerEnter=function(e){e.enabled&&e===this.localPlayer&&this.joinRoom()},UranusMultiplayerColyseusRoom.prototype.onTriggerLeave=function(e){e===this.localPlayer&&this.leaveRoom()},UranusMultiplayerColyseusRoom.prototype.joinRoom=async function(){if(this.app.colyseus||await new Promise((e=>{this.app.once("uranusMultiplayerColyseusServer:ready",e)})),!this.localPlayer||this.isMaster&&UranusMultiplayerRoom.active===this)return;this.isMaster&&(UranusMultiplayerRoom.active=this),this.remotePlayers={};const e={areaId:this.areaId,template:this.playerTemplates.findIndex((e=>e.name===this.localPlayer.name)),remotePlayers:this.remotePlayers},t=this.localPlayer.script?.uranusMultiplayerColyseusPlayer;t&&(e.username=t.username,e.avatarUrl=t.avatarUrl),this.room=await this.app.colyseus.joinOrCreate(this.roomType,e),this.roomData=e,this.localPlayer.tags.add("uranus-multiplayer-local-player"),this.localPlayer.uranusMultiplayerSessionID=this.room.sessionId,this.room.state.players.onAdd(this.onPlayerAdd.bind(this)),this.room.state.players.onRemove(this.onPlayerRemove.bind(this)),this.room.onLeave(this.onRoomLeave.bind(this)),this.room.onError(this.onRoomError.bind(this)),this.app.fire("uranusMultiplayer:room:joined",this.room,this.roomData,this.isMaster)},UranusMultiplayerColyseusRoom.prototype.leaveRoom=async function(){this.isMaster&&UranusMultiplayerRoom.active!==this||!this.room||(await this.room.leave(),this.isMaster&&(UranusMultiplayerRoom.active=void 0),this.room=void 0,this.app.fire("uranusMultiplayer:room:left"))},UranusMultiplayerColyseusRoom.prototype.onPlayerAdd=function(e,t){this.room.sessionId!==t&&this.spawnPlayer(e,t)},UranusMultiplayerColyseusRoom.prototype.onPlayerRemove=function(e,t){this.removePlayer(t)},UranusMultiplayerColyseusRoom.prototype.onRoomLeave=async function(e){for(let e in this.remotePlayers)this.removePlayer(e);1006===e&&(UranusMultiplayerRoom.active=void 0,this.joinRoom())},UranusMultiplayerColyseusRoom.prototype.onRoomError=function(e,t){console.log("COLYSEUS ERROR",e,t)},UranusMultiplayerColyseusRoom.prototype.spawnPlayer=function(e,t){if(this.remotePlayers[t])return;const o=this.playerTemplates?this.playerTemplates[e.template]:null;let r;r=o?o.resource.instantiate():new pc.Entity,r.name=t,r.uranusMultiplayerSessionID=t,r.tags.add("uranus-multiplayer-remote-player");const s=r.script?.uranusMultiplayerColyseusPlayer;s&&(s.username=e.username),r.colyseusPlayer=e,e.listen("avatarUrl",(e=>{r.fire("uranusMultiplayerColyseusPlayer:avatarUrl",e)})),e.listen("username",(e=>{r.fire("uranusMultiplayerColyseusPlayer:username",e)})),this.entity.addChild(r),this.remotePlayers[t]=r,r.enabled=!1},UranusMultiplayerColyseusRoom.prototype.removePlayer=function(e){const t=this.remotePlayers[e];t&&(t.destroy(),delete this.remotePlayers[e],this.app.fire("uranusMultiplayer:room:playerRemoved",e))};var UranusMultiplayerColyseusPlayer=pc.createScript("uranusMultiplayerColyseusPlayer");UranusMultiplayerColyseusPlayer.attributes.add("inEditor",{type:"boolean",default:!1}),UranusMultiplayerColyseusPlayer.attributes.add("username",{type:"string",default:"",title:"Username",description:"Set an optional string based username."}),UranusMultiplayerColyseusPlayer.attributes.add("updateFrequency",{type:"number",default:10,min:1,precision:0,title:"Update Frequency",description:"Set how many times per second the state of this player will be broadcasted to the server."}),UranusMultiplayerColyseusPlayer.attributes.add("interpolationInertia",{type:"number",default:15,min:1,title:"Interpolation Inertia",description:"Sets how smoothly remote players will sync with the target states received. Lower values result in smoother interpolation at the expense of staying behind the remote state."}),UranusMultiplayerColyseusPlayer.prototype.initialize=function(){this.controllerScript=void 0,this.isRemotePlayer=this.entity.tags.has("uranus-multiplayer-remote-player"),this.time=1/0,this.prepare(),this.on("attr:interpolationInertia",(()=>this.setControllerInertia())),this.on("destroy",this.onDestroy)},UranusMultiplayerColyseusPlayer.prototype.prepare=function(){this.setControllerScript();const t=UranusUtilities.getUrlParam("uranusMultiplayerUsername");if(t&&(this.username=t),this.isRemotePlayer){this.setControllerInertia();const t=UranusMultiplayerRoom.active?.room;if(!t)return;this.onMessageHandler=t.onMessage(`playerUpdate:${this.entity.name}`,(([t,e])=>{const r=UranusMultiplayerRoom.active?.remotePlayers;if(!r)return;const s=r[t];s&&s.script.uranusMultiplayerColyseusPlayer.syncState(e)}))}},UranusMultiplayerColyseusPlayer.prototype.onDestroy=function(){},UranusMultiplayerColyseusPlayer.prototype.setControllerScript=function(){const t=this.entity.script;for(let e in t){if("function"==typeof this.entity.script[e].getNetworkState){this.controllerScript=this.entity.script[e];break}}},UranusMultiplayerColyseusPlayer.prototype.setControllerInertia=function(){this.controllerScript&&(this.controllerScript.remoteInterpolationInertia=this.interpolationInertia)},UranusMultiplayerColyseusPlayer.prototype.update=function(t){this.isRemotePlayer||(this.time+=t,this.time>=1/this.updateFrequency&&(this.time=0,this.broadcastState()))},UranusMultiplayerColyseusPlayer.prototype.broadcastState=function(){const t=UranusMultiplayerRoom.active?.room;if(!this.controllerScript||!t)return;const e=this.controllerScript.getNetworkState();this.sendToRoom(`playerUpdate:${t.sessionId}`,e)},UranusMultiplayerColyseusPlayer.prototype.syncState=function(t){this.controllerScript.syncState(t)},UranusMultiplayerColyseusPlayer.prototype.sendToRoom=function(t,e){const r=UranusMultiplayerRoom.active?.room;r?("playerUpdate"===t&&e.avatarUrl&&(this.avatarUrl=e.avatarUrl),r.send(t,e)):this.app.once("uranusMultiplayer:room:joined",(function(){this.sendToRoom(t,e)}),this)};var UranusControllerThirdPerson=pc.createScript("uranusControllerThirdPerson");UranusControllerThirdPerson.attributes.add("moveSpeed",{type:"number",default:2,title:"Move Speed",description:"The move speed of the character."}),UranusControllerThirdPerson.attributes.add("sprintSpeed",{type:"number",default:5,title:"Sprint Speed",description:"The sprint speed of the character. Set to 0.0 to disable sprinting."}),UranusControllerThirdPerson.attributes.add("jumpSpeed",{type:"number",default:30,title:"Jump Speed",description:"The player jump speed."}),UranusControllerThirdPerson.attributes.add("swimSpeed",{type:"number",default:3,title:"Swim Speed",description:"The swimming speed of the character."}),UranusControllerThirdPerson.attributes.add("flySpeed",{type:"number",default:10,title:"Fly Speed",description:"The flying speed of the character."}),UranusControllerThirdPerson.attributes.add("flyClimbRatio",{type:"number",default:.2,title:"Fly Climb Ratio",description:"The vertical flying speed climb and descend ratio."}),UranusControllerThirdPerson.attributes.add("waterLevel",{type:"number",default:0,title:"Water Level",description:"The global water level, if the player falls below this it will automatically enter swimming mode."}),UranusControllerThirdPerson.attributes.add("sprintByDefault",{type:"boolean",default:!0,title:"Sprint By Default",description:"If selected the default movement speed will be sprint."}),UranusControllerThirdPerson.attributes.add("canFly",{type:"boolean",default:!0,title:"Can Fly",description:"If selected the player will fly when double jumping."}),UranusControllerThirdPerson.attributes.add("canMantle",{type:"boolean",default:!1,title:"Can Mantle",description:"If selected the player can mantle on edges and climb up."}),UranusControllerThirdPerson.attributes.add("forceSwim",{type:"boolean",default:!1,title:"Force Swim",description:"If selected the player will be forced to swim/float."}),UranusControllerThirdPerson.attributes.add("playerToPlayerCollision",{type:"boolean",default:!0,title:"Player to Player Collision",description:"If enabled players can collide with each other. Requires application reload."}),UranusControllerThirdPerson.attributes.add("rotationStep",{type:"number",default:0,min:0,max:360,title:"Rotation Step",description:"Useful for creating a more retro 4 or 8 direction player rotation (set it to 45 or 90 for example)."}),UranusControllerThirdPerson.attributes.add("rotationInertia",{type:"number",default:10,title:"Rotation Inertia",description:"The rotation time required for the character to turn towards the movement direction."}),UranusControllerThirdPerson.attributes.add("speedChangeRate",{type:"number",default:10,title:"Speed Change Rate",description:"The acceleration/deceleration speed change amount."}),UranusControllerThirdPerson.attributes.add("mantleRate",{type:"number",default:.5,title:"Mantle Rate",description:"Controls how quickly the player mantles in place (should be synchronized with a corresponding animation)."}),UranusControllerThirdPerson.attributes.add("gravity",{type:"number",default:-15,title:"Gravity",description:"Extra gravity applied to the player in addition to the scene gravity."}),UranusControllerThirdPerson.attributes.add("jumpUpTimeout",{type:"number",default:.3,title:"Jump Up Timeout",description:"Time required to reach the maximum jump elevation when jumping."}),UranusControllerThirdPerson.attributes.add("jumpTimeout",{type:"number",default:.5,title:"Jump Timeout",description:"Time required to pass before being able to jump again. Set to 0.0 to be able to instantly jump again."}),UranusControllerThirdPerson.attributes.add("fallTimeout",{type:"number",default:.15,title:"Ground Fall Timeout",description:"Time required to pass before entering the fall state while on ground. Useful for walking down stairs."}),UranusControllerThirdPerson.attributes.add("flyFallTimeout",{type:"number",default:2,title:"Fly Fall Timeout",description:"Time required to pass before entering the fall state while on hovering on air."}),UranusControllerThirdPerson.attributes.add("groundedOffset",{type:"number",default:.1,title:"Grounded Offset",description:"The threshold in world units for the grounded property, useful to simulate movement in rough terrain."}),UranusControllerThirdPerson.attributes.add("topClamp",{type:"number",default:70,title:"Top Clamp",description:"The maximum value in angle degrees for the camera upwards movement."}),UranusControllerThirdPerson.attributes.add("bottomClamp",{type:"number",default:-30,title:"Bottom Clamp",description:"The maximum value in angle degrees for the camera downwards movement."}),UranusControllerThirdPerson.attributes.add("cameraAngleOverride",{type:"number",default:-30,title:"Camera Angle Override",description:"Additional degress to override the camera. Useful for fine tuning camera position when locked."}),UranusControllerThirdPerson.attributes.add("cameraPositionInertia",{type:"number",default:0,title:"Camera Position Inertia",description:'Controls how quickly the camera snaps into position when following the player. Lower values give more "weight" to the camera. Set to 0.0 to disable any inertia.'}),UranusControllerThirdPerson.attributes.add("cameraPivotInertia",{type:"number",default:25,title:"Camera Pivot Inertia",description:'Controls how quickly the camera snaps its point of view when following the player. Lower values give more "weight" to the camera. Set to 0.0 to disable any inertia.'}),UranusControllerThirdPerson.attributes.add("lockPlayerPosition",{type:"boolean",default:!1,title:"Lock Player Position",description:"If selected player movement will be locked in all axis."}),UranusControllerThirdPerson.attributes.add("lockCameraPosition",{type:"boolean",default:!1,title:"Lock Camera Position",description:"If selected camera movement will be locked in all axis."}),UranusControllerThirdPerson.attributes.add("lockPlayerToCameraRotation",{type:"boolean",default:!1,title:"Lock Player To Camera Rotation",description:"If selected the player will follow the camera rotation always, even stationary."}),UranusControllerThirdPerson.attributes.add("lockCameraToPlayerRotation",{type:"boolean",default:!1,title:"Lock Camera To Player Rotation",description:"If selected the camera will follow the player rotation when the player is moving."}),UranusControllerThirdPerson.attributes.add("camera",{type:"entity",title:"Camera",description:"The camera entity used for this player controller."}),UranusControllerThirdPerson.attributes.add("model",{type:"entity",title:"Model",description:"The model entity used for this player controller."}),UranusControllerThirdPerson.attributes.add("forwardEntity",{type:"entity",title:"Forward Entity",description:"You can optionally provide an entity to be used to calculate the forward direction when applying input to the controller. If no entity is provided then the model forward direction is used."}),UranusControllerThirdPerson.attributes.add("mouseSpeed",{type:"number",default:5,title:"Mouse Sensitivity"}),UranusControllerThirdPerson.attributes.add("touchSpeed",{type:"number",default:30,title:"Touch Sensitivity"}),UranusControllerThirdPerson.attributes.add("touchSprintThreshold",{type:"number",default:.9,title:"Touch Sprint Threshold",description:"Set the threshold at which the touch joystick will switch from walking to sprinting."}),UranusControllerThirdPerson.attributes.add("touchRadius",{title:"Touch Radius",description:"The radius of the virtual joystick.",type:"number",default:50}),UranusControllerThirdPerson.attributes.add("cameraWaterOffset",{title:"Camera Water Offset",description:"If a value > 0 is provided the camera will stay above the water surface by that offset.",type:"number",default:0}),UranusControllerThirdPerson.attributes.add("doubleTapInterval",{title:"Double Tap Interval",description:"The time in milliseconds between two taps of the right virtual joystick for a double tap to register. A double tap will trigger a jump. Set to 0.0 to disable double tapping for jumping.",type:"number",default:300}),UranusControllerThirdPerson.attributes.add("mousePointerLock",{type:"boolean",default:!0,title:"Mouse Pointer Lock",description:"If selected the mouse pointer will be locked on click."}),UranusControllerThirdPerson.attributes.add("horizontalFov",{type:"boolean",default:!1,title:"Horizontal Fov",description:"Control the horizontal fov property of the player camera."}),UranusControllerThirdPerson.attributes.add("landscapeFov",{type:"number",default:45,title:"Landscape Fov",description:"The camera field of view in landscape viewports."}),UranusControllerThirdPerson.attributes.add("portraitFov",{type:"number",default:45,title:"Portrait Fov",description:"The camera field of view in portrait viewports."}),UranusControllerThirdPerson.attributes.add("gamepadSpeed",{type:"number",default:150,title:"Gamepad Sensitivity"}),UranusControllerThirdPerson.attributes.add("gamepadSprintThreshold",{type:"number",default:.9,title:"Gamepad Sprint Threshold",description:"Set the threshold at which the gamepad joystick will switch from walking to sprinting."}),UranusControllerThirdPerson.attributes.add("deadZoneLow",{title:"Low Dead Zone",description:"Radial thickness of inner dead zone of pad's joysticks. This dead zone ensures that all pads report a value of 0 for each joystick axis when untouched.",type:"number",min:0,max:.4,default:.2}),UranusControllerThirdPerson.attributes.add("deadZoneHigh",{title:"High Dead Zone",description:"Radial thickness of outer dead zone of pad's joysticks. This dead zone ensures that all pads can reach the -1 and 1 limits of each joystick axis.",type:"number",min:0,max:.4,default:.2}),UranusControllerThirdPerson.attributes.add("footstepsParticles",{title:"Footsteps Particles",description:"Reference an entity with a particlesystem component to fire automatically on certain footstep actions (start moving, jumping, landing, running).",type:"entity"}),UranusControllerThirdPerson.attributes.add("gender",{type:"string",default:"none",enum:[{None:"none"},{Male:"male"},{Female:"female"}],title:"Gender",description:"The gender of the player model, used by the sound selector."}),UranusControllerThirdPerson.attributes.add("customInputEvents",{title:"Custom Input Events",description:"Add custom input events to drive player input using app wide events. Requires application restart.",type:"json",array:!0,schema:[{name:"key",type:"string",default:"jumpRequest"},{name:"event",type:"string",default:"player:jump"}]}),UranusControllerThirdPerson.prototype.initialize=function(){this.vec=new pc.Vec3,this.vec2=new pc.Vec3,this.vec3=new pc.Vec3,this.vec4=new pc.Vec3,this.vec5=new pc.Vec3,this.vec2D=new pc.Vec2,this.quat=new pc.Quat,this.grounded=!0,this.groundPoint=new pc.Vec3,this.groundNormal=new pc.Vec3,this.isMoving=!1,this.wasMoving=!1,this.wasOnGround=!1,this.canClimb=!1,this.speed=0,this.animationBlend=0,this.currentRotation=0,this.targetMantlePosition=new pc.Vec3,this.mantleMaxTime=1.25,this.mantleEndTimeout=.15,this.endMantling=!1,this.jumpSingleBoost=1,this.cameraTargetPos=new pc.Vec3,this.cameraCurrentPos=new pc.Vec3,this.cameraTargetPivot=new pc.Vec3,this.cameraCurrentPivot=new pc.Vec3,this.particlesPivot=new pc.Vec3,this.verticalVelocity=0,this.terminalVelocity=-53,this.wasOnGroundTimeout=.2,this.footParticlesTimeout=.3,this.jumpTimeoutDelta=this.jumpTimeout,this.jumpUpTimeoutDelta=this.jumpUpTimeout,this.mantleTimeoutDelta=0,this.mantleEndTimeoutDelta=0,this.fallTimeoutDelta=this.fallTimeout,this.flyFallTimeoutDelta=this.flyFallTimeout,this.wasOnGroundTimeoutDelta=this.wasOnGroundTimeout,this.footParticlesTimeoutDelta=this.footParticlesTimeout,this.initialLinearFactor=this.entity.rigidbody.linearFactor.clone(),this.floatingLinearFactor=this.initialLinearFactor.clone(),this.floatingLinearFactor.y=0,this.activeGravity=this.gravity,this.initialFriction=this.entity.rigidbody.friction,this.floatingFriction=0,this.feetOffset=this.entity.collision.height/2,this.cameraTargetPitch=0;const t=this.vec.copy(this.entity.forward).mulScalar(-1);this.cameraTargetYaw=(Math.atan2(t.x,t.z)*pc.math.RAD_TO_DEG+360)%360,this.cameraRayEnd=this.entity.findByName("RaycastEndPoint"),this.firstUpdate=!0,this.remoteEnableCooldown=pc.now(),this.isRemotePlayer=this.entity.tags.has("uranus-multiplayer-remote-player")||this.entity.tags.has("uranus-override-control");const e=this.entity.findComponent("audiolistener");this.isRemotePlayer?(this.entity.script.ccd&&(this.entity.script.ccd.enabled=!1),e&&(e.enabled=!1)):(this.uranusMultiplayerColyseusPlayer=this.entity.script.uranusMultiplayerColyseusPlayer,this.entity.script.ccd&&(this.entity.script.ccd.enabled=!0),this.customInputEvents.forEach((t=>{t.key&&t.event&&this.entity.on(t.event,(()=>{this.input[t.key]=!0}))})),e&&(e.enabled=!0)),this.footstepsParticles&&(this.isRemotePlayer?(this.footstepsParticles.enabled=!1,this.footstepsParticles=this.footstepsParticles.clone(),this.app.root.addChild(this.footstepsParticles),this.footstepsParticles.enabled=!0):this.footstepsParticles.reparent(this.app.root),this.footstepsParticlesSystem=this.footstepsParticles.findComponent("particlesystem"),this.footstepsParticlesSystem.rebuild()),this.entity.script.uranusPathfinderAgent&&(this.uranusPathfinderAgent=this.entity.script.uranusPathfinderAgent),this.networkState=void 0,this.remoteState=void 0,this.input={x:0,y:0,cameraX:0,cameraY:0,jump:!1,sprint:!1,swim:!1,fly:!1,climb:!1},this.lockAnimation=!1,this.prepare(),this.attachInputHandlers(),this.on("destroy",(function(){this.footstepsParticles&&this.footstepsParticles.destroy()})),this.isRemotePlayer||(UranusControllerThirdPerson.api=this,this.app.fire("UranusControllerThirdPerson:ready")),this.entity.on("uranusMultiplayerColyseusPlayer:avatarUrl",this.loadAvatar,this)},UranusControllerThirdPerson.prototype.prepare=function(){this.app.mouse.disableContextMenu();const t=this.entity.findComponent("audiolistener");if(this.remoteState={currentPos:new pc.Vec3,targetPos:new pc.Vec3,currentAngleY:0,targetAngleY:0,currentSpeed:0,targetSpeed:0},!1===this.playerToPlayerCollision&&(this.entity.rigidbody.group=0,this.entity.rigidbody.group=pc.BODYGROUP_USER_1,this.entity.rigidbody.mask=0,this.entity.rigidbody.mask|=pc.BODYGROUP_STATIC,this.entity.rigidbody.mask|=pc.BODYGROUP_DYNAMIC,this.entity.rigidbody.mask|=pc.BODYGROUP_KINEMATIC,this.entity.rigidbody.mask|=pc.BODYGROUP_ENGINE_1,this.entity.rigidbody.mask|=pc.BODYGROUP_TRIGGER,this.entity.rigidbody.mask|=pc.BODYGROUP_ENGINE_2,this.entity.rigidbody.mask|=pc.BODYGROUP_ENGINE_3,this.excludeRaycastGroup=pc.BODYGROUP_USER_1),this.isRemotePlayer){t&&(t.enabled=!1),this.camera&&(this.camera.enabled=!1);this.entity.findByTag("uranus-multiplayer-local-player-only").forEach((t=>t.enabled=!1))}else t&&(t.enabled=!0),this.networkState={x:0,y:0,z:0,angleY:0,speed:0,fly:!1,climb:!1}},UranusControllerThirdPerson.prototype.getNetworkState=function(){if(!this.input)return;const t=this.entity.getPosition();return this.networkState={x:t.x,y:t.y,z:t.z,angleY:this.currentRotation,speed:this.animationBlend,fly:this.input.fly,climb:this.input.climb,jump:this.input.jump},this.networkState},UranusControllerThirdPerson.prototype.syncState=function(t){this.remoteState.targetPos.set(t.x,t.y,t.z),!this.entity.enabled&&pc.now()-this.remoteEnableCooldown>=1e3&&(this.remoteState.currentPos.copy(this.remoteState.targetPos),this.entity.enabled=!0),this.remoteState.targetAngleY=t.angleY,this.currentRotation=t.angleY,this.remoteState.targetSpeed=t.speed,this.input.fly=t.fly,this.input.climb=t.climb,this.input.jump=t.jump},UranusControllerThirdPerson.prototype.loadAvatar=function(t){if(!t||this.avatarUrl===t)return!1;if(this.avatarUrl=t,0===t.indexOf("http"))return!1;const e=this.entity.findByName(t);return!!e&&(e.parent.children.forEach((t=>t.enabled=!1)),e.tags.has("model-gender")?this.gender=e.tags.has("model-gender-female")?"female":"male":this.gender="none",this.entity.anim.rootBone=e,e.enabled=!0,!this.isRemotePlayer&&this.uranusMultiplayerColyseusPlayer&&this.uranusMultiplayerColyseusPlayer.sendToRoom("playerUpdate",{avatarUrl:t}),!0)},UranusControllerThirdPerson.prototype.hasInput=function(){return!this.isRemotePlayer&&(!this.uranusPathfinderAgent||!this.uranusPathfinderAgent.enabled||this.uranusPathfinderAgent.enabled&&!this.uranusPathfinderAgent.isMoving)},UranusControllerThirdPerson.prototype.attachInputHandlers=function(){if(!1===this.hasInput())return;this.onCameraFov(),this.on("attr:horizontalFov",this.onCameraFov),this.on("attr:landscapeFov",this.onCameraFov),this.on("attr:portraitFov",this.onCameraFov);const t=this.onCameraFov.bind(this);if(window.addEventListener("resize",t,!1),this.on("destroy",(function(){window.removeEventListener("resize",t,!1)}),this),this.app.mouse){const t=this.onInputMouseUp.bind(this);this.app.mouse.on("mousemove",this.onInputMouseMove,this),this.app.mouse.on("mousedown",this.onInputMouseDown,this),this.app.mouse.on("mouseup",t,this),window.addEventListener("mouseout",t,!1),this.on("destroy",(function(){this.app.mouse.off("mousemove",this.onInputMouseMove,this),this.app.mouse.off("mousedown",this.onInputMouseDown,this),this.app.mouse.off("mouseup",this.onInputMouseUp,this),window.removeEventListener("mouseout",t,!1)}),this)}if(this.app.touch){const t=this.app.graphicsDevice.canvas;this.tounchInput={leftStick:{identifier:-1,center:new pc.Vec2,pos:new pc.Vec2},rightStick:{identifier:-1,center:new pc.Vec2,pos:new pc.Vec2}};const e=this.onInputTouchStart.bind(this),i=this.onInputTouchMove.bind(this),o=this.onInputTouchEnd.bind(this);this.entity.fire("UranusControllerThirdPerson:touchInput:enable"),t.addEventListener("touchstart",e,!1),t.addEventListener("touchmove",i,!1),t.addEventListener("touchend",o,!1),t.addEventListener("touchcancel",o,!1),this.on("destroy",(function(){t.removeEventListener("touchstart",e,!1),t.removeEventListener("touchmove",i,!1),t.removeEventListener("touchend",o,!1),t.removeEventListener("touchcancel",o,!1)}),this)}this.remappedPos=new pc.Vec2,this.gamepadInput={leftStick:{pos:new pc.Vec2},rightStick:{pos:new pc.Vec2}},this.entity.on("vr:controller:move",this.onInputGamepadMove,this),this.entity.on("vr:controller:turn",this.onInputGamepadTurn,this)},UranusControllerThirdPerson.prototype.onCameraFov=function(){this.camera&&(this.camera.camera.horizontalFov=this.horizontalFov,this.app.graphicsDevice.width>=this.app.graphicsDevice.height?this.camera.camera.fov=this.landscapeFov:this.camera.camera.fov=this.portraitFov)},UranusControllerThirdPerson.prototype.onInputMouseMove=function(t){if(pc.Mouse.isPointerLocked()||!this.mousePointerLock&&this.isMouseLeftPressed){const e=this.input;e.cameraX=-this.mouseSpeed*t.dx,e.cameraY=-this.mouseSpeed*t.dy}},UranusControllerThirdPerson.prototype.onInputMouseDown=function(t){this.entity.enabled&&!this.lockCameraPosition&&t.element===this.app.graphicsDevice.canvas&&(t.button===pc.MOUSEBUTTON_LEFT&&(this.isMouseLeftPressed=!0),this.mousePointerLock&&this.app.mouse.enablePointerLock())},UranusControllerThirdPerson.prototype.onInputMouseUp=function(t){t.button===pc.MOUSEBUTTON_LEFT&&(this.isMouseLeftPressed=!1)},UranusControllerThirdPerson.prototype.onInputKeyboard=function(){const t=this.app.keyboard,e=this.input;(t.isPressed(pc.KEY_A)||t.isPressed(pc.KEY_LEFT))&&(e.x-=1),(t.isPressed(pc.KEY_D)||t.isPressed(pc.KEY_RIGHT))&&(e.x+=1),(t.isPressed(pc.KEY_W)||t.isPressed(pc.KEY_UP))&&(e.y+=1),(t.isPressed(pc.KEY_S)||t.isPressed(pc.KEY_DOWN))&&(e.y-=1),this.lockPlayerPosition?e.jumpRequest=t.isPressed(pc.KEY_SPACE):t.isPressed(pc.KEY_SPACE)&&(e.jumpRequest=!0);const i=t.isPressed(pc.KEY_SHIFT);e.sprint=this.sprintByDefault?!i:i},UranusControllerThirdPerson.prototype.onInputTouchStart=function(t){t.preventDefault();const e=this.app.graphicsDevice,i=e.canvas,o=e.width/i.clientWidth,r=e.height/i.clientHeight,s=this.tounchInput,n=t.changedTouches;for(let t=0;t<n.length;t++){const e=n[t];if(e.pageX<=i.clientWidth/2&&-1===s.leftStick.identifier)s.leftStick.identifier=e.identifier,s.leftStick.center.set(e.pageX,e.pageY),s.leftStick.pos.set(0,0),this.entity.fire("UranusControllerThirdPerson:leftJoystick:enable",e.pageX*o,e.pageY*r);else if(e.pageX>i.clientWidth/2&&-1===s.rightStick.identifier){s.rightStick.identifier=e.identifier,s.rightStick.center.set(e.pageX,e.pageY),s.rightStick.pos.set(0,0);var a=Date.now();if(this.doubleTapInterval>0&&a-this.lastRightTap<this.doubleTapInterval){this.input.jumpRequest=!0}this.lastRightTap=a,this.entity.fire("UranusControllerThirdPerson:rightJoystick:enable",e.pageX*o,e.pageY*r)}}},UranusControllerThirdPerson.prototype.onInputTouchMove=function(t){t.preventDefault();const e=this.app.graphicsDevice,i=e.canvas,o=e.width/i.clientWidth,r=e.height/i.clientHeight,s=this.tounchInput,n=t.changedTouches;for(let t=0;t<n.length;t++){const e=n[t];e.identifier===s.leftStick.identifier?(s.leftStick.pos.set(e.pageX,e.pageY),s.leftStick.pos.sub(s.leftStick.center),s.leftStick.pos.scale(1/this.touchRadius),this.entity.fire("UranusControllerThirdPerson:leftJoystick:move",e.pageX*o,e.pageY*r)):e.identifier===s.rightStick.identifier&&(s.rightStick.pos.set(e.pageX,e.pageY),s.rightStick.pos.sub(s.rightStick.center),s.rightStick.pos.scale(1/this.touchRadius),this.entity.fire("UranusControllerThirdPerson:rightJoystick:move",e.pageX*o,e.pageY*r))}},UranusControllerThirdPerson.prototype.onInputTouchEnd=function(t){t.preventDefault();const e=this.tounchInput,i=t.changedTouches;for(let t=0;t<i.length;t++){const o=i[t];o.identifier===e.leftStick.identifier?(e.leftStick.identifier=-1,e.leftStick.pos.copy(pc.Vec3.ZERO),this.entity.fire("UranusControllerThirdPerson:leftJoystick:disable")):o.identifier===e.rightStick.identifier&&(e.rightStick.identifier=-1,e.rightStick.pos.copy(pc.Vec3.ZERO),this.entity.fire("UranusControllerThirdPerson:rightJoystick:disable"))}},UranusControllerThirdPerson.prototype.onInputTouch=function(){const t=this.tounchInput;if(!t)return;const e=this.input,i=t.leftStick.pos;if(!1===i.equals(pc.Vec2.ZERO)){e.x=i.x,e.y=-i.y;const t=i.length();e.sprint=t>this.touchSprintThreshold}const o=t.rightStick.pos;!1===o.equals(pc.Vec2.ZERO)&&(e.cameraX=-this.touchSpeed*o.x,e.cameraY=-this.touchSpeed*o.y)},UranusControllerThirdPerson.prototype.onInputGamepadMove=function(t,e){this.gamepadInput.leftStick.pos.set(t||0,e?-e:0)},UranusControllerThirdPerson.prototype.onInputGamepadTurn=function(t,e){this.gamepadInput.rightStick.pos.set(t||0,e||0)},UranusControllerThirdPerson.prototype.onInputGamepad=function(){const t=this.gamepadInput,e=this.input,i=navigator.getGamepads?navigator.getGamepads():[];for(var o=0;o<i.length;o++){const r=i[o];r&&("standard"===r.mapping&&r.axes.length>=4&&(t.leftStick.pos.set(r.axes[0],r.axes[1]),t.rightStick.pos.set(r.axes[2],r.axes[3])),this.lockPlayerPosition?e.jumpRequest=r.buttons[0].pressed:r.buttons[0].pressed&&(e.jumpRequest=!0))}!1===t.leftStick.pos.equals(pc.Vec2.ZERO)&&(this.applyRadialDeadZone(t.leftStick.pos,this.remappedPos,this.deadZoneLow,this.deadZoneHigh),e.x=this.remappedPos.x,e.y=-this.remappedPos.y,e.sprint=this.remappedPos.length()>this.gamepadSprintThreshold,t.leftStick.pos.copy(pc.Vec2.ZERO)),!1===t.rightStick.pos.equals(pc.Vec2.ZERO)&&(this.applyRadialDeadZone(t.rightStick.pos,this.remappedPos,this.deadZoneLow,this.deadZoneHigh),e.cameraX=-this.gamepadSpeed*this.remappedPos.x,e.cameraY=-this.gamepadSpeed*this.remappedPos.y,t.rightStick.pos.copy(pc.Vec2.ZERO))},UranusControllerThirdPerson.prototype.applyRadialDeadZone=function(t,e,i,o){const r=t.length();if(r>i){var s=1-o-i,n=Math.min(1,(r-i)/s)/r;e.copy(t).scale(n)}else e.set(0,0)},UranusControllerThirdPerson.prototype.resetInput=function(){const t=this.input;t.x=0,t.y=0,t.cameraX=0,t.cameraY=0},UranusControllerThirdPerson.prototype.update=function(t){const e=this.hasInput();e&&(this.onInputKeyboard(),this.onInputTouch(),this.onInputGamepad());const i=this.input;let o=i.jumpRequest;e&&this.lockPlayerPosition&&(i.x=0,i.y=0,i.jumpRequest=!1),this.checkJumpAndGravity(t),this.checkGround(),this.checkParticles(t),e&&(this.checkClimb(),this.applyMovement(t)),e&&this.lockPlayerPosition&&(i.jumpRequest=o)},UranusControllerThirdPerson.prototype.postUpdate=function(t){!this.hasInput()||!this.firstUpdate&&this.lockCameraPosition||this.rotateCamera(t),this.hasInput()?this.resetInput():this.applyRemoteMovement(t),this.firstUpdate=!1},UranusControllerThirdPerson.prototype.hasAnimation=function(){return this.entity.anim&&!this.lockAnimation},UranusControllerThirdPerson.prototype.checkParticles=function(t){if(!UranusGraphicsSettings.api.activePreset.playerParticles)return;const e=this.input,i=this.footstepsParticlesSystem;if(!1!==this.entity.uranusPlayerVisible&&i){const o=this.footstepsParticles;if((this.isMoving&&!this.wasMoving&&this.grounded||this.isMoving&&this.grounded&&e.sprint&&Math.random()>=.99||this.wasOnGround&&e.jump||this.grounded&&!this.prevGrounded&&!e.jump&&!e.climb&&this.entity.rigidbody.linearVelocity.lengthSq()>=.1)&&this.footParticlesTimeoutDelta<=0&&(this.particlesPivot.copy(this.groundPoint),i.reset(),i.play(),this.footParticlesTimeoutDelta=this.footParticlesTimeout),i.isPlaying()){const t=this.entity.getPosition();o.setPosition(t.x,this.particlesPivot.y+this.groundedOffset/2,t.z)}this.footParticlesTimeoutDelta>0&&(this.footParticlesTimeoutDelta-=t)}},UranusControllerThirdPerson.prototype.checkJumpAndGravity=function(t){const e=this.input,i=this.hasAnimation();let o=!1;const r=this.entity.anim,s=this.entity.rigidbody;if(!1===s.linearFactor.equals(this.initialLinearFactor)&&(s.linearFactor=this.initialLinearFactor),i&&(r.setBoolean("Fly",!1),this.isRemotePlayer||r.setBoolean("Climb",!1)),(e.jumpRequest&&this.jumpSpeed>0&&this.jumpTimeoutDelta<=0&&(this.grounded||this.wasOnGroundTimeoutDelta<=this.wasOnGroundTimeout)||this.isRemotePlayer&&e.jump&&this.jumpTimeoutDelta<=0)&&(e.jump=!0,e.swim=!1,this.jumpTimeoutDelta=this.jumpTimeout,this.jumpUpTimeoutDelta=this.jumpUpTimeout),this.grounded&&!this.forceSwim?(i&&(r.setBoolean("Jump",!1),r.setBoolean("FreeFall",!1),r.setBoolean("Swim",!1)),this.fallTimeoutDelta=this.fallTimeout,this.verticalVelocity<0&&(this.verticalVelocity=0),e.fly=!1):(this.wasOnGroundTimeoutDelta+=t,this.canMantle&&this.canClimb&&e.jumpRequest&&!e.climb&&(this.jumpTimeoutDelta<=0||this.jumpTimeout-this.jumpTimeoutDelta>=.3)&&(e.climb=!0,e.jump=!1,this.mantleTimeoutDelta=this.mantleMaxTime),this.fallTimeoutDelta>=0?this.fallTimeoutDelta-=t:!e.fly&&this.verticalVelocity<=1&&i&&r.setBoolean("FreeFall",!0),this.canFly&&e.jumpRequest&&(e.fly=!0,e.jump=!1,this.jumpUpTimeoutDelta=0,this.jumpTimeoutDelta=0,this.flyFallTimeoutDelta=this.flyFallTimeout,o=!0),e.jumpRequest=!1),e.climb){if(this.mantleTimeoutDelta-=t,e.jumpRequest=!1,!(this.entity.getPosition().y>=this.targetMantlePosition.y||this.mantleTimeoutDelta<=0)){const t=.0083;return this.verticalVelocity=-this.gravity*t+t*this.mantleRate*100,void(i&&(this.isRemotePlayer||r.setBoolean("Climb",!0)))}this.isRemotePlayer||(e.climb=!1),this.endMantling=!0,this.mantleEndTimeoutDelta=this.mantleEndTimeout}if(this.endMantling){if(this.mantleEndTimeoutDelta-=t,e.jumpRequest=!1,this.verticalVelocity=0,!(this.mantleEndTimeoutDelta<=0))return;this.endMantling=!1}if(e.swim&&!e.jump||e.fly)if(e.fly){const n=s.linearVelocity,a=this.vec2D.set(n.x,n.z).length()>0;i&&r.setBoolean("Fly",!0),a?(this.verticalVelocity=this.cameraTargetPitch*this.flyClimbRatio,this.flyFallTimeoutDelta=this.flyFallTimeout):(this.flyFallTimeoutDelta-=t,this.flyFallTimeoutDelta<=0&&(e.fly=!1)),o&&(this.verticalVelocity=10)}else this.verticalVelocity=0,s.linearFactor=this.floatingLinearFactor,i&&r.setBoolean("Swim",!0);else if(this.verticalVelocity>this.terminalVelocity){if(this.jumpUpTimeoutDelta>=0){this.jumpUpTimeoutDelta-=t;const e=this.jumpSpeed;this.verticalVelocity+=t*e*30,this.verticalVelocity=pc.math.clamp(this.verticalVelocity,e/2,e),this.verticalVelocity*=this.jumpSingleBoost,i&&r.setBoolean("Jump",!0),this.activeGravity=this.gravity/2}else this.activeGravity-=10*t,this.activeGravity=Math.max(this.activeGravity,this.gravity),this.isRemotePlayer||(e.jump=!1),e.jumpRequest=!1,this.jumpSingleBoost=1;this.jumpTimeoutDelta>=0&&(this.jumpTimeoutDelta-=t),this.grounded&&!e.jump?(this.verticalVelocity=-.75,this.activeGravity=this.gravity/2):this.verticalVelocity+=this.activeGravity*t}},UranusControllerThirdPerson.prototype.checkClimb=function(){if(this.grounded||!this.canMantle)return;const t=this.vec5.copy(this.model.forward.mulScalar(1.1)),e=this.entity.getPosition(),i=this.entity.collision,o=this.vec.copy(e);o.y+=i.linearOffset.y;const r=this.vec3.copy(o);o.y+=i.height/2*1.35,r.y+=i.height/2*.75;const s=this.vec2.copy(o).add(t),n=this.vec4.copy(r).add(t),a=UranusUtilities.raycastFirstRigidbody(o,s,this.excludeRaycastGroup),l=UranusUtilities.raycastFirstRigidbody(r,n,this.excludeRaycastGroup);this.canClimb=null===a&&null!==l&&l.entity!==this.entity;const h=l?.entity.script?.uranusControllerNetworkPlatform;h&&(this.uranusControllerNetworkPlatformTarget=h),this.canClimb&&(this.targetMantlePosition.copy(l.point),this.targetMantlePosition.y+=this.entity.collision.height/2)},UranusControllerThirdPerson.prototype.checkGround=function(){const t=this.input;t.climb&&this.uranusControllerNetworkPlatformTarget?this.uranusControllerNetworkPlatform=this.uranusControllerNetworkPlatformTarget:this.uranusControllerNetworkPlatform=void 0;const e=this.entity.getPosition(),i=this.vec.copy(e),o=this.entity.collision;i.y+=o.linearOffset.y;const r=this.vec2.copy(i);r.y-=this.feetOffset+this.groundedOffset;const s=UranusUtilities.raycastFirstRigidbody(i,r,this.excludeRaycastGroup);let n=null!==s&&void 0!==s.entity.rigidbody;const a=e.y<=this.waterLevel;if(this.forceSwim||a)return t.swim=!0,a&&n&&(t.swim=!1),void(this.grounded=!0);if(t.swim=!1,!t.fly&&!t.swim&&Math.abs(this.entity.rigidbody.linearVelocity.y)<.01&&(n=!0),this.wasOnGround=!n&&this.grounded,this.wasOnGround&&(this.wasOnGroundTimeoutDelta=0),this.prevGrounded=this.grounded,this.grounded=n,s){this.groundPoint.copy(s.point),this.groundNormal.copy(s.normal);const t=s.entity.script?.uranusControllerNetworkPlatform;t&&(this.uranusControllerNetworkPlatform=t),this.entity.fire("UranusControllerThirdPerson:onRaycastGround",s)}this.entity.anim&&this.entity.anim.setBoolean("Grounded",this.grounded)},UranusControllerThirdPerson.prototype.applyMovement=function(t){const e=.0083,i=this.input,o=this.hasAnimation(),r=this.sprintSpeed>0;let s,n=!1;r&&i.sprint?(s=this.sprintSpeed,n=!0):(s=this.moveSpeed,n=!0),i.swim&&(s=this.swimSpeed,n=!1),i.fly&&(s=this.flySpeed,n=!1),this.jumpTimeoutDelta>0&&this.jumpUpTimeoutDelta<=0&&(s*=.75);const a=(0!==i.x||0!==i.y)&&!i.climb;a||(s=0,n=!1);if(this.speed<s-.1?this.speed=pc.math.lerp(this.speed,1*s,t*this.speedChangeRate):this.speed=s,this.animationBlend=r?s/this.sprintSpeed:s/this.moveSpeed-.3,this.animationBlend<.01&&(this.animationBlend=0),this.app.xr.active){const t=this.model.getPosition(),e=this.vec.copy(this.model.getPosition()).add(this.camera.forward.scale(10));e.y=t.y,this.model.lookAt(e);const o=(Math.atan2(-i.x,i.y)*pc.math.RAD_TO_DEG+360)%360;this.model.rotate(0,o,0),this.currentRotation=Math.atan2(this.camera.forward.x,this.camera.forward.z)*pc.math.RAD_TO_DEG%360+180}else if(a||this.lockPlayerToCameraRotation){let e;if(this.lockCameraToPlayerRotation)e=this.cameraTargetYaw,this.wasMoving||(i.x=0,i.y=1);else if(this.forwardEntity){const t=this.vec4.copy(this.forwardEntity.forward).mulScalar(-1);e=(Math.atan2(t.x,t.z)*pc.math.RAD_TO_DEG+360)%360}else e=this.cameraTargetYaw;let o=this.clampAngle((Math.atan2(-i.x,i.y)*pc.math.RAD_TO_DEG+e)%360);const r=this.rotationStep;r>0&&(o=Math.floor(o/r)*r),this.currentRotation=this.clampAngle(pc.math.lerpAngle(this.currentRotation,o,this.rotationInertia*t));let s=o-this.currentRotation;s=Math.abs((s+180)%360-180),this.lockCameraToPlayerRotation?this.wasMoving||(this.currentRotation=o):s>=150&&(this.currentRotation=o),this.model.setEulerAngles(0,this.currentRotation,0),this.lockCameraToPlayerRotation&&(this.cameraTargetYaw=this.currentRotation)}const l=this.model.forward,h=s>0?1-(s-this.speed)/s:0;if(this.grounded&&a&&h>=.8){const t=this.groundNormal.dot(this.model.forward),e=Math.acos(this.groundNormal.dot(this.model.up))*pc.math.RAD_TO_DEG;t&&e>=20&&(this.speed+=.075*pc.math.clamp(e,0,60))}this.grounded||!a?this.entity.rigidbody.friction=this.initialFriction:this.entity.rigidbody.friction=this.floatingFriction,this.endMantling&&(this.speed=8);const u=this.vec2.copy(l.mulScalar(this.speed*e)),d=this.vec3.set(0,this.verticalVelocity*e,0);u.add(d),u.mulScalar(100),this.uranusControllerNetworkPlatform&&u.add(this.uranusControllerNetworkPlatform.linearVelocity),this.entity.rigidbody.linearVelocity=u;const c=this.speed/s;if(o){const t=this.entity.anim;t.setFloat("Speed",this.animationBlend),t.speed=n?Math.max(c,.5):1}this.wasMoving=this.isMoving,this.isMoving=a},UranusControllerThirdPerson.prototype.applyRemoteMovement=function(t){const e=this.remoteState,i=this.hasAnimation(),o=void 0!==this.remoteInterpolationInertia?this.remoteInterpolationInertia*t:1;e.currentPos.lerp(e.currentPos,e.targetPos,o);const r=this.uranusControllerNetworkPlatform;if(r&&!this.input.jump&&this.jumpTimeoutDelta<=0){0!==r.linearVelocity.y&&(e.currentPos.y=r.entity.getPosition().y+.9)}e.currentAngleY=pc.math.lerpAngle(e.currentAngleY,e.targetAngleY,o),e.currentSpeed=pc.math.lerp(e.currentSpeed,e.targetSpeed,o),this.entity.rigidbody.teleport(e.currentPos),this.model.setEulerAngles(0,e.currentAngleY,0);const s=this.sprintSpeed>0;if(i){let t=e.currentSpeed;s||(t=Math.max(t-.3,0)),this.entity.anim.setFloat("Speed",t),this.entity.anim.setBoolean("Climb",this.input.climb)}this.wasMoving=this.isMoving,this.isMoving=e.currentSpeed>=.1,this.input.sprint=s&&e.currentSpeed>.7},UranusControllerThirdPerson.prototype.rotateCamera=function(t){const e=this.input,i=this.camera?.parent;if(!i)return;this.cameraTargetYaw+=e.cameraX*t*2.5,this.cameraTargetPitch+=e.cameraY*t*2.5,this.cameraTargetPitch=this.clampAngle(this.cameraTargetPitch,this.bottomClamp,this.topClamp),i.setEulerAngles(this.cameraTargetPitch,this.cameraTargetYaw,0);const o=i.getPosition(),r=this.cameraRayEnd.getPosition(),s=UranusUtilities.raycastFirstRigidbody(o,r);let n;n=this.isColliderValid(s)?this.vec.copy(s.point).lerp(s.point,o,t):r;const a=this.cameraWaterOffset;a>0&&n.y<this.waterLevel+a&&(n.y=this.waterLevel+a),this.cameraTargetPos.copy(n),this.cameraCurrentPos=this.cameraCurrentPos.lerp(this.cameraCurrentPos,this.cameraTargetPos,.0083*this.cameraPositionInertia),this.camera.setPosition(this.cameraPositionInertia>0?this.cameraCurrentPos:this.cameraTargetPos),this.cameraTargetPivot.copy(i.getPosition()),this.cameraCurrentPivot=this.cameraCurrentPivot.lerp(this.cameraCurrentPivot,this.cameraTargetPivot,.0083*this.cameraPivotInertia),this.camera.lookAt(this.cameraPivotInertia>0?this.cameraCurrentPivot:this.cameraTargetPivot)},UranusControllerThirdPerson.prototype.isColliderValid=function(t){if(t){const e=t.entity;return!(e===this.entity||e.parent===this.entity||!e.rigidbody||e.script&&e.script.uranusControllerThirdPerson)}return!1},UranusControllerThirdPerson.prototype.clampAngle=function(t,e,i){return t<-360&&(t+=360),t>360&&(t-=360),pc.math.clamp(t,e,i)};var UranusControllerAnimationCustom=pc.createScript("uranusControllerAnimationCustom");UranusControllerAnimationCustom.attributes.add("inEditor",{type:"boolean",default:!1}),UranusControllerAnimationCustom.prototype.initialize=function(){this.playerEntity=this.entity,this.prepare(),this.app.on("uranusControllerAnimationCustom:play",this.playAnimationLocal,this)},UranusControllerAnimationCustom.prototype.prepare=function(){if(this.uranusMultiplayerColyseusPlayer=this.playerEntity.script?.uranusMultiplayerColyseusPlayer,this.isRemotePlayer=this.playerEntity.tags.has("uranus-multiplayer-remote-player"),this.isRemotePlayer){const t=UranusMultiplayerRoom.active?.room;t&&this.onJoinRoom(t),this.app.once("uranusMultiplayer:room:joined",this.onJoinRoom,this),this.on("destroy",this.onDestroy)}},UranusControllerAnimationCustom.prototype.onDestroy=function(){this.app.off("uranusMultiplayer:room:joined",this.onJoinRoom,this)},UranusControllerAnimationCustom.prototype.onJoinRoom=function(t){t.onMessage("player:animation",(([t,o])=>this.playAnimation(o)))},UranusControllerAnimationCustom.prototype.playAnimationLocal=function(t){this.isRemotePlayer||this.playAnimation(t)},UranusControllerAnimationCustom.prototype.playAnimation=function(t){const o=this.playerEntity?.anim;if(o&&t){for(let n in o.parameters){const i=o.parameters[n];if(t===n){switch(i.type){case"TRIGGER":o.setTrigger(n,!0);break;case"BOOLEAN":o.setBoolean(n,!0),this.lockPlayer(!0)}o.once("animation:completed",(function(n){"BOOLEAN"===i.type&&o.setBoolean(t,!1),this.lockPlayer(!1)}),this)}else switch(i.type){case"BOOLEAN":o.setBoolean(n,!1);break;case"FLOAT":o.setFloat(n,0)}}!this.isRemotePlayer&&this.uranusMultiplayerColyseusPlayer&&this.uranusMultiplayerColyseusPlayer.sendToRoom("player:animation",t)}},UranusControllerAnimationCustom.prototype.lockPlayer=function(t){const o=this.playerEntity?.script?.uranusControllerThirdPerson;o&&(o.lockAnimation=t,o.lockPlayerPosition=t)};var UranusControllerNetworkObject=pc.createScript("uranusControllerNetworkObject");UranusControllerNetworkObject.attributes.add("ownershipClaim",{type:"string",default:"collisionstart",enum:[{None:"none"},{"Collision Start":"collisionstart"},{"Collision Contact":"contact"},{"Trigger Enter":"triggerenter"}],title:"Ownership Claim",description:"Set how ownership for this object should be claimed by players."}),UranusControllerNetworkObject.attributes.add("ownershipEvent",{type:"string",default:"",title:"Ownership Event",description:"Optionally set a custom entity event that can be fired to claim ownership. The player entity claiming ownership should be passed as first argument."}),UranusControllerNetworkObject.attributes.add("ownershipTags",{type:"string",array:!0,title:"Ownership Tags",description:"A list of tags a player entity must have to be able to claim ownership."}),UranusControllerNetworkObject.attributes.add("ownershipDistance",{type:"number",default:10,title:"Ownership Distance",description:"Set the maximum distance this object can be from the player that claimed ownership. Getting further away will automatically drop ownership. Set to 0.0 to disable this check."}),UranusControllerNetworkObject.attributes.add("ownershipSleep",{type:"boolean",default:!0,title:"Ownership Sleep",description:"If selected and the object is a rigidbody, the owner will be cleared as soon as the body sleeps."}),UranusControllerNetworkObject.attributes.add("updateFrequency",{type:"number",default:10,min:1,precision:0,title:"Update Frequency",description:"Set how many times per second the state of this object will be broadcasted to the server."}),UranusControllerNetworkObject.attributes.add("interpolationInertia",{type:"number",default:15,min:1,title:"Interpolation Inertia",description:"Sets how smoothly remote objects will sync with the target states received. Lower values result in smoother interpolation at the expense of staying behind the remote state."}),UranusControllerNetworkObject.attributes.add("replicate",{type:"json",schema:[{name:"enabled",type:"boolean",default:!0,title:"Enabled",description:"Replicate the entity enabled state."},{name:"position",type:"boolean",default:!0,title:"Position",description:"Replicate the entity position."},{name:"rotation",type:"boolean",default:!0,title:"Rotation",description:"Replicate the entity rotation."},{name:"scale",type:"boolean",default:!1,title:"Scale",description:"Replicate the entity scale."},{name:"linearVelocity",type:"boolean",default:!1,title:"Linear Velocity",description:"Replicate the entity rigidbody linear velocity."},{name:"angularVelocity",type:"boolean",default:!1,title:"Angular Velocity",description:"Replicate the entity rigidbody angular velocity."}],title:"Replicate",description:"Choose the various states to replicate across the network. The state persists between players joining and leaving."}),UranusControllerNetworkObject.prototype.initialize=function(){this.guid=void 0,this.owner=void 0,this.time=1/0,this.localOwnerTimeout=0,this.state={},this.localState={},this.prepare(),this.on("state",this.onState,this)},UranusControllerNetworkObject.prototype.prepare=function(){this.guid=this.getPosGuid(this.entity.getPosition());const t=this.entity.collision;if(t)switch(this.ownershipClaim){case"collisionstart":case"contact":case"triggerenter":t.on(this.ownershipClaim,this.claimOwnership,this)}const e=UranusMultiplayerRoom?.active?.room;e&&this.onJoinRoom(e),this.app.on("uranusMultiplayer:room:joined",this.onJoinRoom,this)},UranusControllerNetworkObject.prototype.onDestroy=function(){this.app.off("uranusMultiplayer:room:joined",this.onJoinRoom,this)},UranusControllerNetworkObject.prototype.getPosGuid=function(t){const e=.001;let o=Math.floor(t.x/e)*e,i=Math.floor(t.y/e)*e,r=Math.floor(t.z/e)*e;return o=UranusUtilities.roundValue(o,1e3),i=UranusUtilities.roundValue(i,1e3),r=UranusUtilities.roundValue(r,1e3),`${o.toFixed(3)}_${i.toFixed(3)}_${r.toFixed(3)}`},UranusControllerNetworkObject.prototype.onJoinRoom=function(t){t.send("objectUpdate:request",this.guid),t.onMessage(`objectUpdate:${this.guid}`,(([t,e])=>{if(this.localOwnerTimeout<=0&&this.owner?.uranusMultiplayerSessionID!==t){const e=UranusMultiplayerRoom.active?.remotePlayers[t];e&&(this.owner=e,this.uranusMultiplayerColyseusPlayer=void 0)}this.syncState(e),this.owner||this.updateState(1e4)}))},UranusControllerNetworkObject.prototype.onState=function(){this.owner&&this.uranusMultiplayerColyseusPlayer&&this.broadcastState()},UranusControllerNetworkObject.prototype.update=function(t){this.owner&&(this.uranusMultiplayerColyseusPlayer?(this.time+=t,this.localOwnerTimeout>0&&(this.localOwnerTimeout-=t),this.time>=1/this.updateFrequency&&this.broadcastState()):this.updateState(t))},UranusControllerNetworkObject.prototype.claimOwnership=function(t){let e=t;if(t instanceof pc.ContactResult&&(e=t.other),!e instanceof pc.Entity)return;return e.tags.has("uranus-multiplayer-local-player")?(this.localOwnerTimeout=.5,this.owner=e,this.uranusMultiplayerColyseusPlayer=this.owner.script?.uranusMultiplayerColyseusPlayer,void this.broadcastState()):void 0},UranusControllerNetworkObject.prototype.broadcastState=function(){this.time=0;const t=this.state,e=this.replicate,o=this.entity;if(e.enabled&&(t.e=o.enabled),e.position){const e=o.getPosition();t.x=e.x,t.y=e.y,t.z=e.z}if(e.rotation){const e=o.getEulerAngles();t.rotX=e.x,t.rotY=e.y,t.rotZ=e.z}if(e.scale){const e=o.getLocalScale();t.sclX=e.x,t.sclY=e.y,t.sclZ=e.z}if(e.linearVelocity){const e=this.entity.rigidbody;if(e){const o=e.linearVelocity;t.velX=o.x,t.velY=o.y,t.velZ=o.z}}if(e.linearVelocity){const e=this.entity.rigidbody;if(e){const o=e.angularVelocity;t.aVelX=o.x,t.aVelY=o.y,t.aVelZ=o.z}}this.uranusMultiplayerColyseusPlayer&&this.uranusMultiplayerColyseusPlayer.sendToRoom(`objectUpdate:${this.guid}`,t)},UranusControllerNetworkObject.prototype.syncState=function(t){const e=this.localState,o=this.replicate,i=this.entity;o.enabled&&(i.enabled=t.e),o.position&&(e.position||(e.position={target:new pc.Vec3,current:new pc.Vec3(t.x,t.y,t.z)}),e.position.target.set(t.x,t.y,t.z)),o.rotation&&(e.rotation||(e.rotation={target:new pc.Vec3,current:new pc.Vec3(t.rotX,t.rotY,t.rotZ)}),e.rotation.target.set(t.rotX,t.rotY,t.rotZ)),o.scale&&(e.scale||(e.scale={target:new pc.Vec3,current:new pc.Vec3(t.sclX,t.sclY,t.sclZ)}),e.scale.target.set(t.sclX,t.sclY,t.sclZ)),o.linearVelocity&&(e.linearVelocity||(e.linearVelocity={target:new pc.Vec3,current:new pc.Vec3(t.velX,t.velY,t.velZ)}),e.linearVelocity.target.set(t.velX,t.velY,t.velZ)),o.angularVelocity&&(e.angularVelocity||(e.angularVelocity={target:new pc.Vec3,current:new pc.Vec3(t.aVelX,t.aVelY,t.aVelZ)}),e.angularVelocity.target.set(t.aVelX,t.aVelY,t.aVelZ))},UranusControllerNetworkObject.prototype.updateState=function(t){const e=this.localState,o=this.entity,i=this.entity.rigidbody,r=this.interpolationInertia*t,n=e.position,a=e.rotation,s=e.scale,l=e.linearVelocity,c=e.angularVelocity;n&&this.lerpState(e.position,r),a&&this.lerpState(e.rotation,r),s&&this.lerpState(e.scale,r),l&&this.lerpState(e.linearVelocity,r),c&&this.lerpState(e.angularVelocity,r);let u=!1;if(n){const t=e.position.current;if(i&&i.type===pc.BODYTYPE_DYNAMIC)if(a){u=!0;const o=e.rotation.current;i.teleport(t.x,t.y,t.z,o.x,o.y,o.z)}else i.teleport(t.x,t.y,t.z);else o.setPosition(t.x,t.y,t.z)}if(a&&!u){const t=e.rotation.current;o.setEulerAngles(t.x,t.y,t.z)}},UranusControllerNetworkObject.prototype.lerpState=function(t,e){const o=Math.abs(t.current.x-t.target.x),i=Math.abs(t.current.y-t.target.y),r=Math.abs(t.current.z-t.target.z);e>0&&o<1&&i<1&&r<1?t.current.lerp(t.current,t.target,e):t.current.copy(t.target)};var UranusUtilities=pc.createScript("uranusUtilities");UranusUtilities.workerMinRestTime=2e3,UranusUtilities.workersResting=0,UranusUtilities.waitForWorker=function(e){},UranusUtilities.loadAsset=function(e,n){return new Promise((t=>{const i=pc.Application.getApplication(),r=e instanceof pc.Asset?e:i.assets.find(e,n);r?(r.ready(t),i.assets.load(r)):t()}))},UranusUtilities.loadAssets=function(e){return new Promise((n=>{const t=pc.Application.getApplication();let i=0;e=e.filter((e=>e instanceof pc.Asset)),Array.isArray(e)||(e=[e]);const r=e.length,onAssetReady=function(){i+=1,i>=r&&n()};for(let n=0;n<e.length;n++){const i=e[n];i&&(i.loaded?onAssetReady():(i.ready(onAssetReady),t.assets.load(i)))}e&&e.length||onAssetReady()}))},UranusUtilities.copyCameraProperties=function(e,n){if(!e||!n)return;const t=e.camera,i=n.camera;t.fov=i.fov,t.aspectRatio=i.aspectRatio,t.clearColor=i.clearColor,t.clearColorBuffer=i.clearColorBuffer,t.clearDepthBuffer=i.clearDepthBuffer,t.clearStencilBuffer=i.clearStencilBuffer,t.farClip=i.farClip,t.nearClip=i.nearClip,t.frustumCulling=i.frustumCulling,t.rect.copy(i.rect)},UranusUtilities.readPixelsFromTexture=function(e){const n=pc.Application.getApplication().graphicsDevice.gl,t=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,t),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e._glTexture,0);const i=new Uint8Array(e.width*e.height*4);return n.readPixels(0,0,e.width,e.height,n.RGBA,n.UNSIGNED_BYTE,i),n.bindFramebuffer(n.FRAMEBUFFER,null),i},UranusUtilities.getWorkerLibraryUrl=function(e){const n=`importScripts( "${e}" );`;return URL.createObjectURL(new Blob([n],{type:"text/javascript"}))},UranusUtilities.createWorker=function(e,n){let t;const i=pc.Application.getApplication().assets.find(n,"script");if(i){const n=UranusUtilities.getWorkerLibraryUrl(UranusUtilities.getAbsoluteUrl(i.getFileUrl()));t=new Worker(n),t.addEventListener("message",(n=>UranusUtilities.onWorkerMessage(e,n)))}return t},UranusUtilities.onWorkerMessage=function(e,n){const t=n.data.type;if(!t)return;const i=n.data.data;e.fire(`worker:${t}`,i)},UranusUtilities.postWorkerMessage=function(e,n,t,i){const r=[];i&&UranusUtilities.getMessageBuffers(t,r),e.postMessage({type:n,data:t},r)},UranusUtilities.getMessageBuffers=function(e,n){Object.keys(e).forEach((t=>{e[t]&&(e[t].buffer?n.push(e[t].buffer):"object"==typeof e[t]&&UranusUtilities.getMessageBuffers(e[t],n))}))},UranusUtilities.getAbsoluteUrl=function(e){if(0===e.indexOf("http"))return e;const n=new URL(window.location.href);let t=n.origin;return 0===e.indexOf("/")?t+=e:t+=n.pathname+e,t},UranusUtilities.serializeEntityTRS=function(e){const n=e.getLocalPosition(),t=e.getLocalEulerAngles(),i=e.getLocalScale();return{position:{x:n.x,y:n.y,z:n.z},rotation:{x:t.x,y:t.y,z:t.z},scale:{x:i.x,y:i.y,z:i.z}}},UranusUtilities.serializeVec3=function(e){return{x:e.x,y:e.y,z:e.z}},UranusUtilities.deserializeVec3=function(e){return new pc.Vec3(e.x,e.y,e.z)},UranusUtilities.prepareShaderForInjection=function(e,n){const t=`${n}_uranusBase`;if(e.chunks[t])return;let i;if("transformVS"===n)i="\n// INJECT uniforms\n\nuniform mat4 matrix_view;\nuniform vec3 view_position;\n\n#ifdef PIXELSNAP\nuniform vec4 uScreenSize;\n#endif\n\n#ifdef MORPHING\nuniform vec4 morph_weights_a;\nuniform vec4 morph_weights_b;\n#endif\n\n#ifdef MORPHING_TEXTURE_BASED\nuniform vec4 morph_tex_params;\n\nvec2 getTextureMorphCoords() {\n    float vertexId = morph_vertex_id;\n    vec2 textureSize = morph_tex_params.xy;\n    vec2 invTextureSize = morph_tex_params.zw;\n\n    // turn vertexId into int grid coordinates\n    float morphGridV = floor(vertexId * invTextureSize.x);\n    float morphGridU = vertexId - (morphGridV * textureSize.x);\n\n    // convert grid coordinates to uv coordinates with half pixel offset\n    return (vec2(morphGridU, morphGridV) * invTextureSize) + (0.5 * invTextureSize);\n}\n#endif\n\n#ifdef MORPHING_TEXTURE_BASED_POSITION\nuniform highp sampler2D morphPositionTex;\n#endif\n\nmat4 getModelMatrix() {\n    #ifdef DYNAMICBATCH\n    return getBoneMatrix(vertex_boneIndices);\n    #elif defined(SKIN)\n    return matrix_model * getSkinMatrix(vertex_boneIndices, vertex_boneWeights);\n    #elif defined(INSTANCING)\n    return mat4(instance_line1, instance_line2, instance_line3, instance_line4);\n    #else\n    return matrix_model;\n    #endif\n}\n\nvec4 getPosition() {\n    dModelMatrix = getModelMatrix();\n    vec3 localPos = vertex_position;\n\n    #ifdef NINESLICED\n    // outer and inner vertices are at the same position, scale both\n    localPos.xz *= outerScale;\n\n    // offset inner vertices inside\n    // (original vertices must be in [-1;1] range)\n    vec2 positiveUnitOffset = clamp(vertex_position.xz, vec2(0.0), vec2(1.0));\n    vec2 negativeUnitOffset = clamp(-vertex_position.xz, vec2(0.0), vec2(1.0));\n    localPos.xz += (-positiveUnitOffset * innerOffset.xy + negativeUnitOffset * innerOffset.zw) * vertex_texCoord0.xy;\n\n    vTiledUv = (localPos.xz - outerScale + innerOffset.xy) * -0.5 + 1.0; // uv = local pos - inner corner\n\n    localPos.xz *= -0.5; // move from -1;1 to -0.5;0.5\n    localPos = localPos.xzy;\n    #endif\n\n    #ifdef MORPHING\n    #ifdef MORPHING_POS03\n    localPos.xyz += morph_weights_a[0] * morph_pos0;\n    localPos.xyz += morph_weights_a[1] * morph_pos1;\n    localPos.xyz += morph_weights_a[2] * morph_pos2;\n    localPos.xyz += morph_weights_a[3] * morph_pos3;\n    #endif // MORPHING_POS03\n    #ifdef MORPHING_POS47\n    localPos.xyz += morph_weights_b[0] * morph_pos4;\n    localPos.xyz += morph_weights_b[1] * morph_pos5;\n    localPos.xyz += morph_weights_b[2] * morph_pos6;\n    localPos.xyz += morph_weights_b[3] * morph_pos7;\n    #endif // MORPHING_POS47\n    #endif // MORPHING\n\n    #ifdef MORPHING_TEXTURE_BASED_POSITION\n    // apply morph offset from texture\n    vec2 morphUV = getTextureMorphCoords();\n    vec3 morphPos = texture2D(morphPositionTex, morphUV).xyz;\n    localPos += morphPos;\n    #endif\n\n    vec4 posW = dModelMatrix * vec4(localPos, 1.0);\n\n// INJECT chunk\n\n    #ifdef SCREENSPACE\n    posW.zw = vec2(0.0, 1.0);\n    #endif\n    dPositionW = posW.xyz;\n\n    vec4 screenPos;\n\n    #ifdef UV1LAYOUT\n    screenPos = vec4(vertex_texCoord1.xy * 2.0 - 1.0, 0.5, 1);\n    #else\n    #ifdef SCREENSPACE\n    screenPos = posW;\n    #else\n    screenPos = matrix_viewProjection * posW;\n    #endif\n\n    #ifdef PIXELSNAP\n    // snap vertex to a pixel boundary\n    screenPos.xy = (screenPos.xy * 0.5) + 0.5;\n    screenPos.xy *= uScreenSize.xy;\n    screenPos.xy = floor(screenPos.xy);\n    screenPos.xy *= uScreenSize.zw;\n    screenPos.xy = (screenPos.xy * 2.0) - 1.0;\n    #endif\n    #endif\n\n    return screenPos;\n}\n\nvec3 getWorldPosition() {\n    return dPositionW;\n}           \n";else i=`\n// INJECT uniforms\n\n${pc.shaderChunks[n]}\n`,i=i.replace("() {","() {                \n// INJECT preChunk\n"),i=i.replace(new RegExp("}\n"),"\n// INJECT chunk\n}    \n");e.chunks[t]=i},UranusUtilities.addUranusBaseUniforms=function(e){let n;if(e.chunks.basePS){if(n=e.chunks.basePS,n.indexOf("uranus_view_position")>-1)return}else n=pc.shaderChunks.basePS;e.chunks.basePS=`\nuniform vec3 uranus_view_position;\n\n${n}\n`,e.chunks.APIVersion=pc.CHUNKAPI_1_62},UranusUtilities.textCapitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},UranusUtilities.findEntityMeshInstances=function(e,n){let t=[];Array.isArray(e)?e.forEach((e=>{e instanceof pc.Entity!=!1&&(t=t.concat(e.findComponents("model").concat(e.findComponents("render"))))})):t=e.findComponents("model").concat(e.findComponents("render")),n&&(t=t.filter((e=>!1===e.entity.tags.has(...n))));let i=[];return t.forEach((e=>{i=i.concat(e.meshInstances)})),i},UranusUtilities.getMeshGeometry=function(e){const n=e.node.getWorldTransform(),t=e.mesh.vertexBuffer,i=new pc.VertexIterator(t),r=[],s=new pc.Vec3;for(let e=0;e<t.getNumVertices();e++){const e=i.element[pc.SEMANTIC_POSITION],t=e.array[e.index],o=e.array[e.index+1],a=e.array[e.index+2];s.set(t,o,a),n.transformPoint(s,s),r.push(s.x,s.y,s.z),i.next()}i.end();const o=e.mesh.indexBuffer[pc.RENDERSTYLE_SOLID],a=new Uint16Array(o.lock()),c=[],l=e.mesh.primitive[0].base,f=e.mesh.primitive[0].count;for(let e=0;e<f;e++)c.push(a[e+l]);return{vertices:r,indices:c,numIndices:f,numVertices:r.length/3}},UranusUtilities.getCombinedGeometry=function(e){const n=[],t=[];let i=0,r=0;for(let s=0;s<e.length;s++){const o=e[s],a=UranusUtilities.getMeshGeometry(o);let c=0;for(let e=0;e<a.vertices.length;e+=3)t.push(a.vertices[e],a.vertices[e+1],a.vertices[e+2]),c++;for(let e=0;e<a.indices.length;e+=3)n.push(a.indices[e+2]+r,a.indices[e+1]+r,a.indices[e]+r);i+=a.vertices.length/3,r+=c}return{positions:t,indices:n,offset:i}},UranusUtilities.vecToRecast=function(e){return new Recast.Vec3(e.x,e.y,e.z)},UranusUtilities.recastToVec=function(e,n){return n?n.set(e.x,e.y,e.z):new pc.Vec3(e.x,e.y,e.z)},UranusUtilities.loadGlbContainerFromAsset=function(e,n,t,i){const r=pc.Application.getApplication();var s=function(e){var r=new Blob([e.resource]),s=URL.createObjectURL(r);return this.loadGlbContainerFromUrl(s,n,t,(function(e,n){i(e,n),URL.revokeObjectURL(s)}))}.bind(this);e.ready(s),r.assets.load(e)},UranusUtilities.loadGlbContainerFromUrl=function(e,n,t,i){const r=pc.Application.getApplication();var s=t+".glb",o={url:e,filename:s},a=new pc.Asset(s,"container",o,null,n);return a.once("load",(function(e){if(i){var n=e.resource.animations;if(1==n.length)n[0].name=t;else if(n.length>1)for(var r=0;r<n.length;++r)n[r].name=t+" "+r.toString();i(null,e)}})),r.assets.add(a),r.assets.load(a),a},UranusUtilities.getUrlParam=function(e){const n=new URLSearchParams(window.location.search);if(!0===n.has(e))return n.get(e)},UranusUtilities.itemHasTag=function(e,n){if(window.UranusEditor&&!0===window.UranusEditor.inEditor()){let t;return e instanceof pc.Entity?t=editor.entities.get(e._guid):e instanceof pc.Asset&&(t=editor.assets.get(e.id)),!!t&&(t&&t.get("tags").indexOf(n)>-1)}return e.tags.has(n)},UranusUtilities.shuffleArray=function(e,n){n||(n=Math.random);for(var t=e.length-1;t>0;t--){var i=Math.floor(n()*(t+1)),r=e[t];e[t]=e[i],e[i]=r}return e},UranusUtilities.roundValue=function(e,n){return Math.round(e*n)/n},UranusUtilities._distanceVec3=new pc.Vec3,UranusUtilities.raycastFirstRigidbody=function(e,n,t){const i=UranusUtilities._distanceVec3;let r=Number.MAX_VALUE,s=null;const o=pc.app.systems.rigidbody.raycastAll(e,n);for(let n=0;n<o.length;++n){const a=o[n],c=a.entity.rigidbody;if(c&&(void 0===t||c.group!==t)){i.sub2(a.point,e);const n=i.lengthSq();n<r&&(r=n,s=a)}}return s};var ObjectPortal=pc.createScript("objectPortal");ObjectPortal.attributes.add("checkpoint",{type:"entity",default:5,title:"Checkpoint",description:"The checkpoint to travel to."}),ObjectPortal.lastPortal=void 0,ObjectPortal.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.entity.collision.on("triggerleave",this.onTriggerLeave,this)},ObjectPortal.prototype.onTriggerEnter=async function(t){if(t.tags.has("uranus-multiplayer-remote-player"))return;this.app.fire("player:sound:play","Reward"),this.app.fire("ad:respawnCheckpointButton:hide"),this.app.fire("ad:respawnLastButton:hide"),this.app.fire("ad:saveCheckpoint:hide");const e=this.checkpoint.getPosition().y-1;this.app.fire("text:travelUp-indicator:set",InterfaceElevationIndicator.prototype.formatHeightRaw(e)),this.app.fire("ad:travelUpButton:show"),ObjectPortal.lastPortal=this.checkpoint},ObjectPortal.prototype.onTriggerLeave=function(t){t.tags.has("uranus-multiplayer-remote-player")||(this.app.fire("ad:travelUpButton:hide"),ObjectPortal.lastPortal=void 0)};